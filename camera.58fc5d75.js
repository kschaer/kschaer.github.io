parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({57:[function(require,module,exports) {

},{}],239:[function(require,module,exports) {
var o=Math.ceil,r=Math.floor;module.exports=function(t){return isNaN(t=+t)?0:(t>0?r:o)(t)};
},{}],240:[function(require,module,exports) {
module.exports=function(o){if(null==o)throw TypeError("Can't call method on  "+o);return o};
},{}],128:[function(require,module,exports) {
var e=require("./_to-integer"),r=require("./_defined");module.exports=function(t){return function(n,i){var o,u,c=String(r(n)),d=e(i),a=c.length;return d<0||d>=a?t?"":void 0:(o=c.charCodeAt(d))<55296||o>56319||d+1===a||(u=c.charCodeAt(d+1))<56320||u>57343?t?c.charAt(d):o:t?c.slice(d,d+2):u-56320+(o-55296<<10)+65536}};
},{"./_to-integer":239,"./_defined":240}],135:[function(require,module,exports) {
module.exports=!0;
},{}],124:[function(require,module,exports) {

var e=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e);
},{}],63:[function(require,module,exports) {
var e=module.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e);
},{}],139:[function(require,module,exports) {
module.exports=function(o){if("function"!=typeof o)throw TypeError(o+" is not a function!");return o};
},{}],136:[function(require,module,exports) {
var r=require("./_a-function");module.exports=function(n,t,u){if(r(n),void 0===t)return n;switch(u){case 1:return function(r){return n.call(t,r)};case 2:return function(r,u){return n.call(t,r,u)};case 3:return function(r,u,e){return n.call(t,r,u,e)}}return function(){return n.apply(t,arguments)}};
},{"./_a-function":139}],138:[function(require,module,exports) {
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};
},{}],211:[function(require,module,exports) {
var r=require("./_is-object");module.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e};
},{"./_is-object":138}],253:[function(require,module,exports) {
module.exports=function(r){try{return!!r()}catch(r){return!0}};
},{}],230:[function(require,module,exports) {
module.exports=!require("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a});
},{"./_fails":253}],227:[function(require,module,exports) {
var e=require("./_is-object"),r=require("./_global").document,t=e(r)&&e(r.createElement);module.exports=function(e){return t?r.createElement(e):{}};
},{"./_is-object":138,"./_global":124}],383:[function(require,module,exports) {
module.exports=!require("./_descriptors")&&!require("./_fails")(function(){return 7!=Object.defineProperty(require("./_dom-create")("div"),"a",{get:function(){return 7}}).a});
},{"./_descriptors":230,"./_fails":253,"./_dom-create":227}],382:[function(require,module,exports) {
var t=require("./_is-object");module.exports=function(r,e){if(!t(r))return r;var o,n;if(e&&"function"==typeof(o=r.toString)&&!t(n=o.call(r)))return n;if("function"==typeof(o=r.valueOf)&&!t(n=o.call(r)))return n;if(!e&&"function"==typeof(o=r.toString)&&!t(n=o.call(r)))return n;throw TypeError("Can't convert object to primitive value")};
},{"./_is-object":138}],228:[function(require,module,exports) {
var e=require("./_an-object"),r=require("./_ie8-dom-define"),t=require("./_to-primitive"),i=Object.defineProperty;exports.f=require("./_descriptors")?Object.defineProperty:function(o,n,u){if(e(o),n=t(n,!0),e(u),r)try{return i(o,n,u)}catch(e){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(o[n]=u.value),o};
},{"./_an-object":211,"./_ie8-dom-define":383,"./_to-primitive":382,"./_descriptors":230}],238:[function(require,module,exports) {
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};
},{}],125:[function(require,module,exports) {
var r=require("./_object-dp"),e=require("./_property-desc");module.exports=require("./_descriptors")?function(t,u,o){return r.f(t,u,e(1,o))}:function(r,e,t){return r[e]=t,r};
},{"./_object-dp":228,"./_property-desc":238,"./_descriptors":230}],229:[function(require,module,exports) {
var r={}.hasOwnProperty;module.exports=function(e,n){return r.call(e,n)};
},{}],130:[function(require,module,exports) {

var e=require("./_global"),r=require("./_core"),n=require("./_ctx"),t=require("./_hide"),i=require("./_has"),u="prototype",o=function(c,a,f){var l,s,p,h=c&o.F,v=c&o.G,q=c&o.S,w=c&o.P,_=c&o.B,y=c&o.W,d=v?r:r[a]||(r[a]={}),F=d[u],g=v?e:q?e[a]:(e[a]||{})[u];for(l in v&&(f=a),f)(s=!h&&g&&void 0!==g[l])&&i(d,l)||(p=s?g[l]:f[l],d[l]=v&&"function"!=typeof g[l]?f[l]:_&&s?n(p,e):y&&g[l]==p?function(e){var r=function(r,n,t){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,t)}return e.apply(this,arguments)};return r[u]=e[u],r}(p):w&&"function"==typeof p?n(Function.call,p):p,w&&((d.virtual||(d.virtual={}))[l]=p,c&o.R&&F&&!F[l]&&t(F,l,p)))};o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,o.U=64,o.R=128,module.exports=o;
},{"./_global":124,"./_core":63,"./_ctx":136,"./_hide":125,"./_has":229}],243:[function(require,module,exports) {
module.exports=require("./_hide");
},{"./_hide":125}],126:[function(require,module,exports) {
module.exports={};
},{}],220:[function(require,module,exports) {
var r={}.toString;module.exports=function(t){return r.call(t).slice(8,-1)};
},{}],260:[function(require,module,exports) {
var e=require("./_cof");module.exports=Object("z").propertyIsEnumerable(0)?Object:function(r){return"String"==e(r)?r.split(""):Object(r)};
},{"./_cof":220}],237:[function(require,module,exports) {
var e=require("./_iobject"),r=require("./_defined");module.exports=function(i){return e(r(i))};
},{"./_iobject":260,"./_defined":240}],223:[function(require,module,exports) {
var e=require("./_to-integer"),r=Math.min;module.exports=function(t){return t>0?r(e(t),9007199254740991):0};
},{"./_to-integer":239}],409:[function(require,module,exports) {
var e=require("./_to-integer"),r=Math.max,t=Math.min;module.exports=function(n,a){return(n=e(n))<0?r(n+a,0):t(n,a)};
},{"./_to-integer":239}],407:[function(require,module,exports) {
var e=require("./_to-iobject"),r=require("./_to-length"),t=require("./_to-absolute-index");module.exports=function(n){return function(i,o,u){var f,l=e(i),a=r(l.length),c=t(u,a);if(n&&o!=o){for(;a>c;)if((f=l[c++])!=f)return!0}else for(;a>c;c++)if((n||c in l)&&l[c]===o)return n||c||0;return!n&&-1}};
},{"./_to-iobject":237,"./_to-length":223,"./_to-absolute-index":409}],241:[function(require,module,exports) {

var r=require("./_core"),e=require("./_global"),o="__core-js_shared__",i=e[o]||(e[o]={});(module.exports=function(r,e){return i[r]||(i[r]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:require("./_library")?"pure":"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"});
},{"./_core":63,"./_global":124,"./_library":135}],242:[function(require,module,exports) {
var o=0,t=Math.random();module.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++o+t).toString(36))};
},{}],263:[function(require,module,exports) {
var e=require("./_shared")("keys"),r=require("./_uid");module.exports=function(u){return e[u]||(e[u]=r(u))};
},{"./_shared":241,"./_uid":242}],399:[function(require,module,exports) {
var r=require("./_has"),e=require("./_to-iobject"),u=require("./_array-includes")(!1),i=require("./_shared-key")("IE_PROTO");module.exports=function(o,a){var n,s=e(o),t=0,h=[];for(n in s)n!=i&&r(s,n)&&h.push(n);for(;a.length>t;)r(s,n=a[t++])&&(~u(h,n)||h.push(n));return h};
},{"./_has":229,"./_to-iobject":237,"./_array-includes":407,"./_shared-key":263}],352:[function(require,module,exports) {
module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");
},{}],388:[function(require,module,exports) {
var e=require("./_object-keys-internal"),r=require("./_enum-bug-keys");module.exports=Object.keys||function(u){return e(u,r)};
},{"./_object-keys-internal":399,"./_enum-bug-keys":352}],351:[function(require,module,exports) {
var e=require("./_object-dp"),r=require("./_an-object"),t=require("./_object-keys");module.exports=require("./_descriptors")?Object.defineProperties:function(o,i){r(o);for(var u,c=t(i),n=c.length,s=0;n>s;)e.f(o,u=c[s++],i[u]);return o};
},{"./_object-dp":228,"./_an-object":211,"./_object-keys":388,"./_descriptors":230}],226:[function(require,module,exports) {
var e=require("./_global").document;module.exports=e&&e.documentElement;
},{"./_global":124}],261:[function(require,module,exports) {
var e=require("./_an-object"),r=require("./_object-dps"),t=require("./_enum-bug-keys"),n=require("./_shared-key")("IE_PROTO"),o=function(){},i="prototype",u=function(){var e,r=require("./_dom-create")("iframe"),n=t.length;for(r.style.display="none",require("./_html").appendChild(r),r.src="javascript:",(e=r.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u[i][t[n]];return u()};module.exports=Object.create||function(t,c){var a;return null!==t?(o[i]=e(t),a=new o,o[i]=null,a[n]=t):a=u(),void 0===c?a:r(a,c)};
},{"./_an-object":211,"./_object-dps":351,"./_enum-bug-keys":352,"./_shared-key":263,"./_dom-create":227,"./_html":226}],127:[function(require,module,exports) {
var e=require("./_shared")("wks"),r=require("./_uid"),o=require("./_global").Symbol,u="function"==typeof o,i=module.exports=function(i){return e[i]||(e[i]=u&&o[i]||(u?o:r)("Symbol."+i))};i.store=e;
},{"./_shared":241,"./_uid":242,"./_global":124}],146:[function(require,module,exports) {
var e=require("./_object-dp").f,r=require("./_has"),o=require("./_wks")("toStringTag");module.exports=function(t,u,i){t&&!r(t=i?t:t.prototype,o)&&e(t,o,{configurable:!0,value:u})};
},{"./_object-dp":228,"./_has":229,"./_wks":127}],244:[function(require,module,exports) {
"use strict";var e=require("./_object-create"),r=require("./_property-desc"),t=require("./_set-to-string-tag"),i={};require("./_hide")(i,require("./_wks")("iterator"),function(){return this}),module.exports=function(o,u,s){o.prototype=e(i,{next:r(1,s)}),t(o,u+" Iterator")};
},{"./_object-create":261,"./_property-desc":238,"./_set-to-string-tag":146,"./_hide":125,"./_wks":127}],262:[function(require,module,exports) {
var e=require("./_defined");module.exports=function(r){return Object(e(r))};
},{"./_defined":240}],245:[function(require,module,exports) {
var t=require("./_has"),e=require("./_to-object"),o=require("./_shared-key")("IE_PROTO"),r=Object.prototype;module.exports=Object.getPrototypeOf||function(c){return c=e(c),t(c,o)?c[o]:"function"==typeof c.constructor&&c instanceof c.constructor?c.constructor.prototype:c instanceof Object?r:null};
},{"./_has":229,"./_to-object":262,"./_shared-key":263}],129:[function(require,module,exports) {
"use strict";var e=require("./_library"),r=require("./_export"),t=require("./_redefine"),i=require("./_hide"),n=require("./_iterators"),u=require("./_iter-create"),o=require("./_set-to-string-tag"),s=require("./_object-gpo"),a=require("./_wks")("iterator"),c=!([].keys&&"next"in[].keys()),f="@@iterator",l="keys",q="values",y=function(){return this};module.exports=function(_,p,h,k,v,w,d){u(h,p,k);var x,b,g,j=function(e){if(!c&&e in I)return I[e];switch(e){case l:case q:return function(){return new h(this,e)}}return function(){return new h(this,e)}},m=p+" Iterator",A=v==q,F=!1,I=_.prototype,O=I[a]||I[f]||v&&I[v],P=O||j(v),z=v?A?j("entries"):P:void 0,B="Array"==p&&I.entries||O;if(B&&(g=s(B.call(new _)))!==Object.prototype&&g.next&&(o(g,m,!0),e||"function"==typeof g[a]||i(g,a,y)),A&&O&&O.name!==q&&(F=!0,P=function(){return O.call(this)}),e&&!d||!c&&!F&&I[a]||i(I,a,P),n[p]=P,n[m]=y,v)if(x={values:A?P:j(q),keys:w?P:j(l),entries:z},d)for(b in x)b in I||t(I,b,x[b]);else r(r.P+r.F*(c||F),p,x);return x};
},{"./_library":135,"./_export":130,"./_redefine":243,"./_hide":125,"./_iterators":126,"./_iter-create":244,"./_set-to-string-tag":146,"./_object-gpo":245,"./_wks":127}],58:[function(require,module,exports) {
"use strict";var i=require("./_string-at")(!0);require("./_iter-define")(String,"String",function(i){this._t=String(i),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})});
},{"./_string-at":128,"./_iter-define":129}],235:[function(require,module,exports) {
module.exports=function(){};
},{}],236:[function(require,module,exports) {
module.exports=function(e,n){return{value:n,done:!!e}};
},{}],123:[function(require,module,exports) {
"use strict";var e=require("./_add-to-unscopables"),r=require("./_iter-step"),t=require("./_iterators"),i=require("./_to-iobject");module.exports=require("./_iter-define")(Array,"Array",function(e,r){this._t=i(e),this._i=0,this._k=r},function(){var e=this._t,t=this._k,i=this._i++;return!e||i>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?i:"values"==t?e[i]:[i,e[i]])},"values"),t.Arguments=t.Array,e("keys"),e("values"),e("entries");
},{"./_add-to-unscopables":235,"./_iter-step":236,"./_iterators":126,"./_to-iobject":237,"./_iter-define":129}],59:[function(require,module,exports) {

require("./es6.array.iterator");for(var t=require("./_global"),e=require("./_hide"),i=require("./_iterators"),r=require("./_wks")("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),L=0;L<s.length;L++){var a=s[L],l=t[a],S=l&&l.prototype;S&&!S[r]&&e(S,r,a),i[a]=i.Array}
},{"./es6.array.iterator":123,"./_global":124,"./_hide":125,"./_iterators":126,"./_wks":127}],137:[function(require,module,exports) {
var e=require("./_cof"),t=require("./_wks")("toStringTag"),n="Arguments"==e(function(){return arguments}()),r=function(e,t){try{return e[t]}catch(e){}};module.exports=function(u){var o,c,i;return void 0===u?"Undefined":null===u?"Null":"string"==typeof(c=r(o=Object(u),t))?c:n?e(o):"Object"==(i=e(o))&&"function"==typeof o.callee?"Arguments":i};
},{"./_cof":220,"./_wks":127}],140:[function(require,module,exports) {
module.exports=function(o,n,r,i){if(!(o instanceof n)||void 0!==i&&i in o)throw TypeError(r+": incorrect invocation!");return o};
},{}],221:[function(require,module,exports) {
var r=require("./_an-object");module.exports=function(t,e,o,a){try{return a?e(r(o)[0],o[1]):e(o)}catch(e){var c=t.return;throw void 0!==c&&r(c.call(t)),e}};
},{"./_an-object":211}],222:[function(require,module,exports) {
var r=require("./_iterators"),e=require("./_wks")("iterator"),t=Array.prototype;module.exports=function(o){return void 0!==o&&(r.Array===o||t[e]===o)};
},{"./_iterators":126,"./_wks":127}],224:[function(require,module,exports) {
var r=require("./_classof"),e=require("./_wks")("iterator"),t=require("./_iterators");module.exports=require("./_core").getIteratorMethod=function(o){if(null!=o)return o[e]||o["@@iterator"]||t[r(o)]};
},{"./_classof":137,"./_wks":127,"./_iterators":126,"./_core":63}],141:[function(require,module,exports) {
var e=require("./_ctx"),r=require("./_iter-call"),t=require("./_is-array-iter"),i=require("./_an-object"),o=require("./_to-length"),n=require("./core.get-iterator-method"),u={},a={},f=module.exports=function(f,l,c,q,_){var h,s,d,g,p=_?function(){return f}:n(f),v=e(c,q,l?2:1),x=0;if("function"!=typeof p)throw TypeError(f+" is not iterable!");if(t(p)){for(h=o(f.length);h>x;x++)if((g=l?v(i(s=f[x])[0],s[1]):v(f[x]))===u||g===a)return g}else for(d=p.call(f);!(s=d.next()).done;)if((g=r(d,v,s.value,l))===u||g===a)return g};f.BREAK=u,f.RETURN=a;
},{"./_ctx":136,"./_iter-call":221,"./_is-array-iter":222,"./_an-object":211,"./_to-length":223,"./core.get-iterator-method":224}],131:[function(require,module,exports) {
var r=require("./_an-object"),e=require("./_a-function"),u=require("./_wks")("species");module.exports=function(n,o){var i,t=r(n).constructor;return void 0===t||null==(i=r(t)[u])?o:e(i)};
},{"./_an-object":211,"./_a-function":139,"./_wks":127}],225:[function(require,module,exports) {
module.exports=function(e,r,l){var a=void 0===l;switch(r.length){case 0:return a?e():e.call(l);case 1:return a?e(r[0]):e.call(l,r[0]);case 2:return a?e(r[0],r[1]):e.call(l,r[0],r[1]);case 3:return a?e(r[0],r[1],r[2]):e.call(l,r[0],r[1],r[2]);case 4:return a?e(r[0],r[1],r[2],r[3]):e.call(l,r[0],r[1],r[2],r[3])}return e.apply(l,r)};
},{}],142:[function(require,module,exports) {


var e,t,n,i=require("./_ctx"),o=require("./_invoke"),r=require("./_html"),s=require("./_dom-create"),a=require("./_global"),c=a.process,u=a.setImmediate,p=a.clearImmediate,f=a.MessageChannel,l=a.Dispatch,d=0,m={},h="onreadystatechange",g=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},v=function(e){g.call(e.data)};u&&p||(u=function(t){for(var n=[],i=1;arguments.length>i;)n.push(arguments[i++]);return m[++d]=function(){o("function"==typeof t?t:Function(t),n)},e(d),d},p=function(e){delete m[e]},"process"==require("./_cof")(c)?e=function(e){c.nextTick(i(g,e,1))}:l&&l.now?e=function(e){l.now(i(g,e,1))}:f?(n=(t=new f).port2,t.port1.onmessage=v,e=i(n.postMessage,n,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts?(e=function(e){a.postMessage(e+"","*")},a.addEventListener("message",v,!1)):e=h in s("script")?function(e){r.appendChild(s("script"))[h]=function(){r.removeChild(this),g.call(e)}}:function(e){setTimeout(i(g,e,1),0)}),module.exports={set:u,clear:p};
},{"./_ctx":136,"./_invoke":225,"./_html":226,"./_dom-create":227,"./_global":124,"./_cof":220}],143:[function(require,module,exports) {


var e=require("./_global"),t=require("./_task").set,r=e.MutationObserver||e.WebKitMutationObserver,n=e.process,o=e.Promise,a="process"==require("./_cof")(n);module.exports=function(){var i,c,s,v=function(){var e,t;for(a&&(e=n.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?s():c=void 0,e}}c=void 0,e&&e.enter()};if(a)s=function(){n.nextTick(v)};else if(!r||e.navigator&&e.navigator.standalone)if(o&&o.resolve){var u=o.resolve(void 0);s=function(){u.then(v)}}else s=function(){t.call(e,v)};else{var f=!0,l=document.createTextNode("");new r(v).observe(l,{characterData:!0}),s=function(){l.data=f=!f}}return function(e){var t={fn:e,next:void 0};c&&(c.next=t),i||(i=t,s()),c=t}};
},{"./_global":124,"./_task":142,"./_cof":220}],133:[function(require,module,exports) {
"use strict";var r=require("./_a-function");function e(e){var o,t;this.promise=new e(function(r,e){if(void 0!==o||void 0!==t)throw TypeError("Bad Promise constructor");o=r,t=e}),this.resolve=r(o),this.reject=r(t)}module.exports.f=function(r){return new e(r)};
},{"./_a-function":139}],134:[function(require,module,exports) {
module.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}};
},{}],144:[function(require,module,exports) {

var e=require("./_global"),r=e.navigator;module.exports=r&&r.userAgent||"";
},{"./_global":124}],132:[function(require,module,exports) {
var r=require("./_an-object"),e=require("./_is-object"),i=require("./_new-promise-capability");module.exports=function(o,t){if(r(o),e(t)&&t.constructor===o)return t;var u=i.f(o);return(0,u.resolve)(t),u.promise};
},{"./_an-object":211,"./_is-object":138,"./_new-promise-capability":133}],145:[function(require,module,exports) {
var r=require("./_hide");module.exports=function(e,i,n){for(var o in i)n&&e[o]?e[o]=i[o]:r(e,o,i[o]);return e};
},{"./_hide":125}],147:[function(require,module,exports) {

"use strict";var e=require("./_global"),r=require("./_core"),i=require("./_object-dp"),t=require("./_descriptors"),u=require("./_wks")("species");module.exports=function(o){var c="function"==typeof r[o]?r[o]:e[o];t&&c&&!c[u]&&i.f(c,u,{configurable:!0,get:function(){return this}})};
},{"./_global":124,"./_core":63,"./_object-dp":228,"./_descriptors":230,"./_wks":127}],148:[function(require,module,exports) {
var r=require("./_wks")("iterator"),t=!1;try{var n=[7][r]();n.return=function(){t=!0},Array.from(n,function(){throw 2})}catch(r){}module.exports=function(n,e){if(!e&&!t)return!1;var u=!1;try{var o=[7],c=o[r]();c.next=function(){return{done:u=!0}},o[r]=function(){return c},n(o)}catch(r){}return u};
},{"./_wks":127}],60:[function(require,module,exports) {


"use strict";var e,r,t,i,n=require("./_library"),o=require("./_global"),c=require("./_ctx"),s=require("./_classof"),u=require("./_export"),a=require("./_is-object"),_=require("./_a-function"),h=require("./_an-instance"),f=require("./_for-of"),l=require("./_species-constructor"),v=require("./_task").set,d=require("./_microtask")(),p=require("./_new-promise-capability"),m=require("./_perform"),q=require("./_user-agent"),y=require("./_promise-resolve"),j="Promise",w=o.TypeError,g=o.process,x=g&&g.versions,b=x&&x.v8||"",k=o[j],P="process"==s(g),F=function(){},S=r=p.f,E=!!function(){try{var e=k.resolve(1),r=(e.constructor={})[require("./_wks")("species")]=function(e){e(F,F)};return(P||"function"==typeof PromiseRejectionEvent)&&e.then(F)instanceof r&&0!==b.indexOf("6.6")&&-1===q.indexOf("Chrome/66")}catch(e){}}(),O=function(e){var r;return!(!a(e)||"function"!=typeof(r=e.then))&&r},R=function(e,r){if(!e._n){e._n=!0;var t=e._c;d(function(){for(var i=e._v,n=1==e._s,o=0,c=function(r){var t,o,c,s=n?r.ok:r.fail,u=r.resolve,a=r.reject,_=r.domain;try{s?(n||(2==e._h&&H(e),e._h=1),!0===s?t=i:(_&&_.enter(),t=s(i),_&&(_.exit(),c=!0)),t===r.promise?a(w("Promise-chain cycle")):(o=O(t))?o.call(t,u,a):u(t)):a(i)}catch(e){_&&!c&&_.exit(),a(e)}};t.length>o;)c(t[o++]);e._c=[],e._n=!1,r&&!e._h&&C(e)})}},C=function(e){v.call(o,function(){var r,t,i,n=e._v,c=G(e);if(c&&(r=m(function(){P?g.emit("unhandledRejection",n,e):(t=o.onunhandledrejection)?t({promise:e,reason:n}):(i=o.console)&&i.error&&i.error("Unhandled promise rejection",n)}),e._h=P||G(e)?2:1),e._a=void 0,c&&r.e)throw r.v})},G=function(e){return 1!==e._h&&0===(e._a||e._c).length},H=function(e){v.call(o,function(){var r;P?g.emit("rejectionHandled",e):(r=o.onrejectionhandled)&&r({promise:e,reason:e._v})})},T=function(e){var r=this;r._d||(r._d=!0,(r=r._w||r)._v=e,r._s=2,r._a||(r._a=r._c.slice()),R(r,!0))},U=function(e){var r,t=this;if(!t._d){t._d=!0,t=t._w||t;try{if(t===e)throw w("Promise can't be resolved itself");(r=O(e))?d(function(){var i={_w:t,_d:!1};try{r.call(e,c(U,i,1),c(T,i,1))}catch(e){T.call(i,e)}}):(t._v=e,t._s=1,R(t,!1))}catch(e){T.call({_w:t,_d:!1},e)}}};E||(k=function(r){h(this,k,j,"_h"),_(r),e.call(this);try{r(c(U,this,1),c(T,this,1))}catch(e){T.call(this,e)}},(e=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=require("./_redefine-all")(k.prototype,{then:function(e,r){var t=S(l(this,k));return t.ok="function"!=typeof e||e,t.fail="function"==typeof r&&r,t.domain=P?g.domain:void 0,this._c.push(t),this._a&&this._a.push(t),this._s&&R(this,!1),t.promise},catch:function(e){return this.then(void 0,e)}}),t=function(){var r=new e;this.promise=r,this.resolve=c(U,r,1),this.reject=c(T,r,1)},p.f=S=function(e){return e===k||e===i?new t(e):r(e)}),u(u.G+u.W+u.F*!E,{Promise:k}),require("./_set-to-string-tag")(k,j),require("./_set-species")(j),i=require("./_core")[j],u(u.S+u.F*!E,j,{reject:function(e){var r=S(this);return(0,r.reject)(e),r.promise}}),u(u.S+u.F*(n||!E),j,{resolve:function(e){return y(n&&this===i?k:this,e)}}),u(u.S+u.F*!(E&&require("./_iter-detect")(function(e){k.all(e).catch(F)})),j,{all:function(e){var r=this,t=S(r),i=t.resolve,n=t.reject,o=m(function(){var t=[],o=0,c=1;f(e,!1,function(e){var s=o++,u=!1;t.push(void 0),c++,r.resolve(e).then(function(e){u||(u=!0,t[s]=e,--c||i(t))},n)}),--c||i(t)});return o.e&&n(o.v),t.promise},race:function(e){var r=this,t=S(r),i=t.reject,n=m(function(){f(e,!1,function(e){r.resolve(e).then(t.resolve,i)})});return n.e&&i(n.v),t.promise}});
},{"./_library":135,"./_global":124,"./_ctx":136,"./_classof":137,"./_export":130,"./_is-object":138,"./_a-function":139,"./_an-instance":140,"./_for-of":141,"./_species-constructor":131,"./_task":142,"./_microtask":143,"./_new-promise-capability":133,"./_perform":134,"./_user-agent":144,"./_promise-resolve":132,"./_wks":127,"./_redefine-all":145,"./_set-to-string-tag":146,"./_set-species":147,"./_core":63,"./_iter-detect":148}],61:[function(require,module,exports) {

"use strict";var r=require("./_export"),e=require("./_core"),t=require("./_global"),n=require("./_species-constructor"),i=require("./_promise-resolve");r(r.P+r.R,"Promise",{finally:function(r){var o=n(this,e.Promise||t.Promise),u="function"==typeof r;return this.then(u?function(e){return i(o,r()).then(function(){return e})}:r,u?function(e){return i(o,r()).then(function(){throw e})}:r)}});
},{"./_export":130,"./_core":63,"./_global":124,"./_species-constructor":131,"./_promise-resolve":132}],62:[function(require,module,exports) {
"use strict";var r=require("./_export"),e=require("./_new-promise-capability"),i=require("./_perform");r(r.S,"Promise",{try:function(r){var t=e.f(this),o=i(r);return(o.e?t.reject:t.resolve)(o.v),t.promise}});
},{"./_export":130,"./_new-promise-capability":133,"./_perform":134}],31:[function(require,module,exports) {
require("../modules/es6.object.to-string"),require("../modules/es6.string.iterator"),require("../modules/web.dom.iterable"),require("../modules/es6.promise"),require("../modules/es7.promise.finally"),require("../modules/es7.promise.try"),module.exports=require("../modules/_core").Promise;
},{"../modules/es6.object.to-string":57,"../modules/es6.string.iterator":58,"../modules/web.dom.iterable":59,"../modules/es6.promise":60,"../modules/es7.promise.finally":61,"../modules/es7.promise.try":62,"../modules/_core":63}],16:[function(require,module,exports) {
module.exports={default:require("core-js/library/fn/promise"),__esModule:!0};
},{"core-js/library/fn/promise":31}],204:[function(require,module,exports) {
"use strict";function i(){var i=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isMobile=i;
},{}],105:[function(require,module,exports) {
"use strict";function e(e){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.doc=e;
},{}],98:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertArgumentsAreTensors=n,exports.shuffle=e,exports.clamp=o,exports.randUniform=a,exports.distSquared=i,exports.assert=s,exports.assertShapesMatch=u,exports.assertTypesMatch=f,exports.flatten=h,exports.inferShape=p,exports.sizeFromShape=l,exports.isScalarShape=c,exports.arraysEqual=y,exports.isInt=d,exports.tanh=m,exports.sizeToSquarishShape=v,exports.createShuffledIndices=x,exports.rightPad=g,exports.repeatedTry=w,exports.getQueryParams=A,exports.inferFromImplicitShape=S,exports.squeezeShape=b,exports.getTypedArrayFromDType=E,exports.isTensorInList=M,exports.checkForNaN=F,exports.flattenNameArrayMap=I,exports.unflattenToNameArrayMap=N,exports.hasEncodingLoss=U,exports.copyTypedArray=q,exports.isTypedArray=k,exports.bytesPerElement=z,exports.isFunction=C,exports.getTensorsInContainer=P;var r=require("./tensor");function t(t,n,e){s(t instanceof r.Tensor,"Argument '"+n+"' passed to '"+e+"' must be a Tensor, but got "+typeof t+".")}function n(r,n){var e=function(e){var o=r[e];Array.isArray(o)?o.forEach(function(r,o){t(r,e+"["+o+"]",n)}):t(o,e,n)};for(var o in r)e(o)}function e(r){for(var t=r.length,n=0,e=0;t>0;)e=Math.random()*t|0,n=r[--t],r[t]=r[e],r[e]=n}function o(r,t,n){return Math.max(r,Math.min(t,n))}function a(r,t){return Math.random()*(t-r)+r}function i(r,t){for(var n=0,e=0;e<r.length;e++){var o=Number(r[e])-Number(t[e]);n+=o*o}return n}function s(r,t){if(!r)throw new Error(t)}function u(r,t,n){void 0===n&&(n=""),s(y(r,t),n+" Shapes "+r+" and "+t+" must match")}function f(r,t){s(r.dtype===t.dtype," The dtypes of the first("+r.dtype+") and second("+t.dtype+") input must match")}function h(r,t){if(void 0===t&&(t=[]),Array.isArray(r))for(var n=0;n<r.length;++n)h(r[n],t);else t.push(r);return t}function p(r){if(k(r))return[r.length];if(!Array.isArray(r))return[];for(var t=[];r instanceof Array;)t.push(r.length),r=r[0];return t}function l(r){if(0===r.length)return 1;for(var t=r[0],n=1;n<r.length;n++)t*=r[n];return t}function c(r){return 0===r.length}function y(r,t){if(r.length!==t.length)return!1;for(var n=0;n<r.length;n++)if(r[n]!==t[n])return!1;return!0}function d(r){return r%1==0}function m(r){if(null!=Math.tanh)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var t=Math.exp(2*r);return(t-1)/(t+1)}function v(r){for(var t=Math.floor(Math.sqrt(r));t>1;--t)if(r%t==0)return[t,r/t];return[1,r]}function x(r){for(var t=new Uint32Array(r),n=0;n<r;++n)t[n]=n;return e(t),t}function g(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function w(r,t,n){return void 0===t&&(t=function(r){return 0}),new Promise(function(e,o){var a=0,i=function(){if(r())e();else{var s=t(++a);null!=n&&a>=n?o():setTimeout(i,s)}};i()})}function A(r){var t={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(r){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return T(t,n[0],n[1]),n.join("=")}),t}function T(r,t,n){r[decodeURIComponent(t)]=decodeURIComponent(n||"")}function S(r,t){for(var n=1,e=-1,o=0;o<r.length;++o)if(r[o]>0)n*=r[o];else if(-1===r[o]){if(-1!==e)throw Error("Shapes can only have 1 implicit size. Found - 1 at dim "+e+" and dim "+o);e=o}else if(r[o]<=0)throw Error("Shapes can not be <= 0. Found "+r[o]+" at dim "+o);if(-1===e){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+r);return r}if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=r.slice();return a[e]=t/n,a}function b(r,t){for(var n=[],e=[],o=0,a=0;a<r.length;++a){if(null!=t){if(t[o]===a&&r[a]>1)throw new Error("Can't squeeze axis "+a+" since its dim '"+r[a]+"' is not 1");(null==t[o]||t[o]>a)&&1===r[a]&&(n.push(r[a]),e.push(a)),t[o]<=a&&o++}r[a]>1&&(n.push(r[a]),e.push(a))}return{newShape:n,keptDims:e}}function E(r,t){var n=null;if(null==r||"float32"===r)n=new Float32Array(t);else if("int32"===r)n=new Int32Array(t);else{if("bool"!==r)throw new Error("Unknown data type "+r);n=new Uint8Array(t)}return n}function M(r,t){for(var n=0;n<t.length;n++)if(t[n].id===r.id)return!0;return!1}function F(r,t,n){if("float32"===t)for(var e=0;e<r.length;e++)if(isNaN(r[e]))throw Error("The result of the '"+n+"' has NaNs.")}function I(t,n){var e=[];if(t instanceof r.Tensor)e.push(t);else for(var o=t,a=0;a<n.length;a++)e.push(o[n[a]]);return e}function N(r,t){if(r.length!==t.length)throw new Error("Cannot unflatten Tensor[], keys and arrays are not of same length.");for(var n={},e=0;e<r.length;e++)n[r[e]]=t[e];return n}function U(r,t){return"float32"!==t&&(("int32"!==t||"float32"===r)&&("bool"!==t||"bool"!==r))}function q(r,t){if(null==t||"float32"===t)return new Float32Array(r);if("int32"===t)return new Int32Array(r);if("bool"===t){for(var n=new Uint8Array(r.length),e=0;e<n.length;++e)0!==Math.round(r[e])&&(n[e]=1);return n}throw new Error("Unknown data type "+t)}function k(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function z(r){if("float32"===r||"int32"===r)return 4;if("bool"===r)return 1;throw new Error("Unknown dtype "+r)}function C(r){return!!(r&&r.constructor&&r.call&&r.apply)}function P(r){var t=[];return j(r,t,new Set),t}function j(t,n,e){if(null!=t)if(t instanceof r.Tensor)n.push(t);else if(D(t)){var o=t;for(var a in o){var i=o[a];e.has(i)||(e.add(i),j(i,n,e))}}}function D(r){return Array.isArray(r)||"object"==typeof r}
},{"./tensor":101}],210:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tensorToString=o;var r=require("./util"),n=a(r);function a(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a]);return n.default=r,n}var t=20,e=3,u=7;function o(r,n){var a=r.dataSync(),t=i(r),e=p(a,r.shape,r.strides,t),u=["Tensor"];return n&&(u.push("  dtype: "+r.dtype),u.push("  rank: "+r.rank),u.push("  shape: ["+r.shape+"]"),u.push("  values:")),u.push(e.map(function(r){return"    "+r}).join("\n")),u.join("\n")}function i(r){var n=r.dataSync(),a=r.size,t=r.strides[r.strides.length-1],e=new Array(t).fill(0);if(r.rank>1)for(var u=0;u<a/t;u++)for(var o=u*t,i=0;i<t;i++)e[i]=Math.max(e[i],s(n[o+i],0).length);return e}function s(r,a){return n.rightPad(parseFloat(r.toFixed(u)).toString(),a)}function p(r,n,a,u,o){void 0===o&&(o=!0);var i=n[0],f=n.length;if(0===f)return[r[0].toString()];if(1===f){if(i>t){var l=Array.from(r.subarray(0,e)),h=Array.from(r.subarray(i-e,i));return["["+l.map(function(r,n){return s(r,u[n])}).join(", ")+", ..., "+h.map(function(r,n){return s(r,u[i-e+n])}).join(", ")+"]"]}return["["+Array.from(r).map(function(r,n){return s(r,u[n])}).join(", ")+"]"]}var v=n.slice(1),y=a.slice(1),c=a[0],d=[];if(i>t){for(var g=0;g<e;g++){var m=(b=g*c)+c;d.push.apply(d,p(r.subarray(b,m),v,y,u,!1))}d.push("...");for(g=i-e;g<i;g++){m=(b=g*c)+c;d.push.apply(d,p(r.subarray(b,m),v,y,u,g===i-1))}}else for(g=0;g<i;g++){var b;m=(b=g*c)+c;d.push.apply(d,p(r.subarray(b,m),v,y,u,g===i-1))}var j=2===f?",":"";d[0]="["+d[0]+j;for(g=1;g<d.length-1;g++)d[g]=" "+d[g]+j;var S=",\n";for(g=2;g<f;g++)S+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":S),d}
},{"./util":98}],312:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.axesAreInnerMostDims=t,exports.combineLocations=u,exports.computeOutAndReduceShapes=o,exports.expandShapeToKeepDim=s,exports.parseAxisParam=i,exports.assertAxesAreInnerMostDims=a,exports.getAxesPermutation=f,exports.getUndoAxesPermutation=p,exports.getInnerMostAxes=c;var n=require("../util"),r=e(n);function e(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e]);return r.default=n,r}function t(n,r){for(var e=0;e<n.length;++e)if(n[n.length-e-1]!==r-1-e)return!1;return!0}function u(n,r,e){for(var t=n.length+r.length,u=[],o=0,s=0,i=0;i<t;i++)-1===e.indexOf(i)?u.push(n[o++]):u.push(r[s++]);return u}function o(n,r){for(var e=[],t=n.length,u=0;u<t;u++)-1===r.indexOf(u)&&e.push(n[u]);return[e,r.map(function(r){return n[r]})]}function s(n,r){return u(n,r.map(function(n){return 1}),r)}function i(n,e){var t=e.length;return n=null==n?e.map(function(n,r){return r}):[].concat(n),r.assert(n.every(function(n){return n>=-t&&n<t}),"All values in axis param must be in range [-"+t+", "+t+") but got axis "+n),r.assert(n.every(function(n){return r.isInt(n)}),"All values in axis param must be integers but got axis "+n),n.map(function(n){return n<0?t+n:n})}function a(n,e,u){r.assert(t(e,u),n+" supports only inner-most axes for now. Got axes "+e+" and rank-"+u+" input.")}function f(n,r){if(t(n,r))return null;for(var e=[],u=0;u<r;++u)-1===n.indexOf(u)&&e.push(u);return n.forEach(function(n){return e.push(n)}),e}function p(n){return n.map(function(n,r){return[r,n]}).sort(function(n,r){return n[1]-r[1]}).map(function(n){return n[0]})}function c(n,r){for(var e=[],t=r-n;t<r;++t)e.push(t);return e}
},{"../util":98}],355:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertParams=n,exports.computeOutShape1D=a,exports.computeOutShape=o,exports.computeGradientSliceShapes=s;var e=require("../util"),t=r(e);function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e,r,n){var a=e.length,o=r.length;t.assert(e.length===r.length,"Error in concat"+a+"D: rank of x1 ("+a+") and x2 ("+o+") must be the same."),t.assert(n>=0&&n<a,"Error in concat"+a+"D: axis must be between 0 and "+(a-1)+".");for(var s=0;s<a;s++)t.assert(s===n||e[s]===r[s],"Error in concat"+a+"D: Shape ("+e+") does not match ("+r+") along the non-concatenated axis "+s+".")}function a(e,r){t.assert(1===e.length&&1===r.length,"x1 and x2 should be 1d array.");var n=e.slice();return n[0]+=r[0],n}function o(e,r,n){t.assert(e.length===r.length,"x1 and x2 should have the same rank.");var a=e.slice();return a[n]+=r[n],a}function s(e,t){return{aBegin:[0,0],aSize:e,bBegin:[0,e[1]],bSize:t}}
},{"../util":98}],246:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.operation=r;var e=require("../globals");function r(r,t,n){var o=n.value;return n.value=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(0,e.tidy)(t,function(){return o.apply(void 0,r)})},n}
},{"../globals":104}],362:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConcatOps=void 0;var e=require("../doc"),n=require("../environment"),t=require("../util"),r=s(t),o=require("./axis_util"),a=require("./concat_util"),c=s(a),i=require("./operation");function s(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}var u=function(e,n,t,r){var o,a=arguments.length,c=a<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,n,t,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(c=(a<3?o(c):a>3?o(n,t,c):o(n,t))||c);return a>3&&c&&Object.defineProperty(n,t,c),c},p=function(){function n(){}return n.concat1d=function(e){return n.concat(e,0)},n.concat2d=function(e,t){return n.concat(e,t)},n.concat3d=function(e,t){return n.concat(e,t)},n.concat4d=function(e,t){return n.concat(e,t)},n.concat=function(e,n){void 0===n&&(n=0),r.assert(e.length>=1,"Pass at least one tensor to concat"),r.assertArgumentsAreTensors({tensors:e},"concat");var t=e[0];if(1===e.length)return t;for(var a=(0,o.parseAxisParam)(n,t.shape),c=1;c<e.length;++c)t=l(t,e[c],a[0]);return t},u([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),i.operation],n,"concat",null),n}();function l(e,t,o){c.assertParams(e.shape,t.shape,o);var a=c.computeOutShape(e.shape,t.shape,o),i=e.as2D(-1,r.sizeFromShape(e.shape.slice(o))),s=t.as2D(-1,r.sizeFromShape(t.shape.slice(o))),u=c.computeGradientSliceShapes(i.shape,s.shape),p=u.aBegin,l=u.aSize,f=u.bBegin,h=u.bSize;return n.ENV.engine.runKernel(function(e){return e.concat(i,s)},{a:i,b:s},function(e){return{a:function(){return e.slice(p,l)},b:function(){return e.slice(f,h)}}}).reshape(a)}exports.ConcatOps=p;
},{"../doc":105,"../environment":95,"../util":98,"./axis_util":312,"./concat_util":355,"./operation":246}],390:[function(require,module,exports) {
var define;
var t;!function(t,n,e){function s(t){var n,e=this,s=(n=4022871197,function(t){t=t.toString();for(var e=0;e<t.length;e++){var s=.02519603282416938*(n+=t.charCodeAt(e));s-=n=s>>>0,n=(s*=n)>>>0,n+=4294967296*(s-=n)}return 2.3283064365386963e-10*(n>>>0)});e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=s(" "),e.s1=s(" "),e.s2=s(" "),e.s0-=s(t),e.s0<0&&(e.s0+=1),e.s1-=s(t),e.s1<0&&(e.s1+=1),e.s2-=s(t),e.s2<0&&(e.s2+=1),s=null}function r(t,n){return n.c=t.c,n.s0=t.s0,n.s1=t.s1,n.s2=t.s2,n}function o(t,n){var e=new s(t),o=n&&n.state,u=e.next;return u.int32=function(){return 4294967296*e.next()|0},u.double=function(){return u()+1.1102230246251565e-16*(2097152*u()|0)},u.quick=u,o&&("object"==typeof o&&r(o,e),u.state=function(){return r(e,{})}),u}n&&n.exports?n.exports=o:e&&e.amd?e(function(){return o}):this.alea=o}(0,"object"==typeof module&&module,"function"==typeof t&&t);
},{}],391:[function(require,module,exports) {
var define;
var t;!function(t,n,e){function r(t){var n=this,e="";n.x=0,n.y=0,n.z=0,n.w=0,n.next=function(){var t=n.x^n.x<<11;return n.x=n.y,n.y=n.z,n.z=n.w,n.w^=n.w>>>19^t^t>>>8},t===(0|t)?n.x=t:e+=t;for(var r=0;r<e.length+64;r++)n.x^=0|e.charCodeAt(r),n.next()}function o(t,n){return n.x=t.x,n.y=t.y,n.z=t.z,n.w=t.w,n}function u(t,n){var e=new r(t),u=n&&n.state,x=function(){return(e.next()>>>0)/4294967296};return x.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},x.int32=e.next,x.quick=x,u&&("object"==typeof u&&o(u,e),x.state=function(){return o(e,{})}),x}n&&n.exports?n.exports=u:e&&e.amd?e(function(){return u}):this.xor128=u}(0,"object"==typeof module&&module,"function"==typeof t&&t);
},{}],392:[function(require,module,exports) {
var define;
var t;!function(t,n,e){function o(t){var n=this,e="";n.next=function(){var t=n.x^n.x>>>2;return n.x=n.y,n.y=n.z,n.z=n.w,n.w=n.v,(n.d=n.d+362437|0)+(n.v=n.v^n.v<<4^t^t<<1)|0},n.x=0,n.y=0,n.z=0,n.w=0,n.v=0,t===(0|t)?n.x=t:e+=t;for(var o=0;o<e.length+64;o++)n.x^=0|e.charCodeAt(o),o==e.length&&(n.d=n.x<<10^n.x>>>4),n.next()}function r(t,n){return n.x=t.x,n.y=t.y,n.z=t.z,n.w=t.w,n.v=t.v,n.d=t.d,n}function u(t,n){var e=new o(t),u=n&&n.state,x=function(){return(e.next()>>>0)/4294967296};return x.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},x.int32=e.next,x.quick=x,u&&("object"==typeof u&&r(u,e),x.state=function(){return r(e,{})}),x}n&&n.exports?n.exports=u:e&&e.amd?e(function(){return u}):this.xorwow=u}(0,"object"==typeof module&&module,"function"==typeof t&&t);
},{}],393:[function(require,module,exports) {
var define;
var n;!function(n,t,e){function r(n){var t=this;t.next=function(){var n,e,r=t.x,o=t.i;return n=r[o],e=(n^=n>>>7)^n<<24,e^=(n=r[o+1&7])^n>>>10,e^=(n=r[o+3&7])^n>>>3,e^=(n=r[o+4&7])^n<<7,n=r[o+7&7],e^=(n^=n<<13)^n<<9,r[o]=e,t.i=o+1&7,e},function(n,t){var e,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,e=0;e<t.length;++e)r[7&e]=r[7&e]<<15^t.charCodeAt(e)+r[e+1&7]<<13;for(;r.length<8;)r.push(0);for(e=0;e<8&&0===r[e];++e);for(8==e?r[7]=-1:r[e],n.x=r,n.i=0,e=256;e>0;--e)n.next()}(t,n)}function o(n,t){return t.x=n.x.slice(),t.i=n.i,t}function i(n,t){null==n&&(n=+new Date);var e=new r(n),i=t&&t.state,u=function(){return(e.next()>>>0)/4294967296};return u.double=function(){do{var n=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===n);return n},u.int32=e.next,u.quick=u,i&&(i.x&&o(i,e),u.state=function(){return o(e,{})}),u}t&&t.exports?t.exports=i:e&&e.amd?e(function(){return i}):this.xorshift7=i}(0,"object"==typeof module&&module,"function"==typeof n&&n);
},{}],394:[function(require,module,exports) {
var define;
var n;!function(n,t,e){function r(n){var t=this;t.next=function(){var n,e,r=t.w,o=t.X,u=t.i;return t.w=r=r+1640531527|0,e=o[u+34&127],n=o[u=u+1&127],e^=e<<13,n^=n<<17,e^=e>>>15,n^=n>>>12,e=o[u]=e^n,t.i=u,e+(r^r>>>16)|0},function(n,t){var e,r,o,u,i,c=[],f=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,f=Math.max(f,t.length)),o=0,u=-32;u<f;++u)t&&(r^=t.charCodeAt((u+32)%t.length)),0===u&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,u>=0&&(i=i+1640531527|0,o=0==(e=c[127&u]^=r+i)?o+1:0);for(o>=128&&(c[127&(t&&t.length||0)]=-1),o=127,u=512;u>0;--u)r=c[o+34&127],e=c[o=o+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,c[o]=r^e;n.w=i,n.X=c,n.i=o}(t,n)}function o(n,t){return t.i=n.i,t.w=n.w,t.X=n.X.slice(),t}function u(n,t){null==n&&(n=+new Date);var e=new r(n),u=t&&t.state,i=function(){return(e.next()>>>0)/4294967296};return i.double=function(){do{var n=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===n);return n},i.int32=e.next,i.quick=i,u&&(u.X&&o(u,e),i.state=function(){return o(e,{})}),i}t&&t.exports?t.exports=u:e&&e.amd?e(function(){return u}):this.xor4096=u}(0,"object"==typeof module&&module,"function"==typeof n&&n);
},{}],395:[function(require,module,exports) {
var define;
var t;!function(t,n,e){function o(t){var n=this,e="";n.next=function(){var t=n.b,e=n.c,o=n.d,r=n.a;return t=t<<25^t>>>7^e,e=e-o|0,o=o<<24^o>>>8^r,r=r-t|0,n.b=t=t<<20^t>>>12^e,n.c=e=e-o|0,n.d=o<<16^e>>>16^r,n.a=r-t|0},n.a=0,n.b=0,n.c=-1640531527,n.d=1367130551,t===Math.floor(t)?(n.a=t/4294967296|0,n.b=0|t):e+=t;for(var o=0;o<e.length+20;o++)n.b^=0|e.charCodeAt(o),n.next()}function r(t,n){return n.a=t.a,n.b=t.b,n.c=t.c,n.d=t.d,n}function u(t,n){var e=new o(t),u=n&&n.state,c=function(){return(e.next()>>>0)/4294967296};return c.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},c.int32=e.next,c.quick=c,u&&("object"==typeof u&&r(u,e),c.state=function(){return r(e,{})}),c}n&&n.exports?n.exports=u:e&&e.amd?e(function(){return u}):this.tychei=u}(0,"object"==typeof module&&module,"function"==typeof t&&t);
},{}],389:[function(require,module,exports) {
var global = arguments[3];
var define;
var r,n=arguments[3];!function(n,t){var e,o=this,u=256,i=6,a="random",c=t.pow(u,i),f=t.pow(2,52),s=2*f,l=u-1;function p(r,l,p){var m=[],v=h(function r(n,t){var e,o=[],u=typeof n;if(t&&"object"==u)for(e in n)try{o.push(r(n[e],t-1))}catch(r){}return o.length?o:"string"==u?n:n+"\0"}((l=1==l?{entropy:!0}:l||{}).entropy?[r,d(n)]:null==r?function(){try{var r;return e&&(r=e.randomBytes)?r=r(u):(r=new Uint8Array(u),(o.crypto||o.msCrypto).getRandomValues(r)),d(r)}catch(r){var t=o.navigator,i=t&&t.plugins;return[+new Date,o,i,o.screen,d(n)]}}():r,3),m),j=new g(m),S=function(){for(var r=j.g(i),n=c,t=0;r<f;)r=(r+t)*u,n*=u,t=j.g(1);for(;r>=s;)r/=2,n/=2,t>>>=1;return(r+t)/n};return S.int32=function(){return 0|j.g(4)},S.quick=function(){return j.g(4)/4294967296},S.double=S,h(d(j.S),n),(l.pass||p||function(r,n,e,o){return o&&(o.S&&y(o,j),r.state=function(){return y(j,{})}),e?(t[a]=r,n):r})(S,v,"global"in l?l.global:this==t,l.state)}function g(r){var n,t=r.length,e=this,o=0,i=e.i=e.j=0,a=e.S=[];for(t||(r=[t++]);o<u;)a[o]=o++;for(o=0;o<u;o++)a[o]=a[i=l&i+r[o%t]+(n=a[o])],a[i]=n;(e.g=function(r){for(var n,t=0,o=e.i,i=e.j,a=e.S;r--;)n=a[o=l&o+1],t=t*u+a[l&(a[o]=a[i=l&i+n])+(a[i]=n)];return e.i=o,e.j=i,t})(u)}function y(r,n){return n.i=r.i,n.j=r.j,n.S=r.S.slice(),n}function h(r,n){for(var t,e=r+"",o=0;o<e.length;)n[l&o]=l&(t^=19*n[l&o])+e.charCodeAt(o++);return d(n)}function d(r){return String.fromCharCode.apply(0,r)}if(t["seed"+a]=p,h(t.random(),n),"object"==typeof module&&module.exports){module.exports=p;try{e=require("crypto")}catch(r){}}else"function"==typeof r&&r.amd&&r(function(){return p})}([],Math);
},{"crypto":57}],358:[function(require,module,exports) {
var r=require("./lib/alea"),e=require("./lib/xor128"),i=require("./lib/xorwow"),o=require("./lib/xorshift7"),l=require("./lib/xor4096"),x=require("./lib/tychei"),u=require("./seedrandom");u.alea=r,u.xor128=e,u.xorwow=i,u.xorshift7=o,u.xor4096=l,u.tychei=x,module.exports=u;
},{"./lib/alea":390,"./lib/xor128":391,"./lib/xorwow":392,"./lib/xorshift7":393,"./lib/xor4096":394,"./lib/tychei":395,"./seedrandom":389}],386:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MPRandGauss=void 0;var t=require("seedrandom"),e=r(t);function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var i=function(){function t(t,r,i,a,s){this.mean=t,this.stdDev=r,this.dtype=i,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var n=s||Math.random();this.random=e.alea(n.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,r,i=!1;!i;){var a=void 0,s=void 0,n=void 0;do{n=(a=2*this.random()-1)*a+(s=2*this.random()-1)*s}while(n>=1||0===n);var o=Math.sqrt(-2*Math.log(n)/n);e=this.mean+this.stdDev*a*o,r=this.mean+this.stdDev*s*o,this.truncated&&!this.isValidTruncated(e)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}();exports.MPRandGauss=i;
},{"seedrandom":358}],373:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReductionOps=void 0;var e=require("../doc"),n=require("../environment"),r=require("../globals"),a=require("../util"),t=l(a),s=require("./axis_util"),o=l(s),u=require("./operation"),i=require("./ops"),p=l(i);function l(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}var d=function(e,n,r,a){var t,s=arguments.length,o=s<3?n:null===a?a=Object.getOwnPropertyDescriptor(n,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,n,r,a);else for(var u=e.length-1;u>=0;u--)(t=e[u])&&(o=(s<3?t(o):s>3?t(n,r,o):t(n,r))||o);return s>3&&o&&Object.defineProperty(n,r,o),o},m=function(){function a(){}return a.logSumExp=function(e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1),t.assertArgumentsAreTensors({x:e},"logSumExp");var a=o.parseAxisParam(n,e.shape),s=e.max(a,!0),u=e.sub(s).exp().sum(a).log(),i=s.reshape(u.shape).add(u);if(r){var p=o.expandShapeToKeepDim(i.shape,a);return i.reshape(p)}return i},a.sum=function(e,a,s){void 0===a&&(a=null),void 0===s&&(s=!1),t.assertArgumentsAreTensors({x:e},"sum"),"bool"===e.dtype&&(e=e.toInt());var u=o.parseAxisParam(a,e.shape);return(0,r.customGrad)(function(e){var r=o.getAxesPermutation(u,e.rank),a=u,t=e;null!=r&&(t=e.transpose(r),a=o.getInnerMostAxes(a.length,e.rank));var i=n.ENV.engine.runKernel(function(e){return e.sum(t,a)},{permutedX:t});if(s){var l=o.expandShapeToKeepDim(i.shape,u);i=i.reshape(l)}return{value:i,gradFunc:function(n){var r=e.shape.slice();return u.forEach(function(e){r[e]=1}),n.reshape(r).mul(p.ones(e.shape,"float32"))}}})(e)},a.mean=function(e,n,a){void 0===n&&(n=null),void 0===a&&(a=!1),t.assertArgumentsAreTensors({x:e},"mean");var s=o.parseAxisParam(n,e.shape),u=o.computeOutAndReduceShapes(e.shape,s)[1],i=t.sizeFromShape(u);return(0,r.customGrad)(function(e){var r=p.scalar(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(n,a),gradFunc:function(n){var a=e.shape.slice();return s.forEach(function(e){a[e]=1}),n.reshape(a).mul(p.ones(e.shape,"float32")).div(r)}}})(e)},a.min=function(e,r,a){void 0===r&&(r=null),void 0===a&&(a=!1),t.assertArgumentsAreTensors({x:e},"min");var s=o.parseAxisParam(r,e.shape),u=s,i=o.getAxesPermutation(u,e.rank);null!=i&&(e=e.transpose(i),u=o.getInnerMostAxes(u.length,e.rank));var p=n.ENV.engine.runKernel(function(n){return n.min(e,u)},{x:e});if(a){var l=o.expandShapeToKeepDim(p.shape,s);return p.reshape(l)}return p},a.max=function(e,r,a){void 0===r&&(r=null),void 0===a&&(a=!1),t.assertArgumentsAreTensors({x:e},"max");var s=o.parseAxisParam(r,e.shape),u=s,i=o.getAxesPermutation(u,e.rank);null!=i&&(e=e.transpose(i),u=o.getInnerMostAxes(u.length,e.rank));var p=n.ENV.engine.runKernel(function(n){return n.max(e,u)},{x:e});if(a){var l=o.expandShapeToKeepDim(p.shape,s);return p.reshape(l)}return p},a.argMin=function(e,r){void 0===r&&(r=0),t.assertArgumentsAreTensors({x:e},"argMin"),null==r&&(r=0);var a=o.parseAxisParam(r,e.shape),s=o.getAxesPermutation(a,e.rank);return null!=s&&(e=e.transpose(s),a=o.getInnerMostAxes(a.length,e.rank)),n.ENV.engine.runKernel(function(n){return n.argMin(e,a[0])},{x:e})},a.argMax=function(e,r){void 0===r&&(r=0),t.assertArgumentsAreTensors({x:e},"argMax"),null==r&&(r=0);var a=o.parseAxisParam(r,e.shape),s=o.getAxesPermutation(a,e.rank);return null!=s&&(e=e.transpose(s),a=o.getInnerMostAxes(a.length,e.rank)),n.ENV.engine.runKernel(function(n){return n.argMax(e,a[0])},{x:e})},a.moments=function(e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1),t.assertArgumentsAreTensors({x:e},"moments");var a=o.parseAxisParam(n,e.shape),s=e.mean(a,r),u=s.shape;r||(u=o.expandShapeToKeepDim(s.shape,a));var i=e.toFloat().sub(s.reshape(u)).square();return{mean:s,variance:i.mean(a,r)}},a.unsortedSegmentSum=function(e,n,r,a){void 0===a&&(a=0),t.assertArgumentsAreTensors({x:e,segmentIds:n},"unsortedSegmentSum"),t.assert("int32"===n.dtype,"Segment Ids must be of dtype `int32`"),a=o.parseAxisParam(a,e.shape)[0];for(var s=[],u=n.shape[0],i=[],l=0;l<e.shape.length;l++)l===a?i.push(u):i.push(1);var d=p.reshape(n,i);for(l=0;l<r;l++){var m=p.scalar(l,"int32"),c=p.equal(m,d).asType("float32").mul(e).sum(a);s.push(c)}return p.stack(s,a)},d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"logSumExp",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"sum",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"mean",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"min",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"max",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"argMin",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"argMax",null),d([(0,e.doc)({heading:"Operations",subheading:"Normalization"}),u.operation],a,"moments",null),d([(0,e.doc)({heading:"Operations",subheading:"Reduction"}),u.operation],a,"unsortedSegmentSum",null),a}();exports.ReductionOps=m;
},{"../doc":105,"../environment":95,"../globals":104,"../util":98,"./axis_util":312,"./operation":246,"./ops":119}],295:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrayOps=void 0;var e=require("../doc"),n=require("../environment"),r=require("../tensor"),t=require("../tensor_util"),o=f(t),a=require("../util"),s=f(a),i=require("./axis_util"),u=require("./concat"),l=require("./operation"),d=require("./rand"),h=require("./reduction_ops");function f(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}var c=function(e,n,r,t){var o,a=arguments.length,s=a<3?n:null===t?t=Object.getOwnPropertyDescriptor(n,r):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,r,t);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(s=(a<3?o(s):a>3?o(n,r,s):o(n,r))||s);return a>3&&s&&Object.defineProperty(n,r,s),s},p=function(e,n,r,t){return new(r||(r=Promise))(function(o,a){function s(e){try{u(t.next(e))}catch(e){a(e)}}function i(e){try{u(t.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new r(function(n){n(e.value)}).then(s,i)}u((t=t.apply(e,n||[])).next())})},g=function(e,n){var r,t,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,t&&(o=t[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(t,a[1])).done)return o;switch(t=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,t=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=n.call(e,s)}catch(e){a=[6,e],t=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},v=function(){function t(){}return t.tensor=function(e,n,t){void 0===t&&(t="float32");var o=s.inferShape(e);return null!=n&&1!==o.length&&s.assertShapesMatch(n,o,"Error creating a new Tensor. Inferred shape ("+o+") does not match the provided shape ("+n+"). "),s.isTypedArray(e)||Array.isArray(e)||(e=[e]),n=n||o,r.Tensor.make(n,{values:w(e,t)},t)},t.scalar=function(e,n){if(void 0===n&&(n="float32"),s.isTypedArray(e)||Array.isArray(e))throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean)");return t.tensor(e,[],n)},t.tensor1d=function(e,n){void 0===n&&(n="float32");var r=s.inferShape(e);if(1!==r.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return t.tensor(e,r,n)},t.tensor2d=function(e,n,r){if(void 0===r&&(r="float32"),null!=n&&2!==n.length)throw new Error("tensor2d() requires shape to have two numbers");var o=s.inferShape(e);if(2!==o.length&&1!==o.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return n=n||o,t.tensor(e,n,r)},t.tensor3d=function(e,n,r){if(void 0===r&&(r="float32"),null!=n&&3!==n.length)throw new Error("tensor3d() requires shape to have three numbers");var o=s.inferShape(e);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return n=n||o,t.tensor(e,n,r)},t.tensor4d=function(e,n,r){if(void 0===r&&(r="float32"),null!=n&&4!==n.length)throw new Error("tensor4d() requires shape to have four numbers");var o=s.inferShape(e);if(4!==o.length&&1!==o.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return n=n||o,t.tensor(e,n,r)},t.tensor5d=function(e,n,r){if(void 0===r&&(r="float32"),null!=n&&5!==n.length)throw new Error("tensor5d() requires shape to have five numbers");var o=s.inferShape(e);if(5!==o.length&&1!==o.length)throw new Error("tensor5d() requires values to be            number[][][][][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return n=n||o,t.tensor(e,n,r)},t.ones=function(e,n){void 0===n&&(n="float32");var t=b(s.sizeFromShape(e),n);return r.Tensor.make(e,{values:t},n)},t.zeros=function(e,n){void 0===n&&(n="float32");var t=m(s.sizeFromShape(e),n);return r.Tensor.make(e,{values:t},n)},t.fill=function(e,n,t){void 0===t&&(t="float32");var o=s.getTypedArrayFromDType(t,s.sizeFromShape(e));return o.fill(n),r.Tensor.make(e,{values:o},t)},t.onesLike=function(e){return s.assertArgumentsAreTensors({x:e},"onesLike"),t.ones(e.shape,e.dtype)},t.zerosLike=function(e){return s.assertArgumentsAreTensors({x:e},"zerosLike"),t.zeros(e.shape,e.dtype)},t.clone=function(e){s.assertArgumentsAreTensors({x:e},"clone");return n.ENV.engine.runKernel(function(n){return r.Tensor.make(e.shape,{dataId:e.dataId},e.dtype)},{x:e},function(e){return{x:function(){return e.toFloat()}}})},t.eye=function(e,n,r,o){void 0===o&&(o="float32"),null==n&&(n=e);for(var a=t.buffer([e,n],o),s=e<=n?e:n,i=0;i<s;++i)a.set(1,i,i);var u=a.toTensor().as2D(e,n);if(null==r)return u;if(1===r.length)return t.tile(t.expandDims(u,0),[r[0],1,1]);if(2===r.length)return t.tile(t.expandDims(t.expandDims(u,0),0),[r[0],r[1],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+r.length+"D.")},t.randomNormal=function(e,n,r,o,a){if(void 0===n&&(n=0),void 0===r&&(r=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);for(var s=new d.MPRandGauss(n,r,o,!1,a),i=t.buffer(e,o),u=0;u<i.values.length;u++)i.values[u]=s.nextValue();return i.toTensor()},t.truncatedNormal=function(e,n,r,o,a){if(void 0===n&&(n=0),void 0===r&&(r=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);for(var s=new d.MPRandGauss(n,r,o,!0,a),i=t.buffer(e,o),u=0;u<i.values.length;u++)i.values[u]=s.nextValue();return i.toTensor()},t.randomUniform=function(e,n,r,o){void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o="float32");for(var a=t.buffer(e,o),i=0;i<a.values.length;i++)a.values[i]=s.randUniform(n,r);return a.toTensor()},t.rand=function(e,n,t){var o=s.sizeFromShape(e),a=null;if(null==t||"float32"===t)a=new Float32Array(o);else if("int32"===t)a=new Int32Array(o);else{if("bool"!==t)throw new Error("Unknown data type "+t);a=new Uint8Array(o)}for(var i=0;i<o;i++)a[i]=n();return r.Tensor.make(e,{values:a},t)},t.multinomial=function(e,r,t,o){void 0===o&&(o=!1),s.assertArgumentsAreTensors({logits:e},"multinomial");var a=e.size,i=e.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+i);t=t||Math.random();var u=1===i?e.as2D(1,-1):e,l=n.ENV.engine.runKernel(function(e){return e.multinomial(u,o,r,t)},{logits2D:u});return 1===i?l.as1D():l},t.oneHot=function(e,r,t,o){if(void 0===t&&(t=1),void 0===o&&(o=0),s.assert("int32"===e.dtype,"Indices must be of dtype `int32`"),r<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+r);return n.ENV.engine.runKernel(function(n){return n.oneHot(e,r,t,o)},{indices:e})},t.fromPixels=function(e,r){if(void 0===r&&(r=3),r>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return n.ENV.engine.fromPixels(e,r)},t.toPixels=function(e,n){return p(this,void 0,void 0,function(){var r,t,o,a,i,u,l,d,h,f,c,p,v,m,b,w,y,T,A;return g(this,function(g){switch(g.label){case 0:if(s.assertArgumentsAreTensors({img:e},"toPixels"),2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),t=r[0],o=r[1],(a=2===e.rank?1:e.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return i=e.min(),u=e.max(),[4,i.data()];case 1:return l=g.sent()[0],[4,u.data()];case 2:if(d=g.sent()[0],i.dispose(),u.dispose(),"float32"===e.dtype){if(l<0||d>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+l+" - "+d+"].")}else{if("int32"!==e.dtype)throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(l<0||d>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+l+" - "+d+"].")}return[4,e.data()];case 3:for(h=g.sent(),f="float32"===e.dtype?255:1,c=new Uint8ClampedArray(o*t*4),p=0;p<t*o;++p)v=void 0,m=void 0,b=void 0,w=void 0,1===a?(v=h[p]*f,m=h[p]*f,b=h[p]*f,w=255):3===a?(v=h[3*p]*f,m=h[3*p+1]*f,b=h[3*p+2]*f,w=255):4===a&&(v=h[4*p]*f,m=h[4*p+1]*f,b=h[4*p+2]*f,w=h[4*p+3]*f),c[(y=4*p)+0]=Math.round(v),c[y+1]=Math.round(m),c[y+2]=Math.round(b),c[y+3]=Math.round(w);return null!=n&&(n.width=o,n.height=t,T=n.getContext("2d"),A=new ImageData(c,o,t),T.putImageData(A,0,0)),[2,c]}})})},t.reshape=function(e,r){s.assertArgumentsAreTensors({x:e},"reshape"),r=s.inferFromImplicitShape(r,e.size),s.assert(e.size===s.sizeFromShape(r),"new shape and old shape must have the same number of elements.");return n.ENV.engine.runKernel(function(n){return n.reshape(e,r)},{x:e},function(n){return{x:function(){return n.reshape(e.shape)}}})},t.squeeze=function(e,n){return s.assertArgumentsAreTensors({x:e},"squeeze"),t.reshape(e,s.squeezeShape(e.shape,n).newShape)},t.cast=function(e,r){s.assertArgumentsAreTensors({x:e},"cast");return n.ENV.engine.runKernel(function(n){return n.cast(e,r)},{x:e},function(e){return{x:function(){return e.clone()}}})},t.tile=function(e,r){s.assertArgumentsAreTensors({x:e},"tile"),s.assert(e.rank===r.length,"Error in transpose: rank of input "+e.rank+" must match length of reps "+r+".");return n.ENV.engine.runKernel(function(n){return n.tile(e,r)},{x:e},function(n){return{x:function(){var o=t.zerosLike(e);if(1===e.rank)for(var a=0;a<r[0];++a)o=o.add(n.slice([a*e.shape[0]],[e.shape[0]]));else if(2===e.rank)for(a=0;a<r[0];++a)for(var s=0;s<r[1];++s)o=o.add(n.slice([a*e.shape[0],s*e.shape[1]],[e.shape[0],e.shape[1]]));else if(3===e.rank)for(a=0;a<r[0];++a)for(s=0;s<r[1];++s)for(var i=0;i<r[2];++i)o=o.add(n.slice([a*e.shape[0],s*e.shape[1],i*e.shape[2]],[e.shape[0],e.shape[1],e.shape[2]]));else{if(4!==e.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+e.rank+" tensors yet.");for(a=0;a<r[0];++a)for(s=0;s<r[1];++s)for(i=0;i<r[2];++i)for(var u=0;u<r[3];++u)o=o.add(n.slice([a*e.shape[0],s*e.shape[1],i*e.shape[2],u*e.shape[3]],[e.shape[0],e.shape[1],e.shape[2],e.shape[3]]))}return o}}})},t.gather=function(e,r,t){void 0===t&&(t=0),s.assertArgumentsAreTensors({x:e,indices:r},"gather"),s.assert("int32"===r.dtype,"Indices must be of dtype `int32`"),t=(0,i.parseAxisParam)(t,e.shape)[0];return n.ENV.engine.runKernel(function(n){return n.gather(e,r,t)},{x:e},function(n){return{x:function(){return h.ReductionOps.unsortedSegmentSum(n,r,e.shape[t],t)}}})},t.pad1d=function(e,n,r){return void 0===r&&(r=0),s.assert(2===n.length,"Invalid number of paddings. Must be length of 2."),t.pad(e,[n],r)},t.pad2d=function(e,n,r){return void 0===r&&(r=0),s.assert(2===n.length&&2===n[0].length&&2===n[1].length,"Invalid number of paddings. Must be length of 2 each."),t.pad(e,n,r)},t.pad3d=function(e,n,r){return void 0===r&&(r=0),s.assert(3===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length,"Invalid number of paddings. Must be length of 2 each."),t.pad(e,n,r)},t.pad4d=function(e,n,r){return void 0===r&&(r=0),s.assert(4===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length&&2===n[3].length,"Invalid number of paddings. Must be length of 2 each."),t.pad(e,n,r)},t.pad=function(e,r,t){if(void 0===t&&(t=0),s.assertArgumentsAreTensors({x:e},"pad"),0===e.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o=r.map(function(e){return e[0]});return n.ENV.engine.runKernel(function(n){return n.pad(e,r,t)},{x:e},function(n){return{x:function(){return n.slice(o,e.shape)}}})},t.stack=function(e,n){if(void 0===n&&(n=0),s.assertArgumentsAreTensors({tensors:e},"stack"),s.assert(e.length>=1,"Pass at least one tensor to tf.stack"),1===e.length)return e[0].expandDims(n);var r=e[0].rank,t=e[0].shape,o=e[0].dtype;s.assert(n<=r,"Axis must be <= rank of the tensor"),e.forEach(function(e){s.assertShapesMatch(t,e.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(e){s.assert(o===e.dtype,"All tensors passed to stack must have matching dtypes")});var a=e.map(function(e){return e.expandDims(n)});return u.ConcatOps.concat(a,n)},t.unstack=function(e,n){void 0===n&&(n=0);for(var r,t=e.shape[n],o=Array(e.rank-1).fill(0),a=0,s=0;s<e.rank;s++)s!==n&&(o[a]=e.shape[s],a++);r=Array(t).fill(1);var i=Array(e.rank).fill(0),u=e.shape.slice();return r.map(function(r){u[n]=r;var t=e.slice(i,u);return i[n]+=r,t.reshape(o)})},t.split=function(e,n,r){var t;void 0===r&&(r=0),s.assertArgumentsAreTensors({x:e},"split"),r=(0,i.parseAxisParam)(r,e.shape)[0],"number"==typeof n?(s.assert(e.shape[r]%n==0,"Number of splits must evenly divide the axis."),t=Array(n).fill(e.shape[r]/n)):(s.assert(e.shape[r]===n.reduce(function(e,n){return e+n}),"The sum of sizes must match the size of the axis dimension."),t=n);var o=Array(e.rank).fill(0),a=e.shape.slice();return t.map(function(n){a[r]=n;var t=e.slice(o,a);return o[r]+=n,t})},t.cumsum=function(e,r,t,o){void 0===r&&(r=0),void 0===t&&(t=!1),void 0===o&&(o=!1),s.assertArgumentsAreTensors({x:e},"cumsum"),r|=0;var a=(0,i.getAxesPermutation)([r],e.rank),u=e;null!=a&&(u=e.transpose(a));var l=(0,i.getInnerMostAxes)(1,e.rank)[0],d=n.ENV.engine.runKernel(function(e){return e.cumsum(u,l,t,o)},{permutedX:u},function(e){return{permutedX:function(){return e.cumsum(r,t,!o)}}});return null!=a&&(d=d.transpose(a)),d},t.expandDims=function(e,n){void 0===n&&(n=0),s.assertArgumentsAreTensors({x:e},"expandDims"),s.assert(n<=e.rank,"Axis must be <= rank of the tensor");var r=e.shape.slice();return r.splice(n,0,1),t.reshape(e,r)},t.linspace=function(e,n,r){if(0===r)throw new Error("Cannot request zero samples");var o=(n-e)/(r-1),a=m(r,"float32");a[0]=e;for(var s=1;s<a.length;s++)a[s]=a[s-1]+o;return t.tensor1d(a,"float32")},t.range=function(e,n,r,o){if(void 0===r&&(r=1),void 0===o&&(o="float32"),0===r)throw new Error("Cannot have a step of zero");if(e===n||e<n&&r<0||n<e&&r>1)return t.zeros([0],o);var a=m(Math.abs(Math.ceil((n-e)/r)),o);n<e&&1===r&&(r=-1),a[0]=e;for(var s=1;s<a.length;s++)a[s]=a[s-1]+r;return t.tensor1d(a,o)},t.buffer=function(e,n,t){return void 0===n&&(n="float32"),new r.TensorBuffer(e,n,t)},t.print=function(e,n){void 0===n&&(n=!1),console.log(o.tensorToString(e,n))},c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"tensor",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"scalar",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"tensor1d",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"tensor2d",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"tensor3d",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"tensor4d",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"tensor5d",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"ones",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"zeros",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"fill",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"onesLike",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"zerosLike",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"clone",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"eye",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"randomNormal",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"truncatedNormal",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"randomUniform",null),c([l.operation],t,"rand",null),c([l.operation],t,"multinomial",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"oneHot",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"}),l.operation],t,"fromPixels",null),c([(0,e.doc)({heading:"Visualization"})],t,"toPixels",null),c([(0,e.doc)({heading:"Tensors",subheading:"Transformations"}),l.operation],t,"reshape",null),c([(0,e.doc)({heading:"Tensors",subheading:"Transformations"})],t,"squeeze",null),c([(0,e.doc)({heading:"Tensors",subheading:"Transformations"}),l.operation],t,"cast",null),c([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),l.operation],t,"tile",null),c([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),l.operation],t,"gather",null),c([(0,e.doc)({heading:"Tensors",subheading:"Transformations"}),l.operation],t,"pad",null),c([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),l.operation],t,"stack",null),c([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),l.operation],t,"unstack",null),c([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),l.operation],t,"split",null),c([(0,e.doc)({heading:"Operations",subheading:"Scan"})],t,"cumsum",null),c([(0,e.doc)({heading:"Tensors",subheading:"Transformations"}),l.operation],t,"expandDims",null),c([l.operation,(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"linspace",null),c([l.operation,(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"range",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"buffer",null),c([(0,e.doc)({heading:"Tensors",subheading:"Creation"})],t,"print",null),t}();function m(e,n){if(null==n||"float32"===n)return new Float32Array(e);if("int32"===n)return new Int32Array(e);if("bool"===n)return new Uint8Array(e);throw new Error("Unknown data type $ {dtype}")}function b(e,n){for(var r=m(e,n),t=0;t<r.length;t++)r[t]=1;return r}function w(e,n){return y(e,n)?e:(Array.isArray(e)&&(e=s.flatten(e)),s.copyTypedArray(e,n))}function y(e,n){return e instanceof Float32Array&&"float32"===n||e instanceof Int32Array&&"int32"===n||e instanceof Uint8Array&&"bool"===n}exports.ArrayOps=v;
},{"../doc":105,"../environment":95,"../tensor":101,"../tensor_util":210,"../util":98,"./axis_util":312,"./concat":362,"./operation":246,"./rand":386,"./reduction_ops":373}],354:[function(require,module,exports) {
"use strict";function t(t,e){for(var r=t.length,n=[],a=0;a<r;a++){var o=r-1-a,s=t[o]||1;(e[e.length-1-a]||1)>1&&1===s&&n.unshift(o)}return n}function e(t,e){for(var r=[],n=0;n<e.length;n++){var a=t[t.length-n-1],o=e.length-n-1,s=e[o];(null==a||1===a&&s>1)&&r.unshift(o)}return r}function r(t){for(var e=0;e<t.length;e++)if(t[e]!==e)return!1;return!0}function n(t,e){for(var r=[],n="Operands could not be broadcast together with shapes "+t+" and "+e+".",a=Math.max(t.length,e.length),o=0;o<a;o++){var s=t[t.length-o-1]||1,h=e[e.length-o-1]||1;if(s>1&&h>1&&s!==h)throw Error(n);r.unshift(Math.max(s,h))}return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBroadcastDims=t,exports.getReductionAxes=e,exports.broadcastDimsAreOuter=r,exports.assertAndGetBroadcastShape=n;
},{}],359:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BatchNormOps=void 0;var r=require("../doc"),a=require("../environment"),n=require("../util"),t=u(n),e=require("./array_ops"),o=require("./broadcast_util"),s=require("./operation"),i=require("./ops");function u(r){if(r&&r.__esModule)return r;var a={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(a[n]=r[n]);return a.default=r,a}var l=function(r,a,n,t){var e,o=arguments.length,s=o<3?a:null===t?t=Object.getOwnPropertyDescriptor(a,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,a,n,t);else for(var i=r.length-1;i>=0;i--)(e=r[i])&&(s=(o<3?e(s):o>3?e(a,n,s):e(a,n))||s);return o>3&&s&&Object.defineProperty(a,n,s),s},k=function(){function n(){}return n.batchNormalization2d=function(r,a,e,o,s,i){return void 0===o&&(o=.001),t.assert(2===r.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+r.rank+"."),t.assert(2===a.rank||1===a.rank,"Error in batchNormalization2D: mean must be rank 2 or rank 1 but got rank "+a.rank+"."),t.assert(2===e.rank||1===e.rank,"Error in batchNormalization2D: variance must be rank 2 or rank 1 but got rank "+e.rank+"."),null!=s&&t.assert(2===s.rank||1===s.rank,"Error in batchNormalization2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."),null!=i&&t.assert(2===i.rank||1===i.rank,"Error in batchNormalization2D: offset must be rank 2 or rank 1 but got rank "+i.rank+"."),n.batchNormalization(r,a,e,o,s,i)},n.batchNormalization3d=function(r,a,e,o,s,i){return void 0===o&&(o=.001),t.assert(3===r.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+r.rank+"."),t.assert(3===a.rank||1===a.rank,"Error in batchNormalization3D: mean must be rank 3 or rank 1 but got rank "+a.rank+"."),t.assert(3===e.rank||1===e.rank,"Error in batchNormalization3D: variance must be rank 3 or rank 1 but got rank "+e.rank+"."),null!=s&&t.assert(3===s.rank||1===s.rank,"Error in batchNormalization3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."),null!=i&&t.assert(3===i.rank||1===i.rank,"Error in batchNormalization3D: offset must be rank 3 or rank 1 but got rank "+i.rank+"."),n.batchNormalization(r,a,e,o,s,i)},n.batchNormalization4d=function(r,a,e,o,s,i){return void 0===o&&(o=.001),t.assert(4===r.rank,"Error in batchNormalization4D: x must be rank 4 but got rank "+r.rank+"."),t.assert(4===a.rank||1===a.rank,"Error in batchNormalization4D: mean must be rank 4 or rank 1 but got rank "+a.rank+"."),t.assert(4===e.rank||1===e.rank,"Error in batchNormalization4D: variance must be rank 4 or rank 1 but got rank "+e.rank+"."),null!=s&&t.assert(4===s.rank||1===s.rank,"Error in batchNormalization4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."),null!=i&&t.assert(4===i.rank||1===i.rank,"Error in batchNormalization4D: offset must be rank 4 or rank 1 but got rank "+i.rank+"."),n.batchNormalization(r,a,e,o,s,i)},n.batchNormalization=function(r,n,s,u,l,k){var m;void 0===u&&(u=.001),t.assertArgumentsAreTensors({x:r,mean:n,variance:s},"batchNormalization"),null!=l&&t.assertArgumentsAreTensors({scale:l},"batchNormalization"),null!=k&&t.assertArgumentsAreTensors({offset:k},"batchNormalization"),t.assert(n.rank===s.rank,"Batch normalization gradient requires mean and variance to have equal ranks."),t.assert(null==k||n.rank===k.rank,"Batch normalization gradient requires mean and offset to have equal ranks."),t.assert(null==l||n.rank===l.rank,"Batch normalization gradient requires mean and scale to have equal ranks."),m=0===r.rank||1===r.rank?r.as4D(1,1,1,r.size):2===r.rank?r.as4D(1,1,r.shape[0],r.shape[1]):3===r.rank?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r;return a.ENV.engine.runKernel(function(r){return r.batchNormalization(m,c(n),c(s),u,c(l),c(k))},{x:r,mean:n,variance:s,scale:l,offset:k},function(a){var t=null==l?e.ArrayOps.scalar(1):l,k=(0,o.getReductionAxes)(n.shape,m.shape),c=[];if(1===n.rank){for(var h=0;h<m.shape.length-1;++h)c.push(m.shape[h]);c.push(1)}var b=r.sub(n),p=a.mul(t),f=(0,i.rsqrt)(s.add(e.ArrayOps.scalar(u))),z=f.mul(f).mul(f).mul(e.ArrayOps.scalar(-.5));return{x:function(){return 1===n.rank?a.mul(e.ArrayOps.tile(f.as4D(1,1,1,n.shape[0]),c)).mul(t).reshape(r.shape):a.mul(f).mul(t).reshape(r.shape)},mean:function(){var r=f.mul(e.ArrayOps.scalar(-1)).mul(p);return 1===n.rank&&(r=r.sum(k)),r.reshape(n.shape)},variance:function(){var r=z.mul(b).mul(p);return 1===n.rank&&(r=r.sum(k)),r.reshape(n.shape)},scale:function(){var r=b.mul(f),t=a.mul(r);return 1===n.rank&&(t=t.sum(k)),t.reshape(n.shape)},offset:function(){var r=a;return 1===n.rank&&(r=r.sum(k)),r.reshape(n.shape)}}}).reshape(r.shape)},l([s.operation],n,"batchNormalization2d",null),l([s.operation],n,"batchNormalization3d",null),l([s.operation],n,"batchNormalization4d",null),l([(0,r.doc)({heading:"Operations",subheading:"Normalization"})],n,"batchNormalization",null),n}();function c(r){return null==r?null:0===r.rank?r.as1D():1===r.rank?r:2===r.rank?r.as4D(1,1,r.shape[0],r.shape[1]):3===r.rank?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}exports.BatchNormOps=k;
},{"../doc":105,"../environment":95,"../util":98,"./array_ops":295,"./broadcast_util":354,"./operation":246,"./ops":119}],102:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.upcastType=f,exports.sumOutType=a;var o=exports.DType=void 0;!function(o){o.float32="float32",o.int32="int32",o.bool="bool"}(o||(exports.DType=o={}));var t,n,e,i=exports.Rank=void 0;!function(o){o.R0="R0",o.R1="R1",o.R2="R2",o.R3="R3",o.R4="R4",o.R5="R5"}(i||(exports.Rank=i={})),function(o){o.float32="float32",o.int32="int32",o.bool="int32"}(t||(t={})),function(o){o.float32="float32",o.int32="int32",o.bool="bool"}(n||(n={})),function(o){o.float32="float32",o.int32="float32",o.bool="float32"}(e||(e={}));var l={float32:e,int32:t,bool:n};function f(o,t){return l[o][t]}function a(o){return f(o,"int32")}
},{}],360:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BinaryOps=void 0;var e=require("../doc"),t=require("../environment"),r=require("../types"),n=require("../util"),a=p(n),s=require("./broadcast_util"),u=p(s),i=require("./operation"),o=require("./ops");function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var c=function(e,t,r,n){var a,s=arguments.length,u=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(u=(s<3?a(u):s>3?a(t,r,u):a(t,r))||u);return s>3&&u&&Object.defineProperty(t,r,u),u},h=function(){function n(){}return n.add=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"add"),a.assertTypesMatch(e,r);var n=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.add(e,r)},{a:e,b:r},function(t){return{a:function(){var r=t,a=u.getReductionAxes(e.shape,n);return a.length>0&&(r=r.sum(a)),r.reshape(e.shape)},b:function(){var e=t,a=u.getReductionAxes(r.shape,n);return a.length>0&&(e=e.sum(a)),e.reshape(r.shape)}}})},n.addStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in addStrict: "),e.add(t)},n.sub=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"sub"),a.assertTypesMatch(e,r);var n=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.subtract(e,r)},{a:e,b:r},function(t){return{a:function(){var r=t,a=u.getReductionAxes(e.shape,n);return a.length>0&&(r=r.sum(a)),r.reshape(e.shape)},b:function(){var e=t,a=u.getReductionAxes(r.shape,n);return a.length>0&&(e=e.sum(a)),e.neg().reshape(r.shape)}}})},n.subStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in subStrict: "),e.sub(t)},n.pow=function(e,n){a.assertArgumentsAreTensors({base:e,exp:n},"pow");var s=u.assertAndGetBroadcastShape(e.shape,n.shape);e=e.cast((0,r.upcastType)(e.dtype,n.dtype)),n=n.cast((0,r.upcastType)(e.dtype,n.dtype));return t.ENV.engine.runKernel(function(t,r){return r(t.pow(e,n))},{base:e,exp:n},function(t,r){var a=r[0];return{base:function(){var r=t.mul(n.toFloat().mul(a.div(e))),i=u.getReductionAxes(e.shape,s);return i.length>0&&(r=r.sum(i)),r.reshape(e.shape)},exp:function(){var r=t.mul(a.mul(e.log()).toFloat()),i=u.getReductionAxes(n.shape,s);return i.length>0&&(r=r.sum(i)),r.reshape(n.shape)}}})},n.powStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)},n.mul=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"mul"),a.assertTypesMatch(e,r);var n=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.multiply(e,r)},{a:e,b:r},function(t){return{a:function(){var a=t.mul(r.toFloat()),s=u.getReductionAxes(e.shape,n);return s.length>0?a.sum(s).reshape(e.shape):a},b:function(){var a=t.mul(e.toFloat()),s=u.getReductionAxes(r.shape,n);return s.length>0?a.sum(s).reshape(r.shape):a}}})},n.mulStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in multiplyStrict: "),e.mul(t)},n.div=function(e,r){var s;if(a.assertArgumentsAreTensors({a:e,b:r},"div"),a.assertTypesMatch(e,r),"int32"===e.dtype&&"int32"===r.dtype)return n.floorDiv(e,r);s=function(t){return t.realDivide(e,r)};var i=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(s,{a:e,b:r},function(t){return{a:function(){var n=t.div(r.toFloat()),a=u.getReductionAxes(e.shape,i);return a.length>0?n.sum(a).reshape(e.shape):n},b:function(){var n=t.mul(e.toFloat()),a=u.getReductionAxes(r.shape,i);a.length>0&&(n=n.sum(a).reshape(r.shape));var s=r.square();return n.div(s.toFloat()).neg()}}})},n.floorDiv=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"floorDiv"),a.assertTypesMatch(e,r);var n=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.floorDiv(e,r)},{a:e,b:r},function(t){return{a:function(){var a=t.div(r.toFloat()),s=u.getReductionAxes(e.shape,n);return s.length>0?a.sum(s).reshape(e.shape):a},b:function(){var a=t.mul(e.toFloat()),s=u.getReductionAxes(r.shape,n);s.length>0&&(a=a.sum(s).reshape(r.shape));var i=r.square();return a.div(i.toFloat()).neg()}}})},n.divStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in divideStrict: "),e.div(t)},n.mod=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"mod"),a.assertTypesMatch(e,r);var n=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.mod(e,r)},{a:e,b:r},function(t){return{a:function(){var r=u.getReductionAxes(e.shape,n);return r.length>0?t.sum(r).reshape(e.shape):t},b:function(){var a=t.mul(e.div(r).floor().neg()),s=u.getReductionAxes(r.shape,n);return s.length>0?a.sum(s).reshape(r.shape):a}}})},n.modStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in modStrict: "),e.mod(t)},n.minimum=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"minimum"),a.assertTypesMatch(e,r),"bool"===e.dtype&&(e=e.toInt()),"bool"===r.dtype&&(r=r.toInt()),u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.minimum(e,r)},{a:e,b:r},function(t){return{a:function(){return t.mul(e.lessEqual(r).toFloat())},b:function(){return t.mul(e.greater(r).toFloat())}}})},n.minimumStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in minimumStrict: "),e.minimum(t)},n.maximum=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"maximum"),a.assertTypesMatch(e,r),"bool"===e.dtype&&(e=e.toInt()),"bool"===r.dtype&&(r=r.toInt()),u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.maximum(e,r)},{a:e,b:r},function(t){return{a:function(){return t.mul(e.greaterEqual(r).toFloat())},b:function(){return t.mul(e.less(r).toFloat())}}})},n.maximumStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in minimumStrict: "),e.maximum(t)},n.squaredDifference=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"squaredDifference"),a.assertTypesMatch(e,r),u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.squaredDifference(e,r)},{a:e,b:r},function(t){var n=(0,o.scalar)(2);return{a:function(){return t.mul(e.sub(r).mul(n))},b:function(){return t.mul(r.sub(e).mul(n))}}})},n.squaredDifferenceStrict=function(e,t){return a.assertShapesMatch(e.shape,t.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(t)},n.atan2=function(e,r){a.assertArgumentsAreTensors({a:e,b:r},"atan2"),a.assertTypesMatch(e,r);var s=u.assertAndGetBroadcastShape(e.shape,r.shape);return t.ENV.engine.runKernel(function(t){return t.atan2(e,r)},{a:e,b:r},function(t){return{a:function(){var a=n.add((0,o.square)(e),(0,o.square)(r)),i=t.mul(r.div(a)),p=u.getReductionAxes(e.shape,s);return p.length>0&&(i=i.sum(p)),i.reshape(e.shape)},b:function(){var a=n.add((0,o.square)(e),(0,o.square)(r)),i=(0,o.neg)(t.mul(e.div(a))),p=u.getReductionAxes(r.shape,s);return p.length>0&&(i=i.sum(p)),i.reshape(r.shape)}}})},c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"add",null),c([i.operation],n,"addStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"sub",null),c([i.operation],n,"subStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"pow",null),c([i.operation],n,"powStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"mul",null),c([i.operation],n,"mulStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"div",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"floorDiv",null),c([i.operation],n,"divStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"mod",null),c([i.operation],n,"modStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"minimum",null),c([i.operation],n,"minimumStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"maximum",null),c([i.operation],n,"maximumStrict",null),c([(0,e.doc)({heading:"Operations",subheading:"Arithmetic"}),i.operation],n,"squaredDifference",null),c([i.operation],n,"squaredDifferenceStrict",null),c([i.operation],n,"atan2",null),n}();exports.BinaryOps=h;
},{"../doc":105,"../environment":95,"../types":102,"../util":98,"./broadcast_util":354,"./operation":246,"./ops":119}],361:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompareOps=void 0;var e=require("../doc"),r=require("../environment"),t=require("../util"),a=o(t),n=require("./broadcast_util"),s=o(n),u=require("./operation");function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var i=function(e,r,t,a){var n,s=arguments.length,u=s<3?r:null===a?a=Object.getOwnPropertyDescriptor(r,t):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,r,t,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(u=(s<3?n(u):s>3?n(r,t,u):n(r,t))||u);return s>3&&u&&Object.defineProperty(r,t,u),u},l=function(){function t(){}return t.notEqual=function(e,t){return a.assertArgumentsAreTensors({a:e,b:t},"notEqual"),a.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),r.ENV.engine.runKernel(function(r){return r.notEqual(e,t)},{a:e,b:t})},t.notEqualStrict=function(e,r){return a.assertShapesMatch(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)},t.less=function(e,t){return a.assertArgumentsAreTensors({a:e,b:t},"less"),a.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),r.ENV.engine.runKernel(function(r){return r.less(e,t)},{a:e,b:t})},t.lessStrict=function(e,r){return a.assertShapesMatch(e.shape,r.shape,"Error in lessStrict: "),e.less(r)},t.equal=function(e,t){return a.assertArgumentsAreTensors({a:e,b:t},"equal"),a.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),r.ENV.engine.runKernel(function(r){return r.equal(e,t)},{a:e,b:t})},t.equalStrict=function(e,r){return a.assertShapesMatch(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)},t.lessEqual=function(e,t){return a.assertArgumentsAreTensors({a:e,b:t},"lessEqual"),a.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),r.ENV.engine.runKernel(function(r){return r.lessEqual(e,t)},{a:e,b:t})},t.lessEqualStrict=function(e,r){return a.assertShapesMatch(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)},t.greater=function(e,t){return a.assertArgumentsAreTensors({a:e,b:t},"greater"),a.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),r.ENV.engine.runKernel(function(r){return r.greater(e,t)},{a:e,b:t})},t.greaterStrict=function(e,r){return a.assertShapesMatch(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)},t.greaterEqual=function(e,t){return a.assertArgumentsAreTensors({a:e,b:t},"greaterEqual"),a.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),r.ENV.engine.runKernel(function(r){return r.greaterEqual(e,t)},{a:e,b:t})},t.greaterEqualStrict=function(e,r){return a.assertShapesMatch(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)},i([(0,e.doc)({heading:"Operations",subheading:"Logical"}),u.operation],t,"notEqual",null),i([u.operation],t,"notEqualStrict",null),i([(0,e.doc)({heading:"Operations",subheading:"Logical"}),u.operation],t,"less",null),i([u.operation],t,"lessStrict",null),i([(0,e.doc)({heading:"Operations",subheading:"Logical"}),u.operation],t,"equal",null),i([u.operation],t,"equalStrict",null),i([(0,e.doc)({heading:"Operations",subheading:"Logical"}),u.operation],t,"lessEqual",null),i([u.operation],t,"lessEqualStrict",null),i([(0,e.doc)({heading:"Operations",subheading:"Logical"}),u.operation],t,"greater",null),i([u.operation],t,"greaterStrict",null),i([(0,e.doc)({heading:"Operations",subheading:"Logical"}),u.operation],t,"greaterEqual",null),i([u.operation],t,"greaterEqualStrict",null),t}();exports.CompareOps=l;
},{"../doc":105,"../environment":95,"../util":98,"./broadcast_util":354,"./operation":246}],396:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computePool2DInfo=n,exports.computeConv2DInfo=o,exports.computeDefaultPad=i;var t=require("../util"),e=r(t);function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(t,e,r,n,a,i){void 0===i&&(i="channelsLast");var h,s=u(e),l=s[0],f=s[1];if("channelsLast"===i)h=[l,f,t[3],t[3]];else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat "+i);h=[l,f,t[1],t[1]]}return o(t,h,r,1,n,a,!1,i)}function o(t,e,r,n,o,a,i,l){void 0===i&&(i=!1),void 0===l&&(l="channelsLast");var f=[-1,-1,-1,-1],d=f[0],c=f[1],p=f[2],v=f[3];if("channelsLast"===l)d=t[0],c=t[1],p=t[2],v=t[3];else{if("channelsFirst"!==l)throw new Error("Unknown dataFormat "+l);d=t[0],v=t[1],c=t[2],p=t[3]}var m,g=e[0],M=e[1],w=e[3],b=u(r),I=b[0],y=b[1],H=u(n),L=H[0],W=H[1],E=s(o,c,p,I,y,h(g,L),h(M,W),a),F=E.padInfo,C=E.outHeight,D=E.outWidth,S=i?w*v:w;return"channelsFirst"===l?m=[d,S,C,D]:"channelsLast"===l&&(m=[d,C,D,S]),{batchSize:d,dataFormat:l,inHeight:c,inWidth:p,inChannels:v,outHeight:C,outWidth:D,outChannels:S,padInfo:F,strideHeight:I,strideWidth:y,filterHeight:g,filterWidth:M,dilationHeight:L,dilationWidth:W,inShape:t,outShape:m,filterShape:e}}function a(t,r,n,o,a,u){null==a&&(a=i(t,r,o));var h=t[0],s=t[1],f=l((h-r+2*a)/o+1,u);e.assert(e.isInt(f),"The output # of rows ("+f+") must be an integer. Change the stride and/or zero pad parameters");var d=l((s-r+2*a)/o+1,u);return e.assert(e.isInt(d),"The output # of columns ("+d+") must be an integer. Change the stride and/or zero pad parameters"),[f,d,n]}function i(t,e,r,n){void 0===n&&(n=1);var o=h(e,n);return Math.floor((t[0]*(r-1)-r+o)/2)}function u(t){return"number"==typeof t?[t,t]:t}function h(t,e){return e<=1?t:t+(t-1)*(e-1)}function s(t,e,r,n,o,i,u,h){var s,l,f;if("number"==typeof t){s={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var d=a([e,r,1],i,1,n,t,h);l=d[0],f=d[1]}else if("same"===t){var c=((l=Math.ceil(e/n))-1)*n+i-e,p=((f=Math.ceil(r/o))-1)*o+u-r,v=Math.floor(c/2),m=c-v,g=Math.floor(p/2);s={top:v,bottom:m,left:g,right:p-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);s={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-i+1)/n),f=Math.ceil((r-u+1)/o)}return{padInfo:s,outHeight:l,outWidth:f}}function l(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}
},{"../util":98}],363:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConvOps=void 0;var e=require("../doc"),r=require("../environment"),n=require("../util"),t=i(n),s=require("./conv_util"),a=i(s),o=require("./operation");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}var p=function(e,r,n,t){var s,a=arguments.length,o=a<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,r,n,t);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(o=(a<3?s(o):a>3?s(r,n,o):s(r,n))||o);return a>3&&o&&Object.defineProperty(r,n,o),o},u=function(){function n(){}return n.conv1d=function(e,r,s,a,o,i,p){void 0===o&&(o="NWC"),void 0===i&&(i=1),t.assertArgumentsAreTensors({x:e,filter:r},"conv1d");var u=e,d=!1;2===e.rank&&(d=!0,u=e.as3D(1,e.shape[0],e.shape[1])),t.assert(3===u.rank,"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."),t.assert(3===r.rank,"Error in conv1d: filter must be rank 3, but got rank "+r.rank+"."),null!=p&&t.assert(t.isInt(a),"Error in conv1d: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+a+"."),t.assert(u.shape[2]===r.shape[1],"Error in conv1d: depth of input ("+u.shape[2]+") must match input depth for filter "+r.shape[1]+"."),t.assert(l(s,i),"Error in conv1D: Either stride or dilation must be 1. Got stride "+s+" and dilation '"+i+"'"),t.assert("NWC"===o,"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported.");var h=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]),v=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),c=[1,s],f=[1,i],g=n.conv2d(v,h,c,a,"NHWC",f,p);return d?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])},n.conv2d=function(e,s,o,i,p,u,d){void 0===p&&(p="NHWC"),void 0===u&&(u=[1,1]),t.assertArgumentsAreTensors({x:e,filter:s},"conv2d");var v=e,c=!1;3===e.rank&&(c=!0,v=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),t.assert(4===v.rank,"Error in conv2d: input must be rank 4, but got rank "+v.rank+"."),t.assert(4===s.rank,"Error in conv2d: filter must be rank 4, but got rank "+s.rank+"."),null!=d&&t.assert(t.isInt(i),"Error in conv2d: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+i+"."),t.assert(v.shape[3]===s.shape[2],"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+s.shape[2]+"."),t.assert(l(o,u),"Error in conv2D: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+u+"'"),t.assert("NHWC"===p,"Error in conv2d: got dataFormat of "+p+" but only NHWC is currently supported.");var f=a.computeConv2DInfo(v.shape,s.shape,o,u,i,d),g=r.ENV.engine.runKernel(function(e){return e.conv2d(v,s,f)},{x:v,filter:s},function(e){return t.assert(h(u),"Error in gradient of conv2D: dilation rates greater than 1 are notyet supported in gradients. Got dilations '"+u+"'"),{x:function(){return n.conv2dDerInput(v.shape,e,s,o,i)},filter:function(){return n.conv2dDerFilter(v,e,s.shape,o,i)}}});return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g},n.conv2dDerInput=function(e,n,s,o,i,p){t.assertArgumentsAreTensors({dy:n,filter:s},"conv2dDerInput"),t.assert(e.length===n.rank,"Length of inShape ("+e.length+") and rank of dy ("+n.rank+") must match");var u=e,d=n,h=!1;3===n.rank&&(h=!0,d=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]),u=[1,e[0],e[1],e[2]]);var l=u[3],v=d.shape[3];t.assert(4===u.length,"Error in conv2dDerInput: inShape must be length 4, but got length "+u.length+"."),t.assert(4===d.rank,"Error in conv2dDerInput: dy must be rank 4, but got rank "+d.rank),t.assert(4===s.rank,"Error in conv2dDerInput: filter must be rank 4, but got rank "+s.rank),t.assert(l===s.shape[2],"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+s.shape[2]+"."),t.assert(v===s.shape[3],"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+s.shape[3]+"."),null!=p&&t.assert(t.isInt(i),"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+i+".");var c=a.computeConv2DInfo(u,s.shape,o,1,i,p),f=r.ENV.engine.runKernel(function(e){return e.conv2dDerInput(d,s,c)},{dy4D:d});return h?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f},n.conv2dDerFilter=function(e,n,s,o,i,p){t.assertArgumentsAreTensors({x:e,dy:n},"conv2dDerFilter");var u=e;3===e.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var d=n;3===d.rank&&(d=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),t.assert(4===u.rank,"Error in conv2dDerFilter: input must be rank 4, but got shape "+u.shape+"."),t.assert(4===d.rank,"Error in conv2dDerFilter: dy must be rank 4, but got shape "+d.shape+"."),t.assert(4===s.length,"Error in conv2dDerFilter: filterShape must be length 4, but got "+s+"."),t.assert(u.shape[3]===s[2],"Error in conv2dDerFilter: depth of input "+u.shape[3]+") must match input depth in filter ("+s[2]+"."),t.assert(d.shape[3]===s[3],"Error in conv2dDerFilter: depth of dy ("+d.shape[3]+") must match output depth for filter ("+s[3]+")."),null!=p&&t.assert(t.isInt(i),"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+i+".");var h=a.computeConv2DInfo(u.shape,s,o,1,i,p);return r.ENV.engine.runKernel(function(e){return e.conv2dDerFilter(u,d,h)},{x4D:u,dy4D:d})},n.conv2dTranspose=function(e,r,s,a,o,i){return t.assertArgumentsAreTensors({x:e,filter:r},"conv2dTranspose"),n.conv2dDerInput(s,e,r,a,o,i)},n.depthwiseConv2d=function(e,n,s,o,i,p,u){void 0===i&&(i="NHWC"),void 0===p&&(p=[1,1]),t.assertArgumentsAreTensors({x:e,filter:n},"depthwiseConv2d");var d=e,f=!1;3===e.rank&&(f=!0,d=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),t.assert(4===d.rank,"Error in depthwiseConv2d: input must be rank 4, but got rank "+d.rank+"."),t.assert(4===n.rank,"Error in depthwiseConv2d: filter must be rank 4, but got rank "+n.rank+"."),t.assert(d.shape[3]===n.shape[2],"Error in depthwiseConv2d: number of input channels ("+d.shape[3]+") must match the inChannels dimension in filter "+n.shape[2]+"."),null==p&&(p=[1,1]),t.assert(l(s,p),"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+p+"'"),null!=u&&t.assert(t.isInt(o),"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+o+".");var g=a.computeConv2DInfo(d.shape,n.shape,s,p,o,u,!0),b=r.ENV.engine.runKernel(function(e){return e.depthwiseConv2D(d,n,g)},{x:d,filter:n},function(e){return t.assert(h(p),"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+p+"'"),{x:function(){return v(d.shape,e,n,g)},filter:function(){return c(d,e,n.shape,g)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b},n.separableConv2d=function(e,r,s,a,o,i,p){void 0===i&&(i=[1,1]),void 0===p&&(p="NHWC"),t.assertArgumentsAreTensors({x:e,depthwiseFilter:r,pointwiseFilter:s},"separableConv2d");var u=e,d=!1;if(3===e.rank&&(d=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),"NCHW"===p)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");t.assert(4===u.rank,"Error in separableConv2d: input must be rank 4, but got rank "+u.rank+"."),t.assert(4===r.rank,"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+r.rank+"."),t.assert(4===s.rank,"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+r.rank+"."),t.assert(1===s.shape[0],"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+s.shape[0]+"."),t.assert(1===s.shape[1],"Error in separableConv2d: the second dimension of pointwise filter  must be 1, but got "+s.shape[1]+".");var h=r.shape[2],l=r.shape[3];t.assert(s.shape[2]===h*l,"Error in separableConv2d: the third dimension of pointwise filter must be "+h*l+", but got "+s.shape[2]+".");var v=n.depthwiseConv2d(u,r,a,o,p,i),c=n.conv2d(v,s,1,"valid",p);return d?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c},p([(0,e.doc)({heading:"Operations",subheading:"Convolution"}),o.operation],n,"conv1d",null),p([(0,e.doc)({heading:"Operations",subheading:"Convolution"}),o.operation],n,"conv2d",null),p([o.operation],n,"conv2dDerInput",null),p([o.operation],n,"conv2dDerFilter",null),p([(0,e.doc)({heading:"Operations",subheading:"Convolution"}),o.operation],n,"conv2dTranspose",null),p([(0,e.doc)({heading:"Operations",subheading:"Convolution"}),o.operation],n,"depthwiseConv2d",null),p([(0,e.doc)({heading:"Operations",subheading:"Convolution"}),o.operation],n,"separableConv2d",null),n}();function d(e){return"number"==typeof e?[e,e]:e}function h(e){var r=d(e),n=r[0],t=r[1];return 1===n&&1===t}function l(e,r){return h(e)||h(r)}function v(e,n,t,s){var a=n,o=!1;3===n.rank&&(o=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var i=r.ENV.engine.runKernel(function(e){return e.depthwiseConv2DDerInput(a,t,s)},{dy4D:a});return o?i.as3D(i.shape[1],i.shape[2],i.shape[3]):i}function c(e,n,t,s){var a=e;3===e.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=n;return 3===o.rank&&(o=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),r.ENV.engine.runKernel(function(e){return e.depthwiseConv2DDerFilter(a,o,s)},{x4D:a,dy4D:o})}exports.ConvOps=u;
},{"../doc":105,"../environment":95,"../util":98,"./conv_util":396,"./operation":246}],364:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageOps=void 0;var e=require("../doc"),r=require("../environment"),n=require("../util"),a=s(n),t=require("./operation");function s(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}var i=function(e,r,n,a){var t,s=arguments.length,i=s<3?r:null===a?a=Object.getOwnPropertyDescriptor(r,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,n,a);else for(var o=e.length-1;o>=0;o--)(t=e[o])&&(i=(s<3?t(i):s>3?t(r,n,i):t(r,n))||i);return s>3&&i&&Object.defineProperty(r,n,i),i},o=function(){function n(){}return n.resizeBilinear=function(e,n,t){void 0===t&&(t=!1),a.assertArgumentsAreTensors({images:e},"resizeBilinear"),a.assert(3===e.rank||4===e.rank,"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+e.rank+"."),a.assert(2===n.length,"Error in resizeBilinear: new shape must 2D, but got shape "+n+".");var s=e,i=!1;3===e.rank&&(i=!0,s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=n[0],u=n[1],p=r.ENV.engine.runKernel(function(e,r){return e.resizeBilinear(s,o,u,t)},{batchImages:s},function(e,n){return{batchImages:function(){return r.ENV.engine.runKernel(function(r){return r.resizeBilinearBackprop(e,s,t)},{})}}});return i?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p},n.resizeNearestNeighbor=function(e,n,t){void 0===t&&(t=!1),a.assertArgumentsAreTensors({images:e},"resizeNearestNeighbor"),a.assert(3===e.rank||4===e.rank,"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+e.rank+"."),a.assert(2===n.length,"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+n+"."),a.assert("float32"===e.dtype||"int32"===e.dtype,"`images` must have `int32` or `float32` as dtype");var s=e,i=!1;3===e.rank&&(i=!0,s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=n[0],u=n[1],p=r.ENV.engine.runKernel(function(e){return e.resizeNearestNeighbor(s,o,u,t)},{batchImages:s});return i?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p},i([(0,e.doc)({heading:"Operations",subheading:"Images",namespace:"image"}),t.operation],n,"resizeBilinear",null),i([(0,e.doc)({heading:"Operations",subheading:"Images",namespace:"image"}),t.operation],n,"resizeNearestNeighbor",null),n}();exports.ImageOps=o;
},{"../doc":105,"../environment":95,"../util":98,"./operation":246}],281:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tracking=void 0;var e=require("./doc"),n=require("./environment"),t=require("./util"),r=function(e,n,t,r){var o,i=arguments.length,u=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,n,t,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(u=(i<3?o(u):i>3?o(n,t,u):o(n,t))||u);return i>3&&u&&Object.defineProperty(n,t,u),u},o=function(){function o(){}return o.tidy=function(e,t,r){void 0===r&&(r=!1);var o=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}n.ENV.engine.startScope(o,r);var i=t();return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n.ENV.engine.endScope(i,r),i},o.dispose=function(e){(0,t.getTensorsInContainer)(e).forEach(function(e){return e.dispose()})},o.keep=function(e){return n.ENV.engine.keep(e)},o.time=function(e){return n.ENV.engine.time(e)},r([(0,e.doc)({heading:"Performance",subheading:"Memory"})],o,"tidy",null),r([(0,e.doc)({heading:"Performance",subheading:"Memory"})],o,"dispose",null),r([(0,e.doc)({heading:"Performance",subheading:"Memory"})],o,"keep",null),r([(0,e.doc)({heading:"Performance",subheading:"Timing"})],o,"time",null),o}();exports.Tracking=o;
},{"./doc":105,"./environment":95,"./util":98}],365:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LinalgOps=void 0;var e=require("../doc"),r=require("../tracking"),t=require("../util"),n=require("./operation"),i=require("./ops"),o=function(e,r,t,n){var i,o=arguments.length,s=o<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,t,n);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(o<3?i(s):o>3?i(r,t,s):i(r,t))||s);return o>3&&s&&Object.defineProperty(r,t,s),s},s=function(){function s(){}return s.gramSchmidt=function(e){var n;if(Array.isArray(e)){n=!1,(0,t.assert)(null!=e&&e.length>0,"Gram-Schmidt process: input must not be null, undefined, or empty");for(var o=e[0].shape[0],s=1;s<e.length;++s)(0,t.assert)(e[s].shape[0]===o,"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[s].shape[0]+" vs. "+o+")")}else n=!0,e=(0,i.split)(e,e.shape[0],0).map(function(e){return(0,i.squeeze)(e,[0])});(0,t.assert)(e.length<=e[0].shape[0],"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+").");var u=[],a=e,c=function(e){u.push(r.Tracking.tidy(function(){var r=a[e];if(e>0)for(var t=0;t<e;++t){var n=(0,i.sum)(u[t].mulStrict(r)).mul(u[t]);r=r.sub(n)}return r.div((0,i.norm)(r,"euclidean"))}))};for(s=0;s<e.length;++s)c(s);return n?(0,i.stack)(u,0):u},o([(0,e.doc)({heading:"Operations",subheading:"Linear Algebra"}),n.operation],s,"gramSchmidt",null),s}();exports.LinalgOps=s;
},{"../doc":105,"../tracking":281,"../util":98,"./operation":246,"./ops":119}],366:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogicalOps=void 0;var e=require("../doc"),r=require("../environment"),o=require("../types"),t=c(o),n=require("../util"),a=c(n),s=require("./broadcast_util"),i=c(s),l=require("./operation");function c(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r.default=e,r}var u=function(e,r,o,t){var n,a=arguments.length,s=a<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,o):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,o,t);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(s=(a<3?n(s):a>3?n(r,o,s):n(r,o))||s);return a>3&&s&&Object.defineProperty(r,o,s),s},p=function(){function o(){}return o.logicalNot=function(e){return a.assertArgumentsAreTensors({x:e},"logicalNot"),a.assert("bool"===e.dtype,"Error Array must be of type bool."),r.ENV.engine.runKernel(function(r){return r.logicalNot(e)},{x:e})},o.logicalAnd=function(e,o){return a.assertArgumentsAreTensors({a:e,b:o},"logicalAnd"),a.assert("bool"===e.dtype&&"bool"===o.dtype,"Error Array must be of type bool."),i.assertAndGetBroadcastShape(e.shape,o.shape),r.ENV.engine.runKernel(function(r){return r.logicalAnd(e,o)},{a:e,b:o})},o.logicalOr=function(e,o){return a.assertArgumentsAreTensors({a:e,b:o},"logicalOr"),a.assert("bool"===e.dtype&&"bool"===o.dtype,"Error Array must be of type bool."),i.assertAndGetBroadcastShape(e.shape,o.shape),r.ENV.engine.runKernel(function(r){return r.logicalOr(e,o)},{a:e,b:o})},o.logicalXor=function(e,r){return a.assertArgumentsAreTensors({a:e,b:r},"logicalXor"),a.assert("bool"===e.dtype&&"bool"===r.dtype,"Error Array must be of type bool."),i.assertAndGetBroadcastShape(e.shape,r.shape),o.logicalOr(e,r).logicalAnd(o.logicalAnd(e,r).logicalNot())},o.where=function(e,o,n){a.assertArgumentsAreTensors({condition:e,a:o,b:n},"where"),a.assert("bool"===e.dtype,"Error Condition must be of type bool."),a.assertShapesMatch(o.shape,n.shape,"Error in where: "),1===e.rank?a.assert(e.shape[0]===o.shape[0],"The first dimension of `a` must match the size of `condition`."):a.assertShapesMatch(e.shape,n.shape,"Error in where: ");var s=t.upcastType(o.dtype,n.dtype);return r.ENV.engine.runKernel(function(r){return r.where(e,o,n,s)},{condition:e,a:o,b:n})},u([(0,e.doc)({heading:"Operations",subheading:"Logical"}),l.operation],o,"logicalNot",null),u([(0,e.doc)({heading:"Operations",subheading:"Logical"}),l.operation],o,"logicalAnd",null),u([(0,e.doc)({heading:"Operations",subheading:"Logical"}),l.operation],o,"logicalOr",null),u([(0,e.doc)({heading:"Operations",subheading:"Logical"}),l.operation],o,"logicalXor",null),u([(0,e.doc)({heading:"Operations",subheading:"Logical"}),l.operation],o,"where",null),o}();exports.LogicalOps=p;
},{"../doc":105,"../environment":95,"../types":102,"../util":98,"./broadcast_util":354,"./operation":246}],120:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LossOps=exports.Reduction=void 0;var e=require("../doc"),s=require("../util"),r=t(s),n=require("./operation"),o=require("./ops"),a=t(o);function t(e){if(e&&e.__esModule)return e;var s={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r]);return s.default=e,s}var i=function(e,s,r,n){var o,a=arguments.length,t=a<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)t=Reflect.decorate(e,s,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(t=(a<3?o(t):a>3?o(s,r,t):o(s,r))||t);return a>3&&t&&Object.defineProperty(s,r,t),t},u=exports.Reduction=void 0;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(u||(exports.Reduction=u={}));var l=function(){function s(){}return s.computeWeightedLoss=function(e,s,n){void 0===n&&(n=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({losses:e},"computeWeightedLoss"),null!=s&&r.assertArgumentsAreTensors({weights:s},"computeWeightedLoss");var o=null==s?e:e.mul(s);if(n===u.NONE)return o;if(n===u.SUM)return o.sum();if(n===u.MEAN)return null==s?o.mean():o.sum().div(s.sum());if(n===u.SUM_BY_NONZERO_WEIGHTS){if(null==s)return o.sum().div(a.scalar(e.size));var t=s.notEqual(a.scalar(0)).sum().toFloat();return o.sum().div(t)}throw Error("Unknown reduction: "+n)},s.absoluteDifference=function(e,n,o,a){void 0===a&&(a=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({labels:e,predictions:n},"absoluteDifference"),null!=o&&r.assertArgumentsAreTensors({weights:o},"absoluteDifference"),r.assertShapesMatch(e.shape,n.shape,"Error in absoluteDifference: ");var t=e.sub(n).abs();return s.computeWeightedLoss(t,o,a)},s.meanSquaredError=function(e,n,o,a){void 0===a&&(a=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({labels:e,predictions:n},"meanSquaredError"),null!=o&&r.assertArgumentsAreTensors({weights:o},"meanSquaredError"),r.assertShapesMatch(e.shape,n.shape,"Error in meanSquaredError: ");var t=e.squaredDifference(n);return s.computeWeightedLoss(t,o,a)},s.cosineDistance=function(e,n,o,t,i){void 0===i&&(i=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({labels:e,predictions:n},"cosineDistance"),null!=t&&r.assertArgumentsAreTensors({weights:t},"cosineDistance"),r.assertShapesMatch(e.shape,n.shape,"Error in cosineDistance: ");var l=a.scalar(1).sub(e.mul(n).sum(o,!0));return s.computeWeightedLoss(l,t,i)},s.hingeLoss=function(e,n,o,t){void 0===t&&(t=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({labels:e,predictions:n},"hingeLoss"),null!=o&&r.assertArgumentsAreTensors({weights:o},"hingeLoss"),r.assertShapesMatch(e.shape,n.shape,"Error in hingeLoss: ");var i=a.scalar(1);e=a.scalar(2).mul(e).sub(i);var l=i.sub(e.mul(n)).relu();return s.computeWeightedLoss(l,o,t)},s.logLoss=function(e,n,o,t,i){void 0===t&&(t=1e-7),void 0===i&&(i=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({labels:e,predictions:n},"logLoss"),null!=o&&r.assertArgumentsAreTensors({weights:o},"logLoss"),r.assertShapesMatch(e.shape,n.shape,"Error in logLoss: ");var l=a.scalar(1),c=a.scalar(t),d=e.mul(n.add(c).log()).neg().sub(l.sub(e).mul(l.sub(n).add(c).log()));return s.computeWeightedLoss(d,o,i)},s.huberLoss=function(e,n,o,t,i){void 0===t&&(t=1),void 0===i&&(i=u.SUM_BY_NONZERO_WEIGHTS),r.assertArgumentsAreTensors({labels:e,predictions:n},"huberLoss"),null!=o&&r.assertArgumentsAreTensors({weights:o},"huberLoss"),r.assertShapesMatch(e.shape,n.shape,"Error in huberLoss: ");var l=a.scalar(t),c=n.sub(e).abs(),d=a.minimum(c,l),h=c.sub(d),g=a.scalar(.5).mul(d.square()).add(l.mul(h));return s.computeWeightedLoss(g,o,i)},i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"computeWeightedLoss",null),i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"absoluteDifference",null),i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"meanSquaredError",null),i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"cosineDistance",null),i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"hingeLoss",null),i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"logLoss",null),i([(0,e.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),n.operation],s,"huberLoss",null),s}();exports.LossOps=l;
},{"../doc":105,"../util":98,"./operation":246,"./ops":119}],367:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LRNOps=void 0;var e=require("../doc"),r=require("../environment"),o=require("../util"),n=a(o),t=require("./operation");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r.default=e,r}var i=function(e,r,o,n){var t,a=arguments.length,i=a<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,o,n);else for(var s=e.length-1;s>=0;s--)(t=e[s])&&(i=(a<3?t(i):a>3?t(r,o,i):t(r,o))||i);return a>3&&i&&Object.defineProperty(r,o,i),i},s=function(){function o(){}return o.localResponseNormalization=function(e,o,t,a,i){void 0===o&&(o=5),void 0===t&&(t=1),void 0===a&&(a=1),void 0===i&&(i=.5),n.assertArgumentsAreTensors({x:e},"localResponseNormalization"),n.assert(4===e.rank||3===e.rank,"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+e.rank+"."),n.assert(n.isInt(o),"Error in localResponseNormalization: depthRadius must be an integer\n                     but got depthRadius "+o+".");var s=e,l=!1;3===e.rank&&(l=!0,s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=r.ENV.engine.runKernel(function(e){return e.localResponseNormalization4D(s,o,t,a,i)},{x4D:s});return l?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u},i([(0,e.doc)({heading:"Operations",subheading:"Normalization"}),t.operation],o,"localResponseNormalization",null),o}();exports.LRNOps=s;
},{"../doc":105,"../environment":95,"../util":98,"./operation":246}],368:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LSTMOps=void 0;var e=require("../doc"),t=require("../util"),r=n(t),i=require("./operation");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var l=function(e,t,r,i){var n,l=arguments.length,o=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(l<3?n(o):l>3?n(t,r,o):n(t,r))||o);return l>3&&o&&Object.defineProperty(t,r,o),o},o=function(){function t(){}return t.multiRNNCell=function(e,t,i,n){r.assertArgumentsAreTensors({data:t,c:i,h:n},"multiRNNCell");for(var l=t,o=[],s=0;s<e.length;s++){var a=e[s](l,i[s],n[s]);o.push(a[0]),o.push(a[1]),l=a[1]}var u=[],c=[];for(s=0;s<o.length;s+=2)u.push(o[s]),c.push(o[s+1]);return[u,c]},t.basicLSTMCell=function(e,t,i,n,l,o){r.assertArgumentsAreTensors({forgetBias:e,lstmKernel:t,lstmBias:i,data:n,c:l,h:o},"basicLSTMCell");var s=n.concat(o,1).matMul(t).add(i),a=s.shape[0],u=s.shape[1]/4,c=[a,u],d=s.slice([0,0],c),p=s.slice([0,u],c),f=s.slice([0,2*u],c),h=s.slice([0,3*u],c),g=d.sigmoid().mulStrict(p.tanh()).addStrict(l.mulStrict(e.add(f).sigmoid())),m=g.tanh().mulStrict(h.sigmoid());return[g,m]},l([(0,e.doc)({heading:"Operations",subheading:"RNN"}),i.operation],t,"multiRNNCell",null),l([(0,e.doc)({heading:"Operations",subheading:"RNN"}),i.operation],t,"basicLSTMCell",null),t}();exports.LSTMOps=o;
},{"../doc":105,"../util":98,"./operation":246}],369:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MatmulOps=void 0;var r=require("../doc"),t=require("../environment"),a=require("../util"),n=s(a),e=require("./operation");function s(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t.default=r,t}var o=function(r,t,a,n){var e,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,a,n);else for(var u=r.length-1;u>=0;u--)(e=r[u])&&(o=(s<3?e(o):s>3?e(t,a,o):e(t,a))||o);return s>3&&o&&Object.defineProperty(t,a,o),o},u=function(){function a(){}return a.matMul=function(r,a,e,s){void 0===e&&(e=!1),void 0===s&&(s=!1),n.assertArgumentsAreTensors({a:r,b:a},"matMul");var o=e?r.shape[0]:r.shape[1],u=s?a.shape[1]:a.shape[0];n.assert(2===r.rank&&2===a.rank,"Error in matMul: inputs must be rank 2, got ranks "+r.rank+" and "+a.rank+"."),n.assert(o===u,"Error in matMul: inner shapes ("+o+") and ("+u+") of Tensors with shapes "+r.shape+" and "+a.shape+" and transposeA="+e+" and transposeB="+s+" must match.");return t.ENV.engine.runKernel(function(t){return t.matMul(r,a,e,s)},{a:r,b:a},function(t){return e||s?!e&&s?{a:function(){return t.matMul(a.toFloat(),!1,!1)},b:function(){return t.matMul(r.toFloat(),!0,!1)}}:e&&!s?{a:function(){return a.toFloat().matMul(t,!1,!0)},b:function(){return r.toFloat().matMul(t,!1,!1)}}:{a:function(){return a.toFloat().matMul(t,!0,!0)},b:function(){return t.matMul(r.toFloat(),!0,!0)}}:{a:function(){return t.matMul(a.toFloat(),!1,!0)},b:function(){return r.toFloat().matMul(t,!0,!1)}}})},a.vectorTimesMatrix=function(r,t){return n.assert(1===r.rank,"Error in vectorTimesMatrix: first input must be rank 1, but got rank "+r.rank+"."),n.assert(2===t.rank,"Error in vectorTimesMatrix: second input must be rank 2, but got rank "+t.rank+"."),n.assert(r.size===t.shape[0],"Error in vectorTimesMatrix: size of vector ("+r.size+") must match first dimension of matrix ("+t.shape[0]+")"),r.as2D(1,-1).matMul(t).as1D()},a.matrixTimesVector=function(r,t){return n.assert(1===t.rank,"Error in matrixTimesVector: second input must rank 1, but got rank "+t.rank+"."),n.assert(2===r.rank,"Error in matrixTimesVector: first input must be a rank 2, but got rank "+r.rank+"."),n.assert(t.size===r.shape[1],"Error in matrixTimesVector: size of first rank 1 input "+t.size+" must match inner dimension of second rank 2 input, but got shape "+r.shape+"."),r.matMul(t.as2D(-1,1)).as1D()},a.dotProduct=function(r,t){return n.assert(1===r.rank&&1===t.rank,"Error in dotProduct: inputs must be rank 1, but got ranks "+r.rank+" and "+t.rank+"."),n.assert(r.size===t.size,"Error in dotProduct: size of inputs ("+r.size+") and ("+t.size+") must match."),r.as2D(1,-1).matMul(t.as2D(-1,1)).asScalar()},a.outerProduct=function(r,t){return n.assert(1===r.rank&&1===t.rank,"Error in outerProduct: inputs must be rank 1, but got ranks "+r.rank+" and "+t.rank+"."),r.as2D(-1,1).matMul(t.as2D(1,-1))},a.dot=function(r,t){n.assert(!(1!==r.rank&&2!==r.rank||1!==t.rank&&2!==t.rank),"Error in dot: inputs must all be rank 1 or 2, but got ranks "+r.rank+" and "+t.rank+".");var a=1===r.rank?r.size:r.shape[1],e=1===t.rank?t.size:t.shape[0];return n.assert(a===e,"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+e+"."),1===r.rank&&1===t.rank?r.as2D(1,-1).matMul(t.as2D(-1,1)).asScalar():1===r.rank&&2===t.rank?r.as2D(1,-1).matMul(t.as2D(t.shape[0],t.shape[1])).as1D():2===r.rank&&1===t.rank?r.matMul(t.as2D(-1,1)).as1D():r.matMul(t.as2D(t.shape[0],t.shape[1]))},o([(0,r.doc)({heading:"Operations",subheading:"Matrices"}),e.operation],a,"matMul",null),o([e.operation],a,"vectorTimesMatrix",null),o([e.operation],a,"matrixTimesVector",null),o([e.operation],a,"dotProduct",null),o([(0,r.doc)({heading:"Operations",subheading:"Matrices"}),e.operation],a,"outerProduct",null),o([(0,r.doc)({heading:"Operations",subheading:"Matrices"}),e.operation],a,"dot",null),a}();exports.MatmulOps=u;
},{"../doc":105,"../environment":95,"../util":98,"./operation":246}],370:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MovingAverageOps=void 0;var e=require("../doc"),r=require("../util"),t=s(r),a=require("./array_ops"),n=require("./binary_ops"),o=require("./operation");function s(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var i=function(e,r,t,a){var n,o=arguments.length,s=o<3?r:null===a?a=Object.getOwnPropertyDescriptor(r,t):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,t,a);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(s=(o<3?n(s):o>3?n(r,t,s):n(r,t))||s);return o>3&&s&&Object.defineProperty(r,t,s),s},u=function(){function r(){}return r.movingAverage=function(e,r,o,s,i){void 0===i&&(i=!0),t.assertArgumentsAreTensors({v:e,x:r},"movingAverage"),t.assertTypesMatch(e,r),t.assert(t.arraysEqual(e.shape,r.shape),"Shape mismatch in v and x");var u=a.ArrayOps.scalar(1);o="number"==typeof o?a.ArrayOps.scalar(o):o;var p=u.sub(o),c=r.sub(e).mul(p);return i&&(t.assert(null!=s,"When using zeroDebias: true, step is required."),s="number"==typeof s?a.ArrayOps.scalar(s):s,c=c.div(u.sub(n.BinaryOps.pow(o,s)))),e.add(c)},i([(0,e.doc)({heading:"Operations",subheading:"Moving Average"}),o.operation],r,"movingAverage",null),r}();exports.MovingAverageOps=u;
},{"../doc":105,"../util":98,"./array_ops":295,"./binary_ops":360,"./operation":246}],371:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NormOps=void 0;var r=require("../doc"),e=require("../util"),n=s(e),t=require("./axis_util"),i=s(t),o=require("./operation"),a=require("./ops"),u=s(a);function s(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}var f=function(r,e,n,t){var i,o=arguments.length,a=o<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(r,e,n,t);else for(var u=r.length-1;u>=0;u--)(i=r[u])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},l=function(){function e(){}return e.norm=function(r,e,t,o){void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===o&&(o=!1),n.assertArgumentsAreTensors({x:r},"norm");var a=c(r,e,t),u=a.shape;if(o){var s=i.parseAxisParam(t,r.shape);u=i.expandShapeToKeepDim(a.shape,s)}return a.reshape(u)},f([(0,r.doc)({heading:"Operations",subheading:"Matrices"}),o.operation],e,"norm",null),e}();function c(r,e,n){if(void 0===n&&(n=null),0===r.rank)return r.abs();if(1!==r.rank&&null===n)return c(r.reshape([-1]),e,n);if(1===r.rank||"number"==typeof n||n instanceof Array&&1===n.length){if(1===e)return r.abs().sum(n);if(e===1/0)return r.abs().max(n);if(e===-1/0)return r.abs().min(n);if("euclidean"===e||2===e)return r.abs().pow(u.scalar(2,"int32")).sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+e)}if(n instanceof Array&&2===n.length){if(1===e)return r.abs().sum(n[0]).max(n[1]-1);if(e===1/0)return r.abs().sum(n[1]).max(n[0]);if(e===-1/0)return r.abs().sum(n[1]).min(n[0]);if("fro"===e||"euclidean"===e)return r.square().sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+n)}exports.NormOps=l;
},{"../doc":105,"../util":98,"./axis_util":312,"./operation":246,"./ops":119}],372:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PoolOps=void 0;var r=require("../doc"),n=require("../environment"),o=require("../util"),e=u(o),a=require("./conv_util"),t=u(a),s=require("./operation");function u(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o]);return n.default=r,n}var p=function(r,n,o,e){var a,t=arguments.length,s=t<3?n:null===e?e=Object.getOwnPropertyDescriptor(n,o):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,n,o,e);else for(var u=r.length-1;u>=0;u--)(a=r[u])&&(s=(t<3?a(s):t>3?a(n,o,s):a(n,o))||s);return t>3&&s&&Object.defineProperty(n,o,s),s},i=function(){function o(){}return o.maxPool=function(r,a,s,u,p){e.assertArgumentsAreTensors({x:r},"maxPool");var i=r,l=!1;3===r.rank&&(l=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2])),e.assert(4===i.rank,"Error in maxPool: input must be rank 4 but got rank "+i.rank+"."),null!=p&&e.assert(e.isInt(u),"Error in maxPool: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+u+".");var c=t.computePool2DInfo(i.shape,a,s,u,p),k=n.ENV.engine.runKernel(function(r,n){return n(r.maxPool(i,c))},{x:i},function(r,n){var e=n[0];return{x:function(){return o.maxPoolBackprop(r,i,e,a,s,u)}}});return l?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k},o.maxPoolBackprop=function(r,o,a,s,u,p,i){e.assertArgumentsAreTensors({dy:r,input:o,output:a},"maxPoolBackprop"),e.assert(o.rank===r.rank,"Rank of input ("+o.rank+") does not match rank of dy ("+r.rank+")"),e.assert(4===r.rank,"Error in maxPoolBackprop: dy must be rank 4 but got rank "+r.rank+"."),e.assert(4===o.rank,"Error in maxPoolBackprop: input must be rank 4 but got rank "+o.rank+"."),null!=i&&e.assert(e.isInt(p),"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+p+".");var l=t.computePool2DInfo(o.shape,s,u,p,i);return n.ENV.engine.runKernel(function(n){return n.maxPoolBackprop(r,o,a,l)},{dy:r,input:o})},o.avgPool=function(r,a,s,u,p){e.assertArgumentsAreTensors({x:r},"avgPool"),e.assert("float32"===r.dtype,"The input dtype to avgPool must be float32");var i=r,l=!1;3===r.rank&&(l=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2])),e.assert(4===i.rank,"Error in avgPool: x must be rank 4 but got rank "+i.rank+"."),null!=p&&e.assert(e.isInt(u),"Error in avgPool: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+u+".");var c=t.computePool2DInfo(i.shape,a,s,u),k=n.ENV.engine.runKernel(function(r){return r.avgPool(i,c)},{x:i},function(r){return{x:function(){return o.avgPoolBackprop(r,i,a,s,u)}}});return k=k.cast(r.dtype),l?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k},o.avgPoolBackprop=function(r,o,a,s,u){e.assertArgumentsAreTensors({dy:r,input:o},"avgPoolBackprop"),e.assert(o.rank===r.rank,"Rank of input ("+o.rank+") does not match rank of dy ("+r.rank+")");var p=o,i=r,l=!1;3===o.rank&&(l=!0,p=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]),i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2])),e.assert(4===i.rank,"Error in avgPoolBackprop: dy must be rank 4 but got rank "+i.rank+"."),e.assert(4===p.rank,"Error in avgPoolBackprop: input must be rank 4 but got rank "+p.rank+".");var c=t.computePool2DInfo(p.shape,a,s,u),k=n.ENV.engine.runKernel(function(r){return r.avgPoolBackprop(i,p,c)},{dy4D:i,input4D:p});return l?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k},p([(0,r.doc)({heading:"Operations",subheading:"Convolution"}),s.operation],o,"maxPool",null),p([s.operation],o,"maxPoolBackprop",null),p([(0,r.doc)({heading:"Operations",subheading:"Convolution"}),s.operation],o,"avgPool",null),p([s.operation],o,"avgPoolBackprop",null),o}();exports.PoolOps=i;
},{"../doc":105,"../environment":95,"../util":98,"./conv_util":396,"./operation":246}],374:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReverseOps=void 0;var e=require("../doc"),r=require("../environment"),n=require("../util"),t=u(n),s=require("./axis_util"),o=require("./operation");function u(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}var a=function(e,r,n,t){var s,o=arguments.length,u=o<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,r,n,t);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(u=(o<3?s(u):o>3?s(r,n,u):s(r,n))||u);return o>3&&u&&Object.defineProperty(r,n,u),u},i=function(){function n(){}return n.reverse1d=function(e){return t.assert(1===e.rank,"Error in reverse1D: x must be rank 1 but got\n             rank "+e.rank+"."),n.reverse(e,0)},n.reverse2d=function(e,r){return t.assert(2===e.rank,"Error in reverse2D: x must be rank 2 but got\n             rank "+e.rank+"."),n.reverse(e,r)},n.reverse3d=function(e,r){return t.assert(3===e.rank,"Error in reverse3D: x must be rank 3 but got\n             rank "+e.rank+"."),n.reverse(e,r)},n.reverse4d=function(e,r){return t.assert(4===e.rank,"Error in reverse4D: x must be rank 4 but got\n             rank "+e.rank+"."),n.reverse(e,r)},n.reverse=function(e,n){if(t.assertArgumentsAreTensors({x:e},"reverse"),0===e.rank)return e.clone();var o=(0,s.parseAxisParam)(n,e.shape);return r.ENV.engine.runKernel(function(r){return r.reverse(e,o)},{x:e},function(e){return{x:function(){return e.reverse(o)}}}).reshapeAs(e)},a([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),o.operation],n,"reverse",null),n}();exports.ReverseOps=i;
},{"../doc":105,"../environment":95,"../util":98,"./axis_util":312,"./operation":246}],314:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertParamsValid=a,exports.getStridedSlicedInfo=n,exports.startForAxis=o,exports.stopForAxis=s;var r=require("../util"),e=t(r);function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function a(r,t,a){e.assert(r.rank===t.length,"Error in slice"+r.rank+"D: Length of begin "+t+" must match the rank of the array ("+r.rank+")."),e.assert(r.rank===a.length,"Error in slice"+r.rank+"D: Length of size "+a+" must match the rank of the array ("+r.rank+").");for(var n=0;n<r.rank;++n)e.assert(t[n]+a[n]<=r.shape[n],"Error in slice"+r.rank+"D: begin["+n+"] + size["+n+"] ("+(t[n]+a[n])+") would overflow input.shape["+n+"] ("+r.shape[n]+")")}function n(r,e,t,a,n,i){void 0===n&&(n=0),void 0===i&&(i=0);for(var u=[],l=[],f=0;f<r.length;f++)u[f]=o(n,e,a,r,f),l[f]=s(i,t,a,r,f);var c=new Array(r.length).fill(0);return c=c.map(function(r,e){for(var t=0,n=u[e];!(a[e]>0?n>=l[e]:n<=l[e]);n+=a[e])t+=1;return t}),[u,c]}function o(r,t,a,n,o){var s=t[o];r&1<<o&&(s=a[o]>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var i=n[o];return s<0&&(s+=i),s=e.clamp(0,s,i-1)}function s(r,t,a,n,o){var s=t[o];r&1<<o&&(s=a[o]>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var i=n[o];return s<0&&(s+=i),s=a[o]>0?e.clamp(0,s,i):e.clamp(-1,s,i-1)}
},{"../util":98}],375:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SliceOps=void 0;var e=require("../doc"),r=require("../environment"),n=require("../util"),t=o(n),a=require("./operation"),i=require("./slice_util"),s=o(i);function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}var c=function(e,r,n,t){var a,i=arguments.length,s=i<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,n,t);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(r,n,s):a(r,n))||s);return i>3&&s&&Object.defineProperty(r,n,s),s},l=function(){function n(){}return n.slice1d=function(e,r,a){return t.assert(1===e.rank,"slice1d expects a rank-1 tensor, but got a rank-"+e.rank+" tensor"),n.slice(e,[r],[a])},n.slice2d=function(e,r,a){return t.assert(2===e.rank,"slice1d expects a rank-2 tensor, but got a rank-"+e.rank+" tensor"),n.slice(e,r,a)},n.slice3d=function(e,r,a){return t.assert(3===e.rank,"slice1d expects a rank-3 tensor, but got a rank-"+e.rank+" tensor"),n.slice(e,r,a)},n.slice4d=function(e,r,a){return t.assert(4===e.rank,"slice1d expects a rank-4 tensor, but got a rank-"+e.rank+" tensor"),n.slice(e,r,a)},n.slice=function(e,n,a){if(t.assertArgumentsAreTensors({x:e},"slice"),0===e.rank)throw new Error("Slicing scalar is not possible");var i,o;i="number"==typeof n?[n].concat(new Array(e.rank-1).fill(0)):n.length<e.rank?n.concat(new Array(e.rank-n.length).fill(0)):n,o=(o=null==a?new Array(e.rank).fill(-1):"number"==typeof a?[a].concat(new Array(e.rank-1).fill(-1)):a.length<e.rank?a.concat(new Array(e.rank-a.length).fill(-1)):a).map(function(r,n){return r>=0?r:(t.assert(-1===r,"Bad value in size"),e.shape[n]-i[n])}),s.assertParamsValid(e,i,o);var c=e.shape;return r.ENV.engine.runKernel(function(r){return r.slice(e,i,o)},{x:e},function(e){for(var r=[],n=0;n<e.rank;n++)r.push([i[n],c[n]-i[n]-o[n]]);return{x:function(){return e.pad(r)}}})},c([(0,e.doc)({heading:"Tensors",subheading:"Slicing and Joining"}),a.operation],n,"slice",null),n}();exports.SliceOps=l;
},{"../doc":105,"../environment":95,"../util":98,"./operation":246,"./slice_util":314}],376:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoftmaxOps=void 0;var r=require("../doc"),e=require("../globals"),o=require("../util"),t=l(o),n=require("./axis_util"),a=l(n),s=require("./operation"),u=require("./ops"),i=l(u);function l(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e.default=r,e}var p=function(r,e,o,t){var n,a=arguments.length,s=a<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,o):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,o,t);else for(var u=r.length-1;u>=0;u--)(n=r[u])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s},f=function(){function o(){}return o.softmax=function(r,o){if(void 0===o&&(o=-1),t.assertArgumentsAreTensors({logits:r},"softmax"),-1===o&&(o=r.rank-1),o!==r.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+r.rank+" and dim was "+o);return(0,e.customGrad)(function(r){var e=r.logSumExp([o],!0),t=r.toFloat().sub(e).exp();return{value:t,gradFunc:function(r){var e=r.mul(t);return e.sub(e.sum([o],!0).mul(t))}}})(r)},o.softmaxCrossEntropy=function(r,o,n){if(void 0===n&&(n=-1),t.assertArgumentsAreTensors({labels:r,logits:o},"softmaxCrossEntropy"),t.assertShapesMatch(r.shape,o.shape,"Error in softmaxCrossEntropy: "),-1===n&&(n=o.rank-1),n!==o.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+o.rank+" and dim was "+n);return(0,e.customGrad)(function(r,e){var o=e.softmax(n);return{value:i.scalar(1e-5).add(o).log().mul(r).neg().sum([n]),gradFunc:function(e){var t=a.expandShapeToKeepDim(e.shape,[n]);return[e.reshape(t).mul(r.toFloat().sub(o)),e.reshape(t).mul(o.sub(r.toFloat()))]}}})(r,o)},p([(0,r.doc)({heading:"Operations",subheading:"Normalization"}),s.operation],o,"softmax",null),p([(0,r.doc)({heading:"Training",subheading:"Losses",namespace:"losses"}),s.operation],o,"softmaxCrossEntropy",null),o}();exports.SoftmaxOps=f;
},{"../doc":105,"../globals":104,"../util":98,"./axis_util":312,"./operation":246,"./ops":119}],377:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StridedSliceOps=void 0;var e=require("../doc"),r=require("../environment"),t=require("../util"),n=o(t),i=require("./operation");function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var c=function(e,r,t,n){var i,o=arguments.length,c=o<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,r,t,n);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(c=(o<3?i(c):o>3?i(r,t,c):i(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c},u=function(){function t(){}return t.stridedSlice=function(e,t,i,o,c,u){return void 0===c&&(c=0),void 0===u&&(u=0),n.assertArgumentsAreTensors({x:e},"stridedSlice"),r.ENV.engine.runKernel(function(r){return r.stridedSlice(e,t,i,o,c,u)},{x:e})},c([(0,e.doc)({heading:"Operations",subheading:"Slicing and Joining"}),i.operation],t,"stridedSlice",null),t}();exports.StridedSliceOps=u;
},{"../doc":105,"../environment":95,"../util":98,"./operation":246}],378:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransposeOps=void 0;var e=require("../doc"),r=require("../environment"),n=require("../util"),t=a(n),o=require("./axis_util"),s=a(o),u=require("./operation");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}var i=function(e,r,n,t){var o,s=arguments.length,u=s<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,r,n,t);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(u=(s<3?o(u):s>3?o(r,n,u):o(r,n))||u);return s>3&&u&&Object.defineProperty(r,n,u),u},c=function(){function n(){}return n.transpose=function(e,n){if(t.assertArgumentsAreTensors({x:e},"transpose"),null==n&&(n=e.shape.map(function(e,r){return r}).reverse()),t.assert(e.rank===n.length,"Error in transpose: rank of input "+e.rank+" must match length of perm "+n+"."),n.forEach(function(r){t.assert(r>=0&&r<e.rank,"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+n)}),e.rank<=1)return e.clone();return r.ENV.engine.runKernel(function(r){return r.transpose(e,n)},{x:e},function(e){var r=s.getUndoAxesPermutation(n);return{x:function(){return e.transpose(r)}}})},i([(0,e.doc)({heading:"Operations",subheading:"Matrices"}),u.operation],n,"transpose",null),n}();exports.TransposeOps=c;
},{"../doc":105,"../environment":95,"../util":98,"./axis_util":312,"./operation":246}],357:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.SELU_SCALEALPHA=1.7580993408473768,r=exports.SELU_SCALE=1.0507009873554805;
},{}],379:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnaryOps=void 0;var n=require("../doc"),r=require("../environment"),e=require("../util"),t=c(e),u=require("./operation"),i=require("./ops"),o=c(i),s=require("./selu_util"),a=c(s);function c(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e]);return r.default=n,r}var l=function(n,r,e,t){var u,i=arguments.length,o=i<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(n,r,e,t);else for(var s=n.length-1;s>=0;s--)(u=n[s])&&(o=(i<3?u(o):i>3?u(r,e,o):u(r,e))||o);return i>3&&o&&Object.defineProperty(r,e,o),o},g=function(){function e(){}return e.neg=function(n){t.assertArgumentsAreTensors({x:n},"neg");return r.ENV.engine.runKernel(function(r){return r.neg(n)},{x:n},function(n){return{x:function(){return n.neg()}}})},e.ceil=function(n){t.assertArgumentsAreTensors({x:n},"ceil");return r.ENV.engine.runKernel(function(r){return r.ceil(n)},{x:n},function(n){return{x:function(){return o.zerosLike(n)}}})},e.floor=function(n){t.assertArgumentsAreTensors({x:n},"floor");return r.ENV.engine.runKernel(function(r){return r.floor(n)},{x:n},function(n){return{x:function(){return o.zerosLike(n)}}})},e.sign=function(n){t.assertArgumentsAreTensors({x:n},"sign");return r.ENV.engine.runKernel(function(r){return r.sign(n)},{x:n},function(n){return{x:function(){return o.zerosLike(n)}}})},e.round=function(n){t.assertArgumentsAreTensors({x:n},"round");return r.ENV.engine.runKernel(function(r){return r.round(n)},{x:n},function(n){return{x:function(){return o.zerosLike(n)}}})},e.exp=function(n){t.assertArgumentsAreTensors({x:n},"exp");return r.ENV.engine.runKernel(function(r,e){return e(r.exp(n))},{x:n},function(n,r){var e=r[0];return{x:function(){return n.mulStrict(e)}}})},e.expm1=function(n){t.assertArgumentsAreTensors({x:n},"expm1");return r.ENV.engine.runKernel(function(r){return r.expm1(n)},{x:n},function(r){return{x:function(){return r.mulStrict(n.exp())}}})},e.log=function(n){t.assertArgumentsAreTensors({x:n},"log");return r.ENV.engine.runKernel(function(r){return r.log(n)},{x:n},function(r){return{x:function(){return r.divStrict(n.toFloat())}}})},e.log1p=function(n){t.assertArgumentsAreTensors({x:n},"log1p");return r.ENV.engine.runKernel(function(r){return r.log1p(n)},{x:n},function(r){return{x:function(){return r.divStrict(n.add(o.scalar(1)))}}})},e.sqrt=function(n){t.assertArgumentsAreTensors({x:n},"sqrt");return r.ENV.engine.runKernel(function(r){return r.sqrt(n)},{x:n},function(r){return{x:function(){return r.divStrict(n.toFloat().sqrt().mul(o.scalar(2)))}}})},e.rsqrt=function(n){t.assertArgumentsAreTensors({x:n},"rsqrt");return r.ENV.engine.runKernel(function(r){return r.rsqrt(n)},{x:n},function(r){return{x:function(){return r.divStrict(n.pow(o.scalar(1.5)).mul(o.scalar(2))).neg()}}})},e.square=function(n){t.assertArgumentsAreTensors({x:n},"square");return r.ENV.engine.runKernel(function(r){return r.square(n)},{x:n},function(r){return{x:function(){return r.mulStrict(n.toFloat().mul(o.scalar(2)))}}})},e.reciprocal=function(n){t.assertArgumentsAreTensors({x:n},"reciprocal");return r.ENV.engine.runKernel(function(r){return r.reciprocal(n)},{x:n},function(r){return{x:function(){return r.divStrict(n.square().neg())}}})},e.abs=function(n){t.assertArgumentsAreTensors({x:n},"abs");return r.ENV.engine.runKernel(function(r){return r.abs(n)},{x:n},function(r){return{x:function(){return r.mulStrict(n.toFloat().step(-1))}}})},e.clipByValue=function(n,e,u){t.assertArgumentsAreTensors({x:n},"clipByValue"),t.assert(e<=u,"Error in clip: min ("+e+") must be less than or equal to max ("+u+").");return r.ENV.engine.runKernel(function(r){return r.clip(n,e,u)},{x:n},function(r){return{x:function(){return r.where(n.greaterEqual(o.scalar(e)).logicalAnd(n.lessEqual(o.scalar(u))),(0,i.zerosLike)(r))}}})},e.relu=function(n){if(t.assertArgumentsAreTensors({x:n},"relu"),"bool"===n.dtype)return n.toInt();return r.ENV.engine.runKernel(function(r){return r.relu(n)},{x:n},function(r){var e=n.step();return{x:function(){return r.mulStrict(e.toFloat())}}})},e.elu=function(n){t.assertArgumentsAreTensors({x:n},"elu");return r.ENV.engine.runKernel(function(r,e){return e(r.elu(n))},{x:n},function(n,e){var t=e[0];return{x:function(){return r.ENV.engine.runKernel(function(r){return r.eluDer(n,t)},{dy:n,y:t})}}})},e.selu=function(n){t.assertArgumentsAreTensors({x:n},"selu");return r.ENV.engine.runKernel(function(r){return r.selu(n)},{x:n},function(r){return{x:function(){var e=n.greater(o.scalar(0)),t=o.scalar(a.SELU_SCALEALPHA),u=o.scalar(a.SELU_SCALE),i=r.mul(u),s=r.mul(t).mul(n.toFloat().exp());return o.where(e,i,s)}}})},e.leakyRelu=function(n,r){return void 0===r&&(r=.2),t.assertArgumentsAreTensors({x:n},"leakyRelu"),o.maximum(o.scalar(r).mul(n),n)},e.prelu=function(n,r){t.assertArgumentsAreTensors({x:n,alpha:r},"prelu");var e=o.scalar(0);return o.maximum(e,n).add(r.mul(o.minimum(e,n)))},e.sigmoid=function(n){t.assertArgumentsAreTensors({x:n},"sigmoid");return r.ENV.engine.runKernel(function(r,e){return e(r.sigmoid(n))},{x:n},function(n,r){var e=r[0];return{x:function(){return n.mulStrict(e.mul(o.scalar(1).sub(e)))}}})},e.logSigmoid=function(n){t.assertArgumentsAreTensors({x:n},"logSigmoid");return r.ENV.engine.runKernel(function(r){return r.softplus(n.neg()).neg()},{x:n},function(r){return{x:function(){return r.mulStrict(n.neg().sigmoid())}}})},e.softplus=function(n){t.assertArgumentsAreTensors({x:n},"softplus");return r.ENV.engine.runKernel(function(r){return r.softplus(n)},{x:n},function(r){return{x:function(){return r.mulStrict(n.sigmoid())}}})},e.sin=function(n){t.assertArgumentsAreTensors({x:n},"sin");return r.ENV.engine.runKernel(function(r){return r.sin(n)},{x:n},function(r){return{x:function(){return n.toFloat().cos().mulStrict(r)}}})},e.cos=function(n){t.assertArgumentsAreTensors({x:n},"cos");return r.ENV.engine.runKernel(function(r){return r.cos(n)},{x:n},function(r){return{x:function(){return n.toFloat().sin().neg().mulStrict(r)}}})},e.tan=function(n){t.assertArgumentsAreTensors({x:n},"tan");return r.ENV.engine.runKernel(function(r){return r.tan(n)},{x:n},function(r){return{x:function(){return r.divStrict(n.cos().square())}}})},e.asin=function(n){t.assertArgumentsAreTensors({x:n},"asin");return r.ENV.engine.runKernel(function(r){return r.asin(n)},{x:n},function(r){return{x:function(){return r.divStrict(e.sqrt(o.scalar(1).sub(n.toFloat().square())))}}})},e.acos=function(n){t.assertArgumentsAreTensors({x:n},"acos");return r.ENV.engine.runKernel(function(r){return r.acos(n)},{x:n},function(r){return{x:function(){return r.divStrict(e.sqrt(o.scalar(1).sub(n.toFloat().square()))).neg()}}})},e.atan=function(n){t.assertArgumentsAreTensors({x:n},"atan");return r.ENV.engine.runKernel(function(r){return r.atan(n)},{x:n},function(r){return{x:function(){return r.divStrict(o.scalar(1).add(n.toFloat().square()))}}})},e.sinh=function(n){t.assertArgumentsAreTensors({x:n},"sinh");return r.ENV.engine.runKernel(function(r){return r.sinh(n)},{x:n},function(r){return{x:function(){return n.toFloat().cosh().mulStrict(r)}}})},e.cosh=function(n){t.assertArgumentsAreTensors({x:n},"cosh");return r.ENV.engine.runKernel(function(r){return r.cosh(n)},{x:n},function(r){return{x:function(){return n.toFloat().sinh().mulStrict(r)}}})},e.tanh=function(n){t.assertArgumentsAreTensors({x:n},"tanh");return r.ENV.engine.runKernel(function(r,e){return e(r.tanh(n))},{x:n},function(n,r){var e=r[0];return{x:function(){return o.scalar(1).sub(e.square()).mulStrict(n)}}})},e.asinh=function(n){t.assertArgumentsAreTensors({x:n},"asinh");return r.ENV.engine.runKernel(function(r){return r.asinh(n)},{x:n},function(r){return{x:function(){return r.divStrict(e.sqrt(o.scalar(1).add(n.toFloat().square())))}}})},e.acosh=function(n){t.assertArgumentsAreTensors({x:n},"acosh");return r.ENV.engine.runKernel(function(r){return r.acosh(n)},{x:n},function(r){return{x:function(){return r.divStrict(e.sqrt(n.toFloat().square().sub(o.scalar(1))))}}})},e.atanh=function(n){t.assertArgumentsAreTensors({x:n},"atanh");return r.ENV.engine.runKernel(function(r){return r.atanh(n)},{x:n},function(r){return{x:function(){return r.divStrict(o.scalar(1).sub(n.toFloat().square()))}}})},e.erf=function(n){t.assert("int32"===n.dtype||"float32"===n.dtype,"Input dtype must be `int32` or `float32`."),"int32"===n.dtype&&(n=n.toFloat());return r.ENV.engine.runKernel(function(r){return r.erf(n)},{x:n},function(r){return{x:function(){return r.mulStrict(o.scalar(2/Math.sqrt(Math.PI)).mul(n.square().neg().exp()))}}})},e.step=function(n,e){void 0===e&&(e=0),t.assertArgumentsAreTensors({x:n},"step");return r.ENV.engine.runKernel(function(r){return r.step(n,e)},{x:n},function(n){return{x:function(){return o.zerosLike(n)}}})},l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"neg",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"ceil",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"floor",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"sign",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"round",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"exp",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"expm1",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"log",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"log1p",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"sqrt",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"rsqrt",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"square",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"reciprocal",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"abs",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"clipByValue",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"relu",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"elu",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"selu",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"leakyRelu",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"prelu",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"sigmoid",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"logSigmoid",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"softplus",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"sin",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"cos",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"tan",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"asin",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"acos",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"atan",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"sinh",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"cosh",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"tanh",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"asinh",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"acosh",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"atanh",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"erf",null),l([(0,n.doc)({heading:"Operations",subheading:"Basic math"}),u.operation],e,"step",null),e}();exports.UnaryOps=g;
},{"../doc":105,"../environment":95,"../util":98,"./operation":246,"./ops":119,"./selu_util":357}],119:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.image=exports.losses=exports.operation=exports.linalg=exports.localResponseNormalization=exports.softmax=exports.multiRNNCell=exports.basicLSTMCell=exports.movingAverage=exports.pad4d=exports.pad3d=exports.pad2d=exports.pad1d=exports.pad=exports.cumsum=exports.split=exports.unstack=exports.stack=exports.expandDims=exports.print=exports.tensor5d=exports.tensor4d=exports.tensor3d=exports.tensor2d=exports.tensor1d=exports.scalar=exports.tensor=exports.fill=exports.buffer=exports.range=exports.linspace=exports.oneHot=exports.gather=exports.tile=exports.squeeze=exports.reshape=exports.multinomial=exports.randomUniform=exports.truncatedNormal=exports.randomNormal=exports.rand=exports.eye=exports.zerosLike=exports.zeros=exports.onesLike=exports.ones=exports.toPixels=exports.fromPixels=exports.clone=exports.cast=exports.norm=exports.squaredDifferenceStrict=exports.squaredDifference=exports.subStrict=exports.sub=exports.powStrict=exports.pow=exports.mulStrict=exports.mul=exports.modStrict=exports.mod=exports.minimumStrict=exports.minimum=exports.maximumStrict=exports.maximum=exports.divStrict=exports.floorDiv=void 0,exports.div=exports.atan2=exports.addStrict=exports.add=exports.erf=exports.tanh=exports.tan=exports.step=exports.square=exports.rsqrt=exports.sqrt=exports.softplus=exports.sinh=exports.sin=exports.sigmoid=exports.selu=exports.round=exports.reciprocal=exports.relu=exports.prelu=exports.neg=exports.logSigmoid=exports.log1p=exports.log=exports.leakyRelu=exports.sign=exports.floor=exports.expm1=exports.exp=exports.elu=exports.cosh=exports.cos=exports.clipByValue=exports.ceil=exports.atanh=exports.atan=exports.asinh=exports.asin=exports.acosh=exports.acos=exports.abs=exports.where=exports.logicalXor=exports.logicalOr=exports.logicalAnd=exports.logicalNot=exports.notEqualStrict=exports.notEqual=exports.lessEqualStrict=exports.lessEqual=exports.lessStrict=exports.less=exports.greaterEqualStrict=exports.greaterEqual=exports.greaterStrict=exports.greater=exports.equalStrict=exports.equal=exports.unsortedSegmentSum=exports.sum=exports.moments=exports.min=exports.mean=exports.max=exports.logSumExp=exports.argMin=exports.argMax=exports.stridedSlice=exports.slice4d=exports.slice3d=exports.slice2d=exports.slice1d=exports.slice=exports.reverse4d=exports.reverse3d=exports.reverse2d=exports.reverse1d=exports.reverse=exports.transpose=exports.maxPool=exports.avgPool=exports.dot=exports.vectorTimesMatrix=exports.outerProduct=exports.matrixTimesVector=exports.matMul=exports.separableConv2d=exports.depthwiseConv2d=exports.conv2dTranspose=exports.conv2d=exports.conv1d=exports.concat4d=exports.concat3d=exports.concat2d=exports.concat1d=exports.concat=exports.batchNormalization4d=exports.batchNormalization3d=exports.batchNormalization2d=exports.batchNormalization=void 0;var r=require("./operation");Object.defineProperty(exports,"operation",{enumerable:!0,get:function(){return r.operation}});var e=require("./array_ops"),s=require("./batchnorm"),o=require("./binary_ops"),t=require("./compare"),p=require("./concat"),a=require("./conv"),x=require("./image_ops"),i=require("./linalg_ops"),n=require("./logical_ops"),l=require("./loss_ops"),c=require("./lrn"),m=require("./lstm"),d=require("./matmul"),u=require("./moving_average"),O=require("./norm"),y=require("./pool"),g=require("./reduction_ops"),S=require("./reverse"),v=require("./slice"),q=require("./softmax"),h=require("./strided_slice"),f=require("./transpose"),A=require("./unary_ops"),b=require("../tensor"),N=require("../types"),U=exports.batchNormalization=s.BatchNormOps.batchNormalization,C=exports.batchNormalization2d=s.BatchNormOps.batchNormalization2d,L=exports.batchNormalization3d=s.BatchNormOps.batchNormalization3d,B=exports.batchNormalization4d=s.BatchNormOps.batchNormalization4d,z=exports.concat=p.ConcatOps.concat,R=exports.concat1d=p.ConcatOps.concat1d,E=exports.concat2d=p.ConcatOps.concat2d,M=exports.concat3d=p.ConcatOps.concat3d,P=exports.concat4d=p.ConcatOps.concat4d,k=exports.conv1d=a.ConvOps.conv1d,D=exports.conv2d=a.ConvOps.conv2d,T=exports.conv2dTranspose=a.ConvOps.conv2dTranspose,w=exports.depthwiseConv2d=a.ConvOps.depthwiseConv2d,_=exports.separableConv2d=a.ConvOps.separableConv2d,V=exports.matMul=d.MatmulOps.matMul,H=exports.matrixTimesVector=d.MatmulOps.matrixTimesVector,X=exports.outerProduct=d.MatmulOps.outerProduct,j=exports.vectorTimesMatrix=d.MatmulOps.vectorTimesMatrix,I=exports.dot=d.MatmulOps.dot,W=exports.avgPool=y.PoolOps.avgPool,F=exports.maxPool=y.PoolOps.maxPool,G=exports.transpose=f.TransposeOps.transpose,J=exports.reverse=S.ReverseOps.reverse,K=exports.reverse1d=S.ReverseOps.reverse1d,Q=exports.reverse2d=S.ReverseOps.reverse2d,Y=exports.reverse3d=S.ReverseOps.reverse3d,Z=exports.reverse4d=S.ReverseOps.reverse4d,$=exports.slice=v.SliceOps.slice,rr=exports.slice1d=v.SliceOps.slice1d,er=exports.slice2d=v.SliceOps.slice2d,sr=exports.slice3d=v.SliceOps.slice3d,or=exports.slice4d=v.SliceOps.slice4d,tr=exports.stridedSlice=h.StridedSliceOps.stridedSlice,pr=exports.argMax=g.ReductionOps.argMax,ar=exports.argMin=g.ReductionOps.argMin,xr=exports.logSumExp=g.ReductionOps.logSumExp,ir=exports.max=g.ReductionOps.max,nr=exports.mean=g.ReductionOps.mean,lr=exports.min=g.ReductionOps.min,cr=exports.moments=g.ReductionOps.moments,mr=exports.sum=g.ReductionOps.sum,dr=exports.unsortedSegmentSum=g.ReductionOps.unsortedSegmentSum,ur=exports.equal=t.CompareOps.equal,Or=exports.equalStrict=t.CompareOps.equalStrict,yr=exports.greater=t.CompareOps.greater,gr=exports.greaterStrict=t.CompareOps.greaterStrict,Sr=exports.greaterEqual=t.CompareOps.greaterEqual,vr=exports.greaterEqualStrict=t.CompareOps.greaterEqualStrict,qr=exports.less=t.CompareOps.less,hr=exports.lessStrict=t.CompareOps.lessStrict,fr=exports.lessEqual=t.CompareOps.lessEqual,Ar=exports.lessEqualStrict=t.CompareOps.lessEqualStrict,br=exports.notEqual=t.CompareOps.notEqual,Nr=exports.notEqualStrict=t.CompareOps.notEqualStrict,Ur=exports.logicalNot=n.LogicalOps.logicalNot,Cr=exports.logicalAnd=n.LogicalOps.logicalAnd,Lr=exports.logicalOr=n.LogicalOps.logicalOr,Br=exports.logicalXor=n.LogicalOps.logicalXor,zr=exports.where=n.LogicalOps.where,Rr=exports.abs=A.UnaryOps.abs,Er=exports.acos=A.UnaryOps.acos,Mr=exports.acosh=A.UnaryOps.acosh,Pr=exports.asin=A.UnaryOps.asin,kr=exports.asinh=A.UnaryOps.asinh,Dr=exports.atan=A.UnaryOps.atan,Tr=exports.atanh=A.UnaryOps.atanh,wr=exports.ceil=A.UnaryOps.ceil,_r=exports.clipByValue=A.UnaryOps.clipByValue,Vr=exports.cos=A.UnaryOps.cos,Hr=exports.cosh=A.UnaryOps.cosh,Xr=exports.elu=A.UnaryOps.elu,jr=exports.exp=A.UnaryOps.exp,Ir=exports.expm1=A.UnaryOps.expm1,Wr=exports.floor=A.UnaryOps.floor,Fr=exports.sign=A.UnaryOps.sign,Gr=exports.leakyRelu=A.UnaryOps.leakyRelu,Jr=exports.log=A.UnaryOps.log,Kr=exports.log1p=A.UnaryOps.log1p,Qr=exports.logSigmoid=A.UnaryOps.logSigmoid,Yr=exports.neg=A.UnaryOps.neg,Zr=exports.prelu=A.UnaryOps.prelu,$r=exports.relu=A.UnaryOps.relu,re=exports.reciprocal=A.UnaryOps.reciprocal,ee=exports.round=A.UnaryOps.round,se=exports.selu=A.UnaryOps.selu,oe=exports.sigmoid=A.UnaryOps.sigmoid,te=exports.sin=A.UnaryOps.sin,pe=exports.sinh=A.UnaryOps.sinh,ae=exports.softplus=A.UnaryOps.softplus,xe=exports.sqrt=A.UnaryOps.sqrt,ie=exports.rsqrt=A.UnaryOps.rsqrt,ne=exports.square=A.UnaryOps.square,le=exports.step=A.UnaryOps.step,ce=exports.tan=A.UnaryOps.tan,me=exports.tanh=A.UnaryOps.tanh,de=exports.erf=A.UnaryOps.erf,ue=exports.add=o.BinaryOps.add,Oe=exports.addStrict=o.BinaryOps.addStrict,ye=exports.atan2=o.BinaryOps.atan2,ge=exports.div=o.BinaryOps.div,Se=exports.floorDiv=o.BinaryOps.floorDiv,ve=exports.divStrict=o.BinaryOps.divStrict,qe=exports.maximum=o.BinaryOps.maximum,he=exports.maximumStrict=o.BinaryOps.maximumStrict,fe=exports.minimum=o.BinaryOps.minimum,Ae=exports.minimumStrict=o.BinaryOps.minimumStrict,be=exports.mod=o.BinaryOps.mod,Ne=exports.modStrict=o.BinaryOps.modStrict,Ue=exports.mul=o.BinaryOps.mul,Ce=exports.mulStrict=o.BinaryOps.mulStrict,Le=exports.pow=o.BinaryOps.pow,Be=exports.powStrict=o.BinaryOps.powStrict,ze=exports.sub=o.BinaryOps.sub,Re=exports.subStrict=o.BinaryOps.subStrict,Ee=exports.squaredDifference=o.BinaryOps.squaredDifference,Me=exports.squaredDifferenceStrict=o.BinaryOps.squaredDifferenceStrict,Pe=exports.norm=O.NormOps.norm,ke=exports.cast=e.ArrayOps.cast,De=exports.clone=e.ArrayOps.clone,Te=exports.fromPixels=e.ArrayOps.fromPixels,we=exports.toPixels=e.ArrayOps.toPixels,_e=exports.ones=e.ArrayOps.ones,Ve=exports.onesLike=e.ArrayOps.onesLike,He=exports.zeros=e.ArrayOps.zeros,Xe=exports.zerosLike=e.ArrayOps.zerosLike,je=exports.eye=e.ArrayOps.eye,Ie=exports.rand=e.ArrayOps.rand,We=exports.randomNormal=e.ArrayOps.randomNormal,Fe=exports.truncatedNormal=e.ArrayOps.truncatedNormal,Ge=exports.randomUniform=e.ArrayOps.randomUniform,Je=exports.multinomial=e.ArrayOps.multinomial,Ke=exports.reshape=e.ArrayOps.reshape,Qe=exports.squeeze=e.ArrayOps.squeeze,Ye=exports.tile=e.ArrayOps.tile,Ze=exports.gather=e.ArrayOps.gather,$e=exports.oneHot=e.ArrayOps.oneHot,rs=exports.linspace=e.ArrayOps.linspace,es=exports.range=e.ArrayOps.range,ss=exports.buffer=e.ArrayOps.buffer,os=exports.fill=e.ArrayOps.fill,ts=exports.tensor=e.ArrayOps.tensor,ps=exports.scalar=e.ArrayOps.scalar,as=exports.tensor1d=e.ArrayOps.tensor1d,xs=exports.tensor2d=e.ArrayOps.tensor2d,is=exports.tensor3d=e.ArrayOps.tensor3d,ns=exports.tensor4d=e.ArrayOps.tensor4d,ls=exports.tensor5d=e.ArrayOps.tensor5d,cs=exports.print=e.ArrayOps.print,ms=exports.expandDims=e.ArrayOps.expandDims,ds=exports.stack=e.ArrayOps.stack,us=exports.unstack=e.ArrayOps.unstack,Os=exports.split=e.ArrayOps.split,ys=exports.cumsum=e.ArrayOps.cumsum,gs=exports.pad=e.ArrayOps.pad,Ss=exports.pad1d=e.ArrayOps.pad1d,vs=exports.pad2d=e.ArrayOps.pad2d,qs=exports.pad3d=e.ArrayOps.pad3d,hs=exports.pad4d=e.ArrayOps.pad4d,fs=exports.movingAverage=u.MovingAverageOps.movingAverage,As=exports.basicLSTMCell=m.LSTMOps.basicLSTMCell,bs=exports.multiRNNCell=m.LSTMOps.multiRNNCell,Ns=exports.softmax=q.SoftmaxOps.softmax,Us=exports.localResponseNormalization=c.LRNOps.localResponseNormalization,Cs=exports.linalg=i.LinalgOps;b.Tensor,N.Rank,l.Reduction;var Ls=exports.losses={absoluteDifference:l.LossOps.absoluteDifference,computeWeightedLoss:l.LossOps.computeWeightedLoss,cosineDistance:l.LossOps.cosineDistance,hingeLoss:l.LossOps.hingeLoss,huberLoss:l.LossOps.huberLoss,logLoss:l.LossOps.logLoss,meanSquaredError:l.LossOps.meanSquaredError,softmaxCrossEntropy:q.SoftmaxOps.softmaxCrossEntropy},Bs=exports.image={resizeBilinear:x.ImageOps.resizeBilinear,resizeNearestNeighbor:x.ImageOps.resizeNearestNeighbor};
},{"./array_ops":295,"./batchnorm":359,"./binary_ops":360,"./compare":361,"./concat":362,"./conv":363,"./image_ops":364,"./linalg_ops":365,"./logical_ops":366,"./loss_ops":120,"./lrn":367,"./lstm":368,"./matmul":369,"./moving_average":370,"./norm":371,"./pool":372,"./reduction_ops":373,"./reverse":374,"./slice":375,"./softmax":376,"./strided_slice":377,"./transpose":378,"./unary_ops":379,"./operation":246,"../tensor":101,"../types":102}],101:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.variable=exports.Variable=exports.Tensor=exports.TensorBuffer=void 0;var t=require("./doc"),o=require("./environment"),e=require("./ops/ops"),r=p(e),s=require("./tensor_util"),i=p(s),n=require("./util"),h=p(n);function p(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e]);return o.default=t,o}var u=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),a=function(t,o,e,r){var s,i=arguments.length,n=i<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,o,e,r);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(n=(i<3?s(n):i>3?s(o,e,n):s(o,e))||n);return i>3&&n&&Object.defineProperty(o,e,n),n},d=function(t,o,e,r){return new(e||(e=Promise))(function(s,i){function n(t){try{p(r.next(t))}catch(t){i(t)}}function h(t){try{p(r.throw(t))}catch(t){i(t)}}function p(t){t.done?s(t.value):new e(function(o){o(t.value)}).then(n,h)}p((r=r.apply(t,o||[])).next())})},f=function(t,o){var e,r,s,i,n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function h(i){return function(h){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;n;)try{if(e=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return n.label++,{value:i[1],done:!1};case 5:n.label++,r=i[1],i=[0];continue;case 7:i=n.ops.pop(),n.trys.pop();continue;default:if(!(s=(s=n.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){n=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){n.label=i[1];break}if(6===i[0]&&n.label<s[1]){n.label=s[1],s=i;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(i);break}s[2]&&n.ops.pop(),n.trys.pop();continue}i=o.call(t,n)}catch(t){i=[6,t],r=0}finally{e=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,h])}}},c=function(){function o(t,o,e){if(this.dtype=o,null!=e){var r=e.length,s=h.sizeFromShape(t);h.assert(r===s,"Length of values '"+r+"' does not match the size inferred by the shape '"+s+"'")}this.shape=t.slice(),this.values=e||h.getTypedArrayFromDType(o,h.sizeFromShape(t)),this.strides=w(t),this.size=h.sizeFromShape(t)}return o.prototype.set=function(t){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];0===o.length&&(o=[0]),h.assert(o.length===this.rank,"The number of provided coordinates ("+o.length+") must match the rank ("+this.rank+")");var r=this.locToIndex(o);this.values[r]=t},o.prototype.get=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];0===t.length&&(t=[0]);for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return this.values[e]},o.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var o=t[t.length-1],e=0;e<t.length-1;++e)o+=this.strides[e]*t[e];return o},o.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var o=new Array(this.shape.length),e=0;e<o.length-1;++e)o[e]=Math.floor(t/this.strides[e]),t-=o[e]*this.strides[e];return o[o.length-1]=t,o},Object.defineProperty(o.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),o.prototype.toTensor=function(){return l.make(this.shape,{values:this.values},this.dtype)},a([(0,t.doc)({heading:"Tensors",subheading:"Creation"})],o.prototype,"set",null),a([(0,t.doc)({heading:"Tensors",subheading:"Creation"})],o.prototype,"get",null),a([(0,t.doc)({heading:"Tensors",subheading:"Creation"})],o.prototype,"toTensor",null),o=a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],o)}();exports.TensorBuffer=c;var l=function(){function e(t,e,r,i){this.isDisposedInternal=!1,this.size=h.sizeFromShape(t),null!=r&&h.assert(this.size===r.length,"Constructing tensor of shape ("+this.size+") should match the length of values ("+r.length+")"),this.shape=t.slice(),this.dtype=e||"float32",this.strides=w(t),this.dataId=null!=i?i:{},this.id=s.nextId++,this.rankType=this.rank<5?this.rank.toString():"higher",o.ENV.engine.registerTensor(this),null!=r&&o.ENV.engine.write(this.dataId,r)}return s=e,e.make=function(t,o,e){return new s(t,e,o.values,o.dataId)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),h.assert(1===this.size,"The array must have only 1 element."),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,o){return this.throwIfDisposed(),this.reshape([t,o])},e.prototype.as3D=function(t,o,e){return this.throwIfDisposed(),this.reshape([t,o,e])},e.prototype.as4D=function(t,o,e,r){return this.throwIfDisposed(),this.reshape([t,o,e,r])},e.prototype.asType=function(t){return this.throwIfDisposed(),r.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.get=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];h.assert(t.length===this.rank,"Number of coordinates in get() must match the rank of the tensor"),this.throwIfDisposed(),0===t.length&&(t=[0]);for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return this.dataSync()[e]},e.prototype.buffer=function(){return r.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.data=function(){return d(this,void 0,void 0,function(){return f(this,function(t){return this.throwIfDisposed(),[2,o.ENV.engine.read(this.dataId)]})})},e.prototype.dataSync=function(){return this.throwIfDisposed(),o.ENV.engine.readSync(this.dataId)},e.prototype.dispose=function(){this.isDisposed||(o.ENV.engine.disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return void 0===t&&(t=!1),r.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),r.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return void 0===t&&(t=0),r.expandDims(this,t)},e.prototype.cumsum=function(t,o,e){return void 0===t&&(t=0),void 0===o&&(o=!1),void 0===e&&(e=!1),r.cumsum(this,t,o,e)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),r.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),r.clone(this)},e.prototype.toString=function(t){return void 0===t&&(t=!1),i.tensorToString(this,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),r.tile(this,t)},e.prototype.gather=function(t,o){return void 0===o&&(o=0),this.throwIfDisposed(),r.gather(this,t,o)},e.prototype.matMul=function(t,o,e){return void 0===o&&(o=!1),void 0===e&&(e=!1),this.throwIfDisposed(),r.matMul(this,t,o,e)},e.prototype.dot=function(t){return this.throwIfDisposed(),r.dot(this,t)},e.prototype.norm=function(t,o,e){return void 0===t&&(t="euclidean"),void 0===o&&(o=null),void 0===e&&(e=!1),this.throwIfDisposed(),r.norm(this,t,o,e)},e.prototype.slice=function(t,o){return this.throwIfDisposed(),r.slice(this,t,o)},e.prototype.reverse=function(t){return this.throwIfDisposed(),r.reverse(this,t)},e.prototype.concat=function(t,o){return void 0===o&&(o=0),this.throwIfDisposed(),r.concat([this,t],o)},e.prototype.stack=function(t,o){return void 0===o&&(o=0),r.stack([this,t],o)},e.prototype.unstack=function(t,o){return void 0===o&&(o=0),r.unstack(this,o)},e.prototype.pad=function(t,o){return void 0===o&&(o=0),r.pad(this,t,o)},e.prototype.batchNormalization=function(t,o,e,s,i){return void 0===e&&(e=.001),this.throwIfDisposed(),r.batchNormalization(this,t,o,e,s,i)},e.prototype.logSumExp=function(t,o){return void 0===t&&(t=null),void 0===o&&(o=!1),this.throwIfDisposed(),r.logSumExp(this,t,o)},e.prototype.sum=function(t,o){return void 0===t&&(t=null),void 0===o&&(o=!1),this.throwIfDisposed(),r.sum(this,t,o)},e.prototype.mean=function(t,o){return void 0===t&&(t=null),void 0===o&&(o=!1),this.throwIfDisposed(),r.mean(this,t,o)},e.prototype.min=function(t,o){return void 0===t&&(t=null),void 0===o&&(o=!1),this.throwIfDisposed(),r.min(this,t,o)},e.prototype.max=function(t,o){return void 0===t&&(t=null),void 0===o&&(o=!1),this.throwIfDisposed(),r.max(this,t,o)},e.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),r.argMin(this,t)},e.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),r.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),r.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),r.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),r.addStrict(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),r.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),r.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),r.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),r.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),r.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),r.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),r.div(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),r.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),r.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),r.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),r.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),r.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),r.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),r.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),r.modStrict(this,t)},e.prototype.squaredDifference=function(t){return this.throwIfDisposed(),r.squaredDifference(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),r.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),r.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),r.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),r.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),r.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),r.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),r.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),r.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),r.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),r.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),r.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),r.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),r.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),r.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),r.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),r.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),r.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),r.logicalXor(this,t)},e.prototype.where=function(t,o){return this.throwIfDisposed(),r.where(t,this,o)},e.prototype.neg=function(){return this.throwIfDisposed(),r.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),r.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),r.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),r.sign(this)},e.prototype.exp=function(){return this.throwIfDisposed(),r.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),r.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),r.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),r.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),r.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),r.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),r.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),r.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),r.abs(this)},e.prototype.clipByValue=function(t,o){return this.throwIfDisposed(),r.clipByValue(this,t,o)},e.prototype.relu=function(){return this.throwIfDisposed(),r.relu(this)},e.prototype.elu=function(){return this.throwIfDisposed(),r.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),r.selu(this)},e.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),r.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),r.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),r.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),r.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),r.softplus(this)},e.prototype.sin=function(){return this.throwIfDisposed(),r.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),r.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),r.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),r.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),r.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),r.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),r.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),r.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),r.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),r.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),r.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),r.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),r.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),r.round(this)},e.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),r.step(this,t)},e.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),r.softmax(this,t)},e.prototype.resizeBilinear=function(t,o){return void 0===o&&(o=!1),this.throwIfDisposed(),r.image.resizeBilinear(this,t,o)},e.prototype.resizeNearestNeighbor=function(t,o){return void 0===o&&(o=!1),this.throwIfDisposed(),r.image.resizeNearestNeighbor(this,t,o)},e.prototype.conv1d=function(t,o,e,s,i,n){return void 0===s&&(s="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),r.conv1d(this,t,o,e,s,i,n)},e.prototype.conv2d=function(t,o,e,s,i,n){return void 0===s&&(s="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),r.conv2d(this,t,o,e,s,i,n)},e.prototype.conv2dTranspose=function(t,o,e,s,i){return this.throwIfDisposed(),r.conv2dTranspose(this,t,o,e,s,i)},e.prototype.depthwiseConv2D=function(t,o,e,s,i,n){return void 0===s&&(s="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),r.depthwiseConv2d(this,t,o,e,s,i,n)},e.prototype.avgPool=function(t,o,e,s){return this.throwIfDisposed(),r.avgPool(this,t,o,e,s)},e.prototype.maxPool=function(t,o,e,s){return this.throwIfDisposed(),r.maxPool(this,t,o,e,s)},e.prototype.localResponseNormalization=function(t,o,e,s){return void 0===t&&(t=5),void 0===o&&(o=1),void 0===e&&(e=1),void 0===s&&(s=.5),r.localResponseNormalization(this,t,o,e,s)},e.prototype.variable=function(t,o,e){return void 0===t&&(t=!0),this.throwIfDisposed(),y.variable(this,t,o,e)},e.prototype.unsortedSegmentSum=function(t,o,e){return void 0===e&&(e=0),this.throwIfDisposed(),r.unsortedSegmentSum(this,t,o,e)},e.nextId=0,a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"flatten",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"asScalar",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"as1D",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"as2D",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"as3D",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"as4D",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"asType",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"buffer",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"data",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"dataSync",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"dispose",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"toFloat",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"toInt",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"toBool",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"print",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"reshape",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"reshapeAs",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"expandDims",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"cumsum",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"squeeze",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"clone",null),a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e.prototype,"toString",null),e=s=a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],e);var s}();exports.Tensor=l;var y=function(e){function r(t,r,i){void 0===r&&(r=!0);var n=e.call(this,t.shape,t.dtype,null,t.dataId)||this;return n.trainable=r,n.name=i,null==n.name&&(n.name=s.nextVarId.toString(),s.nextVarId++),o.ENV.engine.registerVariable(n),n}return u(r,e),s=r,r.variable=function(t,o,e,r){return void 0===o&&(o=!0),null!=r&&r!==t.dtype&&(t=t.asType(r)),new s(t,o,e)},r.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!h.arraysEqual(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");o.ENV.engine.disposeTensor(this),this.dataId=t.dataId,o.ENV.engine.registerTensor(this)},r.nextVarId=0,a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],r.prototype,"assign",null),a([(0,t.doc)({heading:"Tensors",subheading:"Creation"})],r,"variable",null),r=s=a([(0,t.doc)({heading:"Tensors",subheading:"Classes"})],r);var s}(l);exports.Variable=y;var g=y.variable;function w(t){var o=t.length;if(o<2)return[];var e=new Array(o-1);e[o-2]=t[o-1];for(var r=o-3;r>=0;--r)e[r]=e[r+1]*t[r+1];return e}exports.variable=g;
},{"./doc":105,"./environment":95,"./ops/ops":119,"./tensor_util":210,"./util":98}],280:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Gradients=void 0;var e=require("./doc"),n=require("./environment"),a=require("./globals"),r=require("./tensor"),s=require("./util"),t=i(s);function i(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n.default=e,n}var u=function(e,n,a,r){var s,t=arguments.length,i=t<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var u=e.length-1;u>=0;u--)(s=e[u])&&(i=(t<3?s(i):t>3?s(n,a,i):s(n,a))||i);return t>3&&i&&Object.defineProperty(n,a,i),i},d=function(){function s(){}return s.gradScope=function(e,n){return(0,a.tidy)(e,n,!0)},s.grad=function(e){return t.assert(t.isFunction(e),"The f passed in grad(f) must be a function"),function(s,i){return t.assert(s instanceof r.Tensor,"The x passed in grad(f)(x) must be a tensor"),t.assert(null==i||i instanceof r.Tensor,"The dy passed in grad(f)(x, dy) must be a tensor"),(0,a.tidy)(function(){var a=n.ENV.engine.gradients(function(){return e(s)},[s],i),r=a.value,u=a.grads;return null!=i&&t.assertShapesMatch(r.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),o(u),u[0]})}},s.grads=function(e){return t.assert(t.isFunction(e),"The f passed in grads(f) must be a function"),function(s,i){return t.assert(Array.isArray(s)&&s.every(function(e){return e instanceof r.Tensor}),"The args passed in grads(f)(args) must be an array of tensors"),t.assert(null==i||i instanceof r.Tensor,"The dy passed in grads(f)(args, dy) must be a tensor"),(0,a.tidy)(function(){var a=n.ENV.engine.gradients(function(){return e.apply(void 0,s)},s,i),r=a.value,u=a.grads;return null!=i&&t.assertShapesMatch(r.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),o(u),u})}},s.valueAndGrad=function(e){return t.assert(t.isFunction(e),"The f passed in valueAndGrad(f) must be a function"),function(a,s){t.assert(a instanceof r.Tensor,"The x passed in valueAndGrad(f)(x) must be a tensor"),t.assert(null==s||s instanceof r.Tensor,"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");var i=n.ENV.engine.gradients(function(){return e(a)},[a],s),u=i.grads,d=i.value;return o(u),{grad:u[0],value:d}}},s.valueAndGrads=function(e){return t.assert(t.isFunction(e),"The f passed in valueAndGrads(f) must be a function"),function(a,s){t.assert(Array.isArray(a)&&a.every(function(e){return e instanceof r.Tensor}),"The args passed in valueAndGrads(f)(args) must be array of tensors"),t.assert(null==s||s instanceof r.Tensor,"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");var i=n.ENV.engine.gradients(function(){return e.apply(void 0,a)},a,s);return null!=s&&t.assertShapesMatch(i.value.shape,s.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),o(i.grads),i}},s.variableGrads=function(e,a){if(t.assert(t.isFunction(e),"The f passed in variableGrads(f) must be a function"),t.assert(null==a||Array.isArray(a)&&a.every(function(e){return e instanceof r.Variable}),"The varList passed in variableGrads(f, varList) must be an array of variables"),null==a)for(var s in a=[],n.ENV.engine.registeredVariables)a.push(n.ENV.engine.registeredVariables[s]);var i=a.length;a=a.filter(function(e){return e.trainable}),t.assert(a.length>0,"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable.");var u=n.ENV.engine.gradients(e,a,null,!0),d=u.value,o=u.grads;t.assert(o.some(function(e){return null!=e}),"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),t.assert(0===d.rank,"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+d.rank+" tensor");var f={};return a.forEach(function(e,n){null!=o[n]&&(f[e.name]=o[n])}),{value:d,grads:f}},s.customGrad=function(e){return n.ENV.engine.customGrad(e)},u([(0,e.doc)({heading:"Training",subheading:"Gradients"})],s,"grad",null),u([(0,e.doc)({heading:"Training",subheading:"Gradients"})],s,"grads",null),u([(0,e.doc)({heading:"Training",subheading:"Gradients"})],s,"valueAndGrad",null),u([(0,e.doc)({heading:"Training",subheading:"Gradients"})],s,"valueAndGrads",null),u([(0,e.doc)({heading:"Training",subheading:"Gradients"})],s,"variableGrads",null),u([(0,e.doc)({heading:"Training",subheading:"Gradients"})],s,"customGrad",null),s}();function o(e){if(e.filter(function(e){return null==e}).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}exports.Gradients=d;
},{"./doc":105,"./environment":95,"./globals":104,"./tensor":101,"./util":98}],104:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.customGrad=exports.variableGrads=exports.valueAndGrads=exports.grads=exports.valueAndGrad=exports.grad=exports.time=exports.dispose=exports.keep=exports.tidy=void 0;var r=require("./gradients"),e=require("./tracking"),s=exports.tidy=e.Tracking.tidy,a=exports.keep=e.Tracking.keep,t=exports.dispose=e.Tracking.dispose,d=exports.time=e.Tracking.time,o=exports.grad=r.Gradients.grad,i=exports.valueAndGrad=r.Gradients.valueAndGrad,p=exports.grads=r.Gradients.grads,x=exports.valueAndGrads=r.Gradients.valueAndGrads,n=exports.variableGrads=r.Gradients.variableGrads,G=exports.customGrad=r.Gradients.customGrad;
},{"./gradients":280,"./tracking":281}],249:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.Profiler=void 0;var e=require("./util"),r=o(e);function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r.default=e,r}var t=function(){function e(e,r){this.backendTimer=e,this.logger=r,null==r&&(this.logger=new n)}return e.prototype.profileKernel=function(e,o){var t,n=this,i=this.backendTimer.time(function(){t=o()}),l=t.dataSync();return r.checkForNaN(l,t.dtype,e),i.then(function(r){n.logger.logKernelProfile(e,t,l,r.kernelMs)}),t},e}();exports.Profiler=t;var n=function(){function e(){}return e.prototype.logKernelProfile=function(e,o,t,n){var i=r.rightPad(n+"ms",9),l=r.rightPad(e,25),c=o.rank,u=o.size,a=r.rightPad(o.shape.toString(),14);console.log("%c"+l+"\t%c"+i+"\t%c"+c+"D "+a+"\t%c"+u,"font-weight:bold","color:red","color:blue","color: orange")},e}();exports.Logger=n;
},{"./util":98}],250:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFilteredNodesXToY=i,exports.backpropagateGradients=n;var r=require("./util"),t=e(r);function e(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}function i(r,t,e){for(var i={},n={},a=0;a<t.length;a++)i[t[a].id]=!0;for(a=0;a<r.length;a++){var o=(g=r[a]).inputs;for(var u in o){for(var p=o[u],d=!1,s=0;s<t.length;s++)if(i[p.id]){i[g.output.id]=!0,d=!0,n[g.id]=!0;break}if(d)break}}var f={};f[e.id]=!0;var h={};for(a=r.length-1;a>=0;a--){o=(g=r[a]).inputs;var l=[];l.push(g.output);for(s=0;s<l.length;s++)if(f[l[s].id]){for(var u in o)f[o[u].id]=!0,h[g.id]=!0;break}}var v=[];for(a=0;a<r.length;a++){var g;if(n[(g=r[a]).id]&&h[g.id]){var c={};for(var u in g.inputs){var b=g.inputs[u];i[b.id]&&(c[u]=b)}var w=Object.assign({},g);w.inputs=c,w.output=g.output,v.push(w)}}return v}function n(r,e){for(var i=e.length-1;i>=0;i--){var n=e[i],a=r[n.output.id];if(null==n.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+n.name+".");var o=n.gradient(a);for(var u in n.inputs){if(!(u in o))throw new Error("Cannot backprop through input "+u+". Available gradients found: "+Object.keys(o)+".");var p=o[u](),d=n.inputs[u];if(!t.arraysEqual(p.shape,d.shape))throw new Error("Error in gradient for op "+n.name+". The gradient of input '"+u+"' has shape '"+p.shape+"', which does not match the shape of the input '"+d.shape+"'");if(null==r[d.id])r[d.id]=p;else{var s=r[d.id];r[d.id]=s.add(p),s.dispose()}}}}
},{"./util":98}],205:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Engine=void 0;var e=require("./environment"),t=require("./globals"),r=require("./ops/ops"),n=c(r),s=require("./profiler"),i=require("./tape"),o=require("./tensor"),a=require("./util"),u=c(a);function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var h=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(o,a)}u((n=n.apply(e,t||[])).next())})},p=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},d=function(){function r(e,t){this.backend=e,this.safeMode=t,this.registeredVariables={},this.refCounter=new WeakMap,this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numDataBuffers=0,this.gradientScopeCount=0,this.customGradientDepth=0,this.keepTensors=new Set,this.activeScope={track:[]},this.scopeStack=[this.activeScope],this.profiler=new s.Profiler(e)}return r.prototype.runKernel=function(t,r,n){var s,i=this,o=[],a=function(e){return o.push(e),e},u=this.activeScope.name;if(this.customGradientDepth++,s=e.ENV.get("DEBUG")?this.profiler.profileKernel(u,function(){return t(i.backend,a)}):t(this.backend,a),this.customGradientDepth--,this.shouldRecord()){var c={id:this.nextTapeNodeId++,name:u,inputs:r,output:s};null!=n&&(c.gradient=function(e){return n(e,o)}),this.activeTape.push(c)}return s},r.prototype.registerTensor=function(e){var t=this.refCounter.has(e.dataId)?this.refCounter.get(e.dataId):0;this.numTensors++,0===t&&(this.numDataBuffers++,this.numBytes+=u.sizeFromShape(e.shape)*u.bytesPerElement(e.dtype),this.backend.register(e.dataId,e.shape,e.dtype)),this.refCounter.set(e.dataId,t+1),e instanceof o.Variable||this.track(e)},r.prototype.registerVariable=function(e){if(null!=this.registeredVariables[e.name])throw new Error("Variable with name "+e.name+" was already registered");this.registeredVariables[e.name]=e},r.prototype.disposeTensor=function(e){if(this.refCounter.has(e.dataId)){this.numTensors--;var t=this.refCounter.get(e.dataId);t<=1?(this.refCounter.delete(e.dataId),this.backend.disposeData(e.dataId),this.numDataBuffers--,this.numBytes-=u.sizeFromShape(e.shape)*u.bytesPerElement(e.dtype)):this.refCounter.set(e.dataId,t-1)}},r.prototype.disposeVariables=function(){for(var e in this.registeredVariables){var t=this.registeredVariables[e];this.disposeTensor(t),delete this.registeredVariables[e]}},r.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.numTensors,e.numDataBuffers=this.numDataBuffers,e.numBytes=this.numBytes,e},r.prototype.shouldRecord=function(){return null!=this.activeTape&&0===this.customGradientDepth},r.prototype.addTapeNode=function(e,t,r){var n={};e.forEach(function(e,t){n[t]=e});var s={id:this.nextTapeNodeId++,name:this.activeScope.name,inputs:n,output:t,gradient:function(e){var t=r(e),n={};return t.forEach(function(e,t){n[t]=function(){return e}}),n}};this.activeTape.push(s)},r.prototype.keep=function(t){if(1===this.scopeStack.length&&e.ENV.engine.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {...}) to avoid memory leaks.");return this.keepTensors.add(t.id),t},r.prototype.startScope=function(e,t){void 0===t&&(t=!1),t&&0===this.gradientScopeCount&&(this.activeTape=[]),t&&this.gradientScopeCount++;var r={track:[]};e&&(r.name=e),this.scopeStack.push(r),this.activeScope=r},r.prototype.endScope=function(e,t){var r=this;void 0===t&&(t=!1),t&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null));var n=new Set(this.keepTensors),s=u.getTensorsInContainer(e);s.forEach(function(e){return n.add(e.id)});for(var i=0;i<this.activeScope.track.length;i++){var o=this.activeScope.track[i];n.has(o.id)||(null!=this.activeTape?s.push(o):o.dispose())}var a=this.scopeStack.pop();this.activeScope=0===this.scopeStack.length?{track:[]}:this.scopeStack[this.scopeStack.length-1],s.forEach(function(e){!r.keepTensors.has(e.id)&&u.isTensorInList(e,a.track)&&r.track(e)})},r.prototype.gradients=function(e,r,s,a){var c=this;return void 0===a&&(a=!1),u.assert(r.length>0,"gradients() received an empty list of xs."),(0,t.tidy)("gradients",function(){var t=e();u.assert(t instanceof o.Tensor,"The result y returned by f() must be a tensor.");var h=(0,i.getFilteredNodesXToY)(c.activeTape,r,t);if(!a&&0===h.length&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");var p={};return p[t.id]=null==s?n.ones(t.shape):s,(0,i.backpropagateGradients)(p,h),{value:t,grads:r.map(function(e){return p[e.id]})}},!0)},r.prototype.customGrad=function(e){var r=this;return u.assert(u.isFunction(e),"The f passed in customGrad(f) must be a function."),function(){for(var n,s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];u.assert(s.every(function(e){return e instanceof o.Tensor}),"The args passed in customGrad(f)(x1, x2,...) must all be tensors"),r.customGradientDepth++;var a=(0,t.tidy)(e.name,function(){var t=e.apply(void 0,s),r=t.value,i=t.gradFunc;return u.assert(r instanceof o.Tensor,"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),u.assert(u.isFunction(i),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n=i,r},!0);if(r.customGradientDepth--,r.shouldRecord()){r.addTapeNode(s,a,function(e){var t=n(e),r=Array.isArray(t)?t:[t];return u.assert(r.length===s.length,"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),u.assert(r.every(function(e){return e instanceof o.Tensor}),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."),r})}return a}},r.prototype.write=function(e,t){this.backend.write(e,t)},r.prototype.readSync=function(e){return this.backend.readSync(e)},r.prototype.read=function(e){return this.backend.read(e)},r.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},r.prototype.time=function(e){return h(this,void 0,void 0,function(){var t,r;return p(this,function(n){switch(n.label){case 0:return t=performance.now(),[4,this.backend.time(e)];case 1:return(r=n.sent()).wallMs=performance.now()-t,[2,r]}})})},r.prototype.track=function(e){if(1===this.scopeStack.length&&this.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {op();...}); to avoid memory leaks.");return this.activeScope.track.push(e),e},r}();exports.Engine=d;
},{"./environment":95,"./globals":104,"./ops/ops":119,"./profiler":249,"./tape":250,"./tensor":101,"./util":98}],206:[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],95:[function(require,module,exports) {
var process = require("process");
var global = arguments[3];
var e=require("process"),t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.ENV=exports.Environment=exports.URL_PROPERTIES=exports.Type=void 0;var n=require("./device_util"),r=E(n),i=require("./doc"),o=require("./engine"),a=require("./util"),u=E(a);function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var s=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},f=exports.Type=void 0;!function(e){e[e.NUMBER=0]="NUMBER",e[e.BOOLEAN=1]="BOOLEAN",e[e.STRING=2]="STRING"}(f||(exports.Type=f={}));var c=exports.URL_PROPERTIES=[{name:"DEBUG",type:f.BOOLEAN},{name:"IS_BROWSER",type:f.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",type:f.NUMBER},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:f.BOOLEAN},{name:"WEBGL_VERSION",type:f.NUMBER},{name:"WEBGL_FLOAT_TEXTURE_ENABLED",type:f.BOOLEAN},{name:"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED",type:f.BOOLEAN},{name:"BACKEND",type:f.STRING}];function l(e,t){return null!=e.getExtension(t)}function d(e){if(0===e||!m.get("IS_BROWSER"))throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=document.createElement("canvas");return 1===e?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}function _(e){if(null!=e){var t=e.getExtension("WEBGL_lose_context");if(null==t)throw new Error("Extension WEBGL_lose_context not supported on this browser.");t.loseContext()}}function p(e){var t=d(e);return null!=t&&(_(t),!0)}function g(e){if(0===e)return 0;var t,n=d(e);return t=l(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:l(n,"EXT_disjoint_timer_query")?1:0,null!=n&&_(n),t}function B(e){if(0===e)return!1;var t=d(e);if(1===e){if(!l(t,"OES_texture_float"))return!1}else if(!l(t,"EXT_color_buffer_float"))return!1;var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);var i=2===e?t.RGBA32F:t.RGBA;t.texImage2D(t.TEXTURE_2D,0,i,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;t.readPixels(0,0,1,1,t.RGBA,t.FLOAT,new Float32Array(4));var a=t.getError()===t.NO_ERROR;return _(t),o&&a}function y(e){if(e>0)return!1;if(2!==e)return!1;var t=d(e),n=l(t,"WEBGL_get_buffer_sub_data_async");return _(t),n}var R=function(){function t(e){this.features={},this.registry={},null!=e&&(this.features=e),this.get("DEBUG")&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}return t.setBackend=function(e,t){if(void 0===t&&(t=!1),!(e in m.registry))throw new Error("Backend type '"+e+"' not found in registry");m.initBackend(e,t)},t.getBackend=function(){return m.initDefaultBackend(),m.currentBackend},t.disposeVariables=function(){m.engine.disposeVariables()},t.memory=function(){return m.engine.memory()},t.prototype.get=function(e){return e in this.features?this.features[e]:(this.features[e]=this.evaluateFeature(e),this.features[e])},t.prototype.set=function(e,t){this.features[e]=t},t.prototype.getBestBackendType=function(){var e=this;if(0===Object.keys(this.registry).length)throw new Error("No backend found in registry.");return Object.keys(this.registry).map(function(t){return{name:t,entry:e.registry[t]}}).sort(function(e,t){return t.entry.priority-e.entry.priority})[0].name},t.prototype.evaluateFeature=function(t){if("DEBUG"===t)return!1;if("IS_BROWSER"===t)return"undefined"!=typeof window;if("IS_NODE"===t)return void 0!==e&&void 0!==e.versions.node;if("BACKEND"===t)return this.getBestBackendType();if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"===t){var n=this.get("WEBGL_VERSION");return 0===n?0:g(n)}if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"===t)return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!r.isMobile();if("WEBGL_VERSION"===t)return p(2)?2:p(1)?1:0;if("WEBGL_FLOAT_TEXTURE_ENABLED"===t)return B(this.get("WEBGL_VERSION"));if("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED"===t)return y(this.get("WEBGL_VERSION"));throw new Error("Unknown feature "+t+".")},t.prototype.setFeatures=function(e){this.features=e},t.prototype.reset=function(){this.features=O(),null!=this.globalEngine&&(this.globalEngine=null)},t.prototype.initBackend=function(e,t){void 0===t&&(t=!1),this.currentBackend=e;var n=m.findBackend(e);this.globalEngine=new o.Engine(n,t)},t.prototype.findBackend=function(e){return e in this.registry?this.registry[e].backend:null},t.prototype.registerBackend=function(e,t,n){void 0===n&&(n=1),e in this.registry&&console.warn(e+" backend was already registered");try{var r=t();return this.registry[e]={backend:r,priority:n},!0}catch(t){return console.warn("Registration of backend "+e+" failed"),console.warn(t.stack||t.message),!1}},t.prototype.removeBackend=function(e){if(!(e in this.registry))throw new Error(e+" backend not found in registry");this.registry[e].backend.dispose(),delete this.registry[e]},Object.defineProperty(t.prototype,"engine",{get:function(){return this.initDefaultBackend(),this.globalEngine},enumerable:!0,configurable:!0}),t.prototype.initDefaultBackend=function(){null==this.globalEngine&&this.initBackend(m.get("BACKEND"),!1)},s([(0,i.doc)({heading:"Environment"})],t,"setBackend",null),s([(0,i.doc)({heading:"Environment"})],t,"getBackend",null),s([(0,i.doc)({heading:"Environment"})],t,"disposeVariables",null),s([(0,i.doc)({heading:"Performance",subheading:"Memory"})],t,"memory",null),t}();exports.Environment=R;var N="tfjsflags";function O(){var e={};if("undefined"==typeof window||void 0===window.location)return e;var t=u.getQueryParams(window.location.search);if(N in t){var n={};t[N].split(",").forEach(function(e){var t=e.split(":"),r=t[0],i=t[1];n[r]=i}),c.forEach(function(t){t.name in n&&(console.log("Setting feature override from URL "+t.name+": "+n[t.name]),t.type===f.NUMBER?e[t.name]=+n[t.name]:t.type===f.BOOLEAN?e[t.name]="true"===n[t.name]:t.type===f.STRING?e[t.name]=n[t.name]:console.warn("Unknown URL param: "+t.name+"."))})}return e}function h(){var e;if("undefined"!=typeof window)e=window;else{if(void 0===t)throw new Error("Could not find a global object");e=t}return e}function T(){var e=h();return e.ENV=e.ENV||new R(O()),e.ENV}var m=exports.ENV=T();
},{"./device_util":204,"./doc":105,"./engine":205,"./util":98,"process":206}],313:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeOptimalWindowSize=t;var r=exports.PARALLELIZE_THRESHOLD=30;function t(t){return t<=r?t:e(t,Math.floor(Math.sqrt(t)))}function e(r,t){for(var e=t;e<r;++e)if(r%e==0)return e;return r}
},{}],315:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.castTensor=t,exports.reshapeTensor=a;var r=require(".."),e=require("../ops/array_ops");function t(t,a,n){if(!r.util.hasEncodingLoss(t.dtype,a))return r.Tensor.make(t.shape,{dataId:t.dataId},a);if("int32"===a)return n.int(t);if("bool"===a)return n.notEqual(t,e.ArrayOps.scalar(0,t.dtype));throw new Error("Error in Cast: unknown dtype argument ("+a+")")}function a(e,t){return r.Tensor.make(t,{dataId:e.dataId},e.dtype)}
},{"..":49,"../ops/array_ops":295}],316:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return function(t,n,e){this.variableNames=["A"];var i=t.windowSize,a=t.batchSize,s=t.inSize,d=Math.ceil(s/i);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,d];var o="max"===n?">":"<",r=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+i+";\n\n        int bestIndex = 0;\n        float bestValue = getA(batch, inOffset);\n\n        for (int i = 0; i < "+i+"; i++) {\n          int inIdx = "+r+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+o+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}}();exports.ArgMinMaxProgram=t;
},{}],317:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterHeight,o=n.filterWidth,d=n.strideHeight,e=n.strideWidth,i=t-1-n.padInfo.top,r=o-1-n.padInfo.left,a=1/(t*o);this.userCode="\n      const ivec2 pads = ivec2("+i+", "+r+");\n      const float avgMultiplier = float("+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+d+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+o+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.AvgPool2DBackpropProgram=n;
},{}],318:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BatchNormProgram=void 0;var t=require("../../ops/broadcast_util"),a=e(t);function e(t){if(t&&t.__esModule)return t;var a={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(a[e]=t[e]);return a.default=t,a}var r=function(){return function(t,e,r,s,o,n){this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=["x","mean","variance"],a.assertAndGetBroadcastShape(t,e),a.assertAndGetBroadcastShape(t,r);var i="0.0";null!=s&&(a.assertAndGetBroadcastShape(t,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");var u="1.0";null!=o&&(a.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+i+";\n        float scale = "+u+";\n        float inv = scale * inversesqrt(variance + float("+n+"));\n        setOutput((x - mean) * inv + offset);\n      }\n    "}}();exports.BatchNormProgram=r;
},{"../../ops/broadcast_util":354}],319:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BinaryOpProgram=exports.ELU_DER=exports.ATAN2=exports.MOD=exports.MIN=exports.MAX=exports.LOGICAL_OR=exports.LOGICAL_AND=exports.GREATER_EQUAL=exports.GREATER=exports.LESS_EQUAL=exports.LESS=exports.NOT_EQUAL=exports.EQUAL=exports.SQUARED_DIFFERENCE=exports.POW=exports.INT_DIV=exports.DIV=exports.MUL=exports.SUB=exports.ADD=void 0;var r=require("../../ops/broadcast_util"),t=e(r);function e(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}var o="\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n",n=exports.ADD="return a + b;",a=exports.SUB="return a - b;",s=exports.MUL="return a * b;",p=exports.DIV="return a / b;",u=exports.INT_DIV="\n  float resultSign = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  int result = ia / ib;\n  int amodb = ia - ib * result;\n\n  if (resultSign < 0.0 && amodb != 0) {\n    result -= 1;\n  }\n  return float(result);\n",i=exports.POW="\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",b=exports.SQUARED_DIFFERENCE="return (a - b) * (a - b);",x=exports.EQUAL="return float(a == b);",A=exports.NOT_EQUAL="return float(a != b);",E=exports.LESS="return float(a < b);",l=exports.LESS_EQUAL="return float(a <= b);",f=exports.GREATER="return float(a > b);",L=exports.GREATER_EQUAL="return float(a >= b);",d=exports.LOGICAL_AND="return float(a >= 1.0 && b >= 1.0);",O=exports.LOGICAL_OR="return float(a >= 1.0 || b >= 1.0);",_=exports.MAX=o+"\n  return max(a, b);\n",D=exports.MIN=o+"\n  return min(a, b);\n",N=exports.MOD="return mod(a, b);",R=exports.ATAN2=o+"\n  return atan(a, b);\n",S=exports.ELU_DER="return (b >= 1.0) ? a : a * (b + 1.0);",U=function(){return function(r,e,o){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.outputShape=t.assertAndGetBroadcastShape(e,o),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+r+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}}();exports.BinaryOpProgram=U;
},{"../../ops/broadcast_util":354}],320:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return function(t,e,u){this.variableNames=["A"],this.outputShape=t;var n=e.toFixed(20),a=u.toFixed(20);this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, "+n+", "+a+"));\n      }\n    "}}();exports.ClipProgram=t;
},{}],321:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConcatProgram=void 0;var t=require("../../ops/concat_util"),e=n(t);function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var o=function(){return function(t,n){this.variableNames=["A","B"],this.outputShape=[],this.outputShape=e.computeOutShape(t,n,1),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        float value = 0.0;\n        if (yC < "+t[1]+") {\n          value = getA(yR, yC);\n        } else {\n          yC -= "+t[1]+";\n          value = getB(yR, yC);\n        }\n\n        setOutput(value);\n      }\n    "}}();exports.ConcatProgram=o;
},{"../../ops/concat_util":355}],322:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,o=n.strideWidth,d=n.padInfo.top,e=n.padInfo.left;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+n.batchSize+"; b++) {\n          for (int yR = 0; yR < "+n.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+d+";\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+n.outWidth+"; yC++) {\n              int xC = wC + yC * "+o+" - "+e+";\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.Conv2DDerFilterProgram=n;var t=function(){return function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,o=n.filterWidth,d=n.strideHeight,e=n.strideWidth,i=t-1-n.padInfo.top,r=o-1-n.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+r+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+d+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+o+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+o+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+n.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.Conv2DDerInputProgram=t;
},{}],323:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,o=n.padInfo.top,i=n.padInfo.left,d=n.outChannels/n.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+d+" + dm;\n\n        float dotProd = 0.0;\n\n        // TODO: Vec4 over the batch size\n        for (int b = 0; b < "+n.batchSize+"; b++) {\n          for (int yR = 0; yR < "+n.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+o+";\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+n.outWidth+"; yC++) {\n              int xC = wC + yC * "+e+" - "+i+";\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.DepthwiseConv2DDerFilterProgram=n;var t=function(){return function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,o=n.strideHeight,i=n.strideWidth,d=t-1-n.padInfo.top,r=e-1-n.padInfo.left,a=n.outChannels/n.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+d+", "+r+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+o+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+e+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+e+" - 1 - wC;\n\n            // TODO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+a+"; dm++) {\n              int d2 = d1 * "+a+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.DepthwiseConv2DDerInputProgram=t;
},{}],326:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var e=n.padInfo.top,t=n.padInfo.left,d=n.strideHeight,o=n.strideWidth,i=n.dilationHeight,r=n.dilationWidth,a=n.filterHeight,s=n.filterWidth,C=4*Math.floor(n.inChannels/4),x=n.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+d+", "+o+");\n      const ivec2 pads = ivec2("+e+", "+t+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+"; wR++) {\n          int xR = xRCorner + wR * "+i+";\n\n          if (xR < 0 || xR >= "+n.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+s+"; wC++) {\n            int xC = xCCorner + wC * "+r+";\n\n            if (xC < 0 || xC >= "+n.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+C+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===x)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+C+") *\n                getW(wR, wC, "+C+", d2);\n            } else if ("+(2===x)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+C+"),\n                getX(batch, xR, xC, "+C+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+C+", d2),\n                getW(wR, wC, "+C+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===x)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+C+"),\n                getX(batch, xR, xC, "+C+" + 1),\n                getX(batch, xR, xC, "+C+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+C+", d2),\n                getW(wR, wC, "+C+" + 1, d2),\n                getW(wR, wC, "+C+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.Conv2DProgram=n;
},{}],325:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var t=n.inHeight,e=n.inWidth,o=n.padInfo.top,i=n.padInfo.left,r=n.strideHeight,d=n.strideWidth,s=n.dilationHeight,a=n.dilationWidth,C=n.filterHeight,l=n.filterWidth,x=n.outChannels/n.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+d+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+x+";\n        int q = d2 - d1 * "+x+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+C+"; wR++) {\n          int xR = xRCorner + wR * "+s+";\n\n          if (xR < 0 || xR >= "+t+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+l+"; wC++) {\n            int xC = xCCorner + wC * "+a+";\n\n            if (xC < 0 || xC >= "+e+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.DepthwiseConv2DProgram=n;
},{}],251:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUnpackedMatrixTextureShapeWidthHeight=e,exports.getUnpackedArraySizeFromMatrixSize=t,exports.getColorMatrixTextureShapeWidthHeight=n,exports.getMatrixSizeFromUnpackedArraySize=o,exports.encodeMatrixToUnpackedArray=a,exports.encodeFloatArray=g,exports.decodeToFloatArray=p,exports.decodeMatrixFromUnpackedArray=x,exports.decodeMatrixFromUnpackedColorRGBAArray=d,exports.getPackedMatrixTextureShapeWidthHeight=s,exports.getPackedRGBAArraySizeFromMatrixShape=v,exports.encodeMatrixToPackedRGBA=A,exports.decodeMatrixFromPackedRGBA=M;var r=exports.TextureType=void 0;function e(r,e){return[e,r]}function t(r,e){return r*e}function n(r,e){return[4*e,r]}function o(r,e){if(r%e!=0)throw new Error("unpackedSize ("+r+") must be a multiple of "+e);return r/e}function a(r,e,n){var o=t(r.length,n);if(e.length<o)throw new Error("unpackedArray length ("+e.length+") must be >= "+o);for(var a=0,i=0;i<r.length;++i)e[a]=r[i],a+=n}!function(r){r[r.FLOAT=0]="FLOAT",r[r.UNSIGNED_BYTE=1]="UNSIGNED_BYTE"}(r||(exports.TextureType=r={}));var i=exports.FLOAT_MAX=2e4,f=exports.FLOAT_MIN=-i,h=(i-f)/255,u=[1,1/255,1/65025,1/16581375],c=[1,255,65025],l=exports.BYTE_NAN_VALUE=0;function g(r){for(var e=new Uint8Array(4*r.length),t=function(t){var n=r[t/4];if(isNaN(n))return e[t]=l,e[t+1]=l,e[t+2]=l,e[t+3]=l,"continue";var o=(n-f)/h,a=c.map(function(r){return r*o}).map(function(r){return Math.floor(r%1*255)});e[t]=Math.floor(o),e[t+1]=a[0],e[t+2]=a[1],e[t+3]=a[2]},n=0;n<e.length;n+=4)t(n);return e}function p(r){for(var e=new Float32Array(r.length/4),t=function(t){if(r[t]===l&&r[t+1]===l&&r[t+2]===l&&r[t+3]===l)return e[t/4]=NaN,"continue";var n=0;u.forEach(function(e,o){n+=e*r[t+o]});var o=n*h+f;e[t/4]=o},n=0;n<r.length;n+=4)t(n);return e}function x(r,e,t){var n=o(r.length,t);if(e.length<n)throw new Error("matrix length ("+e.length+") must be >= "+n);for(var a=0,i=0;i<r.length;i+=t)e[a++]=r[i]}function d(r,e,t){var n=r.length*t/4;if(e.length<n)throw new Error("matrix length ("+e.length+") must be >= "+n);for(var o=0,a=0;a<r.length;a+=4)for(var i=0;i<t;i++)e[o++]=r[a+i]}function s(r,e){return[Math.ceil(e/2),Math.ceil(r/2)]}function v(r,e){var t=s(r,e);return t[0]*t[1]*4}function A(r,e,t,n){var o=v(e,t);if(n.length<o)throw new Error("packedRGBA length ("+n.length+") must be >= "+o);for(var a=s(e,t),i=a[0],f=a[1],h=t%2==1,u=e%2==1,c=Math.floor(t/2),l=Math.floor(e/2),g=h?4:0,p=t,x=0,d=0;d<l;++d){for(var A=2*d*t,M=0;M<c;++M){var m=A+2*M;n[x]=r[m],n[x+1]=r[m+1],n[x+2]=r[m+p],n[x+3]=r[m+p+1],x+=4}x+=g}if(h){m=t-1,x=4*(i-1);var T=2*t;for(g=4*i,d=0;d<l;++d)n[x]=r[m],n[x+2]=r[m+t],m+=T,x+=g}if(u)for(m=(e-1)*t,x=(f-1)*i*4,M=0;M<c;++M)n[x++]=r[m++],n[x++]=r[m++],x+=2;return h&&u&&(n[n.length-4]=r[r.length-1]),n}function M(r,e,t,n){var o=e*t;if(o<n.length)throw new Error("matrix length ("+n.length+") must be >= "+o);for(var a=t%2==1,i=e%2==1,f=Math.floor(t/2),h=Math.floor(e/2),u=s(e,t),c=u[0],l=u[1],g=a?4:0,p=t+(a?1:0),x=0,d=0,v=t,A=0;A<h;++A){for(var M=0;M<f;++M)n[d++]=r[x++],n[d++]=r[x++],n[v++]=r[x++],n[v++]=r[x++];x+=g,d+=p,v+=p}if(a){x=4*(c-1);var m=t-1;for(g=4*c,p=2*t,A=0;A<h;++A)n[m]=r[x],n[m+t]=r[x+2],x+=g,m+=p}if(i)for(x=(l-1)*c*4,m=(e-1)*t,M=0;M<f;++M)n[m++]=r[x++],n[m++]=r[x++],x+=2;return a&&i&&(n[n.length-1]=r[r.length-4]),n}
},{}],384:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeShader=c,exports.getCoordsDataType=B;var n=require("../../environment"),e=require("../../util"),t=u(e),r=require("../../ops/broadcast_util"),i=u(r),o=require("./tex_util"),a=u(o);function u(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function c(n,e,t,r){var i=l(),o=s(),a=n.map(function(n){return"uniform sampler2D "+n.name+";"}).join("\n"),u=n.map(function(n){return d(n,e,r)}).join("\n"),c=e.texShape,x=p(e.logicalShape,c);return[N,i,o,a,x,u,t].join("\n")}function l(){return n.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?w:g}function s(){return n.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?T:R}function x(n){var e=n.shapeInfo.logicalShape;switch(e.length){case 0:return O(n);case 1:return A(n);case 2:return _(n);case 3:return I(n);case 4:return b(n);case 5:return q(n);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function d(n,e,r){var i=k(n);return i+=x(n),(r||t.arraysEqual(n.shapeInfo.logicalShape,e.logicalShape))&&(i+=F(n,e,r)),i}function p(n,e){switch(n.length){case 0:return V();case 1:return y(n,e);case 2:return E(n,e);case 3:return S(n,e);case 4:return U(n,e);case 5:return D(n,e);default:throw new Error(n.length+"-D output sampling is not yet supported")}}var v="\nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",h="\nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",f="\nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",m="\nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",C="\nvec2 UVfrom5D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int stride3, int row, int col, int depth,\n    int depth2, int depth3) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + \n              depth * stride2 + depth2 * stride3 + depth3;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",g="\n  uniform float NaN;\n\n  const vec4 floatDeltas = vec4(\n      1.0,\n      1.0 / 255.0,\n      1.0 / (255.0 * 255.0),\n      1.0 / (255.0 * 255.0 * 255.0)\n  );\n  const float minValue = "+a.FLOAT_MIN+".0;\n  const float maxValue = "+a.FLOAT_MAX+".0;\n  const float range = (maxValue - minValue) / 255.0;\n  const vec2 dotRange = vec2(1.0, range);\n\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    vec4 sampleValue = texture2D(textureSampler, uv);\n    if (all(equal(sampleValue, vec4("+a.BYTE_NAN_VALUE+")))) {\n      return NaN;\n    }\n\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\n    float decodedValue = dot(encValue, floatDeltas);\n    return dot(vec2(minValue, decodedValue), dotRange);\n  }\n",R="\n  const vec4 floatPowers = vec4(\n    1.0,\n    255.0,\n    255.0 * 255.0,\n    255.0 * 255.0 * 255.0\n  );\n  const vec2 recipRange = vec2(1.0/range);\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\n\n  void setOutput(float decodedValue) {\n    if (isNaN(decodedValue)) {\n      gl_FragColor = vec4("+a.BYTE_NAN_VALUE+");\n      return;\n    }\n\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\n    float b = fract(a) * 255.0;\n    float c = fract(b) * 255.0;\n    float d = fract(c) * 255.0;\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\n\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\n    // than the version below. Benchmark to determine if the accuracy is worth\n    // the cost.\n\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\n    // vec4 f = normValue * floatPowers;\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\n  }\n",w="\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    return texture2D(textureSampler, uv).r;\n  }\n",T="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n",N="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  struct ivec5\n  {\n    int x;\n    int y;\n    int z;\n    int w;\n    int u;\n  };\n\n  bool isNaN(float val) {\n    float v1 = val * val;\n    float v2 = val * val;\n    return v1 == v2 ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  //Based on the work of Dave Hoskins\n  //https://www.shadertoy.com/view/4djSRW\n  #define HASHSCALE1 443.8975\n  float random(float seed){\n    vec2 p = resultUV * seed;\n    vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n  }\n\n  "+v+"\n  "+h+"\n  "+f+"\n  "+m+"\n  "+C+"\n";function V(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function y(n,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}function S(n,e){var t=n[1]*n[2],r=n[2];return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t+";\n      index -= r * "+t+";\n      int c = index / "+r+";\n      int d = index - c * "+r+";\n      return ivec3(r, c, d);\n    }\n  "}function U(n,e){var t=n[3],r=n[2]*t,i=n[1]*r;return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      int r = index / "+i+";\n      index -= r * "+i+";\n\n      int c = index / "+r+";\n      index -= c * "+r+";\n\n      int d = index / "+t+";\n      int d2 = index - d * "+t+";\n\n      return ivec4(r, c, d, d2);\n    }\n  "}function D(n,e){var t=n[4],r=n[3]*t,i=n[2]*r,o=n[1]*i;return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      int r = index / "+o+";\n      index -= r * "+o+";\n\n      int c = index / "+i+";\n      index -= c * "+i+";\n\n      int d = index / "+r+";\n      index -= d * "+r+";\n\n      int d2 = index  / "+t+";\n      int d3 = index - d2 * "+t+";\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}function E(n,e){return t.arraysEqual(n,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===n[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===n[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+n[1]+";\n      int c = index - r * "+n[1]+";\n      return ivec2(r, c);\n    }\n  "}function O(n){var e=n.name;return"\n    float "+("get"+e.charAt(0).toUpperCase()+e.slice(1))+"() {\n      return sampleTexture("+e+", halfCR);\n    }\n  "}function A(n){var e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1);return"\n    float "+t+"(int index) {\n      return "+t+"Flat(index);\n    }\n  "}function _(n){var e=n.shapeInfo.logicalShape,r=n.shapeInfo.texShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[0],u=r[1];if(t.arraysEqual(e,r))return"\n    float "+o+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+u+".0, "+a+".0);\n      return sampleTexture("+i+", uv);\n    }\n  ";var c=t.squeezeShape(e),l=c.newShape,s=c.keptDims,d=l;if(d.length<e.length){return"\n      "+x(j(n,d))+"\n      float "+o+"(int row, int col) {\n        return "+o+"("+z(["row","col"],s)+");\n      }\n    "}return 1===u?"\n    float "+o+"(int row, int col) {\n      int index = row * "+e[1]+" + col;\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / "+a+".0);\n      return sampleTexture("+i+", uv);\n    }\n  ":1===a?"\n    float "+o+"(int row, int col) {\n      int index = row * "+e[1]+" + col;\n      vec2 uv = vec2((float(index) + 0.5) / "+u+".0, 0.5);\n      return sampleTexture("+i+", uv);\n    }\n  ":"\n  float "+o+"(int row, int col) {\n    vec2 uv = UVfrom2D("+a+", "+u+", "+e[1]+", row, col);\n    return sampleTexture("+i+", uv);\n  }\n"}function I(n){var e=n.shapeInfo.texShape,r=n.shapeInfo.logicalShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=e[0],u=e[1],c=r[1]*r[2],l=r[2],s=t.squeezeShape(r),d=s.newShape,p=s.keptDims,v=d;if(v.length<r.length){return"\n        "+x(j(n,v))+"\n        float "+o+"(int row, int col, int depth) {\n          return "+o+"("+z(["row","col","depth"],p)+");\n        }\n      "}return u===c?"\n        float "+o+"(int row, int col, int depth) {\n          int texR = row;\n          int texC = col * "+l+" + depth;\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+u+".0, "+a+".0);\n          return sampleTexture("+i+", uv);\n        }\n      ":u===l?"\n    float "+o+"(int row, int col, int depth) {\n      int texR = row * "+r[1]+" + col;\n      int texC = depth;\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+".0, "+a+".0);\n      return sampleTexture("+i+", uv);\n    }\n  ":"\n      float "+o+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+a+", "+u+", "+c+", "+l+", row, col, depth);\n        return sampleTexture("+i+", uv);\n      }\n  "}function b(n){var e=n.shapeInfo.logicalShape,r=n.shapeInfo.texShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[0],u=r[1],c=e[3],l=e[2]*c,s=e[1]*l,d=t.squeezeShape(e),p=d.newShape,v=d.keptDims;if(p.length<e.length){return"\n      "+x(j(n,p))+"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        return "+o+"("+z(["row","col","depth","depth2"],v)+");\n      }\n    "}return u===s?"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        int texR = row;\n        int texC = col * "+l+" + depth * "+c+" + depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+u+".0, "+a+".0);\n        return sampleTexture("+i+", uv);\n      }\n    ":u===c?"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        int texR = row * "+e[1]*e[2]+" + col * "+e[2]+" + depth;\n        int texC = depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+u+".0, "+a+".0);\n        return sampleTexture("+i+", uv);\n      }\n    ":"\n    float "+o+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+a+", "+u+", "+s+", "+l+",\n          "+c+", row, col, depth, depth2);\n      return sampleTexture("+i+", uv);\n    }\n  "}function q(n){var e=n.shapeInfo.logicalShape,r=n.shapeInfo.texShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[0],u=r[1],c=e[4],l=e[3]*c,s=e[2]*l,d=e[1]*s,p=t.squeezeShape(e),v=p.newShape,h=p.keptDims;if(v.length<e.length){return"\n      "+x(j(n,v))+"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+o+"("+z(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}return u===d?"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        int texC = col * "+s+" + depth * "+l+" +\n                   depth2 * "+c+" + depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+u+".0, "+a+".0);\n        return sampleTexture("+i+", uv);\n      }\n    ":u===c?"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row * "+e[1]*e[2]+" + col * "+e[2]+" +\n                   depth * "+e[3]+" + depth2;\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+u+".0, "+a+".0);\n        return sampleTexture("+i+", uv);\n      }\n    ":"\n    float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n      vec2 uv = UVfrom5D("+a+", "+u+", "+d+", "+s+",\n          "+l+", "+c+", row, col, depth, depth2, depth3);\n      return sampleTexture("+i+", uv);\n    }\n  "}function k(n){var e=n.name,t=n.shapeInfo.texShape,r="get"+e.charAt(0).toUpperCase()+e.slice(1)+"Flat",i=t[0],o=t[1];return 1===o&&1===i?"\n      float "+r+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ":1===o?"\n      float "+r+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+r+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+r+"(int index) {\n      vec2 uv = UVfrom1D("+i+", "+o+", index);\n      return sampleTexture("+e+", uv);\n    }\n  "}function L(n,e,t,r){var o=n.shapeInfo.logicalShape.length,a=e.logicalShape.length,u="int";2===a?u="ivec2":3===a?u="ivec3":4===a&&(u="ivec4");var c=i.getBroadcastDims(n.shapeInfo.logicalShape,e.logicalShape),l=a-o;return"\n    float "+r+"() {\n      "+u+" coords = getOutputCoords();\n      "+(0===o?"":a<2&&c.length>=1?"coords = 0;":c.map(function(n){return"coords["+(n+l)+"] = 0;"}).join("\n"))+"\n      return get"+t+"("+(a<2&&o>0?"coords":n.shapeInfo.logicalShape.map(function(n,e){return"coords["+(e+l)+"]"}).join(", "))+");\n    }\n  "}function F(n,e,r){var o=n.shapeInfo.texShape,a=n.name,u=a.charAt(0).toUpperCase()+a.slice(1),c="get"+u+"AtOutCoords",l=i.getBroadcastDims(n.shapeInfo.logicalShape,e.logicalShape),s=n.shapeInfo.logicalShape.length,x=e.logicalShape.length,d=r&&(x>s||l.length>0),p=i.broadcastDimsAreOuter(l);if(d&&!p)return L(n,e,u,c);var v=e.texShape;if(t.arraysEqual(o,v))return"\n      float "+c+"() {\n        return sampleTexture("+a+", resultUV);\n      }\n    ";var h=t.sizeFromShape(o),f="";return d&&p&&(f="\n        int mainPart = index / "+h+";\n        index -= mainPart * "+h+";\n      "),"\n    float "+c+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+v[0]+", "+v[1]+"));\n      int index = resTexRC.x * "+v[1]+" + resTexRC.y;\n      "+f+"\n      int texR = index / "+o[1]+";\n      int texC = index - texR * "+o[1]+";\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+o[1]+".0, "+o[0]+".0);\n\n      return sampleTexture("+a+", uv);\n    }\n  "}function B(n){if(n<=1)return"int";if(2===n)return"ivec2";if(3===n)return"ivec3";if(4===n)return"ivec4";if(5===n)return"ivec5";throw Error("GPU for rank "+n+" is not yet supported")}function j(n,e){var t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function z(n,e){return e.map(function(e){return n[e]}).join(", ")}
},{"../../environment":95,"../../util":98,"../../ops/broadcast_util":354,"./tex_util":251}],324:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CumSumProgram=void 0;var n=require("./shader_compiler"),r=function(){return function(r,i,o){this.variableNames=["x"],this.outputShape=r;var u=r.length,s=r[r.length-1],d=o?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(o?"return "+s+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+(0,n.getCoordsDataType)(u)+" coords = getOutputCoords();\n        int end = "+e(u,"coords")+";\n        float val = 0.0;\n        for (int i = "+s+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+d+" end) {\n            continue;\n          }\n          if (idx == end && "+i+") {\n            continue;\n          }\n          "+e(u,"coords")+" = idx;\n          val += getX("+t(u,"coords")+");\n        }\n        setOutput(val);\n      }\n    "}}();function t(n,r){if(1===n)return""+r;if(2===n)return r+".x, "+r+".y";if(3===n)return r+".x, "+r+".y, "+r+".z";if(4===n)return r+".x, "+r+".y, "+r+".z, "+r+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}function e(n,r){if(1===n)return""+r;if(2===n)return r+".y";if(3===n)return r+".z";if(4===n)return r+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}exports.CumSumProgram=r;
},{"./shader_compiler":384}],327:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return function(e){this.variableNames=["A"];var t=e[0],n=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+n+".0, "+t+".0);\n\n        vec4 values = texture2D(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "}}();exports.FromPixelsProgram=e;
},{}],328:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GatherProgram=void 0;var e=require("./shader_compiler"),r=function(){return function(r,s,n){this.variableNames=["A","indices"];var i=r.slice();i[n]=s,this.outputShape=i,this.rank=i.length;var o=(0,e.getCoordsDataType)(this.rank),a=t(r,n);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "}}();function t(e,r){var t=e.length;if(t>4)throw Error("Gather for rank "+t+" is not yet supported");if(1===t)return"int(getIndices(resRC))";for(var s=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[],i=0;i<e.length;i++)i===r?n.push("int(getIndices("+s[i]+"))"):n.push(""+s[i]);return n.join()}exports.GatherProgram=r;
},{"./shader_compiler":384}],208:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createWebGLRenderingContext=u,exports.createWebGLRenderingContextFromCanvas=a,exports.callAndCheck=i,exports.enableDebugWebGLErrorChecking=c,exports.checkWebGLError=E,exports.getWebGLErrorMessage=s,exports.getExtensionOrThrow=T,exports.createVertexShader=l,exports.createFragmentShader=R,exports.createProgram=x,exports.linkProgram=A,exports.validateProgram=b,exports.createStaticVertexBuffer=d,exports.createStaticIndexBuffer=_,exports.queryMaxTextureSize=h,exports.getChannelsPerTexture=m,exports.createTexture=U,exports.validateTextureSize=p,exports.createFramebuffer=L,exports.bindVertexBufferToProgramAttribute=S,exports.bindTextureUnit=M,exports.unbindTextureUnit=O,exports.getProgramUniformLocationOrThrow=I,exports.getProgramUniformLocation=N,exports.bindTextureToProgramUniformSampler=v,exports.bindCanvasToFramebuffer=P,exports.bindColorTextureToFramebuffer=w,exports.unbindColorTextureFromFramebuffer=B,exports.validateFramebuffer=C,exports.getFramebufferErrorMessage=D,exports.getTextureShapeFromLogicalShape=V;var r=require("../../util"),e=n(r),t=require("../../environment");function n(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var o=null;function u(r){var e=document.createElement("canvas");return e.width=1,e.height=1,a(e,r)}function a(r,e){var n,o=t.ENV.get("WEBGL_VERSION");if(2===o?n=r.getContext("webgl2",e):1===o&&(n=r.getContext("webgl",e)||r.getContext("experimental-webgl",e)),0===o||null==n)throw new Error("This browser does not support WebGL.");return n}function i(r,e){var t=e();return E(r),t}var f=!1;function c(r){f=r}function E(r){if(f){var e=r.getError();if(e!==r.NO_ERROR)throw new Error("WebGL Error: "+s(r,e))}}function s(r,e){switch(e){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function T(r,e){return G(r,function(){return r.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function l(r,e){var t=G(r,function(){return r.createShader(r.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(i(r,function(){return r.shaderSource(t,e)}),i(r,function(){return r.compileShader(t)}),!1===r.getShaderParameter(t,r.COMPILE_STATUS))throw console.log(r.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function R(r,e){var t=G(r,function(){return r.createShader(r.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(i(r,function(){return r.shaderSource(t,e)}),i(r,function(){return r.compileShader(t)}),!1===r.getShaderParameter(t,r.COMPILE_STATUS))throw F(e,r.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}var g=/ERROR: [0-9]+:([0-9]+):/g;function F(r,t){var n=g.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(r);for(var o=+n[1],u=r.split("\n"),a=u.length.toString().length+2,i=u.map(function(r,t){return e.rightPad((t+1).toString(),a)+r}),f=0,c=0;c<i.length;c++)f=Math.max(i[c].length,f);var E=i.slice(0,o-1),s=i.slice(o-1,o),T=i.slice(o);console.log(E.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+e.rightPad(s[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(T.join("\n"))}function x(r){return G(r,function(){return r.createProgram()},"Unable to create WebGLProgram.")}function A(r,e){if(i(r,function(){return r.linkProgram(e)}),!1===r.getProgramParameter(e,r.LINK_STATUS))throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function b(r,e){if(i(r,function(){return r.validateProgram(e)}),!1===r.getProgramParameter(e,r.VALIDATE_STATUS))throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function d(r,e){var t=G(r,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return i(r,function(){return r.bindBuffer(r.ARRAY_BUFFER,t)}),i(r,function(){return r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)}),t}function _(r,e){var t=G(r,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return i(r,function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t)}),i(r,function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)}),t}function h(r){return null!=o?o:o=i(r,function(){return r.getParameter(r.MAX_TEXTURE_SIZE)})}function m(){return t.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===t.ENV.get("WEBGL_VERSION")?1:4}function U(r){return G(r,function(){return r.createTexture()},"Unable to create WebGLTexture.")}function p(r,e,t){var n=h(r);if(e<=0||t<=0){var o="["+e+"x"+t+"]";throw new Error("Requested texture size "+o+" is invalid.")}if(e>n||t>n){o="["+e+"x"+t+"]";throw new Error("Requested texture size "+o+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}}function L(r){return G(r,function(){return r.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function S(r,e,t,n,o,u,a){var f=r.getAttribLocation(e,t);return-1!==f&&(i(r,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),i(r,function(){return r.vertexAttribPointer(f,o,r.FLOAT,!1,u,a)}),i(r,function(){return r.enableVertexAttribArray(f)}),!0)}function M(r,e,t){W(r,t),i(r,function(){return r.activeTexture(r.TEXTURE0+t)}),i(r,function(){return r.bindTexture(r.TEXTURE_2D,e)})}function O(r,e){W(r,e),i(r,function(){return r.activeTexture(r.TEXTURE0+e)}),i(r,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function I(r,e,t){return G(r,function(){return r.getUniformLocation(e,t)},'uniform "'+t+'" not present in program.')}function N(r,e,t){return r.getUniformLocation(e,t)}function v(r,e,t,n,o){i(r,function(){return M(r,t,o)}),i(r,function(){return r.uniform1i(n,o)})}function P(r){i(r,function(){return r.bindFramebuffer(r.FRAMEBUFFER,null)}),i(r,function(){return r.viewport(0,0,r.canvas.width,r.canvas.height)}),i(r,function(){return r.scissor(0,0,r.canvas.width,r.canvas.height)})}function w(r,e,t){i(r,function(){return r.bindFramebuffer(r.FRAMEBUFFER,t)}),i(r,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0)})}function B(r,e){i(r,function(){return r.bindFramebuffer(r.FRAMEBUFFER,e)}),i(r,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)})}function C(r){var e=r.checkFramebufferStatus(r.FRAMEBUFFER);if(e!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+D(r,e))}function D(r,e){switch(e){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function G(r,e,t){var n=i(r,function(){return e()});if(null==n)throw new Error(t);return n}function W(r,e){var t=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+r.TEXTURE0;if(n<r.TEXTURE0||n>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function V(r,t){2!==t.length&&(t=e.squeezeShape(t).newShape);var n=h(r),o=e.sizeFromShape(t);return t.length<=1&&o<=n?[o,1]:2===t.length&&t[0]<=n&&t[1]<=n?t:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?[t[0],t[1]*t[2]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n?[t[0],t[1]*t[2]*t[3]]:e.sizeToSquarishShape(o)}
},{"../../util":98,"../../environment":95}],207:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWebGLContextAttributes=o,exports.createWebGLContext=l,exports.createVertexShader=d,exports.createVertexBuffer=f,exports.createIndexBuffer=A,exports.createMatrixTexture=s,exports.createColorMatrixTexture=p,exports.createPackedMatrixTexture=_,exports.bindVertexProgramAttributeStreams=R,exports.uploadPixelDataToTexture=C,exports.uploadMatrixToTexture=k,exports.uploadMatrixToPackedTexture=v,exports.downloadMatrixFromOutputTextureAsync=P,exports.downloadMatrixFromOutputTexture=y,exports.downloadMatrixFromRGBAColorTexture=L,exports.downloadMatrixFromPackedOutputTexture=U;var e=require("../../environment"),r=require("./tex_util"),t=u(r),n=require("./webgl_util"),a=u(n);function u(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var c=function(e,r,t,n){return new(t||(t=Promise))(function(a,u){function c(e){try{o(n.next(e))}catch(e){u(e)}}function i(e){try{o(n.throw(e))}catch(e){u(e)}}function o(e){e.done?a(e.value):new t(function(r){r(e.value)}).then(c,i)}o((n=n.apply(e,r||[])).next())})},i=function(e,r){var t,n,a,u,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(u){return function(i){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,n&&(a=n[2&u[0]?"return":u[0]?"throw":"next"])&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[0,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return c.label++,{value:u[1],done:!1};case 5:c.label++,n=u[1],u=[0];continue;case 7:u=c.ops.pop(),c.trys.pop();continue;default:if(!(a=(a=c.trys).length>0&&a[a.length-1])&&(6===u[0]||2===u[0])){c=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){c.label=u[1];break}if(6===u[0]&&c.label<a[1]){c.label=a[1],a=u;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(u);break}a[2]&&c.ops.pop(),c.trys.pop();continue}u=r.call(e,c)}catch(e){u=[6,e],n=0}finally{t=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,i])}}};function o(){return{alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}}function l(e){var r,t=o();return r=null!=e?a.createWebGLRenderingContextFromCanvas(e,t):a.createWebGLRenderingContext(t),a.callAndCheck(r,function(){return r.disable(r.DEPTH_TEST)}),a.callAndCheck(r,function(){return r.disable(r.STENCIL_TEST)}),a.callAndCheck(r,function(){return r.disable(r.BLEND)}),a.callAndCheck(r,function(){return r.disable(r.DITHER)}),a.callAndCheck(r,function(){return r.disable(r.POLYGON_OFFSET_FILL)}),a.callAndCheck(r,function(){return r.disable(r.SAMPLE_COVERAGE)}),a.callAndCheck(r,function(){return r.enable(r.SCISSOR_TEST)}),a.callAndCheck(r,function(){return r.enable(r.CULL_FACE)}),a.callAndCheck(r,function(){return r.cullFace(r.BACK)}),r}function d(e){return a.createVertexShader(e,"\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function f(e){var r=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return a.createStaticVertexBuffer(e,r)}function A(e){var r=new Uint16Array([0,1,2,2,1,3]);return a.createStaticIndexBuffer(e,r)}function E(r,t){return e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===e.ENV.get("WEBGL_VERSION")?4===t?r.RGBA32F:r.R32F:r.RGBA}function T(r,t){return e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===e.ENV.get("WEBGL_VERSION")?4===t?r.RGBA:r.RED:r.RGBA}function x(r){return e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?r.FLOAT:r.UNSIGNED_BYTE}function h(e,r,t,n){a.validateTextureSize(e,r,t);var u=a.createTexture(e),c=e.TEXTURE_2D,i=E(e,n),o=T(e,n);return a.callAndCheck(e,function(){return e.bindTexture(c,u)}),a.callAndCheck(e,function(){return e.texParameteri(c,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),a.callAndCheck(e,function(){return e.texParameteri(c,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),a.callAndCheck(e,function(){return e.texParameteri(c,e.TEXTURE_MIN_FILTER,e.NEAREST)}),a.callAndCheck(e,function(){return e.texParameteri(c,e.TEXTURE_MAG_FILTER,e.NEAREST)}),a.callAndCheck(e,function(){return e.texImage2D(c,0,i,r,t,0,o,x(e),null)}),a.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)}),u}function s(e,r,n){var a=t.getUnpackedMatrixTextureShapeWidthHeight(r,n);return h(e,a[0],a[1],1)}function p(e,r,n){var a=t.getColorMatrixTextureShapeWidthHeight(r,n);return h(e,a[0],a[1],4)}function _(e,r,n){var a=t.getPackedMatrixTextureShapeWidthHeight(r,n);return h(e,a[0],a[1],4)}function R(e,r,t){return a.callAndCheck(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,t)}),a.bindVertexBufferToProgramAttribute(e,r,"clipSpacePos",t,3,20,0)&&a.bindVertexBufferToProgramAttribute(e,r,"uv",t,2,20,12)}function C(e,r,t){a.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,r)}),a.callAndCheck(e,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)}),a.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function b(e,r,t,n,u,c){var i=T(e,c);a.validateTextureSize(e,t,n),a.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,r)}),a.callAndCheck(e,function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,t,n,i,x(e),u)}),a.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function k(r,n,u,c,i,o){var l,d=t.getUnpackedMatrixTextureShapeWidthHeight(u,c),f=d[0],A=d[1];if(e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var E=1===o?a.getChannelsPerTexture():o;1===E?l=i:(l=new Float32Array(t.getUnpackedArraySizeFromMatrixSize(i.length,E)),t.encodeMatrixToUnpackedArray(i,l,E))}else l=t.encodeFloatArray(i);b(r,n,f,A,l,o)}function v(e,r,n,a,u){var c=t.getPackedMatrixTextureShapeWidthHeight(n,a),i=c[0],o=c[1],l=new Float32Array(t.getPackedRGBAArraySizeFromMatrixShape(n,a));t.encodeMatrixToPackedRGBA(u,n,a,l);b(e,r,i,o,l,4)}var B=null,g=null;function F(r,t,n){var a=e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED"),u=r*t*n;return a?(null==B||B.length<u)&&(B=new Float32Array(u)):(null==g||g.length<u)&&(g=new Uint8Array(u)),(a?B:g).subarray(0,u)}function S(r,n,a,u){if(e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var c=new Float32Array(n*a);return t.decodeMatrixFromUnpackedArray(r,c,u),c}return t.decodeToFloatArray(r)}function P(e,r,t,n){return c(this,void 0,void 0,function(){var u,c,o,l,d;return i(this,function(i){switch(i.label){case 0:return u=e,o=F(t,n,c=4),l=o instanceof Float32Array?4*o.length:o,d=e.createBuffer(),a.callAndCheck(e,function(){return e.bindBuffer(u.PIXEL_PACK_BUFFER,d)}),a.callAndCheck(e,function(){return e.bufferData(u.PIXEL_PACK_BUFFER,l,e.STATIC_DRAW)}),a.callAndCheck(e,function(){return u.readPixels(0,0,n,t,e.RGBA,x(e),0)}),[4,r.getBufferSubDataAsync(u.PIXEL_PACK_BUFFER,0,o)];case 1:return i.sent(),[2,S(o,t,n,c)]}})})}function y(e,r,n){var u=t.getUnpackedMatrixTextureShapeWidthHeight(r,n),c=u[0],i=u[1],o=F(r,n,4);return a.callAndCheck(e,function(){return e.readPixels(0,0,c,i,e.RGBA,x(e),o)}),S(o,r,n,4)}function L(e,r,n,u){var c=r*n*4,i=new Uint8Array(c);a.callAndCheck(e,function(){return e.readPixels(0,0,n,r,e.RGBA,e.UNSIGNED_BYTE,i)});for(var o=new Float32Array(c),l=0;l<i.length;l++)o[l]=i[l];var d=new Float32Array(r*n*u);return t.decodeMatrixFromUnpackedColorRGBAArray(o,d,u),d}function U(e,r,n){var u=t.getPackedMatrixTextureShapeWidthHeight(r,n),c=u[0],i=u[1],o=new Float32Array(t.getPackedRGBAArraySizeFromMatrixShape(r,n));a.callAndCheck(e,function(){return e.readPixels(0,0,c,i,e.RGBA,x(e),o)});var l=new Float32Array(r*n);return t.decodeMatrixFromPackedRGBA(o,r,n,l)}
},{"../../environment":95,"./tex_util":251,"./webgl_util":208}],209:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GPGPUContext=void 0,exports.binSearchLastTrue=d;var t=require("../../environment"),e=require("../../util"),r=l(e),o=require("./gpgpu_util"),i=l(o),n=require("./tex_util"),u=l(n),s=require("./webgl_util"),a=l(s);function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var h=function(t,e,r,o){return new(r||(r=Promise))(function(i,n){function u(t){try{a(o.next(t))}catch(t){n(t)}}function s(t){try{a(o.throw(t))}catch(t){n(t)}}function a(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(u,s)}a((o=o.apply(t,e||[])).next())})},f=function(t,e){var r,o,i,n,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(i=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){u.label=n[1];break}if(6===n[0]&&u.label<i[1]){u.label=i[1],i=n;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(n);break}i[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},c=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[],this.gl=null!=e?e:i.createWebGLContext(),1===t.ENV.get("WEBGL_VERSION")?(this.textureFloatExtension=a.getExtensionOrThrow(this.gl,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float")):this.colorBufferFloatExtension=a.getExtensionOrThrow(this.gl,"EXT_color_buffer_float"),this.loseContextExtension=a.getExtensionOrThrow(this.gl,"WEBGL_lose_context"),t.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&(this.getBufferSubDataAsyncExtension=this.gl.getExtension("WEBGL_get_buffer_sub_data_async")),this.vertexBuffer=i.createVertexBuffer(this.gl),this.indexBuffer=i.createIndexBuffer(this.gl),this.framebuffer=a.createFramebuffer(this.gl)}return e.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;a.callAndCheck(e,function(){return e.finish()}),a.callAndCheck(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),a.callAndCheck(e,function(){return e.deleteFramebuffer(t.framebuffer)}),a.callAndCheck(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),a.callAndCheck(e,function(){return e.deleteBuffer(t.vertexBuffer)}),a.callAndCheck(e,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),a.callAndCheck(e,function(){return e.deleteBuffer(t.indexBuffer)}),this.loseContextExtension.loseContext(),this.disposed=!0}},e.prototype.enableAutomaticDebugValidation=function(t){this.autoDebugValidate=t,a.enableDebugWebGLErrorChecking(t)},e.prototype.createMatrixTexture=function(t,e){return this.throwIfDisposed(),i.createMatrixTexture(this.gl,t,e)},e.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),i.uploadPixelDataToTexture(this.gl,t,e)},e.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),i.createPackedMatrixTexture(this.gl,t,e)},e.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(a.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),a.callAndCheck(this.gl,function(){return e.gl.deleteTexture(t)})},e.prototype.uploadMatrixToTexture=function(t,e,r,o){this.throwIfDisposed();return i.uploadMatrixToTexture(this.gl,t,e,r,o,1)},e.prototype.uploadMatrixToPackedTexture=function(t,e,r,o){return this.throwIfDisposed(),i.uploadMatrixToPackedTexture(this.gl,t,e,r,o)},e.prototype.downloadMatrixFromTexture=function(t,e,r){var o=this;return this.downloadMatrixDriver(t,function(){return i.downloadMatrixFromOutputTexture(o.gl,e,r)})},e.prototype.downloadMatrixFromTextureAsync=function(t,e,r){return h(this,void 0,void 0,function(){var o=this;return f(this,function(n){if(null==this.getBufferSubDataAsyncExtension)throw new Error("Cannot download matrix from output texture asynchronously, WEBGL_get_buffer_sub_data_async is not enabled.");return[2,this.downloadMatrixDriverAsync(t,function(){return i.downloadMatrixFromOutputTextureAsync(o.gl,o.getBufferSubDataAsyncExtension,e,r)})]})})},e.prototype.downloadMatrixFromRGBAColorTexture=function(t,e,r,o){var n=this;return this.downloadMatrixDriver(t,function(){return i.downloadMatrixFromRGBAColorTexture(n.gl,e,r,o)})},e.prototype.downloadMatrixFromPackedTexture=function(t,e,r){var o=this;return this.downloadMatrixDriver(t,function(){return i.downloadMatrixFromPackedOutputTexture(o.gl,e,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,r=a.createFragmentShader(e,t),o=i.createVertexShader(e),n=a.createProgram(e);return a.callAndCheck(e,function(){return e.attachShader(n,o)}),a.callAndCheck(e,function(){return e.attachShader(n,r)}),a.linkProgram(e,n),this.autoDebugValidate&&a.validateProgram(e,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=i.bindVertexProgramAttributeStreams(e,this.program,this.vertexBuffer)),n},e.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&a.callAndCheck(this.gl,function(){return e.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.autoDebugValidate&&a.validateProgram(this.gl,this.program),a.callAndCheck(this.gl,function(){return e.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,e,r){return void 0===r&&(r=!0),this.throwIfDisposed(),r?a.getProgramUniformLocationOrThrow(this.gl,t,e):a.getProgramUniformLocation(this.gl,t,e)},e.prototype.getAttributeLocation=function(t,e){var r=this;return this.throwIfDisposed(),a.callAndCheck(this.gl,function(){return r.gl.getAttribLocation(t,e)})},e.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},e.prototype.setInputMatrixTexture=function(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),a.bindTextureToProgramUniformSampler(this.gl,this.program,t,e,r)},e.prototype.setOutputMatrixTexture=function(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)},e.prototype.setOutputPackedMatrixTexture=function(t,e,r){this.throwIfDisposed();var o=u.getPackedMatrixTextureShapeWidthHeight(e,r),i=o[0],n=o[1];this.setOutputMatrixTextureDriver(t,i,n)},e.prototype.setOutputMatrixWriteRegion=function(t,e,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,e)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,e,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&a.validateProgram(this.gl,this.program),a.validateFramebuffer(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.autoDebugValidate&&this.debugValidate(),a.callAndCheck(t,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),a.callAndCheck(this.gl,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=a.getExtensionOrThrow(this.gl,2===t.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.runQuery=function(t){var e=this.beginQuery();return t(),this.endQuery(),this.pollQueryTime(e)},e.prototype.beginQuery=function(){if(2===t.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=e.createQuery();return e.beginQuery(r.TIME_ELAPSED_EXT,o),o}var i=this.getQueryTimerExtensionWebGL1(),n=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,n),n},e.prototype.endQuery=function(){if(2!==t.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var r=this.gl,o=this.getQueryTimerExtensionWebGL2();r.endQuery(o.TIME_ELAPSED_EXT)}},e.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollQueryTime=function(e){var r=this;return new Promise(function(o){var i=t.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION");r.addItemToPoll(function(){return r.isQueryAvailable(e,i)},function(){return o(r.getQueryTime(e,i))})})},e.prototype.pollItems=function(){for(var t=d(this.itemsToPoll.map(function(t){return t.isDoneFn})),e=0;e<=t;++e){(0,this.itemsToPoll[e].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,e){var o=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||r.repeatedTry(function(){return o.pollItems(),0===o.itemsToPoll.length})},e.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.downloadMatrixDriverSetup=function(t){this.throwIfDisposed(),a.bindColorTextureToFramebuffer(this.gl,t,this.framebuffer),this.autoDebugValidate&&a.validateFramebuffer(this.gl)},e.prototype.downloadMatrixDriverTeardown=function(){null!=this.outputTexture?(a.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&a.validateFramebuffer(this.gl)):a.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,e){this.downloadMatrixDriverSetup(t);var r=e();return this.downloadMatrixDriverTeardown(),r},e.prototype.downloadMatrixDriverAsync=function(t,e){return h(this,void 0,void 0,function(){var r;return f(this,function(o){switch(o.label){case 0:return this.downloadMatrixDriverSetup(t),[4,e()];case 1:return r=o.sent(),this.downloadMatrixDriverTeardown(),[2,r]}})})},e.prototype.setOutputMatrixTextureDriver=function(t,e,r){this.throwIfDisposed();var o=this.gl;a.bindColorTextureToFramebuffer(o,t,this.framebuffer),this.autoDebugValidate&&a.validateFramebuffer(o),this.outputTexture=t,a.callAndCheck(o,function(){return o.viewport(0,0,e,r)}),a.callAndCheck(o,function(){return o.scissor(0,0,e,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,e,r,o){var i=this;this.throwIfDisposed(),a.callAndCheck(this.gl,function(){return i.gl.scissor(t,e,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function d(t){for(var e=0,r=t.length-1,o=-1;e<=r;){var i=e+r>>1;t[i]()?(o=i,e=i+1):r=i-1}return o}exports.GPGPUContext=c;
},{"../../environment":95,"../../util":98,"./gpgpu_util":207,"./tex_util":251,"./webgl_util":208}],329:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.compileProgram=s,exports.runProgram=h,exports.makeShaderKey=c;var e=require("../../environment"),r=require("../../util"),a=n(r),t=require("./shader_compiler"),o=n(t);function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r.default=e,r}var i="NaN";function u(){return!e.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")}function s(e,r,a,t){for(var n=r.userCode,s=a.map(function(e,a){var t={logicalShape:e.tensor.shape,texShape:e.texData.texShape};return{name:r.variableNames[a],shapeInfo:t}}),p=s.map(function(e){return e.shapeInfo}),h={logicalShape:t.tensor.shape,texShape:t.texData.texShape},c=o.makeShader(s,h,n,!0===r.supportsBroadcasting),f=e.createProgram(c),m={},l=0;l<r.variableNames.length;l++){var g=r.variableNames[l];m[g]=e.getUniformLocation(f,g)}if(u()){m[i]=e.getUniformLocation(f,i,!1)}return{program:r,source:c,webGLProgram:f,uniformLocations:m,gpgpu:e,inShapeInfos:p,outShapeInfo:h}}function p(e,r){if(e.length!==r.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+r.length+" inputs");e.forEach(function(e,t){var o=e.logicalShape,n=e.texShape,i=r[t].tensor.shape,u=r[t].texData.texShape;if(!a.arraysEqual(o,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+i+" must match");if(!a.arraysEqual(n,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+n+" and "+u+" must match")})}function h(e,r,a,t){p(e.inShapeInfos,r),p([e.outShapeInfo],[a]);var o=a.texData.texture,n=a.texData.texShape,s=e.gpgpu;s.setOutputMatrixTexture(o,n[0],n[1]),s.setProgram(e.webGLProgram),r.forEach(function(r,a){var t=r.texData.texture,o=e.program.variableNames[a],n=e.uniformLocations[o];s.setInputMatrixTexture(t,n,a)}),u()&&s.gl.uniform1f(e.uniformLocations[i],NaN),null!=t&&t(s,e.webGLProgram),s.executeProgram()}function c(e,r,a){var t="";r.concat(a).forEach(function(e){t+=e.tensor.shape+"_"+e.texData.texShape});var o=e.userCode,n=(!0===e.supportsBroadcasting).toString(),i=e.constructor.name;return i+="_"+n+"_"+t+"_"+o}
},{"../../environment":95,"../../util":98,"./shader_compiler":384}],330:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WhereProgram=void 0;var e=require("./shader_compiler"),r=function(){return function(r,t,s){var o,n;if(this.variableNames=["c","a","b"],this.outputShape=t,s>4)throw Error("Where for rank "+s+" is not yet supported");if(1===s)n="resRC",o="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],u=[],p=0;p<t.length;p++)u.push(""+a[p]),p<r&&i.push(""+a[p]);o=i.join(),n=u.join()}var h=(0,e.getCoordsDataType)(s);this.userCode="\n      void main() {\n        "+h+" resRC = getOutputCoords();\n        float cVal = getC("+o+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+n+"));\n        } else {\n          setOutput(getB("+n+"));\n        }\n      }\n    "}}();exports.WhereProgram=r;
},{"./shader_compiler":384}],331:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return function(t,n,o,r,e){this.variableNames=["x"],this.outputShape=[];var i,s=n,a=t[3]-1;this.outputShape=t;var u="float("+o+") + float("+r+") * sum";i=.5===e?"inversesqrt("+u+")":1===e?"1.0/("+u+")":"exp(log("+u+") * float(-"+e+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+s+"; j <= "+s+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+a+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "}}();exports.LRNProgram=t;
},{}],332:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.filterHeight,o=n.filterWidth,e=n.strideHeight,d=n.strideWidth,i=t-1-n.padInfo.top,r=o-1-n.padInfo.left,a=t*o-1;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+r+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+o+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+d+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+a+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+o+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();exports.MaxPool2DBackpropProgram=n;
},{}],333:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return function(t,n,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this.variableNames=["matrixA","matrixB"];var r=e?t[1]:t[0],a=i?n[0]:n[1],o=e?t[0]:t[1];this.outputShape=[r,a];var u=function(t,n){return e?n+" + "+t+", aRow":"aRow, "+n+" + "+t},x=function(t,n){return i?"bCol, "+n+" + "+t:n+" + "+t+", bCol"},M=4*Math.floor(o/4),s=o%4;this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+M+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+u(0,"i")+"),\n          getMatrixA("+u(1,"i")+"),\n          getMatrixA("+u(2,"i")+"),\n          getMatrixA("+u(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+x(0,"i")+"),\n          getMatrixB("+x(1,"i")+"),\n          getMatrixB("+x(2,"i")+"),\n          getMatrixB("+x(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1===s)+") {\n        result += getMatrixA("+u(0,M)+") *\n          getMatrixB("+x(0,M)+");\n      } else if ("+(2===s)+") {\n        vec2 a = vec2(\n          getMatrixA("+u(0,M)+"),\n          getMatrixA("+u(1,M)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+x(0,M)+"),\n          getMatrixB("+x(1,M)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3===s)+") {\n        vec3 a = vec3(\n          getMatrixA("+u(0,M)+"),\n          getMatrixA("+u(1,M)+"),\n          getMatrixA("+u(2,M)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+x(0,M)+"),\n          getMatrixB("+x(1,M)+"),\n          getMatrixB("+x(2,M)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "}}();exports.MatMulProgram=t;
},{}],334:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(n,t,e){this.variableNames=["probs"],this.outputShape=[n,e],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return n.prototype.getCustomSetupFunc=function(n){var t=this;return function(e,o){null==t.seedLoc&&(t.seedLoc=e.getUniformLocation(o,"seed")),e.gl.uniform1f(t.seedLoc,n)}},n}();exports.MultinomialProgram=n;
},{}],337:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return function(t,e,o,n){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+n+"), float("+o+"),\n                      float(index == coords.y)));\n      }\n    "}}();exports.OneHotProgram=t;
},{}],335:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PadProgram=void 0;var t=require("./shader_compiler"),n=function(){return function(n,e,o){this.variableNames=["x"],this.outputShape=e.map(function(t,e){return t[0]+n[e]+t[1]});var r=n.length,u=(0,t.getCoordsDataType)(r),s=e.map(function(t){return t[0]}).join(","),a=e.map(function(t,e){return t[0]+n[e]}).join(","),i=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+u+" start = "+u+"("+s+");\n      "+u+" end = "+u+"("+a+");\n\n      void main() {\n        "+u+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+o+"));\n        } else {\n          "+u+" coords = outC - start;\n          setOutput(getX("+i+"));\n        }\n      }\n    ":"\n        int start = "+s+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+o+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "}}();exports.PadProgram=n;
},{"./shader_compiler":384}],336:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n,e,t){if(this.variableNames=["x"],"avg"===e&&t)throw new Error("Cannot compute positions for average pool.");var i=n.filterHeight,a=n.filterWidth,o=n.strideHeight,r=n.strideWidth,u=n.padInfo.top,x=n.padInfo.left;this.outputShape=n.outShape;var l="avg"===e,c="0.0";if(l||(c="-1.0 / 0.0"),t)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+r+");\n        const ivec2 pads = ivec2("+u+", "+x+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+i+"; wR++) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+a+"; wC++) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+a+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var s=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(s="avgValue / count");var C=4*Math.floor(a/4),d=a%4,v="\n      if ("+l+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+r+");\n      const ivec2 pads = ivec2("+u+", "+x+");\n      const float initializationValue = "+c+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+n.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+c+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+i+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+n.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+C+"; wC += 4) {\n            int xC = xCCorner + wC;\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              getValue(batch, xR, xC + 3, d)\n            );\n\n            "+v+"\n          }\n\n          int xC = xCCorner + "+C+";\n          if ("+(1===d)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(2===d)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(3===d)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              initializationValue\n            );\n\n            "+v+"\n          }\n        }\n        setOutput("+s+");\n      }\n    "}}}();exports.Pool2DProgram=n;
},{}],339:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n,i){this.variableNames=["x"];var e=n.windowSize,a=n.batchSize,t=n.inSize,u=Math.ceil(t/e);this.outputShape=[a,u];var l="sum"===i,o="0.0";l||(o="min"===i?"1.0 / 0.0":"-1.0 / 0.0");var c="min"===i?"min":"max",s=i+"("+i+"("+i+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===i&&(s="sumValue");var d=4*Math.floor(e/4),x=e%4,V="\n      if ("+l+") {\n        sumValue += dot(values, ones);\n      } else {\n        minMaxValue = "+c+"(values, minMaxValue);\n      }\n    ",v="";t%e>0&&(v="\n        if (inIdx < 0 || inIdx >= "+t+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+v+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+e+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+d+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+V+"\n        }\n\n        int inIdx = inOffset + "+d+";\n        if ("+(1===x)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n          "+V+"\n        } else if ("+(2===x)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n          "+V+"\n        } else if ("+(3===x)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n          "+V+"\n        }\n        setOutput("+s+");\n      }\n    "}}();exports.ReduceProgram=n;
},{}],338:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){return function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var o=t.shape,i=o[1],d=o[2],r=n.shape,a=r[1],f=r[2],l=[e&&a>1?i-1:i,e&&f>1?d-1:d],s=[e&&a>1?a-1:a,e&&f>1?f-1:f],x=l[0]/s[0],c=l[1]/s[1],p=1/x,y=1/c,h=2*Math.ceil(p)+2,C=2*Math.ceil(y)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+x+");\n        const float widthScale = float("+c+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+y+");\n\n        const int winHeight = int("+h+");\n        const int winWidth = int("+C+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+f+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(d-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "}}();exports.ResizeBilinearBackpropProgram=n;
},{}],341:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return function(e,t,o,n){this.variableNames=["A"],this.outputShape=[];var r=e[0],c=e[1],i=e[2],u=e[3];this.outputShape=[r,t,o,u];var s=[n&&t>1?c-1:c,n&&o>1?i-1:i],a=[n&&t>1?t-1:t,n&&o>1?o-1:o];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+c+".0, "+i+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}}();exports.ResizeBilinearProgram=e;
},{}],340:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return function(e,t,n,o){this.variableNames=["A"],this.outputShape=[];var r=e[0],c=e[1],s=e[2],u=e[3];this.outputShape=[r,t,n,u];var i=o?[c-1,s-1]:[c,s],a=o?[t-1,n-1]:[t,n],v=o?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+i[0]/a[0]+",\n          "+i[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+c+".0, "+s+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+v+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "}}();exports.ResizeNearestNeighborProgram=e;
},{}],342:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReverseProgram=void 0;var e=require("./shader_compiler"),r=function(){return function(r,t){this.variableNames=["x"];var o=r.length;if(o>4)throw new Error("WebGL backend: Reverse of rank-"+o+" tensor is not yet supported");if(this.outputShape=r,1!==o){var n=r.map(function(e,o){return function(e){return-1!==t.indexOf(e)&&1!==r[e]?r[e]+" - coords["+e+"] - 1":"coords["+e+"]"}(o)}).join(","),s=(0,e.getCoordsDataType)(o);this.userCode="\n      void main() {\n        "+s+" coords = getOutputCoords();\n        setOutput(getX("+n+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+r[0]+" - coord - 1));\n        }\n      "}}();exports.ReverseProgram=r;
},{"./shader_compiler":384}],344:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SliceProgram=void 0;var r=require("./shader_compiler"),t=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e=(0,r.getCoordsDataType)(this.rank),n=o(this.rank);this.userCode="\n      uniform "+e+" start;\n\n      void main() {\n        "+e+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+n+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(r){var t=this;if(r.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+r.length+")");return function(o,e){if(null!=t.startLoc||(t.startLoc=o.getUniformLocationNoThrow(e,"start"),null!=t.startLoc))if(1===t.rank)o.gl.uniform1i(t.startLoc,r[0]);else if(2===t.rank)o.gl.uniform2i(t.startLoc,r[0],r[1]);else if(3===t.rank)o.gl.uniform3i(t.startLoc,r[0],r[1],r[2]);else{if(4!==t.rank)throw Error("Slicing for rank "+t.rank+" is not yet supported");o.gl.uniform4i(t.startLoc,r[0],r[1],r[2],r[3])}}},t}();function o(r){if(1===r)return"sourceLoc";if(2===r)return"sourceLoc.x, sourceLoc.y";if(3===r)return"sourceLoc.x, sourceLoc.y, sourceLoc.z";if(4===r)return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w";throw Error("Slicing for rank "+r+" is not yet supported")}exports.SliceProgram=t;
},{"./shader_compiler":384}],343:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StridedSliceProgram=void 0;var e=require("./shader_compiler"),r=function(){return function(r,t,i){this.variableNames=["x"],this.outputShape=i,this.rank=i.length;var s=(0,e.getCoordsDataType)(this.rank),n="";n=1===this.rank?"coords * strides + begin":i.map(function(e,r){return"coords["+r+"] * strides["+r+"] + begin["+r+"]"}).join(","),this.userCode="\n      "+s+" begin = "+s+"("+r+");\n      "+s+" strides = "+s+"("+t+");\n\n      void main() {\n        "+s+" coords = getOutputCoords();\n        setOutput(getX("+n+"));\n      }\n    "}}();exports.StridedSliceProgram=r;
},{"./shader_compiler":384}],345:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextureManager=void 0;var e=require("./tex_util"),t=function(){function t(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,s){void 0===s&&(s=e.TextureType.FLOAT);var u=r(t,s);if(u in this.freeTextures||(this.freeTextures[u]=[]),u in this.usedTextures||(this.usedTextures[u]=[]),this.freeTextures[u].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var i=this.freeTextures[u].shift();return this.usedTextures[u].push(i),i}this.numUsedTextures++,this.log();var n=this.gpgpu.createMatrixTexture(t[0],t[1]);return this.usedTextures[u].push(n),n},t.prototype.releaseTexture=function(t,s,u){void 0===u&&(u=e.TextureType.FLOAT);var i=r(s,u);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var n=this.usedTextures[i],x=n.indexOf(t);if(x<0)throw new Error("Cannot release a texture that was never provided by this texture manager");n.splice(x,1),this.log()},t.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function r(e,t){return e[0]+"_"+e[1]+"_"+t}exports.TextureManager=t;
},{"./tex_util":251}],346:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileProgram=void 0;var r=require("./shader_compiler"),e=function(){return function(e,o){this.variableNames=["A"];for(var n=new Array(e.length),s=0;s<n.length;s++)n[s]=e[s]*o[s];this.outputShape=n,this.rank=n.length;var i=(0,r.getCoordsDataType)(this.rank),a=t(e);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "}}();function t(r){var e=r.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+r[0]+")";for(var t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],o=[],n=0;n<r.length;n++)o.push("imod("+t[n]+", "+r[n]+")");return o.join()}exports.TileProgram=e;
},{"./shader_compiler":384}],347:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransposeProgram=void 0;var r=require("./shader_compiler"),e=function(){return function(e,s){this.variableNames=["A"];for(var n=new Array(e.length),o=0;o<n.length;o++)n[o]=e[s[o]];this.outputShape=n,this.rank=n.length;var a=(0,r.getCoordsDataType)(this.rank),i=t(s);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "}}();function t(r){var e=r.length;if(e>5)throw Error("Transpose for rank "+e+" is not yet supported");for(var t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=new Array(e),n=0;n<r.length;n++)s[r[n]]=t[n];return s.join()}exports.TransposeProgram=e;
},{"./shader_compiler":384}],356:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.ERF_P=.3275911,r=exports.ERF_A1=.254829592,t=exports.ERF_A2=-.284496736,s=exports.ERF_A3=1.421413741,o=exports.ERF_A4=-1.453152027,p=exports.ERF_A5=1.061405429;
},{}],348:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TO_INT=exports.LOGICAL_NOT=exports.RECIPROCAL=exports.SQUARE=exports.ERF=exports.ATANH=exports.ACOSH=exports.ASINH=exports.TANH=exports.COSH=exports.SINH=exports.ATAN=exports.ACOS=exports.ASIN=exports.TAN=exports.COS=exports.SIN=exports.SOFTPLUS=exports.SIGMOID=exports.RSQRT=exports.SQRT=exports.LOG1P=exports.LOG=exports.EXPM1=exports.EXP=exports.ROUND=exports.SIGN=exports.FLOOR=exports.CEIL=exports.NEG=exports.SELU=exports.ELU=exports.RELU=exports.ABS=exports.UnaryOpProgram=void 0,exports.STEP=i;var r=require("../../ops/erf_util"),e=o(r),t=require("../../ops/selu_util"),n=o(t);function o(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var x=function(){return function(r,e){this.variableNames=["A"],this.outputShape=r,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}}();exports.UnaryOpProgram=x;var s="if (isNaN(x)) return x;",p=exports.ABS="return abs(x);",a=exports.RELU=s+"\n  return (x < 0.0) ? 0.0 : x;\n",l=exports.ELU="return (x >= 0.0) ? x : (exp(x) - 1.0);",u=exports.SELU="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+n.SELU_SCALEALPHA+";\n  float scale = "+n.SELU_SCALE+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n";function i(r){return void 0===r&&(r=0),s+"\n    return x > 0.0 ? 1.0 : float("+r+");\n  "}var f=exports.NEG="return -x;",A=exports.CEIL="return ceil(x);",S=exports.FLOOR="return floor(x);",O=exports.SIGN="\n  if (isNaN(x)) { return 0.0; }\n  return sign(x);\n",E=exports.ROUND="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",N=exports.EXP="return exp(x);",L=exports.EXPM1="return exp(x) - 1.0;",R=exports.LOG="return log(x);",c=exports.LOG1P="return log(1.0 + x);",_=exports.SQRT="return sqrt(x);",d=exports.RSQRT="return inversesqrt(x);",T=exports.SIGMOID="return 1.0 / (1.0 + exp(-1.0 * x));",h=exports.SOFTPLUS="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",I=exports.SIN="return sin(x);",g=exports.COS="return cos(x);",b=exports.TAN="return tan(x);",C=exports.ASIN="return asin(x);",P=exports.ACOS="return acos(x);",U=exports.ATAN=s+"\n  return atan(x);\n",m=exports.SINH="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",F=exports.COSH="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",G=exports.TANH="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",H=exports.ASINH="return log(x + sqrt(x * x + 1.0));",v=exports.ACOSH="return log(x + sqrt(x * x - 1.0));",y=exports.ATANH="return (log(1.0 + x) - log(1.0 - x)) / 2.0;",M=exports.ERF='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '+e.ERF_P+";\n  float a1 = "+e.ERF_A1+";\n  float a2 = "+e.ERF_A2+";\n  float a3 = "+e.ERF_A3+";\n  float a4 = "+e.ERF_A4+";\n  float a5 = "+e.ERF_A5+";\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n",q=exports.SQUARE="return x * x;",Q=exports.RECIPROCAL="return 1.0 / x;",w=exports.LOGICAL_NOT="return float(!(x >= 1.0));",D=exports.TO_INT="return float(int(x));";
},{"../../ops/erf_util":356,"../../ops/selu_util":357}],108:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MathBackendWebGL=void 0;var e=require("../environment"),t=require("../ops/axis_util"),r=ne(t),n=require("../ops/ops"),a=ne(n),o=require("../ops/reduce_util"),i=ne(o),p=require("../ops/slice_util"),u=require("../tensor"),s=require("../types"),h=ne(s),l=require("../util"),c=ne(l),m=require("./backend_util"),d=ne(m),g=require("./webgl/argminmax_gpu"),y=require("./webgl/avg_pool_backprop_gpu"),f=require("./webgl/batchnorm_gpu"),w=require("./webgl/binaryop_gpu"),v=ne(w),A=require("./webgl/clip_gpu"),P=require("./webgl/concat_gpu"),R=require("./webgl/conv_backprop_gpu"),O=require("./webgl/conv_backprop_gpu_depthwise"),x=require("./webgl/conv_gpu"),S=require("./webgl/conv_gpu_depthwise"),b=require("./webgl/cumsum_gpu"),_=require("./webgl/from_pixels_gpu"),E=require("./webgl/gather_gpu"),D=require("./webgl/gpgpu_context"),T=require("./webgl/gpgpu_math"),U=ne(T),I=require("./webgl/gpgpu_util"),N=ne(I),k=require("./webgl/logical_gpu"),B=require("./webgl/lrn_gpu"),M=require("./webgl/max_pool_backprop_gpu"),G=require("./webgl/mulmat_gpu"),q=require("./webgl/multinomial_gpu"),C=require("./webgl/onehot_gpu"),L=require("./webgl/pad_gpu"),W=require("./webgl/pool_gpu"),F=require("./webgl/reduce_gpu"),z=require("./webgl/resize_bilinear_backprop_gpu"),V=require("./webgl/resize_bilinear_gpu"),Q=require("./webgl/resize_nearest_neighbor_gpu"),H=require("./webgl/reverse_gpu"),Y=require("./webgl/slice_gpu"),X=require("./webgl/strided_slice_gpu"),K=require("./webgl/tex_util"),J=require("./webgl/texture_manager"),j=require("./webgl/tile_gpu"),Z=require("./webgl/transpose_gpu"),$=require("./webgl/unaryop_gpu"),ee=ne($),te=require("./webgl/webgl_util"),re=ne(te);function ne(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var ae=function(e,t,r,n){return new(r||(r=Promise))(function(a,o){function i(e){try{u(n.next(e))}catch(e){o(e)}}function p(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(i,p)}u((n=n.apply(e,t||[])).next())})},oe=function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:p(0),throw:p(1),return:p(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function p(o){return function(p){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[0,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,p])}}},ie=300,pe=function(){function t(t,r){if(void 0===r&&(r=!0),this.gpgpu=t,this.delayedStorage=r,this.texData=new WeakMap,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.lruDataGPU=[],this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.binaryCache={},this.disposed=!1,e.ENV.get("WEBGL_VERSION")<1)throw new Error("WebGL is not supported on this device");e.ENV.get("IS_BROWSER")&&(this.canvas=document.createElement("canvas")),null==t?(this.gpgpu=new D.GPGPUContext(N.createWebGLContext(this.canvas)),this.gpgpuCreatedLocally=!0):this.gpgpuCreatedLocally=!1,this.NUM_BYTES_BEFORE_PAGING=window.screen.height*window.screen.width*window.devicePixelRatio*ie,this.textureManager=new J.TextureManager(this.gpgpu)}return t.prototype.register=function(e,t,r){if(this.texData.has(e))throw new Error("Data buffer is already registered");this.texData.set(e,{shape:t,dtype:r,values:null,texture:null,texShape:null,texType:K.TextureType.FLOAT})},t.prototype.fromPixels=function(t,r){if(null==t)throw new Error("MathBackendWebGL.writePixels(): pixels can not be null");var n=[t.height,t.width],a=[t.height,t.width,r];if(t instanceof HTMLVideoElement){if(null==this.fromPixelsCanvas){if(!e.ENV.get("IS_BROWSER"))throw new Error("Can't read pixels from HTMLImageElement outside the browser.");if("complete"!==document.readyState)throw new Error("The DOM is not ready yet. Please call tf.fromPixels() once the DOM is ready. One way to do that is to add an event listener for `DOMContentLoaded` on the document object");this.fromPixelsCanvas=document.createElement("canvas")}this.fromPixelsCanvas.width=t.width,this.fromPixelsCanvas.height=t.height,this.fromPixelsCanvas.getContext("2d").drawImage(t,0,0,t.width,t.height),t=this.fromPixelsCanvas}var o=u.Tensor.make(n,{},"int32");this.texData.get(o.dataId).texType=K.TextureType.UNSIGNED_BYTE,this.gpgpu.uploadPixelDataToTexture(this.getTexture(o.dataId),t);var i=new _.FromPixelsProgram(a),p=this.compileAndRun(i,[o]);return o.dispose(),p},t.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendWebGL.write(): values can not be null");this.throwIfNoData(e);var r=this.texData.get(e),n=r.texture,a=r.texShape,o=r.texType;null!=n&&(this.releaseTexture(e,n,a,o),r.texture=null,r.texShape=null),r.values=t,this.delayedStorage||this.uploadToGPU(e)},t.prototype.readSync=function(e){this.throwIfNoData(e);var t=this.texData.get(e),r=t.texture,n=t.values,a=t.texShape;if(null!=n)return this.cacheOnCPU(e),n;var o,i=null!=this.activeTimers;i&&(o=performance.now());var p=this.gpgpu.downloadMatrixFromTexture(r,a[0],a[1]);return i&&(this.downloadWaitMs+=performance.now()-o),this.cacheOnCPU(e,p),t.values},t.prototype.read=function(t){return ae(this,void 0,void 0,function(){var r,n,a,o,i,p,u,s;return oe(this,function(h){switch(h.label){case 0:return this.pendingRead.has(t)?(r=this.pendingRead.get(t),[2,new Promise(function(e){return r.push(e)})]):(this.throwIfNoData(t),n=this.texData.get(t),a=n.texture,o=n.values,i=n.texShape,null!=o?(this.cacheOnCPU(t),[2,o]):e.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")?[4,this.gpgpu.downloadMatrixFromTextureAsync(a,i[0],i[1])]:[3,2]);case 1:return p=h.sent(),this.cacheOnCPU(t,p),[2,n.values];case 2:return 0===e.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?[2,this.readSync(t)]:(this.pendingRead.set(t,[]),[4,this.gpgpu.runQuery(function(){})]);case 3:return h.sent(),u=this.pendingRead.get(t),this.pendingRead.delete(t),s=this.readSync(t),u.forEach(function(e){return e(s)}),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,s]}})})},t.prototype.time=function(e){return ae(this,void 0,void 0,function(){var t,r,n,a,o,i;return oe(this,function(p){switch(p.label){case 0:return t=this.activeTimers,r=[],n=!1,null==this.programTimersStack?(this.programTimersStack=r,n=!0):this.activeTimers.push(r),this.activeTimers=r,e(),a=c.flatten(this.activeTimers),this.activeTimers=t,n&&(this.programTimersStack=null),[4,Promise.all(a).then(function(e){var t=0;return e.forEach(function(e){return t+=e}),t})];case 1:return o=p.sent(),i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:o,wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,i]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return e.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},t.prototype.endTimer=function(t){return e.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=performance.now(),t)},t.prototype.getQueryTime=function(t){return ae(this,void 0,void 0,function(){var r;return oe(this,function(n){return e.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.pollQueryTime(t)]:[2,(r=t).endMs-r.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e))if(this.pendingRead.has(e))this.pendingDisposal.add(e);else if(this.texData.has(e)){var t=this.texData.get(e),r=t.texture,n=t.texShape,a=t.texType;null!=r&&this.releaseTexture(e,r,n,a),this.texData.delete(e)}},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.getCanvas=function(){return this.canvas},t.prototype.slice=function(e,t,r){var n=new Y.SliceProgram(r),a=n.getCustomSetupFunc(t);return this.compileAndRun(n,[e],null,a)},t.prototype.stridedSlice=function(e,t,r,n,o,i){var u=(0,p.getStridedSlicedInfo)(e.shape,t,r,n,o,i),s=u[0],h=u[1];if(h.some(function(e){return 0===e}))return a.tensor([],h);var l=new X.StridedSliceProgram(s,n,h);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,t){var r=new H.ReverseProgram(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.concat=function(e,t){var r=new P.ConcatProgram(e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.neg=function(e){var t=new $.UnaryOpProgram(e.shape,ee.NEG);return this.compileAndRun(t,[e])},t.prototype.matMul=function(e,t,r,n){var a=new G.MatMulProgram(e.shape,t.shape,r,n);return this.compileAndRun(a,[e,t])},t.prototype.multiply=function(e,t){var r=new w.BinaryOpProgram(v.MUL,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(e.dtype,t.dtype));return this.compileAndRun(r,[e,t],n)},t.prototype.batchNormalization=function(e,t,r,n,a,o){var i=[e,t,r],p=null;null!=o&&(p=o.shape,i.push(o));var u=null;null!=a&&(u=a.shape,i.push(a));var s=new f.BatchNormProgram(e.shape,t.shape,r.shape,p,u,n);return this.compileAndRun(s,i)},t.prototype.localResponseNormalization4D=function(e,t,r,n,a){var o=new B.LRNProgram(e.shape,t,r,n,a);return this.compileAndRun(o,[e])},t.prototype.tile=function(e,t){var r=new j.TileProgram(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,r){var n=new L.PadProgram(e.shape,t,r);return this.compileAndRun(n,[e])},t.prototype.transpose=function(e,t){var r=new Z.TransposeProgram(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.gather=function(e,t,r){var n=new E.GatherProgram(e.shape,t.size,r);return this.compileAndRun(n,[e,t])},t.prototype.reduce=function(e,t,r){var n=e.shape[0],a=e.shape[1],o={windowSize:i.computeOptimalWindowSize(a),inSize:a,batchSize:n},p=new F.ReduceProgram(o,t),u=p.outputShape,s=u[0],h=u[1],l=this.makeOutputArray([s,h],r);return this.compileAndRun(p,[e],l),1===l.shape[1]?l:this.reduce(l,t,r)},t.prototype.argReduce=function(e,t,r){void 0===r&&(r=null);var n=e.shape[0],a=e.shape[1];null!=r&&(n=r.shape[0],a=r.shape[1]);var o={windowSize:i.computeOptimalWindowSize(a),inSize:a,batchSize:n},p=new g.ArgMinMaxProgram(o,t,null==r),u=p.outputShape,s=u[0],h=u[1],l=this.makeOutputArray([s,h],"int32"),c=[e];return null!=r&&c.push(r),this.compileAndRun(p,c,l),1===l.shape[1]?l:this.argReduce(e,t,l)},t.prototype.sum=function(e,t){r.assertAxesAreInnerMostDims("sum",t,e.rank);var n=r.computeOutAndReduceShapes(e.shape,t),a=n[0],o=n[1],i=c.sizeFromShape(o),p=e.as2D(-1,i),u=h.sumOutType(e.dtype);return this.reduce(p,"sum",u).reshape(a)},t.prototype.argMin=function(e,t){var n=[t];r.assertAxesAreInnerMostDims("argMin",n,e.rank);var a=r.computeOutAndReduceShapes(e.shape,n),o=a[0],i=a[1],p=c.sizeFromShape(i),u=e.as2D(-1,p);return this.argReduce(u,"min").reshape(o)},t.prototype.argMax=function(e,t){var n=[t];r.assertAxesAreInnerMostDims("argMax",n,e.rank);var a=r.computeOutAndReduceShapes(e.shape,n),o=a[0],i=a[1],p=c.sizeFromShape(i),u=e.as2D(-1,p);return this.argReduce(u,"max").reshape(o)},t.prototype.cumsum=function(e,t,r,n){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var a=new b.CumSumProgram(e.shape,r,n);return this.compileAndRun(a,[e])},t.prototype.equal=function(e,t){var r=new w.BinaryOpProgram(v.EQUAL,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.notEqual=function(e,t){var r=new w.BinaryOpProgram(v.NOT_EQUAL,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.less=function(e,t){var r=new w.BinaryOpProgram(v.LESS,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.lessEqual=function(e,t){var r=new w.BinaryOpProgram(v.LESS_EQUAL,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.greater=function(e,t){var r=new w.BinaryOpProgram(v.GREATER,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.greaterEqual=function(e,t){var r=new w.BinaryOpProgram(v.GREATER_EQUAL,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.logicalNot=function(e){var t=new $.UnaryOpProgram(e.shape,ee.LOGICAL_NOT);return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){var r=new w.BinaryOpProgram(v.LOGICAL_AND,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.logicalOr=function(e,t){var r=new w.BinaryOpProgram(v.LOGICAL_OR,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[e,t],n)},t.prototype.where=function(e,t,r,n){var a=new k.WhereProgram(e.rank,t.shape,t.rank),o=this.makeOutputArray(a.outputShape,n);return this.compileAndRun(a,[e,t,r],o)},t.prototype.topKValues=function(e,t){throw new Error("topKValues GPU not yet implemented!")},t.prototype.topKIndices=function(e,t){throw new Error("topKIndices GPU not yet implemented!")},t.prototype.min=function(e,t){r.assertAxesAreInnerMostDims("min",t,e.rank);var n=r.computeOutAndReduceShapes(e.shape,t),a=n[0],o=n[1],i=c.sizeFromShape(o),p=e.as2D(-1,i);return this.reduce(p,"min",p.dtype).reshape(a)},t.prototype.minimum=function(e,t){var r=new w.BinaryOpProgram(v.MIN,e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.mod=function(e,t){var r=new w.BinaryOpProgram(v.MOD,e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.max=function(e,t){r.assertAxesAreInnerMostDims("max",t,e.rank);var n=r.computeOutAndReduceShapes(e.shape,t),a=n[0],o=n[1],i=c.sizeFromShape(o),p=e.as2D(-1,i);return this.reduce(p,"max",p.dtype).reshape(a)},t.prototype.maximum=function(e,t){var r=new w.BinaryOpProgram(v.MAX,e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.squaredDifference=function(e,t){var r=new w.BinaryOpProgram(v.SQUARED_DIFFERENCE,e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.realDivide=function(e,t){var r=v.DIV,n=new w.BinaryOpProgram(r,e.shape,t.shape),a=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e,t],a)},t.prototype.floorDiv=function(e,t){var r=v.INT_DIV,n=new w.BinaryOpProgram(r,e.shape,t.shape),a=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[e,t],a)},t.prototype.add=function(e,t){var r=new w.BinaryOpProgram(v.ADD,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(e.dtype,t.dtype));return this.compileAndRun(r,[e,t],n)},t.prototype.subtract=function(e,t){var r=new w.BinaryOpProgram(v.SUB,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(e.dtype,t.dtype));return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var r=new w.BinaryOpProgram(v.POW,e.shape,t.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(e.dtype,t.dtype));return this.compileAndRun(r,[e,t],n)},t.prototype.ceil=function(e){var t=new $.UnaryOpProgram(e.shape,ee.CEIL);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){var t=new $.UnaryOpProgram(e.shape,ee.FLOOR);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SIGN);return this.compileAndRun(t,[e])},t.prototype.round=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ROUND);return this.compileAndRun(t,[e])},t.prototype.exp=function(e){var t=new $.UnaryOpProgram(e.shape,ee.EXP);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){var t=new $.UnaryOpProgram(e.shape,ee.EXPM1);return this.compileAndRun(t,[e])},t.prototype.log=function(e){var t=new $.UnaryOpProgram(e.shape,ee.LOG);return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new $.UnaryOpProgram(e.shape,ee.LOG1P);return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SQRT);return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){var t=new $.UnaryOpProgram(e.shape,ee.RSQRT);return this.compileAndRun(t,[e])},t.prototype.square=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SQUARE);return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new $.UnaryOpProgram(e.shape,ee.RECIPROCAL);return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t=new $.UnaryOpProgram(e.shape,ee.RELU);return this.compileAndRun(t,[e])},t.prototype.elu=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ELU);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var r=new w.BinaryOpProgram(v.ELU_DER,e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.selu=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SELU);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new $.UnaryOpProgram(e.shape,ee.TO_INT),r=this.makeOutputArray(t.outputShape,"int32");return this.compileAndRun(t,[e],r)},t.prototype.clip=function(e,t,r){var n=new A.ClipProgram(e.shape,t,r);return this.compileAndRun(n,[e])},t.prototype.abs=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ABS);return this.compileAndRun(t,[e])},t.prototype.sigmoid=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SIGMOID);return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SOFTPLUS);return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SIN);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new $.UnaryOpProgram(e.shape,ee.COS);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new $.UnaryOpProgram(e.shape,ee.TAN);return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ASIN);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ACOS);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ATAN);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var r=new w.BinaryOpProgram(v.ATAN2,e.shape,t.shape);return this.compileAndRun(r,[e,t])},t.prototype.sinh=function(e){var t=new $.UnaryOpProgram(e.shape,ee.SINH);return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new $.UnaryOpProgram(e.shape,ee.COSH);return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new $.UnaryOpProgram(e.shape,ee.TANH);return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ASINH);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ACOSH);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ATANH);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new $.UnaryOpProgram(e.shape,ee.ERF);return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var r=new $.UnaryOpProgram(e.shape,ee.STEP(t));return this.compileAndRun(r,[e])},t.prototype.conv2d=function(e,t,r){var n=new x.Conv2DProgram(r);return this.compileAndRun(n,[e,t])},t.prototype.conv2dDerInput=function(e,t,r){var n=new R.Conv2DDerInputProgram(r);return this.compileAndRun(n,[e,t])},t.prototype.conv2dDerFilter=function(e,t,r){var n=new R.Conv2DDerFilterProgram(r);return this.compileAndRun(n,[e,t])},t.prototype.depthwiseConv2D=function(e,t,r){var n=new S.DepthwiseConv2DProgram(r);return this.compileAndRun(n,[e,t])},t.prototype.depthwiseConv2DDerInput=function(e,t,r){var n=new O.DepthwiseConv2DDerInputProgram(r);return this.compileAndRun(n,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,r){var n=new O.DepthwiseConv2DDerFilterProgram(r);return this.compileAndRun(n,[e,t])},t.prototype.maxPool=function(e,t){var r=new W.Pool2DProgram(t,"max",!1),n=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[e],n)},t.prototype.avgPool=function(e,t){var r=new W.Pool2DProgram(t,"avg",!1),n=this.makeOutputArray(r.outputShape,"float32");return this.compileAndRun(r,[e],n)},t.prototype.maxPoolBackprop=function(e,t,r,n){var a=new W.Pool2DProgram(n,"max",!0),o=this.compileAndRun(a,[t]),i=new M.MaxPool2DBackpropProgram(n),p=this.makeOutputArray(i.outputShape,t.dtype),u=this.compileAndRun(i,[e,o],p);return o.dispose(),u},t.prototype.avgPoolBackprop=function(e,t,r){var n=new y.AvgPool2DBackpropProgram(r),a=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[e],a)},t.prototype.cast=function(e,t){return d.castTensor(e,t,this)},t.prototype.reshape=function(e,t){return d.reshapeTensor(e,t)},t.prototype.resizeBilinear=function(e,t,r,n){var a=new V.ResizeBilinearProgram(e.shape,t,r,n);return this.compileAndRun(a,[e])},t.prototype.resizeBilinearBackprop=function(e,t,r){var n=new z.ResizeBilinearBackpropProgram(e,t,r);return this.compileAndRun(n,[e])},t.prototype.resizeNearestNeighbor=function(e,t,r,n){var a=new Q.ResizeNearestNeighborProgram(e.shape,t,r,n);return this.compileAndRun(a,[e])},t.prototype.multinomial=function(e,t,r,n){var o=t?e:a.softmax(e),i=o.shape[0],p=o.shape[1],u=new q.MultinomialProgram(i,p,r),s=this.makeOutputArray(u.outputShape,"int32"),h=u.getCustomSetupFunc(n);return this.compileAndRun(u,[o],s,h)},t.prototype.oneHot=function(e,t,r,n){var a=new C.OneHotProgram(e.size,t,r,n);return this.compileAndRun(a,[e])},t.prototype.makeOutputArray=function(e,t){return u.Tensor.make(e,{},t)},t.prototype.compileAndRun=function(e,t,r,n){var a=this;null==r&&(r=this.makeOutputArray(e.outputShape,t[0].dtype));var o=t.map(function(e){return a.uploadToGPU(e.dataId),{tensor:e,texData:a.texData.get(e.dataId)}});this.uploadToGPU(r.dataId);var i,p={tensor:r,texData:this.texData.get(r.dataId)},u=U.makeShaderKey(e,o,p),s=this.getAndSaveBinary(u,function(){return U.compileProgram(a.gpgpu,e,o,p)}),h=null!=this.activeTimers;if(h&&(i=this.startTimer()),U.runProgram(s,o,p,n),this.numBytesInGPU>this.NUM_BYTES_BEFORE_PAGING)for(var l=this.numBytesInGPU-this.NUM_BYTES_BEFORE_PAGING;l>0;){var c=this.lruDataGPU.shift(),m=this.texData.get(c),d=m.shape,g=m.dtype;l-=this.computeBytes(d,g),this.read(c)}return h&&(i=this.endTimer(i),this.activeTimers.push(this.getQueryTime(i))),r},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){if(!this.disposed){for(var e in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram);this.textureManager.dispose(),this.canvas.remove(),null!=this.fromPixelsCanvas&&this.fromPixelsCanvas.remove(),this.gpgpuCreatedLocally&&this.gpgpu.dispose(),this.disposed=!0}},t.prototype.throwIfNoData=function(e){if(!this.texData.has(e))throw new Error("WebGL backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},t.prototype.uploadToGPU=function(e){this.throwIfNoData(e);var t=this.texData.get(e),r=t.shape,n=t.values,a=t.texture,o=t.dtype,i=t.texType;if(null!=a)return this.lruDataGPU.splice(this.lruDataGPU.indexOf(e),1),void this.lruDataGPU.push(e);var p,u=null!=this.activeTimers;u&&(p=performance.now());var s=re.getTextureShapeFromLogicalShape(this.gpgpu.gl,r);t.texShape=s;var h=this.acquireTexture(e,s,i);t.texture=h,null!=n&&(this.gpgpu.uploadMatrixToTexture(h,s[0],s[1],se(n,o)),t.values=null,u&&(this.uploadWaitMs+=performance.now()-p))},t.prototype.cacheOnCPU=function(e,t){var r=this.delayedStorage,n=this.texData.get(e),a=n.texture,o=n.texShape,i=n.dtype,p=n.texType;r&&null!=a&&(this.releaseTexture(e,a,o,p),n.texture=null,n.texShape=null),null!=t&&(n.values=ue(t,i))},t.prototype.releaseTexture=function(e,t,r,n){var a=this.texData.get(e),o=a.shape,i=a.dtype,p=this.lruDataGPU.indexOf(e);p>=0&&this.lruDataGPU.splice(p,1),this.numBytesInGPU-=this.computeBytes(o,i),this.textureManager.releaseTexture(t,r,n)},t.prototype.acquireTexture=function(e,t,r){var n=this.texData.get(e),a=n.shape,o=n.dtype;return this.lruDataGPU.push(e),this.numBytesInGPU+=this.computeBytes(a,o),this.textureManager.acquireTexture(t,r)},t.prototype.computeBytes=function(e,t){return c.sizeFromShape(e)*c.bytesPerElement(t)},t}();function ue(e,t){if("float32"===t)return e;if("int32"===t||"bool"===t){for(var r="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),n=0;n<r.length;++n)r[n]=Math.round(e[n]);return r}throw new Error("Unknown dtype "+t)}function se(e,t){return e instanceof Float32Array?e:new Float32Array(e)}exports.MathBackendWebGL=pe,e.ENV.get("IS_BROWSER")&&e.ENV.registerBackend("webgl",function(){return new pe},2);
},{"../environment":95,"../ops/axis_util":312,"../ops/ops":119,"../ops/reduce_util":313,"../ops/slice_util":314,"../tensor":101,"../types":102,"../util":98,"./backend_util":315,"./webgl/argminmax_gpu":316,"./webgl/avg_pool_backprop_gpu":317,"./webgl/batchnorm_gpu":318,"./webgl/binaryop_gpu":319,"./webgl/clip_gpu":320,"./webgl/concat_gpu":321,"./webgl/conv_backprop_gpu":322,"./webgl/conv_backprop_gpu_depthwise":323,"./webgl/conv_gpu":326,"./webgl/conv_gpu_depthwise":325,"./webgl/cumsum_gpu":324,"./webgl/from_pixels_gpu":327,"./webgl/gather_gpu":328,"./webgl/gpgpu_context":209,"./webgl/gpgpu_math":329,"./webgl/gpgpu_util":207,"./webgl/logical_gpu":330,"./webgl/lrn_gpu":331,"./webgl/max_pool_backprop_gpu":332,"./webgl/mulmat_gpu":333,"./webgl/multinomial_gpu":334,"./webgl/onehot_gpu":337,"./webgl/pad_gpu":335,"./webgl/pool_gpu":336,"./webgl/reduce_gpu":339,"./webgl/resize_bilinear_backprop_gpu":338,"./webgl/resize_bilinear_gpu":341,"./webgl/resize_nearest_neighbor_gpu":340,"./webgl/reverse_gpu":342,"./webgl/slice_gpu":344,"./webgl/strided_slice_gpu":343,"./webgl/tex_util":251,"./webgl/texture_manager":345,"./webgl/tile_gpu":346,"./webgl/transpose_gpu":347,"./webgl/unaryop_gpu":348,"./webgl/webgl_util":208}],109:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MathBackendCPU=void 0;var t=require("seedrandom"),e=T(t),r=require("../environment"),a=require("../ops/axis_util"),n=T(a),o=require("../ops/broadcast_util"),i=T(o),s=require("../ops/concat_util"),u=T(s),f=require("../ops/erf_util"),p=T(f),h=require("../ops/ops"),l=T(h),c=require("../ops/selu_util"),d=T(c),y=require("../ops/slice_util"),v=require("../tensor"),g=require("../types"),m=T(g),S=require("../util"),M=T(S),b=require("./backend_util"),w=T(b);function T(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var A=function(t,e,r,a){return new(r||(r=Promise))(function(n,o){function i(t){try{u(a.next(t))}catch(t){o(t)}}function s(t){try{u(a.throw(t))}catch(t){o(t)}}function u(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(i,s)}u((a=a.apply(t,e||[])).next())})},x=function(t,e){var r,a,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,a&&(n=a[2&o[0]?"return":o[0]?"throw":"next"])&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[0,n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},k=function(){function t(){this.data=new WeakMap,this.firstUse=!0,r.ENV.get("IS_BROWSER")&&(this.canvas=document.createElement("canvas"))}return t.prototype.register=function(t,e,a){if(this.firstUse&&(this.firstUse=!1,r.ENV.get("IS_NODE")&&console.warn("\n============================\nHi there ð. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,null)},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.throwIfNoData(t),this.data.set(t,e)},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("MathBackendCPU.writePixels(): pixels can not be null");var r,a;if(t instanceof ImageData)r=t.data;else if(t instanceof HTMLCanvasElement)r=t.getContext("2d").getImageData(0,0,t.width,t.height).data;else{if(!(t instanceof HTMLImageElement||t instanceof HTMLVideoElement))throw new Error("pixels is of unknown type: "+t.constructor.name);if(null==this.canvas)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,t.width,t.height),r=this.canvas.getContext("2d").getImageData(0,0,t.width,t.height).data}if(4===e)a=new Int32Array(r);else{var n=t.width*t.height;a=new Int32Array(n*e);for(var o=0;o<n;o++)for(var i=0;i<e;++i)a[o*e+i]=r[4*o+i]}var s=[t.height,t.width,e];return(0,h.tensor3d)(a,s,"int32")},t.prototype.read=function(t){return A(this,void 0,void 0,function(){return x(this,function(e){return[2,this.readSync(t)]})})},t.prototype.readSync=function(t){return this.throwIfNoData(t),this.data.get(t)},t.prototype.disposeData=function(t){this.data.has(t)&&this.data.delete(t)},t.prototype.time=function(t){return A(this,void 0,void 0,function(){var e;return x(this,function(r){return e=performance.now(),t(),[2,{kernelMs:performance.now()-e}]})})},t.prototype.memory=function(){return{unreliable:!0}},t.prototype.throwIfNoData=function(t){if(!this.data.has(t))throw new Error("CPU backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},t.prototype.slice=function(t,e,r){for(var a=l.buffer(r,t.dtype),n=0;n<a.size;++n){var o=a.indexToLoc(n),i=o.map(function(t,r){return t+e[r]});a.set.apply(a,[t.get.apply(t,i)].concat(o))}return a.toTensor()},t.prototype.stridedSlice=function(t,e,r,a,n,o){var i=(0,y.getStridedSlicedInfo)(t.shape,e,r,a,n,o),s=i[0],u=i[1];if(u.some(function(t){return 0===t}))return l.tensor([],u);for(var f=l.buffer(u,t.dtype),p=0;p<f.size;p++){for(var h=f.indexToLoc(p),c=new Array(h.length),d=0;d<c.length;d++)c[d]=h[d]*a[d]+s[d];f.set.apply(f,[t.get.apply(t,c)].concat(h))}return f.toTensor()},t.prototype.reverse=function(t,e){for(var r=l.buffer(t.shape,t.dtype),a=t.buffer(),n=function(n){var o=r.indexToLoc(n),i=o.slice();e.forEach(function(e){return i[e]=t.shape[e]-1-i[e]}),r.set.apply(r,[a.get.apply(a,i)].concat(o))},o=0;o<r.size;o++)n(o);return r.toTensor()},t.prototype.concat=function(t,e){var r=u.computeOutShape(t.shape,e.shape,1),a=l.buffer(r,t.dtype);if(1===t.shape[0]&&1===e.shape[0]){var n=t.dataSync(),o=e.dataSync(),i=a.values;return i.set(n,0),i.set(o,t.size),a.toTensor()}for(var s=0;s<r[0];++s){for(var f=0;f<t.shape[1];++f)a.set(t.get(s,f),s,f);for(f=0;f<e.shape[1];++f)a.set(e.get(s,f),s,f+t.shape[1])}return a.toTensor()},t.prototype.neg=function(t){return this.multiply(l.scalar(-1),t)},t.prototype.add=function(t,e){return this.broadcastedBinaryOp(t,e,m.upcastType(t.dtype,e.dtype),function(t,e){return t+e})},t.prototype.subtract=function(t,e){return this.broadcastedBinaryOp(t,e,m.upcastType(t.dtype,e.dtype),function(t,e){return t-e})},t.prototype.pow=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.pow(t,e)})},t.prototype.matMul=function(t,e,r,a){for(var n=r?t.shape[0]:t.shape[1],o=r?t.shape[1]:t.shape[0],i=a?e.shape[0]:e.shape[1],s=t.dataSync(),u=e.dataSync(),f=r?[1,t.strides[0]]:[t.strides[0],1],p=f[0],h=f[1],c=a?[e.strides[0],1]:[1,e.strides[0]],d=c[0],y=c[1],v=o*p,g=i*d,m=new Float32Array(o*i),S=0,M=0;M<v;M+=p)for(var b=0;b<g;b+=d){for(var w=M,T=b,A=0,x=0;x<n;++x)A+=s[w]*u[T],w+=h,T+=y;m[S++]=A}return l.tensor2d(m,[o,i])},t.prototype.multiply=function(t,e){return this.broadcastedBinaryOp(t,e,m.upcastType(t.dtype,e.dtype),function(t,e){return t*e})},t.prototype.realDivide=function(t,e){return this.broadcastedBinaryOp(t,e,"float32",function(t,e){return t/e})},t.prototype.floorDiv=function(t,e){return this.broadcastedBinaryOp(t,e,"int32",function(t,e){return Math.floor(t/e)})},t.prototype.sum=function(t,e){n.assertAxesAreInnerMostDims("sum",e,t.rank);for(var r=n.computeOutAndReduceShapes(t.shape,e),a=r[0],o=r[1],i=m.upcastType(t.dtype,"int32"),s=l.zeros(a,i),u=M.sizeFromShape(o),f=s.dataSync(),p=t.dataSync(),h=0;h<f.length;++h){for(var c=h*u,d=0,y=0;y<u;++y)d+=p[c+y];f[h]=d}return s},t.prototype.argMin=function(t,e){var r=[e];n.assertAxesAreInnerMostDims("argMin",r,t.rank);for(var a=n.computeOutAndReduceShapes(t.shape,r),o=a[0],i=a[1],s=l.zeros(o,"int32"),u=M.sizeFromShape(i),f=s.dataSync(),p=t.dataSync(),h=0;h<f.length;++h){for(var c=h*u,d=p[c],y=0,v=0;v<u;++v){var g=p[c+v];g<d&&(d=g,y=v)}f[h]=y}return s},t.prototype.argMax=function(t,e){var r=[e];n.assertAxesAreInnerMostDims("argMax",r,t.rank);for(var a=n.computeOutAndReduceShapes(t.shape,r),o=a[0],i=a[1],s=l.zeros(o,"int32"),u=M.sizeFromShape(i),f=s.dataSync(),p=t.dataSync(),h=0;h<f.length;++h){for(var c=h*u,d=p[c],y=0,v=0;v<u;++v){var g=p[c+v];g>d&&(d=g,y=v)}f[h]=y}return s},t.prototype.cumsum=function(t,e,r,a){if(e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var n=m.upcastType(t.dtype,"int32"),o=l.zeros(t.shape,n),i=o.dataSync(),s=t.dataSync(),u=t.shape[t.rank-1],f=a?function(t,e){return t+u-e-1}:function(t,e){return t+e},p=0;p<s.length;p+=u)for(var h=0;h<u;h++){var c=f(p,h);if(0===h)i[c]=r?0:s[c];else{var d=f(p,h-1);i[c]=r?s[d]+i[d]:s[c]+i[d]}}return o},t.prototype.equal=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t===e?1:0})},t.prototype.notEqual=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t!==e?1:0})},t.prototype.less=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t<e?1:0})},t.prototype.lessEqual=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t<=e?1:0})},t.prototype.greater=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t>e?1:0})},t.prototype.greaterEqual=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t>=e?1:0})},t.prototype.logicalNot=function(t){for(var e=t.dataSync(),r=new Int32Array(e.length),a=0;a<e.length;++a)r[a]=e[a]?0:1;return v.Tensor.make(t.shape,{values:r},"bool")},t.prototype.logicalAnd=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t&&e})},t.prototype.logicalOr=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t||e})},t.prototype.where=function(t,e,r,a){for(var n=t.dataSync(),o=e.dataSync(),i=r.dataSync(),s=l.zeros(e.shape,a),u=s.dataSync(),f=0,p=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1],h=0;h<n.length;h++)for(var c=0;c<p;c++)1===n[h]?u[f++]=o[h]:u[f++]=i[h];return s},t.prototype.topKValues=function(t,e){return this.topK(t,e).values},t.prototype.topKIndices=function(t,e){return this.topK(t,e).indices},t.prototype.topK=function(t,e){for(var r=t.dataSync(),a=[],n=0;n<r.length;n++)a.push({value:r[n],index:n});a.sort(function(t,e){return e.value-t.value});var o=M.getTypedArrayFromDType(t.dtype,e),i=new Int32Array(e);for(n=0;n<e;n++)o[n]=a[n].value,i[n]=a[n].index;return{values:l.tensor1d(o,t.dtype),indices:l.tensor1d(i,"int32")}},t.prototype.min=function(t,e){n.assertAxesAreInnerMostDims("min",e,t.rank);for(var r=n.computeOutAndReduceShapes(t.shape,e),a=r[0],o=r[1],i=l.zeros(a,t.dtype),s=M.sizeFromShape(o),u=i.dataSync(),f=t.dataSync(),p=0;p<u.length;++p){for(var h=p*s,c=f[0],d=0;d<s;++d){var y=f[h+d];y<c&&(c=y)}u[p]=c}return i},t.prototype.minimum=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.min(t,e)})},t.prototype.mod=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){var r=t%e;return t<0&&e<0||t>=0&&e>=0?r:(r+e)%e})},t.prototype.max=function(t,e){n.assertAxesAreInnerMostDims("max",e,t.rank);for(var r=n.computeOutAndReduceShapes(t.shape,e),a=r[0],o=r[1],i=l.zeros(a,t.dtype),s=M.sizeFromShape(o),u=i.dataSync(),f=t.dataSync(),p=0;p<u.length;++p){for(var h=p*s,c=f[h],d=0;d<s;++d){var y=f[h+d];y>c&&(c=y)}u[p]=c}return i},t.prototype.maximum=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.max(t,e)})},t.prototype.squaredDifference=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){var r=t-e;return r*r})},t.prototype.ceil=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a)r[a]=Math.ceil(e[a]);return v.Tensor.make(t.shape,{values:r})},t.prototype.floor=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a)r[a]=Math.floor(e[a]);return v.Tensor.make(t.shape,{values:r})},t.prototype.sign=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a)e[a]<0?r[a]=-1:e[a]>0?r[a]=1:r[a]=0;return v.Tensor.make(t.shape,{values:r})},t.prototype.round=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a){var n=Math.floor(e[a]);e[a]-n<.5?r[a]=Math.floor(e[a]):e[a]-n>.5?r[a]=Math.ceil(e[a]):r[a]=n%2==0?n:n+1}return v.Tensor.make(t.shape,{values:r})},t.prototype.exp=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a)r[a]=Math.exp(e[a]);return v.Tensor.make(t.shape,{values:r})},t.prototype.expm1=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a)r[a]=Math.expm1(e[a]);return v.Tensor.make(t.shape,{values:r})},t.prototype.log=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a){var n=e[a];r[a]=Math.log(n)}return v.Tensor.make(t.shape,{values:r})},t.prototype.log1p=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a){var n=e[a];r[a]=Math.log1p(n)}return v.Tensor.make(t.shape,{values:r})},t.prototype.sqrt=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a){var n=e[a];r[a]=Math.sqrt(n)}return v.Tensor.make(t.shape,{values:r})},t.prototype.rsqrt=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a){var n=e[a];r[a]=1/Math.sqrt(n)}return v.Tensor.make(t.shape,{values:r})},t.prototype.square=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a){var n=e[a];r[a]=n*n}return v.Tensor.make(t.shape,{values:r})},t.prototype.reciprocal=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),a=0;a<e.length;++a)r[a]=1/e[a];return v.Tensor.make(t.shape,{values:r})},t.prototype.relu=function(t){for(var e=l.zeros(t.shape,t.dtype),r=e.dataSync(),a=t.dataSync(),n=0;n<a.length;++n)r[n]=Math.max(0,a[n]);return e},t.prototype.elu=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a){var n=r[a];e[a]=n>=0?n:Math.exp(n)-1}return v.Tensor.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){for(var r=new Float32Array(e.size),a=e.dataSync(),n=t.dataSync(),o=0;o<a.length;++o){var i=a[o];r[o]=i>=1?n[o]:n[o]*(i+1)}return v.Tensor.make(e.shape,{values:r})},t.prototype.selu=function(t){for(var e=d.SELU_SCALEALPHA,r=d.SELU_SCALE,a=new Float32Array(t.size),n=t.dataSync(),o=0;o<n.length;++o){var i=n[o];a[o]=i>=0?r*i:e*(Math.exp(i)-1)}return v.Tensor.make(t.shape,{values:a})},t.prototype.clip=function(t,e,r){for(var a=new Float32Array(t.size),n=t.dataSync(),o=0;o<n.length;++o)a[o]=Math.min(r,Math.max(e,n[o]));return v.Tensor.make(t.shape,{values:a})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.abs(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.int=function(t){for(var e=new Int32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=r[a];return v.Tensor.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=1/(1+Math.exp(-r[a]));return v.Tensor.make(t.shape,{values:e})},t.prototype.softplus=function(t){for(var e=Math.log(1.1920928955078125e-7)+2,r=new Float32Array(t.size),a=t.dataSync(),n=0;n<a.length;++n){var o=a[n]>-e,i=a[n]<e,s=Math.exp(a[n]),u=void 0;u=i?s:o?a[n]:Math.log(1+s),r[n]=u}return v.Tensor.make(t.shape,{values:r})},t.prototype.sin=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.sin(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.cos=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.cos(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.tan=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.tan(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.asin=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.asin(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.acos=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.acos(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.atan=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.atan(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.atan2(t,e)})},t.prototype.sinh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.sinh(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.cosh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.cosh(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.tanh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=M.tanh(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.asinh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.asinh(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.acosh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.acosh(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.atanh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=0;a<r.length;++a)e[a]=Math.atanh(r[a]);return v.Tensor.make(t.shape,{values:e})},t.prototype.erf=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),a=p.ERF_P,n=p.ERF_A1,o=p.ERF_A2,i=p.ERF_A3,s=p.ERF_A4,u=p.ERF_A5,f=0;f<r.length;++f){var h=r[f],l=1/(1+a*h);e[f]=1-((((u*l+s)*l+i)*l+o)*l+n)*l*Math.exp(-h*h)}return v.Tensor.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0);for(var r=new Float32Array(t.size),a=t.dataSync(),n=0;n<a.length;++n){var o=a[n];isNaN(o)?r[n]=NaN:r[n]=o>0?1:e}return v.Tensor.make(t.shape,{values:r})},t.prototype.conv2d=function(t,e,r){for(var a=r.filterHeight,n=r.filterWidth,o=r.dilationHeight,i=r.dilationWidth,s=r.padInfo.left,u=r.padInfo.top,f=l.buffer(r.outShape,t.dtype),p=0;p<r.batchSize;++p)for(var h=0;h<r.outChannels;++h)for(var c=0;c<r.outHeight;++c)for(var d=c*r.strideHeight-s,y=0;y<r.outWidth;++y){for(var v=y*r.strideWidth-u,g=0,m=0;m<a;m++){var S=d+m*o;if(!(S<0||S>=r.inHeight))for(var M=0;M<n;M++){var b=v+M*i;if(!(b<0||b>=r.inWidth))for(var w=0;w<r.inChannels;++w){g+=t.get(p,S,b,w)*e.get(m,M,w,h)}}}f.set(g,p,c,y,h)}return f.toTensor()},t.prototype.conv2dDerInput=function(t,e,r){for(var a=l.buffer(r.inShape,"float32"),n=a.values,o=a.strides,i=o[0],s=o[1],u=o[2],f=t.dataSync(),p=t.strides,h=p[0],c=p[1],d=p[2],y=e.dataSync(),v=e.strides,g=v[0],m=v[1],S=v[2],M=r.batchSize,b=r.filterHeight,w=r.filterWidth,T=r.inChannels,A=r.inHeight,x=r.inWidth,k=r.outChannels,I=r.outHeight,z=r.outWidth,F=r.strideHeight,H=r.strideWidth,W=b-1-r.padInfo.top,E=w-1-r.padInfo.left,C=0;C<M;++C)for(var B=0;B<T;++B)for(var O=0;O<A;++O)for(var D=O-W,N=Math.max(0,Math.ceil(D/F)),q=Math.min(I,(b+D)/F),_=0;_<x;++_){for(var P=_-E,L=Math.max(0,Math.ceil(P/H)),R=Math.min(z,(w+P)/H),U=0,V=N;V<q;++V)for(var j=V*F-D,K=L;K<R;++K)for(var G=h*C+c*V+d*K,Y=g*(b-1-j)+m*(w-1-(K*H-P))+S*B,J=0;J<k;++J){U+=f[G+J]*y[Y+J]}n[i*C+s*O+u*_+B]=U}return a.toTensor()},t.prototype.conv2dDerFilter=function(t,e,r){for(var a=r.strideHeight,n=r.strideWidth,o=r.filterHeight,i=r.filterWidth,s=l.buffer(r.filterShape,"float32"),u=r.padInfo.left,f=r.padInfo.top,p=0;p<o;++p)for(var h=Math.max(0,Math.ceil((f-p)/a)),c=Math.min(r.outHeight,(r.inHeight+f-p)/a),d=0;d<i;++d)for(var y=Math.max(0,Math.ceil((u-d)/n)),v=Math.min(r.outWidth,(r.inWidth+u-d)/n),g=0;g<r.inChannels;++g)for(var m=0;m<r.outChannels;++m){for(var S=0,M=0;M<r.batchSize;++M)for(var b=h;b<c;++b)for(var w=p+b*a-f,T=y;T<v;++T){var A=d+T*n-u;S+=t.get(M,w,A,g)*e.get(M,b,T,m)}s.set(S,p,d,g,m)}return s.toTensor()},t.prototype.depthwiseConv2D=function(t,e,r){for(var a=r.filterHeight,n=r.filterWidth,o=r.dilationHeight,i=r.dilationWidth,s=r.padInfo.left,u=r.padInfo.top,f=r.outChannels/r.inChannels,p=l.buffer(r.outShape,t.dtype),h=0;h<r.batchSize;++h)for(var c=0;c<r.inChannels;++c)for(var d=0;d<r.outHeight;++d)for(var y=d*r.strideHeight-s,v=0;v<r.outWidth;++v)for(var g=v*r.strideWidth-u,m=0;m<f;++m){for(var S=0,M=0;M<a;++M){var b=y+M*o;if(!(b<0||b>=r.inHeight))for(var w=0;w<n;++w){var T=g+w*i;if(!(T<0||T>=r.inWidth))S+=t.get(h,b,T,c)*e.get(M,w,c,m)}}p.set(S,h,d,v,c*f+m)}return p.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,r){for(var a=l.buffer(r.inShape,"float32"),n=a.values,o=a.strides,i=o[0],s=o[1],u=o[2],f=t.dataSync(),p=t.strides,h=p[0],c=p[1],d=p[2],y=e.dataSync(),v=e.strides,g=v[0],m=v[1],S=v[2],M=r.batchSize,b=r.filterHeight,w=r.filterWidth,T=r.inChannels,A=r.inHeight,x=r.inWidth,k=r.outChannels,I=r.outHeight,z=r.outWidth,F=r.strideHeight,H=r.strideWidth,W=b-1-r.padInfo.top,E=w-1-r.padInfo.left,C=k/T,B=0;B<M;++B)for(var O=0;O<T;++O)for(var D=0;D<A;++D)for(var N=D-W,q=Math.max(0,Math.ceil(N/F)),_=Math.min(I,(b+N)/F),P=0;P<x;++P){for(var L=P-E,R=Math.max(0,Math.ceil(L/H)),U=Math.min(z,(w+L)/H),V=0,j=q;j<_;++j)for(var K=j*F-N,G=R;G<U;++G)for(var Y=h*B+c*j+d*G,J=g*(b-1-K)+m*(w-1-(G*H-L))+S*O,Q=0;Q<C;++Q){V+=f[Y+(O*C+Q)]*y[J+Q]}n[i*B+s*D+u*P+O]=V}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,r){for(var a=r.strideHeight,n=r.strideWidth,o=r.filterHeight,i=r.filterWidth,s=l.buffer(r.filterShape,"float32"),u=r.padInfo.left,f=r.padInfo.top,p=r.outChannels/r.inChannels,h=0;h<o;++h)for(var c=Math.max(0,Math.ceil((f-h)/a)),d=Math.min(r.outHeight,(r.inHeight+f-h)/a),y=0;y<i;++y)for(var v=Math.max(0,Math.ceil((u-y)/n)),g=Math.min(r.outWidth,(r.inWidth+u-y)/n),m=0;m<r.outChannels;++m){for(var S=Math.trunc(m/p),M=m%p,b=0,w=0;w<r.batchSize;++w)for(var T=c;T<d;++T)for(var A=h+T*a-f,x=v;x<g;++x){var k=y+x*n-u;b+=t.get(w,A,k,S)*e.get(w,T,x,m)}s.set(b,h,y,S,M)}return s.toTensor()},t.prototype.tile=function(t,e){for(var r=new Array(t.rank),a=0;a<r.length;a++)r[a]=t.shape[a]*e[a];var n=l.buffer(r,t.dtype),o=t.buffer();for(a=0;a<n.values.length;++a){for(var i=n.indexToLoc(a),s=new Array(t.rank),u=0;u<s.length;u++)s[u]=i[u]%t.shape[u];var f=o.locToIndex(s);n.values[a]=o.values[f]}return n.toTensor()},t.prototype.pad=function(t,e,r){var a=e.map(function(e,r){return e[0]+t.shape[r]+e[1]}),n=e.map(function(t){return t[0]}),o=t.buffer(),i=l.buffer(a,t.dtype);0!==r&&i.values.fill(r);for(var s=0;s<t.size;s++){var u=o.indexToLoc(s),f=u.map(function(t,e){return t+n[e]});i.set.apply(i,[t.get.apply(t,u)].concat(f))}return i.toTensor()},t.prototype.transpose=function(t,e){for(var r=new Array(t.rank),a=0;a<r.length;a++)r[a]=t.shape[e[a]];var n=t.dataSync(),o=(0,h.buffer)(r,t.dtype),i=t.buffer();for(a=0;a<t.size;++a){for(var s=i.indexToLoc(a),u=new Array(s.length),f=0;f<u.length;f++)u[f]=s[e[f]];var p=o.locToIndex(u);o.values[p]=n[a]}return o.toTensor()},t.prototype.gather=function(t,e,r){var a=t.shape.slice(),n=e.dataSync();a[r]=n.length;for(var o=(0,h.buffer)(a,t.dtype),i=t.buffer(),s=0;s<o.size;++s){var u=o.indexToLoc(s),f=u.slice();f[r]=n[u[r]];var p=i.locToIndex(f);o.values[s]=i.values[p]}return o.toTensor()},t.prototype.pool=function(t,e,r){for(var a=e.strideHeight,n=e.strideWidth,o=e.filterHeight,i=e.filterWidth,s=l.buffer(e.outShape,"float32"),u=e.padInfo.top,f=e.padInfo.left,p=0;p<e.batchSize;++p)for(var h=0;h<e.inChannels;++h)for(var c=0;c<e.outHeight;++c)for(var d=c*a-u,y=Math.max(0,d),v=Math.min(e.inHeight,o+d),g=0;g<e.outWidth;++g){for(var m=g*n-f,S=Math.max(0,m),M=Math.min(e.inWidth,i+m),b="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=0,T=0,A=y;A<v;++A){for(var x=S;x<M;++x){var k=t.get(p,A,x,h);"max"===r&&k>b?b=k:"avg"===r&&(w+=k,T++)}if(isNaN(b))break}s.set("avg"===r?w/T:b,p,c,g,h)}return s.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var r=l.buffer(e.outShape,"int32"),a=e.strideHeight,n=e.strideWidth,o=e.filterHeight,i=e.filterWidth,s=e.padInfo.top,u=e.padInfo.left,f=0;f<e.batchSize;++f)for(var p=0;p<e.inChannels;++p)for(var h=0;h<e.outHeight;++h)for(var c=h*a-s,d=Math.max(0,c),y=Math.min(e.inHeight,o+c),v=0;v<e.outWidth;++v){for(var g=v*n-u,m=Math.max(0,g),S=Math.min(e.inWidth,i+g),M=Number.NEGATIVE_INFINITY,b=-1,w=d;w<y;++w)for(var T=w-c,A=m;A<S;++A){var x=A-g,k=t.get(f,w,A,p);k>M&&(M=k,b=T*i+x)}r.set(b,f,h,v,p)}return r.toTensor()},t.prototype.maxPoolBackprop=function(t,e,r,a){for(var n=this.maxPoolPositions(e,a),o=a.strideHeight,i=a.strideWidth,s=a.filterHeight,u=a.filterWidth,f=u-1-a.padInfo.left,p=s-1-a.padInfo.top,h=l.buffer(e.shape,"float32"),c=0;c<a.batchSize;++c)for(var d=0;d<a.inChannels;++d)for(var y=0;y<a.inHeight;++y)for(var v=0;v<a.inWidth;++v){for(var g=y-p,m=v-f,S=0,M=0;M<s;++M){var b=(g+M)/o;if(!(b<0||b>=a.outHeight||Math.floor(b)!==b))for(var w=0;w<u;++w){var T=(m+w)/i;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var A=s*u-1-n.get(c,b,T,d)===M*u+w?1:0;if(0!==A)S+=t.get(c,b,T,d)*A}}}h.set(S,c,y,v,d)}return h.toTensor()},t.prototype.avgPoolBackprop=function(t,e,r){for(var a=r.strideHeight,n=r.strideWidth,o=r.filterHeight,i=r.filterWidth,s=i-1-r.padInfo.left,u=o-1-r.padInfo.top,f=l.buffer(e.shape,"float32"),p=1/(o*i),h=0;h<r.batchSize;++h)for(var c=0;c<r.inChannels;++c)for(var d=0;d<r.inHeight;++d)for(var y=0;y<r.inWidth;++y){for(var v=d-u,g=y-s,m=0,S=0;S<o;++S){var M=(v+S)/a;if(!(M<0||M>=r.outHeight||Math.floor(M)!==M))for(var b=0;b<i;++b){var w=(g+b)/n;if(!(w<0||w>=r.outWidth||Math.floor(w)!==w))m+=t.get(h,M,w,c)}}f.set(m*p,h,d,y,c)}return f.toTensor()},t.prototype.cast=function(t,e){return w.castTensor(t,e,this)},t.prototype.reshape=function(t,e){return w.reshapeTensor(t,e)},t.prototype.avgPool=function(t,e){return this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,r,a){for(var n=t.shape,o=n[0],i=n[1],s=n[2],u=n[3],f=l.buffer([o,e,r,u],t.dtype),p=[a&&e>1?i-1:i,a&&r>1?s-1:s],h=[a&&e>1?e-1:e,a&&r>1?r-1:r],c=0;c<o;c++)for(var d=0;d<e;d++)for(var y=0;y<r;y++)for(var v=0;v<u;v++){var g=p[0]*d/h[0],m=p[1]*y/h[1],S=Math.floor(g),M=Math.min(i-1,Math.ceil(g)),b=Math.floor(m),w=Math.min(s-1,Math.ceil(m)),T=t.get(c,S,b,v),A=t.get(c,M,b,v),x=m-b,k=T+(t.get(c,S,w,v)-T)*x,I=k+(A+(t.get(c,M,w,v)-A)*x-k)*(g-S);f.set(I,c,d,y,v)}return f.toTensor()},t.prototype.resizeBilinearBackprop=function(t,e,r){for(var a=e.shape,n=a[0],o=a[1],i=a[2],s=a[3],u=t.shape,f=u[1],p=u[2],h=l.buffer([n,o,i,s],e.dtype),c=[r&&f>1?o-1:o,r&&p>1?i-1:i],d=[r&&f>1?f-1:f,r&&p>1?p-1:p],y=c[0]/d[0],v=c[1]/d[1],g=0;g<n;g++)for(var m=0;m<f;m++)for(var S=m*y,M=Math.floor(S),b=Math.min(Math.ceil(S),o-1),w=S-M,T=1-w,A=0;A<p;A++)for(var x=A*v,k=Math.floor(x),I=Math.min(Math.ceil(x),i-1),z=x-k,F=1-z,H=0;H<s;H++){var W=t.get(g,m,A,H),E=h.get(g,M,k,H);E+=W*T*F,h.set(E,g,M,k,H);var C=h.get(g,M,I,H);C+=W*T*z,h.set(C,g,M,I,H);var B=h.get(g,b,k,H);B+=W*w*F,h.set(B,g,b,k,H);var O=h.get(g,b,I,H);O+=W*w*z,h.set(O,g,b,I,H)}return h.toTensor()},t.prototype.resizeNearestNeighbor=function(t,e,r,a){for(var n=t.shape,o=n[0],i=n[1],s=n[2],u=n[3],f=l.buffer([o,e,r,u],t.dtype),p=a?[i-1,s-1]:[i,s],h=a?[e-1,r-1]:[e,r],c=0;c<o;c++)for(var d=0;d<e;d++)for(var y=0;y<r;y++)for(var v=0;v<u;v++){var g=p[0]*d/h[0],m=p[1]*y/h[1],S=Math.min(i-1,a?Math.round(g):Math.floor(g)),M=Math.min(s-1,a?Math.round(m):Math.floor(m)),b=t.get(c,S,M,v);f.set(b,c,d,y,v)}return f.toTensor()},t.prototype.batchNormalization=function(t,e,r,a,n,o){for(var i=t.dataSync(),s=e.dataSync(),u=r.dataSync(),f=n?n.dataSync():new Float32Array([1]),p=o?o.dataSync():new Float32Array([0]),l=new Float32Array(i.length),c=0;c<i.length;c++)l[c]=p[c%p.length]+(i[c]-s[c%s.length])*f[c%f.length]/Math.sqrt(u[c%u.length]+a);return(0,h.tensor4d)(l,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,r,a,n){var o=l.buffer(t.shape,"float32"),i=e,s=o.shape[3]-1;function u(e,r,a,n){for(var o=0,u=Math.max(0,n-i);u<=Math.min(n+i,s);u++){var f=t.get(e,r,a,u);o+=f*f}return o}for(var f=0;f<o.shape[0];f++)for(var p=0;p<=o.shape[1];p++)for(var h=0;h<o.shape[2];h++)for(var c=0;c<o.shape[3];c++){var d=u(f,p,h,c),y=t.get(f,p,h,c)*Math.pow(r+a*d,-n);o.set(y,f,p,h,c)}return o.toTensor()},t.prototype.multinomial=function(t,r,a,n){for(var o=r?t:l.softmax(t),i=o.shape[0],s=o.shape[1],u=l.zeros([i,a],"int32"),f=u.dataSync(),p=o.dataSync(),h=0;h<i;++h){var c=h*s,d=new Float32Array(s-1);d[0]=p[c];for(var y=1;y<d.length;++y)d[y]=d[y-1]+p[c+y];for(var v=e.alea(n.toString()),g=h*a,m=0;m<a;++m){var S=v();f[g+m]=d.length;for(var M=0;M<d.length;M++)if(S<d[M]){f[g+m]=M;break}}}return u},t.prototype.oneHot=function(t,e,r,a){var n=new Float32Array(t.size*e);n.fill(a);for(var o=0;o<t.size;++o)n[o*e+t.get(o)]=r;return l.tensor2d(n,[t.size,e])},t.prototype.broadcastedBinaryOp=function(t,e,r,a){for(var n=i.assertAndGetBroadcastShape(t.shape,e.shape),o=l.buffer(n,r),s=t.dataSync(),u=e.dataSync(),f=i.getBroadcastDims(t.shape,n),p=i.getBroadcastDims(e.shape,n),h=t.buffer(),c=e.buffer(),d=function(r){var n=o.indexToLoc(r),i=n.slice(-t.rank);f.forEach(function(t){return i[t]=0});var l=h.locToIndex(i),d=n.slice(-e.rank);p.forEach(function(t){return d[t]=0});var y=c.locToIndex(d);o.values[r]=a(s[l],u[y])},y=0;y<o.values.length;++y)d(y);return o.toTensor()},t.prototype.dispose=function(){},t}();exports.MathBackendCPU=k,r.ENV.registerBackend("cpu",function(){return new k},1);
},{"seedrandom":358,"../environment":95,"../ops/axis_util":312,"../ops/broadcast_util":354,"../ops/concat_util":355,"../ops/erf_util":356,"../ops/ops":119,"../ops/selu_util":357,"../ops/slice_util":314,"../tensor":101,"../types":102,"../util":98,"./backend_util":315}],94:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserUtil=void 0;var e=require("./doc"),r=function(e,r,t,n){var o,i=arguments.length,c=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,r,t,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(c=(i<3?o(c):i>3?o(r,t,c):o(r,t))||c);return i>3&&c&&Object.defineProperty(r,t,c),c},t=function(){function t(){}return t.nextFrame=function(){return new Promise(function(e){return requestAnimationFrame(function(){return e()})})},r([(0,e.doc)({heading:"Performance",subheading:"Timing"})],t,"nextFrame",null),t}();exports.BrowserUtil=t;
},{"./doc":105}],252:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.DTYPE_VALUE_SIZE_MAP={float32:4,int32:4,uint16:2,uint8:1,bool:1};
},{}],216:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encodeWeights=a,exports.decodeWeights=i,exports.concatenateTypedArrays=u,exports.stringByteLength=s,exports.arrayBufferToBase64String=l,exports.base64StringToArrayBuffer=f,exports.concatenateArrayBuffers=c,exports.basename=p,exports.getModelArtifactsInfoForJSON=y;var e=require("../ops/array_ops"),t=require("../util"),r=require("./types"),n=function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function u(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})},o=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};function a(e){return n(this,void 0,void 0,function(){var t,r,n,a;return o(this,function(o){switch(o.label){case 0:for(n in t=[],r=[],e){if("float32"!==(a=e[n]).dtype&&"int32"!==a.dtype&&"bool"!==a.dtype)throw new Error("Unsupported dtype in weight '"+n+"': "+a.dtype);t.push({name:n,shape:a.shape,dtype:a.dtype}),r.push(a.data())}return[4,Promise.all(r)];case 1:return[2,{data:u(o.sent()),specs:t}]}})})}function i(n,o){for(var a={},i=0,u=0,s=o;u<s.length;u++){var l=s[u],f=l.name,c=l.dtype,p=l.shape;if(null!=l.quantization)throw new Error("decodeWeights does not support quantization yet, but encountered weight '"+f+" with quantization.'");var y=(0,t.sizeFromShape)(p),h=void 0;if("float32"===c)h=e.ArrayOps.tensor(new Float32Array(n,i,y),p,"float32");else if("int32"===c)h=e.ArrayOps.tensor(new Int32Array(n,i,y),p,"int32");else{if("bool"!==c)throw new Error("Unsupported dtype in weight '"+f+"': "+c);h=e.ArrayOps.tensor(new Uint8Array(n,i,y),p,"bool")}a[f]=h,i+=y*r.DTYPE_VALUE_SIZE_MAP[c]}return a}function u(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0;e.forEach(function(e){if(e instanceof Float32Array||e instanceof Int32Array)t+=4*e.length;else{if(!(e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name);t+=e.length}});var r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(new Uint8Array(e.buffer),n),e instanceof Float32Array||e instanceof Int32Array?n+=4*e.length:n+=e.length}),r.buffer}function s(e){return new Blob([e]).size}function l(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}function f(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;++n)r.set([t.charCodeAt(n)],n);return r.buffer}function c(e){var t=0;e.forEach(function(e){t+=e.byteLength});var r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(new Uint8Array(e),n),n+=e.byteLength}),r.buffer}function p(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function y(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:s(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:s(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}
},{"../ops/array_ops":295,"../util":98,"./types":252}],218:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t){return e.getHandlers(t,"load")},e.getHandlers=function(e,t){var n=[];return("load"===t?this.getInstance().loadRouters:this.getInstance().saveRouters).forEach(function(t){var r=t(e);null!==r&&n.push(r)}),n},e}();exports.IORouterRegistry=e;
},{}],217:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModelManagement=exports.ModelStoreManagerRegistry=void 0;var e=require("../doc"),n=require("../util"),t=require("./router_registry"),r=function(e,n,t,r){var a,o=arguments.length,s=o<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(s=(o<3?a(s):o>3?a(n,t,s):a(n,t))||s);return o>3&&s&&Object.defineProperty(n,t,s),s},a=function(e,n,t,r){return new(t||(t=Promise))(function(a,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?a(e.value):new t(function(n){n(e.value)}).then(s,i)}l((r=r.apply(e,n||[])).next())})},o=function(e,n){var t,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(a=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[0,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},s="://",i=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,r){(0,n.assert)(null!=t,"scheme must not be undefined or null."),t.endsWith(s)&&(t=t.slice(0,t.indexOf(s))),(0,n.assert)(t.length>0,"scheme must not be an empty string.");var a=e.getInstance();(0,n.assert)(null==a.managers[t],"A model store manager is already registered for scheme '"+t+"'."),a.managers[t]=r},e.getManager=function(e){var n=this.getInstance().managers[e];if(null==n)throw new Error("Cannot find model manager for scheme '"+e+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function l(e){if(-1===e.indexOf(s))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+i.getSchemes().join(","));return{scheme:e.split(s)[0],path:e.split(s)[1]}}function c(e,r,s){return void 0===s&&(s=!1),a(this,void 0,void 0,function(){var a,c,u,d,f,h,g,m,p;return o(this,function(o){switch(o.label){case 0:return(0,n.assert)(e!==r,"Old path and new path are the same: '"+e+"'"),a=t.IORouterRegistry.getLoadHandlers(e),(0,n.assert)(a.length>0,"Copying failed because no load handler is found for source URL "+e+"."),(0,n.assert)(a.length<2,"Copying failed because more than one ("+a.length+") load handlers for source URL "+e+"."),c=a[0],u=t.IORouterRegistry.getSaveHandlers(r),(0,n.assert)(u.length>0,"Copying failed because no save handler is found for destination URL "+r+"."),(0,n.assert)(u.length<2,"Copying failed because more than one ("+a.length+") save handlers for destination URL "+r+"."),d=u[0],f=l(e).scheme,h=l(e).path,g=f===l(e).scheme,[4,c.load()];case 1:return m=o.sent(),s&&g?[4,i.getManager(f).removeModel(h)]:[3,3];case 2:o.sent(),o.label=3;case 3:return[4,d.save(m)];case 4:return p=o.sent(),!s||g?[3,6]:[4,i.getManager(f).removeModel(h)];case 5:o.sent(),o.label=6;case 6:return[2,p.modelArtifactsInfo]}})})}exports.ModelStoreManagerRegistry=i;var u=function(){function n(){}return n.listModels=function(){return a(this,void 0,void 0,function(){var e,n,t,r,a,l,c;return o(this,function(o){switch(o.label){case 0:e=i.getSchemes(),n={},t=0,r=e,o.label=1;case 1:return t<r.length?(a=r[t],[4,i.getManager(a).listModels()]):[3,4];case 2:for(c in l=o.sent())n[a+s+c]=l[c];o.label=3;case 3:return t++,[3,1];case 4:return[2,n]}})})},n.removeModel=function(e){return a(this,void 0,void 0,function(){var n;return o(this,function(t){switch(t.label){case 0:return n=l(e),[4,i.getManager(n.scheme).removeModel(n.path)];case 1:return[2,t.sent()]}})})},n.copyModel=function(e,n){return a(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return!1,[4,c(e,n,!1)];case 1:return[2,t.sent()]}})})},n.moveModel=function(e,n){return a(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return!0,[4,c(e,n,!0)];case 1:return[2,t.sent()]}})})},r([(0,e.doc)({heading:"Models",subheading:"Management",namespace:"io"})],n,"listModels",null),r([(0,e.doc)({heading:"Models",subheading:"Management",namespace:"io"})],n,"removeModel",null),r([(0,e.doc)({heading:"Models",subheading:"Management",namespace:"io"})],n,"copyModel",null),r([(0,e.doc)({heading:"Models",subheading:"Management",namespace:"io"})],n,"moveModel",null),n}();exports.ModelManagement=u;
},{"../doc":105,"../util":98,"./router_registry":218}],212:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserIndexedDBManager=exports.indexedDBRouter=exports.BrowserIndexedDB=void 0,exports.deleteDatabase=l,exports.browserIndexedDB=m;var e=require("../environment"),r=require("./io_utils"),t=require("./model_management"),n=require("./router_registry"),o=function(e,r,t,n){return new(t||(t=Promise))(function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function c(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new t(function(r){r(e.value)}).then(u,c)}s((n=n.apply(e,r||[])).next())})},i=function(e,r){var t,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;u;)try{if(t=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=r.call(e,u)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},u="tensorflowjs",c=1,s="models_store",a="model_info_store";function l(){return o(this,void 0,void 0,function(){var e;return i(this,function(r){return e=d(),[2,new Promise(function(r,t){var n=e.deleteDatabase(u);n.onsuccess=function(){return r()},n.onerror=function(e){return t(e)}})]})})}function d(){if(!e.ENV.get("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function f(e){var r=e.result;r.createObjectStore(s,{keyPath:"modelPath"}),r.createObjectStore(a,{keyPath:"modelPath"})}var h=function(){function e(e){if(this.indexedDB=d(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return o(this,void 0,void 0,function(){return i(this,function(r){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},e.prototype.load=function(){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(e,o){var i=n.indexedDB.open(u,c);i.onupgradeneeded=function(){return f(i)},i.onsuccess=function(){var u=i.result;if(null==t){var c=u.transaction(s,"readonly"),l=c.objectStore(s).get(n.modelPath);l.onsuccess=function(){if(null==l.result)return u.close(),o(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(l.result.modelArtifacts)},l.onerror=function(e){return u.close(),o(l.error)},c.oncomplete=function(){return u.close()}}else{var d,f=(0,r.getModelArtifactsInfoForJSON)(t),h=u.transaction(a,"readwrite"),p=h.objectStore(a),m=p.put({modelPath:n.modelPath,modelArtifactsInfo:f});m.onsuccess=function(){var r=(d=u.transaction(s,"readwrite")).objectStore(s).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:f});r.onsuccess=function(){return e({modelArtifactsInfo:f})},r.onerror=function(e){var t=(p=h.objectStore(a)).delete(n.modelPath);t.onsuccess=function(){return u.close(),o(r.error)},t.onerror=function(e){return u.close(),o(r.error)}}},m.onerror=function(e){return u.close(),o(m.error)},h.oncomplete=function(){null==d?u.close():d.oncomplete=function(){return u.close()}}}},i.onerror=function(e){return o(i.error)}})},e.URL_SCHEME="indexeddb://",e}();exports.BrowserIndexedDB=h;var p=exports.indexedDBRouter=function(r){return e.ENV.get("IS_BROWSER")&&r.startsWith(h.URL_SCHEME)?m(r.slice(h.URL_SCHEME.length)):null};function m(e){return new h(e)}function v(e){return e.startsWith(h.URL_SCHEME)?e.slice(h.URL_SCHEME.length):e}n.IORouterRegistry.registerSaveRouter(p),n.IORouterRegistry.registerLoadRouter(p);var w=function(){function e(){this.indexedDB=d()}return e.prototype.listModels=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(r){return[2,new Promise(function(r,t){var n=e.indexedDB.open(u,c);n.onupgradeneeded=function(){return f(n)},n.onsuccess=function(){var e=n.result,o=e.transaction(a,"readonly"),i=o.objectStore(a).getAll();i.onsuccess=function(){for(var e={},t=0,n=i.result;t<n.length;t++){var o=n[t];e[o.modelPath]=o.modelArtifactsInfo}r(e)},i.onerror=function(r){return e.close(),t(i.error)},o.oncomplete=function(){return e.close()}},n.onerror=function(e){return t(n.error)}})]})})},e.prototype.removeModel=function(e){return o(this,void 0,void 0,function(){var r=this;return i(this,function(t){return e=v(e),[2,new Promise(function(t,n){var o=r.indexedDB.open(u,c);o.onupgradeneeded=function(){return f(o)},o.onsuccess=function(){var r,i=o.result,u=i.transaction(a,"readwrite"),c=u.objectStore(a),l=c.get(e);l.onsuccess=function(){if(null==l.result)return i.close(),n(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var o=c.delete(e),u=function(){var o=(r=i.transaction(s,"readwrite")).objectStore(s).delete(e);o.onsuccess=function(){return t(l.result.modelArtifactsInfo)},o.onerror=function(e){return n(l.error)}};o.onsuccess=u,o.onerror=function(e){return u(),i.close(),n(l.error)}},l.onerror=function(e){return i.close(),n(l.error)},u.oncomplete=function(){null==r?i.close():r.oncomplete=function(){return i.close()}}},o.onerror=function(e){return n(o.error)}})]})})},e}();if(exports.BrowserIndexedDBManager=w,e.ENV.get("IS_BROWSER"))try{t.ModelStoreManagerRegistry.registerManager(h.URL_SCHEME,new w)}catch(e){}
},{"../environment":95,"./io_utils":216,"./model_management":217,"./router_registry":218}],213:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserLocalStorageManager=exports.localStorageRouter=exports.BrowserLocalStorage=void 0,exports.purgeLocalStorageArtifacts=f,exports.browserLocalStorage=m;var e=require("../environment"),t=require("../util"),o=require("./io_utils"),r=require("./model_management"),n=require("./router_registry"),i=function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?n(e.value):new o(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},s=function(e,t){var o,r,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(n=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},a="/",l="tensorflowjs_models",h="info",u="model_topology",c="weight_specs",g="weight_data";function f(){if(!e.ENV.get("IS_BROWSER")||void 0===window.localStorage)throw new Error("purgeLocalStorageModels() cannot proceed because local storage is unavailable in the current environment.");for(var t=window.localStorage,o=[],r=0;r<t.length;++r){var n=t.key(r),i=l+a;if(n.startsWith(i)&&n.length>i.length){t.removeItem(n);var s=w(n);-1===o.indexOf(s)&&o.push(s)}}return o}function p(e){return{info:[l,e,h].join(a),topology:[l,e,u].join(a),weightSpecs:[l,e,c].join(a),weightData:[l,e,g].join(a)}}function w(e){var t=e.split(a);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(a)}function S(e){return e.startsWith(d.URL_SCHEME)?e.slice(d.URL_SCHEME.length):e}var d=function(){function t(t){if(!e.ENV.get("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=p(this.modelPath)}return t.prototype.save=function(e){return i(this,void 0,void 0,function(){var t,r,n,i;return s(this,function(s){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),n=(0,o.getModelArtifactsInfoForJSON)(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(n)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(0,o.arrayBufferToBase64String)(e.weightData)),[2,{modelArtifactsInfo:n}]}catch(e){for(i in this.keys)this.LS.removeItem(this.keys[i]);throw new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+n.modelTopologyBytes+", weightSpecsBytes="+n.weightSpecsBytes+", weightDataBytes="+n.weightDataBytes+".")}return[2]})})},t.prototype.load=function(){return i(this,void 0,void 0,function(){var e,t,r,n,i;return s(this,function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(r=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,null==(n=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=n,null==(i=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=(0,o.base64StringToArrayBuffer)(i),[2,t]})})},t.URL_SCHEME="localstorage://",t}();exports.BrowserLocalStorage=d;var y=exports.localStorageRouter=function(t){return e.ENV.get("IS_BROWSER")&&t.startsWith(d.URL_SCHEME)?m(t.slice(d.URL_SCHEME.length)):null};function m(e){return new d(e)}n.IORouterRegistry.registerSaveRouter(y),n.IORouterRegistry.registerLoadRouter(y);var v=function(){function o(){(0,t.assert)(e.ENV.get("IS_BROWSER"),"Current environment is not a web browser"),(0,t.assert)(void 0!==window.localStorage,"Current browser does not appear to support localStorage"),this.LS=window.localStorage}return o.prototype.listModels=function(){return i(this,void 0,void 0,function(){var e,t,o,r,n,i;return s(this,function(s){for(e={},t=l+a,o=a+h,r=0;r<this.LS.length;++r)(n=this.LS.key(r)).startsWith(t)&&n.endsWith(o)&&(i=w(n),e[i]=JSON.parse(this.LS.getItem(n)));return[2,e]})})},o.prototype.removeModel=function(e){return i(this,void 0,void 0,function(){var t,o;return s(this,function(r){if(e=S(e),t=p(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return o=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,o]})})},o}();if(exports.BrowserLocalStorageManager=v,e.ENV.get("IS_BROWSER"))try{r.ModelStoreManagerRegistry.registerManager(d.URL_SCHEME,new v)}catch(e){}
},{"../environment":95,"../util":98,"./io_utils":216,"./model_management":217,"./router_registry":218}],214:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.browserDownloadsRouter=exports.BrowserDownloads=void 0,exports.browserDownloads=c,exports.browserFiles=h;var e=require("../environment"),t=require("./io_utils"),n=require("./router_registry"),o=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function l(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,l)}s((o=o.apply(e,t||[])).next())})},r=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i="model",a=".json",l=".weights.bin",s=function(){function n(t){if(!e.ENV.get("IS_BROWSER"))throw new Error("triggerDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(n.URL_SCHEME)&&(t=t.slice(n.URL_SCHEME.length)),null!=t&&0!==t.length||(t=i),this.modelTopologyFileName=t+a,this.weightDataFileName=t+l}return n.prototype.save=function(e){return o(this,void 0,void 0,function(){var n,o,i,a,l,s;return r(this,function(r){if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),e.modelTopology instanceof ArrayBuffer)throw new Error("DownloadTrigger.save() does not support saving model topology in binary formats yet.");return o=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,weightsManifest:o},a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(l=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,l.href=a,l.click(),null!=e.weightData&&((s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,s.click()),[2,{modelArtifactsInfo:(0,t.getModelArtifactsInfoForJSON)(e)}]})})},n.URL_SCHEME="downloads://",n}();exports.BrowserDownloads=s;var u=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return o(this,void 0,void 0,function(){var e,n,o=this;return r(this,function(r){return e=this.files[0],n=this.files.slice(1),[2,new Promise(function(r,i){var a=new FileReader;a.onload=function(a){var l=JSON.parse(a.target.result),s=l.modelTopology;if(null!=s){0===n.length&&r({modelTopology:s});var u=l.weightsManifest;if(null!=u){var f;try{f=o.checkManifestAndWeightFiles(u,n)}catch(e){return void i(e)}var c=[],h=[],d=[];u.forEach(function(e){e.paths.forEach(function(e){h.push(e),d.push(null)}),c.push.apply(c,e.weights)}),u.forEach(function(e){e.paths.forEach(function(e){var n=new FileReader;n.onload=function(n){var o=n.target.result,i=h.indexOf(e);d[i]=o,-1===d.indexOf(null)&&r({modelTopology:s,weightSpecs:c,weightData:(0,t.concatenateArrayBuffers)(d)})},n.onerror=function(t){i("Failed to weights data from file of path '"+e+"'.")},n.readAsArrayBuffer(f[e])})})}else i(new Error("weightManifest field is missing from file "+e.name))}else i(new Error("modelTopology field is missing from file "+e.name))},a.onerror=function(t){i("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(e)})]})})},e.prototype.checkManifestAndWeightFiles=function(e,n){for(var o=[],r=n.map(function(e){return(0,t.basename)(e.name)}),i={},a=0,l=e;a<l.length;a++){l[a].paths.forEach(function(e){var a=(0,t.basename)(e);if(-1!==o.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: '"+a+"'");if(o.push(a),-1===r.indexOf(a))throw new Error("Weight file with basename '"+a+"' is not provided.");i[e]=n[r.indexOf(a)]})}if(o.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+o.length+") and the number of weight files provided ("+n.length+").");return i},e}(),f=exports.browserDownloadsRouter=function(t){return e.ENV.get("IS_BROWSER")&&t.startsWith(s.URL_SCHEME)?c(t.slice(s.URL_SCHEME.length)):null};function c(e){return void 0===e&&(e="model"),new s(e)}function h(e){return new u(e)}n.IORouterRegistry.registerSaveRouter(f);
},{"../environment":95,"./io_utils":216,"./router_registry":218}],219:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadWeightsAsArrayBuffer=u,exports.loadWeights=f;var n=require("../ops/ops"),t=require("../util"),e=i(t),r=require("./types");function i(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}var a=function(n,t,e,r){return new(e||(e=Promise))(function(i,a){function o(n){try{f(r.next(n))}catch(n){a(n)}}function u(n){try{f(r.throw(n))}catch(n){a(n)}}function f(n){n.done?i(n.value):new e(function(t){t(n.value)}).then(o,u)}f((r=r.apply(n,t||[])).next())})},o=function(n,t){var e,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(i=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[0,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(n,o)}catch(n){a=[6,n],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};function u(n,t){return a(this,void 0,void 0,function(){var e,r;return o(this,function(i){switch(i.label){case 0:return e=n.map(function(n){return fetch(n,t)}),[4,Promise.all(e)];case 1:return r=i.sent(),[4,Promise.all(r.map(function(n){return n.arrayBuffer()}))];case 2:return[2,i.sent()]}})})}function f(t,i,f,s){return void 0===i&&(i=""),a(this,void 0,void 0,function(){var a,c,l,h,p,y,w,m,d,v;return o(this,function(o){switch(o.label){case 0:if(a=t.map(function(){return!1}),c={},l=null!=f?f.map(function(){return!1}):[],h=[],t.forEach(function(n,t){var i=0;n.weights.forEach(function(n){var o="quantization"in n?n.quantization.dtype:n.dtype,u=r.DTYPE_VALUE_SIZE_MAP[o]*e.sizeFromShape(n.shape),s=function(){a[t]=!0,null==c[t]&&(c[t]=[]),c[t].push({manifestEntry:n,groupOffset:i,sizeBytes:u})};null!=f?f.forEach(function(t,e){t===n.name&&(s(),l[e]=!0)}):s(),h.push(n.name),i+=u})}),!l.every(function(n){return n}))throw p=f.filter(function(n,t){return!l[t]}),new Error("Could not find weights in manifest with names: "+p.join(", ")+". \nManifest JSON has weights with names: "+h.join(", ")+".");return y=a.reduce(function(n,t,e){return t&&n.push(e),n},[]),w=[],y.forEach(function(n){t[n].paths.forEach(function(n){var t=i+(i.endsWith("/")?"":"/")+n;w.push(t)})}),[4,u(w,s)];case 1:return m=o.sent(),d={},v=0,y.forEach(function(e){for(var r=t[e].paths.length,i=0,a=0;a<r;a++)i+=m[v+a].byteLength;for(var o=new ArrayBuffer(i),u=new Uint8Array(o),f=0,s=0;s<r;s++){var l=new Uint8Array(m[v+s]);u.set(l,f),f+=l.byteLength}c[e].forEach(function(t){var e,r=o.slice(t.groupOffset,t.groupOffset+t.sizeBytes),i=t.manifestEntry.dtype;if("quantization"in t.manifestEntry){var a=t.manifestEntry.quantization;if("uint8"!==a.dtype&&"uint16"!==a.dtype)throw new Error("Weight "+t.manifestEntry.name+" has unknown quantization dtype "+a.dtype+".");var u="uint8"===a.dtype?new Uint8Array(r):new Uint16Array(r);if("float32"===i)e=Float32Array.from(u,function(n){return n*a.scale+a.min});else{if("int32"!==i)throw new Error("Weight "+t.manifestEntry.name+" has a dtype not supported by quantization: "+i);e=Int32Array.from(u,function(n){return Math.round(n*a.scale+a.min)})}}else if("float32"===i)e=new Float32Array(r);else{if("int32"!==i)throw new Error("Weight "+t.manifestEntry.name+" has unknown dtype "+i+".");e=new Int32Array(r)}var f=t.manifestEntry.name;if(null!=d[f])throw new Error("Duplicate weight with name "+f+". Please make sure weights names are unique in the manifest JSON.");d[f]=(0,n.tensor)(e,t.manifestEntry.shape,t.manifestEntry.dtype)}),v+=r}),[2,d]}})})}
},{"../ops/ops":119,"../util":98,"./types":252}],215:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.httpRequestRouter=exports.BrowserHTTPRequest=void 0,exports.browserHTTPRequest=l;var e=require("../environment"),t=require("../util"),r=require("./io_utils"),o=require("./router_registry"),n=require("./weights_loader"),s=function(e,t,r,o){return new(r||(r=Promise))(function(n,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function u(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(i,u)}a((o=o.apply(e,t||[])).next())})},i=function(e,t){var r,o,n,s,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=o[2&s[0]?"return":s[0]?"throw":"next"])&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[0,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},u=function(){function o(r,o){if(this.DEFAULT_METHOD="POST",!e.ENV.get("IS_BROWSER"))throw new Error("browserHTTPRequest is not supported outside the web browser.");if((0,t.assert)(null!=r&&r.length>0,"URL path for browserHTTPRequest must not be null, undefined or empty."),this.path=r,null!=o&&null!=o.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=o||{}}return o.prototype.save=function(e){return s(this,void 0,void 0,function(){var t,o,n,s;return i(this,function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,o=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],n={modelTopology:e.modelTopology,weightsManifest:o},t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,fetch(this.path,t)];case 1:if(200===(s=i.sent()).status)return[2,{modelArtifactsInfo:(0,r.getModelArtifactsInfoForJSON)(e),responses:[s]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+s.status+".")}})})},o.prototype.load=function(){return s(this,void 0,void 0,function(){var e,t,o,s,u,a,l,h,p,f,c,d;return i(this,function(i){switch(i.label){case 0:return[4,fetch(this.path,this.requestInit)];case 1:return[4,i.sent().json()];case 2:if(e=i.sent(),t=e.modelTopology,o=e.weightsManifest,null==t&&null==o)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");if(null==o)return[3,4];for(a=e.weightsManifest,s=[],l=0,h=a;l<h.length;l++)p=h[l],s.push.apply(s,p.weights);return(f=this.path.substring(0,this.path.lastIndexOf("/"))).endsWith("/")||(f+="/"),c=[],a.forEach(function(e){e.paths.forEach(function(e){c.push(f+e)})}),d=r.concatenateArrayBuffers,[4,(0,n.loadWeightsAsArrayBuffer)(c,this.requestInit)];case 3:u=d.apply(void 0,[i.sent()]),i.label=4;case 4:return[2,{modelTopology:t,weightSpecs:s,weightData:u}]}})})},o.URL_SCHEMES=["http://","https://"],o}();exports.BrowserHTTPRequest=u;var a=exports.httpRequestRouter=function(t){if(e.ENV.get("IS_BROWSER")){for(var r=0,o=u.URL_SCHEMES;r<o.length;r++){var n=o[r];if(t.startsWith(n))return l(t)}return null}return null};function l(e,t){return new u(e,t)}o.IORouterRegistry.registerSaveRouter(a),o.IORouterRegistry.registerLoadRouter(a);
},{"../environment":95,"../util":98,"./io_utils":216,"./router_registry":218,"./weights_loader":219}],110:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeModel=exports.registerSaveRouter=exports.registerLoadRouter=exports.moveModel=exports.loadWeights=exports.listModels=exports.getSaveHandlers=exports.getModelArtifactsInfoForJSON=exports.getLoadHandlers=exports.encodeWeights=exports.decodeWeights=exports.copyModel=exports.browserHTTPRequest=exports.browserFiles=void 0,require("./indexed_db"),require("./local_storage");var e=require("./browser_files"),r=require("./browser_http"),o=require("./io_utils"),t=require("./model_management"),s=require("./router_registry"),d=require("./weights_loader"),i=s.IORouterRegistry.registerSaveRouter,l=s.IORouterRegistry.registerLoadRouter,a=s.IORouterRegistry.getSaveHandlers,g=s.IORouterRegistry.getLoadHandlers,p=t.ModelManagement.copyModel,x=t.ModelManagement.listModels,u=t.ModelManagement.moveModel,n=t.ModelManagement.removeModel;exports.browserFiles=e.browserFiles,exports.browserHTTPRequest=r.browserHTTPRequest,exports.copyModel=p,exports.decodeWeights=o.decodeWeights,exports.encodeWeights=o.encodeWeights,exports.getLoadHandlers=g,exports.getModelArtifactsInfoForJSON=o.getModelArtifactsInfoForJSON,exports.getSaveHandlers=a,exports.listModels=x,exports.loadWeights=d.loadWeights,exports.moveModel=u,exports.registerLoadRouter=l,exports.registerSaveRouter=i,exports.removeModel=n;
},{"./indexed_db":212,"./local_storage":213,"./browser_files":214,"./browser_http":215,"./io_utils":216,"./model_management":217,"./router_registry":218,"./weights_loader":219}],96:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,n){return new e(n)},e}();exports.Serializable=e;var n=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(e){this.getMap().classNameMap[e.className]=[e,e.fromConfig]},e}();exports.SerializationMap=n;
},{}],97:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEST_EPSILON=exports.ALL_ENVS=exports.CPU_ENVS=exports.WEBGL_ENVS=void 0,exports.expectArraysClose=c,exports.expectPromiseToFail=f,exports.expectArraysEqual=p,exports.expectNumbersClose=u,exports.expectValuesInRange=d;var e=require("./tensor"),r=require("./util"),t=n(r);function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var o=exports.WEBGL_ENVS={BACKEND:"test-webgl"},a=exports.CPU_ENVS={BACKEND:"test-cpu"},s=exports.ALL_ENVS={},i=exports.TEST_EPSILON=.001;function c(r,n,o){if(void 0===o&&(o=i),r instanceof e.Tensor||n instanceof e.Tensor){if(r instanceof e.Tensor&&n instanceof e.Tensor){if(r.dtype!==n.dtype)throw new Error("Arrays are of different type actual: "+r.dtype+" vs expected: "+n.dtype+".");if(!t.arraysEqual(r.shape,n.shape))throw new Error("Arrays are of different shape actual: "+r.shape+" vs expected: "+n.shape+".")}}else{var a=r.constructor.name,s=n.constructor.name;if(a!==s)throw new Error("Arrays are of different type actual: "+a+" vs expected: "+s)}var c,f;if(c=r instanceof e.Tensor?r.dataSync():r,f=n instanceof e.Tensor?n.dataSync():n,c.length!==f.length)throw new Error("Arrays have different lengths actual: "+c.length+" vs expected: "+f.length+".\nActual:   "+c+".\nExpected: "+f+".");for(var p=0;p<f.length;++p){var u=c[p],d=f[p];if(!l(u,Number(d),o))throw new Error("Arrays differ: actual["+p+"] = "+u+", expected["+p+"] = "+d+".\nActual:   "+c+".\nExpected: "+f+".")}}function f(e,r){e().then(function(){return r.fail()},function(){return r()})}function p(e,r){return c(e,r,0)}function u(e,r,t){if(void 0===t&&(t=i),!l(e,r,t))throw new Error("Numbers differ: actual === "+e+", expected === "+r)}function l(e,r,t){return!(!isNaN(e)||!isNaN(r))||!(isNaN(e)||isNaN(r)||Math.abs(e-r)>t)}function d(r,t,n){var o;o=r instanceof e.Tensor?r.dataSync():r;for(var a=0;a<o.length;a++)if(o[a]<t||o[a]>n)throw new Error("Value out of range:"+o[a]+" low: "+t+", high: "+n)}
},{"./tensor":101,"./util":98}],99:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="0.11.6";exports.version=e;
},{}],100:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.webgl_util=exports.gpgpu_util=exports.GPGPUContext=exports.MathBackendWebGL=void 0;var e=require("./kernels/backend_webgl");Object.defineProperty(exports,"MathBackendWebGL",{enumerable:!0,get:function(){return e.MathBackendWebGL}});var t=require("./kernels/webgl/gpgpu_context");Object.defineProperty(exports,"GPGPUContext",{enumerable:!0,get:function(){return t.GPGPUContext}});var r=require("./kernels/webgl/gpgpu_util"),n=o(r),u=require("./kernels/webgl/webgl_util"),l=o(u);function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}exports.gpgpu_util=n,exports.webgl_util=l;
},{"./kernels/webgl/gpgpu_util":207,"./kernels/webgl/webgl_util":208,"./kernels/backend_webgl":108,"./kernels/webgl/gpgpu_context":209}],116:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Optimizer=void 0;var e=require("../doc"),t=require("../globals"),r=require("../serialization"),n=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},o=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return n(o,r),o.prototype.minimize=function(e,t,r){void 0===t&&(t=!1);var n=this.computeGradients(e,r),i=n.value,o=n.grads;return this.applyGradients(o),Object.keys(o).forEach(function(e){return o[e].dispose()}),t?i:(i.dispose(),null)},o.prototype.computeGradients=function(e,r){return(0,t.variableGrads)(e,r)},i([(0,e.doc)({heading:"Training",subheading:"Optimizers"})],o.prototype,"minimize",null),o=i([(0,e.doc)({heading:"Training",subheading:"Classes",namespace:"train"})],o)}(r.Serializable);exports.Optimizer=o;
},{"../doc":105,"../globals":104,"../serialization":96}],111:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdadeltaOptimizer=void 0;var e=require("../environment"),a=require("../globals"),t=require("../ops/ops"),r=require("../serialization"),i=require("./optimizer"),s=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])};return function(a,t){function r(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=function(r){function i(e,i,s){void 0===s&&(s=1e-8);var o=r.call(this)||this;return o.learningRate=e,o.rho=i,o.epsilon=s,o.accumulatedGrads={},o.accumulatedUpdates={},o.c=(0,a.keep)((0,t.scalar)(-e)),o.epsilonScalar=(0,a.keep)((0,t.scalar)(s)),o.rhoScalar=(0,a.keep)((0,t.scalar)(i)),o.oneMinusRho=(0,a.keep)((0,t.scalar)(1-i)),o}return s(i,r),i.prototype.applyGradients=function(r){var i=this,s=function(s){var n=e.ENV.engine.registeredVariables[s];if(null==o.accumulatedGrads[s]){(0,a.tidy)(function(){i.accumulatedGrads[s]=(0,t.zerosLike)(n).variable(!1)})}if(null==o.accumulatedUpdates[s]){(0,a.tidy)(function(){i.accumulatedUpdates[s]=(0,t.zerosLike)(n).variable(!1)})}var u=r[s],c=o.accumulatedGrads[s],l=o.accumulatedUpdates[s];(0,a.tidy)(function(){var e=i.rhoScalar.mul(c).add(i.oneMinusRho.mul(u.square())),a=l.add(i.epsilonScalar).sqrt().div(c.add(i.epsilonScalar).sqrt()).mul(u),t=i.rhoScalar.mul(l).add(i.oneMinusRho.mul(a.square()));i.accumulatedGrads[s].assign(e),i.accumulatedUpdates[s].assign(t);var r=i.c.mul(a).add(n);n.assign(r)})},o=this;for(var n in r)s(n)},i.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilonScalar.dispose(),this.rhoScalar.dispose(),this.oneMinusRho.dispose(),null!=this.accumulatedUpdates&&(Object.keys(this.accumulatedUpdates).forEach(function(a){return e.accumulatedUpdates[a].dispose()}),Object.keys(this.accumulatedGrads).forEach(function(a){return e.accumulatedGrads[a].dispose()}))},i.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},i.fromConfig=function(e,a){return new e(a.learningRate,a.rho,a.epsilon)},i.className="AdadeltaOptimizer",i}(i.Optimizer);exports.AdadeltaOptimizer=o,r.SerializationMap.register(o);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./optimizer":116}],112:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdagradOptimizer=void 0;var t=require("../environment"),e=require("../globals"),r=require("../ops/ops"),i=require("../serialization"),a=require("./optimizer"),n=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),o=function(i){function a(t,a){void 0===a&&(a=.1);var n=i.call(this)||this;return n.learningRate=t,n.initialAccumulatorValue=a,n.accumulatedGrads={},n.c=(0,e.keep)((0,r.scalar)(-t)),n.epsilon=(0,e.keep)((0,r.scalar)(1e-8)),n}return n(a,i),a.prototype.applyGradients=function(i){var a=this,n=function(n){var u=t.ENV.engine.registeredVariables[n];if(null==o.accumulatedGrads[n]){(0,e.tidy)(function(){a.accumulatedGrads[n]=(0,r.fill)(u.shape,a.initialAccumulatorValue).variable(!1)})}var s=i[n],c=o.accumulatedGrads[n];(0,e.tidy)(function(){var t=c.add(s.square());a.accumulatedGrads[n].assign(t);var e=a.c.mul(s.div(t.add(a.epsilon).sqrt())).add(u);u.assign(e)})},o=this;for(var u in i)n(u)},a.prototype.dispose=function(){var t=this;this.epsilon.dispose(),this.c.dispose(),null!=this.accumulatedGrads&&Object.keys(this.accumulatedGrads).forEach(function(e){return t.accumulatedGrads[e].dispose()})},a.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},a.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},a.className="AdagradOptimizer",a}(a.Optimizer);exports.AdagradOptimizer=o,i.SerializationMap.register(o);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./optimizer":116}],113:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdamOptimizer=void 0;var e=require("../environment"),a=require("../globals"),t=require("../ops/ops"),i=require("../serialization"),n=require("./optimizer"),r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])};return function(a,t){function i(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),s=function(i){function n(e,n,r,s){void 0===s&&(s=1e-8);var c=i.call(this)||this;return c.learningRate=e,c.beta1=n,c.beta2=r,c.epsilon=s,c.accumulatedFirstMoment={},c.accumulatedSecondMoment={},c.c=(0,a.keep)((0,t.scalar)(-e)),c.epsScalar=(0,a.keep)((0,t.scalar)(s)),c.beta1Scalar=(0,a.keep)((0,t.scalar)(n)),c.beta2Scalar=(0,a.keep)((0,t.scalar)(r)),(0,a.tidy)(function(){c.accBeta1=(0,t.scalar)(n).variable(),c.accBeta2=(0,t.scalar)(r).variable()}),c.oneMinusBeta1=(0,a.keep)((0,t.scalar)(1-n)),c.oneMinusBeta2=(0,a.keep)((0,t.scalar)(1-r)),c.one=(0,a.keep)((0,t.scalar)(1)),c}return r(n,i),n.prototype.applyGradients=function(i){var n=this;(0,a.tidy)(function(){var a=n.one.sub(n.accBeta1),r=n.one.sub(n.accBeta2);for(var s in i){var c=e.ENV.engine.registeredVariables[s];if(null==n.accumulatedFirstMoment[s]){var o=!1;n.accumulatedFirstMoment[s]=(0,t.zerosLike)(c).variable(o)}if(null==n.accumulatedSecondMoment[s]){o=!1;n.accumulatedSecondMoment[s]=(0,t.zerosLike)(c).variable(o)}var u=i[s],l=n.accumulatedFirstMoment[s],d=n.accumulatedSecondMoment[s],p=n.beta1Scalar.mul(l).add(n.oneMinusBeta1.mul(u)),m=n.beta2Scalar.mul(d).add(n.oneMinusBeta2.mul(u.square())),b=p.div(a),f=m.div(r);n.accumulatedFirstMoment[s].assign(p),n.accumulatedSecondMoment[s].assign(m);var h=n.c.mul(b.div(n.epsScalar.add(f.sqrt()))).add(c);c.assign(h)}n.accBeta1.assign(n.accBeta1.mul(n.beta1Scalar)),n.accBeta2.assign(n.accBeta2.mul(n.beta2Scalar))})},n.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsScalar.dispose(),this.beta1Scalar.dispose(),this.beta2Scalar.dispose(),this.accBeta1.dispose(),this.accBeta2.dispose(),this.oneMinusBeta1.dispose(),this.oneMinusBeta2.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach(function(a){return e.accumulatedFirstMoment[a].dispose()}),null!=this.accumulatedSecondMoment&&Object.keys(this.accumulatedSecondMoment).forEach(function(a){return e.accumulatedSecondMoment[a].dispose()})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},n.fromConfig=function(e,a){return new e(a.learningRate,a.beta1,a.beta2,a.epsilon)},n.className="AdamOptimizer",n}(n.Optimizer);exports.AdamOptimizer=s,i.SerializationMap.register(s);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./optimizer":116}],114:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdamaxOptimizer=void 0;var e=require("../environment"),a=require("../globals"),t=require("../ops/ops"),i=require("../serialization"),r=require("./optimizer"),n=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])};return function(a,t){function i(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),s=function(i){function r(e,r,n,s,o){void 0===s&&(s=1e-8),void 0===o&&(o=0);var c=i.call(this)||this;return c.learningRate=e,c.beta1=r,c.beta2=n,c.epsilon=s,c.decay=o,c.accumulatedFirstMoment={},c.accumulatedWeightedInfNorm={},c.c=(0,a.keep)((0,t.scalar)(-e)),c.epsScalar=(0,a.keep)((0,t.scalar)(s)),c.beta1Scalar=(0,a.keep)((0,t.scalar)(r)),c.beta2Scalar=(0,a.keep)((0,t.scalar)(n)),c.decayScalar=(0,a.keep)((0,t.scalar)(o)),(0,a.tidy)(function(){c.iteration=(0,t.scalar)(0).variable(),c.accBeta1=(0,t.scalar)(r).variable()}),c.oneMinusBeta1=(0,a.keep)((0,t.scalar)(1-r)),c.one=(0,a.keep)((0,t.scalar)(1)),c}return n(r,i),r.prototype.applyGradients=function(i){var r=this;(0,a.tidy)(function(){var a=r.one.sub(r.accBeta1),n=r.c.div(r.one.add(r.decayScalar.mul(r.iteration)));for(var s in i){var o=e.ENV.engine.registeredVariables[s];if(null==r.accumulatedFirstMoment[s]){var c=!1;r.accumulatedFirstMoment[s]=(0,t.zerosLike)(o).variable(c)}if(null==r.accumulatedWeightedInfNorm[s]){c=!1;r.accumulatedWeightedInfNorm[s]=(0,t.zerosLike)(o).variable(c)}var u=i[s],l=r.accumulatedFirstMoment[s],d=r.accumulatedWeightedInfNorm[s],p=r.beta1Scalar.mul(l).add(r.oneMinusBeta1.mul(u)),m=r.beta2Scalar.mul(d),f=u.abs(),h=m.maximum(f);r.accumulatedFirstMoment[s].assign(p),r.accumulatedWeightedInfNorm[s].assign(h);var b=n.div(a).mul(p.div(r.epsScalar.add(h))).add(o);o.assign(b)}r.iteration.assign(r.iteration.add(r.one)),r.accBeta1.assign(r.accBeta1.mul(r.beta1Scalar))})},r.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsScalar.dispose(),this.accBeta1.dispose(),this.beta1Scalar.dispose(),this.beta2Scalar.dispose(),this.oneMinusBeta1.dispose(),this.decayScalar.dispose(),this.iteration.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach(function(a){return e.accumulatedFirstMoment[a].dispose()}),null!=this.accumulatedWeightedInfNorm&&Object.keys(this.accumulatedWeightedInfNorm).forEach(function(a){return e.accumulatedWeightedInfNorm[a].dispose()})},r.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},r.fromConfig=function(e,a){return new e(a.learningRate,a.beta1,a.beta2,a.epsilon,a.decay)},r.className="AdamaxOptimizer",r}(r.Optimizer);exports.AdamaxOptimizer=s,i.SerializationMap.register(s);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./optimizer":116}],118:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SGDOptimizer=void 0;var e=require("../environment"),t=require("../globals"),r=require("../ops/ops"),i=require("../serialization"),n=require("./optimizer"),o=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),a=function(i){function n(e){var t=i.call(this)||this;return t.learningRate=e,t.setLearningRate(e),t}return o(n,i),n.prototype.applyGradients=function(r){var i=this;Object.keys(r).forEach(function(n){var o=r[n],a=e.ENV.engine.registeredVariables[n];(0,t.tidy)(function(){var e=i.c.mul(o).add(a);a.assign(e)})})},n.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=(0,t.keep)((0,r.scalar)(-e))},n.prototype.dispose=function(){this.c.dispose()},n.prototype.getConfig=function(){return{learningRate:this.learningRate}},n.fromConfig=function(e,t){return new e(t.learningRate)},n.className="SGDOptimizer",n}(n.Optimizer);exports.SGDOptimizer=a,i.SerializationMap.register(a);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./optimizer":116}],115:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MomentumOptimizer=void 0;var t=require("../environment"),e=require("../globals"),i=require("../ops/ops"),o=require("../serialization"),n=require("./sgd_optimizer"),r=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),s=function(o){function n(t,e,n){void 0===n&&(n=!1);var r=o.call(this,t)||this;return r.learningRate=t,r.momentum=e,r.useNesterov=n,r.m=(0,i.scalar)(r.momentum),r.accumulations={},r}return r(n,o),n.prototype.applyGradients=function(o){var n=this,r=function(r){var u=t.ENV.engine.registeredVariables[r];if(null==s.accumulations[r]){(0,e.tidy)(function(){n.accumulations[r]=(0,i.zerosLike)(u).variable(!1)})}var a=s.accumulations[r],m=o[r];(0,e.tidy)(function(){var t,e=n.m.mul(a).add(m);t=n.useNesterov?n.c.mul(m.add(e.mul(n.m))).add(u):n.c.mul(e).add(u),n.accumulations[r].assign(e),u.assign(t)})},s=this;for(var u in o)r(u)},n.prototype.dispose=function(){if(o.prototype.dispose.call(this),this.m.dispose(),null!=this.accumulations)for(var t in this.accumulations)this.accumulations[t].dispose()},n.prototype.setMomentum=function(t){this.momentum=t},n.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},n.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},n.className="MomentumOptimizer",n}(n.SGDOptimizer);exports.MomentumOptimizer=s,o.SerializationMap.register(s);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./sgd_optimizer":118}],117:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RMSPropOptimizer=void 0;var e=require("../environment"),a=require("../globals"),t=require("../ops/ops"),n=require("../serialization"),r=require("./optimizer"),s=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])};return function(a,t){function n(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),u=function(n){function r(e,r,s,u,c){void 0===r&&(r=.9),void 0===s&&(s=0),void 0===u&&(u=1e-8),void 0===c&&(c=!1);var i=n.call(this)||this;return i.learningRate=e,i.decay=r,i.momentum=s,i.epsilon=u,i.accumulatedMeanSquares={},i.accumulatedMeanGrads={},i.accumulatedMoments={},i.c=(0,a.keep)((0,t.scalar)(e)),i.epsilonScalar=(0,a.keep)((0,t.scalar)(u)),i.decayScalar=(0,a.keep)((0,t.scalar)(r)),i.momentumScalar=(0,a.keep)((0,t.scalar)(s)),i.oneMinusDecay=(0,a.keep)((0,t.scalar)(1-r)),i.centered=c,i}return s(r,n),r.prototype.applyGradients=function(n){var r=this,s=function(s){var c=e.ENV.engine.registeredVariables[s];if(null==u.accumulatedMeanSquares[s]){(0,a.tidy)(function(){r.accumulatedMeanSquares[s]=(0,t.zerosLike)(c).variable(!1)})}if(null==u.accumulatedMeanGrads[s]&&u.centered){(0,a.tidy)(function(){r.accumulatedMeanGrads[s]=(0,t.zerosLike)(c).variable(!1)})}if(null==u.accumulatedMoments[s]){(0,a.tidy)(function(){r.accumulatedMoments[s]=(0,t.zerosLike)(c).variable(!1)})}var i=u.accumulatedMeanSquares[s],o=u.accumulatedMeanGrads[s],l=u.accumulatedMoments[s],d=n[s];(0,a.tidy)(function(){var e=r.decayScalar.mul(i).add(r.oneMinusDecay.mul(d.square()));if(r.centered){var a=r.decayScalar.mul(o).add(r.oneMinusDecay.mul(d)),t=r.momentumScalar.mul(l).add(r.c.mul(d).div(e.sub(a.square().add(r.epsilonScalar)).sqrt()));r.accumulatedMeanSquares[s].assign(e),r.accumulatedMeanGrads[s].assign(a),r.accumulatedMoments[s].assign(t);var n=c.sub(t);c.assign(n)}else{var u=r.decayScalar.mul(i).add(r.oneMinusDecay.mul(d.square()));t=r.momentumScalar.mul(l).add(r.c.mul(d).div(u.add(r.epsilonScalar).sqrt()));r.accumulatedMeanSquares[s].assign(u),r.accumulatedMoments[s].assign(t);n=c.sub(t);c.assign(n)}})},u=this;for(var c in n)s(c)},r.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilonScalar.dispose(),this.decayScalar.dispose(),this.momentumScalar.dispose(),this.oneMinusDecay.dispose(),null!=this.accumulatedMeanSquares&&Object.keys(this.accumulatedMeanSquares).forEach(function(a){return e.accumulatedMeanSquares[a].dispose()}),null!=this.accumulatedMeanGrads&&this.centered&&Object.keys(this.accumulatedMeanGrads).forEach(function(a){return e.accumulatedMeanGrads[a].dispose()}),null!=this.accumulatedMoments&&Object.keys(this.accumulatedMoments).forEach(function(a){return e.accumulatedMoments[a].dispose()})},r.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},r.fromConfig=function(e,a){return new e(a.learningRate,a.decay,a.momentum,a.epsilon,a.centered)},r.className="RMSPropOptimizer",r}(r.Optimizer);exports.RMSPropOptimizer=u,n.SerializationMap.register(u);
},{"../environment":95,"../globals":104,"../ops/ops":119,"../serialization":96,"./optimizer":116}],279:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OptimizerConstructors=void 0;var e=require("../doc"),i=require("./adadelta_optimizer"),r=require("./adagrad_optimizer"),n=require("./adam_optimizer"),a=require("./adamax_optimizer"),t=require("./momentum_optimizer"),d=require("./rmsprop_optimizer"),o=require("./sgd_optimizer"),m=function(e,i,r,n){var a,t=arguments.length,d=t<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,i,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(d=(t<3?a(d):t>3?a(i,r,d):a(i,r))||d);return t>3&&d&&Object.defineProperty(i,r,d),d},u=function(){function u(){}return u.sgd=function(e){return new o.SGDOptimizer(e)},u.momentum=function(e,i,r){return void 0===r&&(r=!1),new t.MomentumOptimizer(e,i,r)},u.rmsprop=function(e,i,r,n,a){return void 0===i&&(i=.9),void 0===r&&(r=0),void 0===n&&(n=1e-8),void 0===a&&(a=!1),new d.RMSPropOptimizer(e,i,r,n,a)},u.adam=function(e,i,r,a){return void 0===e&&(e=.001),void 0===i&&(i=.9),void 0===r&&(r=.999),void 0===a&&(a=1e-8),new n.AdamOptimizer(e,i,r,a)},u.adadelta=function(e,r,n){return void 0===e&&(e=.001),void 0===r&&(r=.95),void 0===n&&(n=1e-8),new i.AdadeltaOptimizer(e,r,n)},u.adamax=function(e,i,r,n,t){return void 0===e&&(e=.002),void 0===i&&(i=.9),void 0===r&&(r=.999),void 0===n&&(n=1e-8),void 0===t&&(t=0),new a.AdamaxOptimizer(e,i,r,n,t)},u.adagrad=function(e,i){return void 0===i&&(i=.1),new r.AdagradOptimizer(e,i)},m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"sgd",null),m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"momentum",null),m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"rmsprop",null),m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"adam",null),m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"adadelta",null),m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"adamax",null),m([(0,e.doc)({heading:"Training",subheading:"Optimizers",namespace:"train"})],u,"adagrad",null),u}();exports.OptimizerConstructors=u;
},{"../doc":105,"./adadelta_optimizer":111,"./adagrad_optimizer":112,"./adam_optimizer":113,"./adamax_optimizer":114,"./momentum_optimizer":115,"./rmsprop_optimizer":117,"./sgd_optimizer":118}],103:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.train=void 0;var r=require("./optimizers/adadelta_optimizer"),i=require("./optimizers/adagrad_optimizer"),e=require("./optimizers/adam_optimizer"),t=require("./optimizers/adamax_optimizer"),m=require("./optimizers/momentum_optimizer"),o=require("./optimizers/optimizer_constructors"),a=require("./optimizers/rmsprop_optimizer"),p=require("./optimizers/sgd_optimizer");m.MomentumOptimizer,p.SGDOptimizer,r.AdadeltaOptimizer,i.AdagradOptimizer,a.RMSPropOptimizer,t.AdamaxOptimizer,e.AdamOptimizer;var s=exports.train={sgd:o.OptimizerConstructors.sgd,momentum:o.OptimizerConstructors.momentum,adadelta:o.OptimizerConstructors.adadelta,adagrad:o.OptimizerConstructors.adagrad,rmsprop:o.OptimizerConstructors.rmsprop,adamax:o.OptimizerConstructors.adamax,adam:o.OptimizerConstructors.adam};
},{"./optimizers/adadelta_optimizer":111,"./optimizers/adagrad_optimizer":112,"./optimizers/adam_optimizer":113,"./optimizers/adamax_optimizer":114,"./optimizers/momentum_optimizer":115,"./optimizers/optimizer_constructors":279,"./optimizers/rmsprop_optimizer":117,"./optimizers/sgd_optimizer":118}],49:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.webgl=exports.util=exports.test_util=exports.serialization=exports.io=exports.environment=exports.nextFrame=exports.doc=exports.version_core=exports.memory=exports.disposeVariables=exports.getBackend=exports.setBackend=exports.Environment=exports.ENV=exports.Reduction=exports.Rank=exports.Variable=exports.variable=exports.TensorBuffer=exports.Tensor=exports.SGDOptimizer=exports.RMSPropOptimizer=exports.Optimizer=exports.MomentumOptimizer=exports.AdamaxOptimizer=exports.AdamOptimizer=exports.AdagradOptimizer=exports.AdadeltaOptimizer=void 0;var e=require("./optimizers/adadelta_optimizer");Object.defineProperty(exports,"AdadeltaOptimizer",{enumerable:!0,get:function(){return e.AdadeltaOptimizer}});var r=require("./optimizers/adagrad_optimizer");Object.defineProperty(exports,"AdagradOptimizer",{enumerable:!0,get:function(){return r.AdagradOptimizer}});var t=require("./optimizers/adam_optimizer");Object.defineProperty(exports,"AdamOptimizer",{enumerable:!0,get:function(){return t.AdamOptimizer}});var i=require("./optimizers/adamax_optimizer");Object.defineProperty(exports,"AdamaxOptimizer",{enumerable:!0,get:function(){return i.AdamaxOptimizer}});var o=require("./optimizers/momentum_optimizer");Object.defineProperty(exports,"MomentumOptimizer",{enumerable:!0,get:function(){return o.MomentumOptimizer}});var n=require("./optimizers/optimizer");Object.defineProperty(exports,"Optimizer",{enumerable:!0,get:function(){return n.Optimizer}});var p=require("./optimizers/rmsprop_optimizer");Object.defineProperty(exports,"RMSPropOptimizer",{enumerable:!0,get:function(){return p.RMSPropOptimizer}});var s=require("./optimizers/sgd_optimizer");Object.defineProperty(exports,"SGDOptimizer",{enumerable:!0,get:function(){return s.SGDOptimizer}});var a=require("./tensor");Object.defineProperty(exports,"Tensor",{enumerable:!0,get:function(){return a.Tensor}}),Object.defineProperty(exports,"TensorBuffer",{enumerable:!0,get:function(){return a.TensorBuffer}}),Object.defineProperty(exports,"variable",{enumerable:!0,get:function(){return a.variable}}),Object.defineProperty(exports,"Variable",{enumerable:!0,get:function(){return a.Variable}});var u=require("./types");Object.defineProperty(exports,"Rank",{enumerable:!0,get:function(){return u.Rank}});var m=require("./ops/ops");Object.keys(m).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return m[e]}})});var d=require("./ops/loss_ops");Object.defineProperty(exports,"Reduction",{enumerable:!0,get:function(){return d.Reduction}});var c=require("./train");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}})});var x=require("./globals");Object.keys(x).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return x[e]}})});var l=require("./environment");Object.defineProperty(exports,"ENV",{enumerable:!0,get:function(){return l.ENV}}),Object.defineProperty(exports,"Environment",{enumerable:!0,get:function(){return l.Environment}});var b=require("./doc");Object.defineProperty(exports,"doc",{enumerable:!0,get:function(){return b.doc}}),require("./kernels/backend_webgl"),require("./kernels/backend_cpu");var f=require("./browser_util"),O=M(l),z=require("./io/io"),v=M(z),g=require("./serialization"),y=M(g),_=require("./test_util"),j=M(_),q=require("./util"),P=M(q),k=require("./version"),E=require("./webgl"),A=M(E);function M(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var B=exports.setBackend=l.Environment.setBackend,R=exports.getBackend=l.Environment.getBackend,V=exports.disposeVariables=l.Environment.disposeVariables,w=exports.memory=l.Environment.memory;exports.version_core=k.version;var S=exports.nextFrame=f.BrowserUtil.nextFrame;exports.environment=O,exports.io=v,exports.serialization=y,exports.test_util=j,exports.util=P,exports.webgl=A;
},{"./kernels/backend_webgl":108,"./kernels/backend_cpu":109,"./browser_util":94,"./environment":95,"./io/io":110,"./serialization":96,"./test_util":97,"./util":98,"./version":99,"./webgl":100,"./optimizers/adadelta_optimizer":111,"./optimizers/adagrad_optimizer":112,"./optimizers/adam_optimizer":113,"./optimizers/adamax_optimizer":114,"./optimizers/momentum_optimizer":115,"./optimizers/optimizer":116,"./optimizers/rmsprop_optimizer":117,"./optimizers/sgd_optimizer":118,"./tensor":101,"./types":102,"./ops/ops":119,"./ops/loss_ops":120,"./train":103,"./globals":104,"./doc":105}],200:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])};return function(r,o){function e(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),r=function(r){function o(t){var e=r.call(this,t)||this;return Object.setPrototypeOf(e,o.prototype),e}return t(o,r),o}(Error);exports.AttributeError=r;var o=function(r){function o(t){var e=r.call(this,t)||this;return Object.setPrototypeOf(e,o.prototype),e}return t(o,r),o}(Error);exports.RuntimeError=o;var e=function(r){function o(t){var e=r.call(this,t)||this;return Object.setPrototypeOf(e,o.prototype),e}return t(o,r),o}(Error);exports.ValueError=e;var n=function(r){function o(t){var e=r.call(this,t)||this;return Object.setPrototypeOf(e,o.prototype),e}return t(o,r),o}(Error);exports.NotImplementedError=n;var u=function(r){function o(t){var e=r.call(this,t)||this;return Object.setPrototypeOf(e,o.prototype),e}return t(o,r),o}(Error);exports.AssertionError=u;var c=function(r){function o(t){var e=r.call(this,t)||this;return Object.setPrototypeOf(e,o.prototype),e}return t(o,r),o}(Error);exports.IndexError=c;
},{}],198:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pyListRepeat=n,exports.assert=t,exports.count=o,exports.singletonOrArray=i,exports.toList=a,exports.objectListUid=s,exports.isArrayOfShapes=u,exports.normalizeShapeList=l,exports.toSnakeCase=f,exports.toCamelCase=c,exports.serializeKerasObject=g,exports.deserializeKerasObject=h,exports.getExactlyOneTensor=v,exports.getExactlyOneShape=y,exports.numberCompare=w,exports.reverseNumberCompare=x,exports.stringToDType=d,exports.stringsEqual=O,exports.unique=A,exports.isObjectEmpty=b,exports.checkStringTypeUnionValue=m;var r=require("../errors"),e=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r};function n(r,e){if(Array.isArray(r)){for(var n=[],t=0;t<e;t++)n=n.concat(r);return n}return(n=new Array(e)).fill(r),n}function t(e,n){if(!e)throw new r.AssertionError(n)}function o(r,e){for(var n=0,t=0,o=r;t<o.length;t++){o[t]===e&&n++}return n}function i(r){return 1===r.length?r[0]:r}function a(r){return Array.isArray(r)?r:[r]}function s(e){for(var n="",t=0,o=a(e);t<o.length;t++){var i=o[t];if(null==i.id)throw new r.ValueError("Object "+i+" passed to objectListUid without an id");""!==n&&(n+=", "),n+=Math.abs(i.id)}return n}function u(r){return Array.isArray(r)&&Array.isArray(r[0])}function l(r){return 0===r.length?[]:Array.isArray(r[0])?r:[r]}function f(r){var e=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function c(r){return r.length<=1?r:-1===r.indexOf("_")?r:r.replace(/[_]+(\w|$)/g,function(r,e){return e.toUpperCase()})}var p={};function g(r){return null==r?null:{className:r.getClassName(),config:r.getConfig()}}function h(n,t,o,i){if(void 0===t&&(t={}),void 0===o&&(o={}),void 0===i&&(i="object"),"string"==typeof n){var a=n,s=void 0;if(a in o)s=o[a];else if(a in p)s=p[a];else if(null==(s=t[a]))throw new r.ValueError("Unknown "+i+": "+n);return s}var u=n;if(null==u.className||null==u.config)throw new r.ValueError(i+": Improper config format: "+JSON.stringify(u)+".\n'className' and 'config' must set.");var l=u.className,f=void 0,c=void 0;if(l in o?(f=(E=o.get(l))[0],c=E[1]):l in p?(f=(V=p.className)[0],c=V[1]):l in t&&(f=(C=t[l])[0],c=C[1]),null==f)throw new r.ValueError("Unknown "+i+": "+l);if(null!=c){for(var g={},h=0,v=Object.keys(p);h<v.length;h++){g[A=v[h]]=p[A]}for(var y=0,w=Object.keys(o);y<w.length;y++){g[A=w[y]]=o[A]}u.config.customObjects=g;for(var x=e({},p),d=0,O=Object.keys(o);d<O.length;d++){var A=O[d];p[A]=o[A]}var b=c(f,u.config);return p=e({},x),b}x=e({},p);for(var m=0,j=Object.keys(o);m<j.length;m++){A=j[m];p[A]=o[A]}var E,V,C;b=new f(u.config);return p=e({},x),b}function v(e){var n;if(Array.isArray(e)){if(1!==e.length)throw new r.ValueError("Expected Tensor length to be 1; got "+e.length);n=e[0]}else n=e;return n}function y(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new r.ValueError("Expected exactly 1 Shape; got "+e.length)}return e}function w(r,e){return r<e?-1:r>e?1:0}function x(r,e){return-1*w(r,e)}function d(e){switch(e){case"float32":return"float32";default:throw new r.ValueError("Invalid dtype: "+e)}}function O(r,e){if(null==r||null==e)return r===e;if(r.length!==e.length)return!1;for(var n=0;n<r.length;++n)if(r[n]!==e[n])return!1;return!0}function A(r){if(null==r)return r;for(var e=[],n=0,t=r;n<t.length;n++){var o=t[n];-1===e.indexOf(o)&&e.push(o)}return e}function b(e){if(null==e)throw new r.ValueError("Invalid value in obj: "+JSON.stringify(e));for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function m(e,n,t){if(null!=t&&e.indexOf(t)<0)throw new r.ValueError(t+" is not a valid "+n+".  Valid values are "+e+" or null/undefined.")}
},{"../errors":200}],199:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VALID_POOL_MODE_VALUES=exports.VALID_PADDING_MODE_VALUES=exports.VALID_DATA_FORMAT_VALUES=void 0,exports.checkDataFormat=o,exports.checkPaddingMode=a,exports.checkPoolMode=i,exports.nameScope=u,exports.getScopedTensorName=A,exports.getUniqueTensorName=D,exports.isValidTensorName=d;var e=require("./utils/generic_utils"),r=new Map,t=exports.VALID_DATA_FORMAT_VALUES=["channelsFirst","channelsLast"];function o(r){(0,e.checkStringTypeUnionValue)(t,"DataFormat",r)}var n=exports.VALID_PADDING_MODE_VALUES=["valid","same","causal"];function a(r){(0,e.checkStringTypeUnionValue)(n,"PaddingMode",r)}var s=exports.VALID_POOL_MODE_VALUES=["max","avg"];function i(r){(0,e.checkStringTypeUnionValue)(s,"PoolMode",r)}var c=[],p="/";function u(e,r){c.push(e);try{var t=r();return c.pop(),t}catch(e){throw c.pop(),e}}function _(){return 0===c.length?"":c.join(p)+p}function A(e){if(!d(e))throw new Error("Not a valid tensor name: '"+e+"'");return _()+e}function D(e){if(!d(e))throw new Error("Not a valid tensor name: '"+e+"'");r.has(e)||r.set(e,0);var t=r.get(e);if(r.set(e,r.get(e)+1),t>0){var o=e+"_"+t;return r.set(o,1),o}return e}var l=new RegExp(/^[A-Za-z][A-Za-z0-9\._\/]*$/);function d(e){return!!e.match(l)}
},{"./utils/generic_utils":198}],310:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isInteger=o,exports.arrayProd=u,exports.min=i,exports.max=s,exports.sum=c,exports.mean=l,exports.variance=f,exports.median=p,exports.range=d;var r=require("@tensorflow/tfjs-core"),n=e(r),t=require("../errors");function e(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t]);return n.default=r,n}function o(r){return r===parseInt(r.toString(),10)}function u(r,n,t){null==n&&(n=0),null==t&&(t=r.length);for(var e=1,o=n;o<t;++o)e*=r[o];return e}function a(n){return n=Array.isArray(n)?new Float32Array(n):n,(0,r.tensor1d)(n)}function i(r){return n.min(a(r)).dataSync()[0]}function s(r){return n.max(a(r)).dataSync()[0]}function c(r){return n.sum(a(r)).dataSync()[0]}function l(r){return c(r)/r.length}function f(t){var e=n.sub(a(t),(0,r.scalar)(l(t)));return n.sum(n.mulStrict(e,e)).dataSync()[0]/t.length}function p(r){var n=r.slice().sort(function(r,n){return r-n}),t=Math.floor((n.length-1)/2),e=Math.ceil((n.length-1)/2);return t===e?n[t]:(n[t]+n[e])/2}function d(r,n){if(n<r)throw new t.ValueError("end ("+n+") < begin ("+r+") is forbidden.");for(var e=[],o=r;o<n;++o)e.push(o);return e}
},{"@tensorflow/tfjs-core":49,"../errors":200}],92:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SymbolicTensor=void 0,exports.getNextUniqueTensorId=n;var e=require("@tensorflow/tfjs-core"),t=require("./common"),r=function(e,t,r,o){var n,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(s<3?n(i):s>3?n(t,r,i):n(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},o=0;function n(){return o++}var s=function(){function o(e,r,o,s,i,c,l){this.dtype=e,this.shape=r,this.sourceLayer=o,this.inputs=s,this.callArgs=i,this.outputTensorIndex=l,this.id=n(),null!=c&&(this.originalName=(0,t.getScopedTensorName)(c),this.name=(0,t.getUniqueTensorName)(this.originalName)),this.rank=r.length}return o=r([(0,e.doc)({heading:"Models",subheading:"Classes"})],o)}();exports.SymbolicTensor=s;
},{"@tensorflow/tfjs-core":49,"./common":199}],349:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LayerVariable=void 0,exports.variable=d,exports.zerosVariable=p,exports.zerosLike=c,exports.onesVariable=f,exports.onesLike=m,exports.eyeVariable=h,exports.randomUniformVariable=v,exports.truncatedNormalVariable=b,exports.randomNormalVariable=w,exports.update=x,exports.updateAdd=y,exports.updateSub=N,exports.batchGetValue=V,exports.batchSetValue=g;var e=require("@tensorflow/tfjs-core"),r=a(e),t=require("./backend/tfjs_backend"),n=require("./common"),o=require("./errors"),i=require("./types");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var s="Variable",u=function(){function e(e,t,o,a,u){void 0===t&&(t="float32"),void 0===o&&(o=s),void 0===a&&(a=!0),void 0===u&&(u=null),this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=(0,i.getNextUniqueTensorId)(),o=null==o?s:o,this.originalName=(0,n.getScopedTensorName)(o),this.name=(0,n.getUniqueTensorName)(this.originalName),this.trainable=a,this.constraint=u,this.val=r.variable(e,this.trainable,this.name,this.dtype)}return e.prototype.read=function(){return this.val},e.prototype.write=function(e){return l(this.val,e),this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val)),this},e}();function l(e,r){if(e.shape.toString()!==r.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(r.shape))}function d(e,r,t,n){return new u(e,r,t,!0,n)}function p(e,t,n){return new u(r.zeros(e),t,n)}function c(e,t,n){return new u(r.zerosLike(e),t,n)}function f(e,t,n){var o=r.ones(e);return new u(o,t,n)}function m(e,t,n){var o=r.onesLike(e);return new u(o,t,n)}function h(e,t,n){return new u(r.eye(e),t,n)}function v(e,t,n,o,i,a){return void 0===a&&(a="randomUniform"),new u(r.randomUniform(e,t,n,o),o,a)}function b(e,t,n,i,a,s){if(void 0===t&&(t=0),void 0===n&&(n=1),void 0===s&&(s="truncatedNormal"),"bool"===i)throw new o.NotImplementedError("randomNormal does not support dType bool.");return new u(r.truncatedNormal(e,t,n,i,a),i,s)}function w(e,r,n,i,a,s){if(void 0===r&&(r=0),void 0===n&&(n=1),void 0===s&&(s="randomNormal"),"bool"===i)throw new o.NotImplementedError("randomNormalVariable does not support dType bool.");return new u((0,t.randomNormal)(e,r,n,i,a),i,s)}function x(e,r){return e.write(r)}function y(e,t){return e.write(r.add(e.read(),t))}function N(e,t){return e.write(r.sub(e.read(),t))}function V(e){return e.map(function(e){return e.read()})}function g(e){e.map(function(e){e[0].write(e[1])})}exports.LayerVariable=u;
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./common":199,"./errors":200,"./types":92}],350:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.epsilon=t,exports.setEpsilon=n,exports.imageDataFormat=r;var e=1e-7;function t(){return e}function n(t){e=t}function r(){return"channelsLast"}
},{}],197:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.epsilon=void 0,exports.disposeScalarCache=l,exports.setBackend=d,exports.getBackend=h,exports.getScalar=m,exports.isBackendSymbolic=w,exports.shape=k,exports.intShape=y,exports.dtype=v,exports.countParams=g,exports.cast=b,exports.expandDims=A,exports.repeat=E,exports.flatten=V,exports.batchFlatten=q,exports.sliceAlongFirstAxis=M,exports.sliceAlongLastAxis=F,exports.sliceAlongAxis=N,exports.concatenate=S,exports.concatAlongFirstAxis=L,exports.tile=T,exports.identity=I,exports.eyeVariable=P,exports.scalarTimesArray=D,exports.scalarPlusArray=B,exports.randomNormal=O,exports.dot=_,exports.sign=U,exports.qr=j,exports.oneHot=z,exports.gather=G,exports.square=H,exports.pow=C,exports.biasAdd=J,exports.elu=K,exports.softsign=Q,exports.dropout=R,exports.nameScope=W,exports.floatx=X,exports.getUid=Z,exports.hardSigmoid=$,exports.inTrainPhase=ee,exports.gradients=re;var e=require("@tensorflow/tfjs-core"),r=u(e),t=require("../common"),n=require("../errors"),a=require("../utils/math_utils"),o=u(a),s=require("../variables"),i=require("./common");function u(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var c="webgl",p="float32";function l(){for(var e in f)for(var r in f[e])f[e][r].dispose(),delete f[e][r]}function d(e){r.setBackend(e),c=e,l()}function h(){return c}var f={float32:{},int32:{}};function m(t,n){return void 0===n&&(n=p),null==f[n][t]&&(f[n][t]=(0,e.scalar)(t,n),r.keep(f[n][t])),f[n][t]}var x=exports.epsilon=i.epsilon;function w(){return!1}function k(e){return e.shape}function y(e){return e.shape}function v(r){return r instanceof e.Tensor?p:r.dtype}function g(e){var r=e.shape;return r.length>0?r.reduce(function(e,r){return e*r}):1}function b(e,r){return e.asType(r)}function A(e,r){void 0===r&&(r=-1);var t=k(e).slice();return r<0&&(r=t.length+r+1),t.splice(r,0,1),e.reshape(t)}function E(r,t){return(0,e.tidy)(function(){if(2!==r.shape.length)throw new n.ValueError("repeat() expects a rank-2 tensor, but received a rank-"+r.shape.length+" tensor.");return T(A(r,1),[1,t,1])})}function V(e){var r=[o.arrayProd(e.shape)];return e.reshape(r)}function q(e){if(e.rank<=1)throw new n.ValueError("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var r=[e.shape[0],o.arrayProd(e.shape,1)];return e.reshape(r)}function M(t,a,o){return(0,e.tidy)(function(){switch(t.rank){case 1:return r.slice1d(t,a,o);case 2:return r.slice2d(t,[a,0],[o,t.shape[1]]);case 3:return r.slice3d(t,[a,0,0],[o,t.shape[1],t.shape[2]]);case 4:return r.slice4d(t,[a,0,0,0],[o,t.shape[1],t.shape[2],t.shape[3]]);default:throw new n.ValueError("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function F(t,a,o){return(0,e.tidy)(function(){switch(t.rank){case 1:return r.slice1d(t,a,o);case 2:return r.slice2d(t,[0,a],[t.shape[0],o]);case 3:return r.slice3d(t,[0,0,a],[t.shape[0],t.shape[1],o]);case 4:return r.slice4d(t,[0,0,0,a],[t.shape[0],t.shape[1],t.shape[2],o]);default:throw new n.ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function N(t,a,o,s){return(0,e.tidy)(function(){switch(t.rank){case 1:return r.slice1d(t,a,o);case 2:switch(s){case 1:return M(t,a,o);case 2:return F(t,a,o);default:throw new n.ValueError("The axis is not within the rank of the tensor "+s)}case 3:switch(s){case 1:return M(t,a,o);case 2:return r.slice3d(t,[0,a,0],[t.shape[0],o,t.shape[2]]);case 3:return F(t,a,o);default:throw new n.ValueError("The axis is not within the rank of the tensor "+s)}case 4:switch(s){case 1:return M(t,a,o);case 2:return r.slice4d(t,[0,a,0,0],[t.shape[0],o,t.shape[2],t.shape[3]]);case 3:return r.slice4d(t,[0,0,a,0],[t.shape[0],t.shape[1],o,t.shape[3]]);case 4:return F(t,a,o);default:throw new n.ValueError("The axis is not within the rank of the tensor "+s)}default:throw new n.ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function S(e,t){var n;return void 0===t&&(t=-1),t<0&&(t=0!==(n=e[0].rank)?n:0),t===e[0].rank&&(t=-1),r.concat(e,t)}function L(e,t){switch(e.rank){case 1:return r.concat1d([e,t]);case 2:return r.concat2d([e,t],0);case 3:return r.concat3d([e,t],0);case 4:return r.concat4d([e,t],0);default:throw new n.ValueError("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function T(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new n.ValueError("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return r.tile(e,t)}function I(e){return e.clone()}function P(e,t,n){return new s.LayerVariable(r.eye(e,e,null,t),t,n)}function D(e,t){return r.mul(e,t)}function B(e,t){return r.add(e,t)}function O(e,t,n,a,o){return void 0===t&&(t=0),void 0===n&&(n=1),r.randomNormal(e,t,n,a,o)}function _(e,t){if(2!==t.rank)throw new n.NotImplementedError("dot support for y other than rank 2 is not yet implemented: y shape = "+k);if(2===e.rank)return r.matMul(e,t);if(3===e.rank){var a=e.shape[0],o=e.shape[1],s=e.shape[2];return e=e.reshape([a*o,s]),r.matMul(e,t).reshape([a,o,t.shape[1]])}throw new n.NotImplementedError("dot support for x of rank "+e.rank+" is not yet implemented: x shape = "+k)}function U(t){return(0,e.tidy)(function(){var n=(0,e.zerosLike)(t),a=(0,e.onesLike)(t);return(0,e.where)(r.equal(t,n),n,(0,e.where)(r.greater(t,(0,e.zerosLike)(t)),a,D(m(-1),a)))})}function j(t){var a=(0,e.tidy)(function(){if(2!==t.shape.length)throw new n.ValueError("qr() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");if(t.shape[0]<t.shape[1])throw new n.ValueError("qr() requires x.shape[0] >= x.shape[1], but got shape: ["+t.shape+"]");for(var a=t.shape[0],o=t.shape[1],s=r.eye(a),i=t.clone(),u=(0,e.tensor2d)([[1]],[1,1]),c=u.clone(),p=function(t){var n,p=i,l=c,d=s;n=(0,e.tidy)(function(){var e=i.slice([t,t],[a-t,1]),n=r.norm(e),p=i.slice([t,t],[1,1]),l=r.neg(U(p)),d=p.sub(r.mul(l,n)),h=r.div(e,d);c=1===h.shape[0]?u.clone():u.concat(h.slice([1,0],[h.shape[0]-1,h.shape[1]]),0);var f=r.neg(r.div(r.matMul(l,d),n)),m=i.slice([t,0],[a-t,o]),x=f.mul(c);i=0===t?m.sub(x.matMul(c.transpose().matMul(m))):i.slice([0,0],[t,o]).concat(m.sub(x.matMul(c.transpose().matMul(m))),0);var w=s.slice([0,t],[a,s.shape[1]-t]);return s=0===t?w.sub(w.matMul(c).matMul(x.transpose())):s.slice([0,0],[a,t]).concat(w.sub(w.matMul(c).matMul(x.transpose())),1),[c,i,s]}),c=n[0],i=n[1],s=n[2],(0,e.dispose)([p,l,d])},l=0;l<o;++l)p(l);return[s,i]});return[a[0],a[1]]}function z(t,n){return(0,e.tidy)(function(){if(1!==t.rank)throw new Error("Only 1D one-hot tensors are supported in the deeplearn backend, at present.");return t=t.toInt(),r.oneHot(t,n).toFloat()})}function G(t,n,a){return(0,e.tidy)(function(){return n=Array.isArray(n)?(0,e.tensor1d)(n,"int32"):n.toInt(),r.gather(t,n,a)})}function H(e){return r.mulStrict(e,e)}function C(t,a){return(0,e.tidy)(function(){if("number"==typeof a&&(a=(0,e.scalar)(Math.round(a),"int32")),"int32"!==a.dtype)throw new n.NotImplementedError("Non-int32 dtype ("+a.dtype+") is not supported by pow() yet");return r.pow(t,a)})}function J(r,a,o){return(0,e.tidy)(function(){if(null==o&&(o=(0,i.imageDataFormat)()),(0,t.checkDataFormat)(o),1!==a.rank&&a.rank!==r.rank)throw new n.ValueError("Unexpected bias dimensions: "+a.rank+"; expected it to be 1 or "+r.rank);var e,s=a.shape;if(5===r.rank)"channelsFirst"===o?e=1===s.length?r.add(a.reshape([1,s[0],1,1,1])):r.add(a.reshape([1,s[3],s[0],s[1],s[2]])):"channelsLast"===o&&(e=1===s.length?r.add(a.reshape([1,1,1,1,s[0]])):r.add(a.reshape([1].concat(s))));else if(4===r.rank)"channelsFirst"===o?e=1===s.length?r.add(a.reshape([1,s[0],1,1])):r.add(a.reshape([1,s[2],s[0],s[1]])):"channelsLast"===o&&(e=1===s.length?r.add(a.reshape([1,1,1,s[0]])):r.add(a.reshape([1].concat(s))));else if(3===r.rank)"channelsFirst"===o?e=1===s.length?r.add(a.reshape([1,s[0],1])):r.add(a.reshape([1,s[1],s[0]])):"channelsLast"===o&&(e=1===s.length?r.add(a.reshape([1,1,s[0]])):r.add(a.reshape([1].concat(s))));else{if(!(r.rank<3))throw new n.ValueError("Unsupported input rank by biasAdd: "+r.rank);e=r.add(a)}return e})}function K(e,t){if(void 0===t&&(t=1),1!==t)throw new n.NotImplementedError("Support for alpha values other than 1 ("+t+") is not implemented yet.");return r.elu(e)}function Q(t){return(0,e.tidy)(function(){return r.div(t,r.add(m(1),r.abs(t)))})}function R(t,a,o,s){return(0,e.tidy)(function(){if(null!=o&&!e.util.arraysEqual(t.shape,o))throw new n.NotImplementedError("Non-default noise shape is not implemented yet: "+JSON.stringify(o));if(null!=s)throw new n.NotImplementedError("seed is not implemented for dropout yet.");var i=r.step(r.add(r.neg(a),r.randomUniform(t.shape,0,1,"float32")));return i=r.mul(r.div(m(1),r.sub(m(1),a)),i),r.mul(t,i)})}function W(e,r){return(0,t.nameScope)(e,r)}function X(){return"float32"}var Y={};function Z(e){return void 0===e&&(e=""),e in Y||(Y[e]=0),Y[e]+=1,e+Y[e].toString()}function $(t){return(0,e.tidy)(function(){var e=B(m(.5),D(m(.2),t));return r.clipByValue(e,0,1)})}function ee(e,r,t){return void 0===t&&(t=!1),t?e():r()}function re(r,t){var n=t.map(function(e){return e.read()}),a=(0,e.variableGrads)(r,n);return t.map(function(e){return a.grads[e.name]})}
},{"@tensorflow/tfjs-core":49,"../common":199,"../errors":200,"../utils/math_utils":310,"../variables":349,"./common":350}],264:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP=exports.MinMaxNorm=exports.NonNeg=exports.UnitNorm=exports.MaxNorm=exports.Constraint=void 0,exports.serializeConstraint=d,exports.deserializeConstraint=y,exports.getConstraint=N;var t=require("@tensorflow/tfjs-core"),e=i(t),a=require("./backend/tfjs_backend"),r=i(a),n=require("./utils/generic_utils");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}var o=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function r(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),l=function(t,e,a,r){var n,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,a,r);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(o=(i<3?n(o):i>3?n(e,a,o):n(e,a))||o);return i>3&&o&&Object.defineProperty(e,a,o),o};function u(a,n){return(0,t.tidy)(function(){return e.sqrt(e.sum(r.square(a),n,!0))})}var s=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return o(a,e),a.prototype.getConfig=function(){return{}},a=l([(0,t.doc)({heading:"Constraints",subheading:"Classes",namespace:"constraints"})],a)}(t.serialization.Serializable);exports.Constraint=s;var c=function(a){function n(t){var e=a.call(this)||this;return e.defaultMaxValue=2,e.defaultAxis=0,e.maxValue=null!=t.maxValue?t.maxValue:e.defaultMaxValue,e.axis=null!=t.axis?t.axis:e.defaultAxis,e}return o(n,a),n.prototype.apply=function(a){var n=this;return(0,t.tidy)(function(){var t=u(a,n.axis),i=e.clipByValue(t,0,n.maxValue);return e.mul(a,e.div(i,r.scalarPlusArray(r.getScalar(r.epsilon()),t)))})},n.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},n.className="MaxNorm",n}(s);exports.MaxNorm=c,t.serialization.SerializationMap.register(c);var p=function(a){function n(t){var e=a.call(this)||this;return e.defaultAxis=0,e.axis=null!=t.axis?t.axis:e.defaultAxis,e}return o(n,a),n.prototype.apply=function(a){var n=this;return(0,t.tidy)(function(){return e.div(a,r.scalarPlusArray(r.getScalar(r.epsilon()),u(a,n.axis)))})},n.prototype.getConfig=function(){return{axis:this.axis}},n.className="UnitNorm",n}(s);exports.UnitNorm=p,t.serialization.SerializationMap.register(p);var f=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return o(a,t),a.prototype.apply=function(t){return e.relu(t)},a.className="NonNeg",a}(s);exports.NonNeg=f,t.serialization.SerializationMap.register(f);var x=function(a){function n(t){var e=a.call(this)||this;return e.defaultMinValue=0,e.defaultMaxValue=1,e.defaultRate=1,e.defaultAxis=0,e.minValue=null!=t.minValue?t.minValue:e.defaultMinValue,e.maxValue=null!=t.maxValue?t.maxValue:e.defaultMaxValue,e.rate=null!=t.rate?t.rate:e.defaultRate,e.axis=null!=t.axis?t.axis:e.defaultAxis,e}return o(n,a),n.prototype.apply=function(a){var n=this;return(0,t.tidy)(function(){var t=u(a,n.axis),i=e.add(r.scalarTimesArray(r.getScalar(n.rate),e.clipByValue(t,n.minValue,n.maxValue)),r.scalarTimesArray(r.getScalar(1-n.rate),t));return e.mul(a,e.div(i,r.scalarPlusArray(r.getScalar(r.epsilon()),t)))})},n.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},n.className="MinMaxNorm",n}(s);exports.MinMaxNorm=x,t.serialization.SerializationMap.register(x);var m=exports.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function d(t){return(0,n.serializeKerasObject)(t)}function y(e,a){return void 0===a&&(a={}),(0,n.deserializeKerasObject)(e,t.serialization.SerializationMap.getMap().classNameMap,a,"constraint")}function N(t){return null==t?null:"string"==typeof t?y({className:t in m?m[t]:t,config:{}}):t instanceof s?t:y(t)}
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./utils/generic_utils":198}],202:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deserialize=i;var e=require("@tensorflow/tfjs-core"),r=require("../utils/generic_utils");function i(i,t){return void 0===t&&(t={}),(0,r.deserializeKerasObject)(i,e.serialization.SerializationMap.getMap().classNameMap,t,"layer")}
},{"@tensorflow/tfjs-core":49,"../utils/generic_utils":198}],203:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertPythonicToTs=o,exports.convertTsToPythonic=u;var e=require("../utils/generic_utils"),r=t(e);function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function n(e,r,t){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===r&&"string"==typeof t}function o(e,t){if(null===e)return null;if("string"==typeof e)return r.toCamelCase(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var u=[],a=e.length,s=0;s<a;++s){var f=e[s];n(t,s,f)?u.push(f):u.push(o(f,t))}return u}for(var i={},l=0,p=Object.keys(e);l<p.length;l++){var y=p[l],c=e[y];if("name"===y&&"string"==typeof c)i[y]=c;else{var v=r.toCamelCase(y);i[v]=o(c,v)}}return i}function u(e,t){if(null==e)return null;if("string"==typeof e)return r.toSnakeCase(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var o=[],a=e.length,s=0;s<a;++s){var f=e[s];n(t,s,f)?o.push(f):o.push(u(f,t))}return o}for(var i={},l=0,p=Object.keys(e);l<p.length;l++){var y=p[l],c=e[y],v=r.toSnakeCase(y);i[v]="name"!==y&&"className"!==y||"string"!=typeof c?u(c,y):c}return i}
},{"../utils/generic_utils":198}],93:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="0.6.6";exports.version=e;
},{}],201:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Container=exports.InputLayer=exports.Layer=exports.Node=exports.InputSpec=void 0,exports.Input=I,exports.getSourceInputs=S,exports.loadWeightsFromNamedTensorMap=T,exports.loadWeightsFromJson=_;var e=require("@tensorflow/tfjs-core"),t=require("../backend/tfjs_backend"),n=h(t),r=require("../errors"),a=require("../layers/serialization"),i=require("../types"),o=require("../utils/generic_utils"),s=h(o),u=require("../utils/serialization_utils"),l=require("../variables"),p=require("../version");function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var d=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},f=function(){return function(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}();exports.InputSpec=f;var y=0,g=function(){function e(e,t){this.callArgs=t,this.id=y++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(var n=0,r=e.inboundLayers;n<r.length;n++){var a=r[n];null!=a&&a.outboundNodes.push(this)}e.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var e=[],t=0,n=this.inboundLayers;t<n.length;t++){var r=n[t];null!=r?e.push(r.name):e.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}();exports.Node=g;var b=0,m=function(t){function a(e){var r=t.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=b++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var a=e.name;if(!a){var i=r.getClassName();a=s.toSnakeCase(i)+"_"+n.getUid(i)}if(r.name=a,r.trainable=null==e.trainable||e.trainable,r.updatable=null==e.updatable||e.updatable,null!=e.inputShape||null!=e.batchInputShape){var o=void 0;if(null!=e.batchInputShape)o=e.batchInputShape;else if(null!=e.inputShape){var u=null;null!=e.batchSize&&(u=e.batchSize),o=[u].concat(e.inputShape)}r.batchInputShape=o;var l=e.dtype;null==l&&(l=e.inputDType),null==l&&(l=n.floatx()),r.dtype=l}return null!=e.weights?r.initialWeights=e.weights:r.initialWeights=null,r}return d(a,t),a.nodeKey=function(e,t){return e.name+"_ib-"+t.toString()},a.prototype.getNodeAtIndex=function(e,t){if(0===this.inboundNodes.length)throw new r.RuntimeError("The layer has never been called and thus has no defined "+t+".");if(this.inboundNodes.length<=e)throw new r.ValueError("Asked to get "+t+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},a.prototype.getInputAt=function(e){return s.singletonOrArray(this.getNodeAtIndex(e,"input").inputTensors)},a.prototype.getOutputAt=function(e){return s.singletonOrArray(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(a.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new r.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new r.AttributeError("Layer "+this.name+" is not connected, no input to return.");return s.singletonOrArray(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new r.AttributeError("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new r.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return s.singletonOrArray(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),a.prototype.calculateLosses=function(){return this.losses.map(function(e){return e()})},Object.defineProperty(a.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"trainableWeights",{get:function(){return this.trainable?this._trainableWeights:[]},set:function(e){this._trainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._nonTrainableWeights:this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),a.prototype.assertInputCompatibility=function(e){if(e=s.toList(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=s.toList(this.inputSpec);if(e.length!==t.length)throw new r.ValueError("Layer "+this.name+" expects "+t.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(var a=0;a<e.length;a++){var i=e[a],o=t[a];if(null!=o){var u=i.rank;if(null!=o.ndim&&u!==o.ndim)throw new r.ValueError("Input "+a+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+u);if(null!=o.maxNDim&&u>o.maxNDim)throw new r.ValueError("Input "+a+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+u);if(null!=o.minNDim&&u<o.minNDim)throw new r.ValueError("Input "+a+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+u+".");if(null!=o.dtype&&n.dtype(i)!==o.dtype){var l=n.dtype(i);throw new r.ValueError("Input "+a+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+l+".")}if(o.axes){var p=n.intShape(i);for(var h in o.axes){var d=Number(h),c=o.axes[h],f=d>=0?p[d]:p[p.length+d];if(null!=c&&-1===[c,null].indexOf(f))throw new r.ValueError("Input "+a+" is incompatible with layer "+this.name+": expected axis "+d+" of input shape to have value "+c+" but got shape "+p+".")}}if(null!=o.shape){p=n.intShape(i);for(var y=0;y<o.shape.length;++y){var g=o.shape[y],b=p[y];if(null!=g&&null!=b&&g!==b)throw new r.ValueError("Input "+a+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape=${xShape}.")}}}}}},a.prototype.call=function(e,t){return e},a.prototype.invokeCallHook=function(e,t){null!=this._callHook&&this._callHook(e,t)},a.prototype.setCallHook=function(e){this._callHook=e},a.prototype.clearCallHook=function(){this._callHook=null},a.prototype.apply=function(e,t){var a=this;t=t||{};for(var o=s.toList(e),u=!0,l=0,p=o;l<p.length;l++){if(!(p[l]instanceof i.SymbolicTensor)){u=!1;break}}for(var h=!0,d=0,c=o;d<c.length;d++){if(c[d]instanceof i.SymbolicTensor){h=!1;break}}if(u===h)throw new r.ValueError("Arguments to apply() must be all SymbolicTensors or all Tensors");return n.nameScope(this.name,function(){if(!a.built){a.assertInputCompatibility(e);for(var u=[],l=0,p=s.toList(e);l<p.length;l++){var d=p[l];u.push(n.intShape(d))}a.build(s.singletonOrArray(u)),a.built=!0,a.initialWeights&&a.setWeights(a.initialWeights)}if(a.assertInputCompatibility(e),h){for(var c=a.call(e,t),f=[],y=0,g=s.toList(c);y<g.length;y++){var b=g[y];-1!==o.indexOf(b)&&(b=n.identity(b)),f.push(b)}if(c=s.singletonOrArray(f),null!=a.activityRegularizer)throw new r.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}var m=v(e),L=a.computeOutputShape(m),I=(c=void 0,w(e));if(c=null!=L&&L.length>0&&Array.isArray(L[0])?L.map(function(n,r){return new i.SymbolicTensor(I,n,a,s.toList(e),t,a.name,r)}):new i.SymbolicTensor(I,L,a,s.toList(e),t,a.name),a.addInboundNode(e,c,null,null,m,L,t),null!=a.activityRegularizer)throw new r.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c})},a.prototype.build=function(e){this.built=!0},a.prototype.getWeights=function(e){return void 0===e&&(e=!1),(0,l.batchGetValue)(e?this.trainableWeights:this.weights)},a.prototype.setWeights=function(t){var n=this;(0,e.tidy)(function(){var a=n.weights;if(a.length!==t.length)throw new r.ValueError('You called setWeights(weights) on layer "'+n.name+'" with a weight list of length '+t.length+", but the layer was expecting "+a.length+" weights. Provided weights: "+t+"...");if(0!==a.length){for(var i=[],o=(0,l.batchGetValue)(a),s=0;s<o.length;++s){var u=o[s],p=a[s],h=t[s];if(!e.util.arraysEqual(u.shape,h.shape))throw new r.ValueError("Layer weight shape "+u.shape+" not compatible with provided weight shape "+h.shape);i.push([p,h])}(0,l.batchSetValue)(i)}})},a.prototype.addWeight=function(e,t,a,i,o,s,u){if(-1!==this._addedWeightNames.indexOf(e))throw new r.ValueError("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),null==a&&(a=n.floatx());var p=new l.LayerVariable(i.apply(t,a),a,e,s,u);return null!=o&&this.addLoss(function(){return o.apply(p.read())}),null==s&&(s=!0),s?this._trainableWeights.push(p):this._nonTrainableWeights.push(p),p},a.prototype.addLoss=function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=s.toList(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,e))},a.prototype.computeOutputShape=function(e){return e},a.prototype.computeMask=function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer "+this.name+" does not support masking,but was passed an inputMask.");t.forEach(function(e){if(null!=e)throw new TypeError("Layer "+n.name+" does not support masking,but was passed an inputMask.")})}return null}return t},a.prototype.addInboundNode=function(e,t,n,r,a,i,o){void 0===o&&(o=null);var u=s.toList(e);t=s.toList(t),n=s.toList(n),r=s.toList(r),a=s.normalizeShapeList(a),i=s.normalizeShapeList(i);for(var l=[],p=[],h=[],d=0,c=u;d<c.length;d++){var f=c[d];l.push(f.sourceLayer),p.push(f.nodeIndex),h.push(f.tensorIndex)}new g({outboundLayer:this,inboundLayers:l,nodeIndices:p,tensorIndices:h,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var y=0;y<t.length;y++)t[y].sourceLayer=this,t[y].nodeIndex=this.inboundNodes.length-1,t[y].tensorIndex=y},a.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e},c([(0,e.doc)({heading:"Models",subheading:"Classes"})],a.prototype,"apply",null),a=c([(0,e.doc)({heading:"Layers",subheading:"Classes",namespace:"layers"})],a)}(e.serialization.Serializable);function v(e){for(var t=[],r=0,a=e=s.toList(e);r<a.length;r++){var i=a[r];t.push(n.intShape(i))}return s.singletonOrArray(t)}function w(e){return"float32"}exports.Layer=m;var L=function(e){function t(t){var a=e.call(this,{dtype:t.dtype,name:null!=t.name?t.name:n.getUid("input").toString()})||this;if(null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),a.trainable=!1,a.built=!0,a.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new r.ValueError("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var o=t.batchInputShape;if(null==o){if(null==t.inputShape)throw new r.ValueError("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");o=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new r.ValueError("Cannot specify batchSize if batchInputShape isspecified when creating an InputLayer.");var s=t.dtype||n.floatx();a.batchInputShape=o,a.dtype=s,a.inputSpec=[{shape:o}];var u=new i.SymbolicTensor(a.dtype,a.batchInputShape,a,[],{},a.name);return u.nodeIndex=0,u.tensorIndex=0,new g({outboundLayer:a,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[u],outputTensors:[u],inputMasks:[null],outputMasks:[null],inputShapes:[o],outputShapes:[o]}),a}return d(t,e),t.prototype.apply=function(e,t){throw new r.ValueError("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(m);function I(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new r.ValueError("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var a=e.dtype;return null==a&&(a=n.floatx()),new L({batchInputShape:t,name:e.name,dtype:a,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}exports.InputLayer=L,e.serialization.SerializationMap.register(L);var N=function(t){function i(e){var a=t.call(this,{})||this;if(a.containerNodes=new Set,a.name=e.name,null==a.name){var o=a.getClassName().toLowerCase();a.name=n.getUid(o)}if(a.supportsMasking=!1,a.trainable=!0,a.updatable=!0,Array.isArray(e.inputs)?a.inputs=e.inputs.slice():a.inputs=[e.inputs],Array.isArray(e.outputs)?a.outputs=e.outputs.slice():a.outputs=[e.outputs],s.unique(a.inputs).length!==a.inputs.length)throw new r.ValueError("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+a.inputs.map(function(e){return e.name}));s.unique(a.outputs).length!==a.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+a.outputs.map(function(e){return e.name})),a.inputLayers=[],a.inputLayersNodeIndices=[],a.inputLayersTensorIndices=[],a.outputLayers=[],a.outputLayersNodeIndices=[],a.outputLayersTensorIndices=[],a.layers=[];for(var u=0,l=a.outputs;u<l.length;u++){var p=(E=l[u]).sourceLayer,h=E.nodeIndex,d=E.tensorIndex;a.outputLayers.push(p),a.outputLayersNodeIndices.push(h),a.outputLayersTensorIndices.push(d)}for(var c=0,f=a.inputs;c<f.length;c++){p=(E=f[c]).sourceLayer,h=E.nodeIndex,d=E.tensorIndex;s.assert(0===h,"input layer has >1 nodes"),s.assert(0===d,"input layer has >1 tensors"),a.inputLayers.push(p),a.inputLayersNodeIndices.push(h),a.inputLayersTensorIndices.push(d)}a.inputNames=[],a.outputNames=[],a.feedInputShapes=[],a.feedInputNames=[],a.feedOutputNames=[];for(var y=0;y<a.inputLayers.length;y++){if(!((p=a.inputLayers[y])instanceof L))throw new TypeError("Input layers to a Model must be InputLayer objects. Received inputs: "+e.inputs+". Input "+y+" (0-based) originates from layer type "+p.getClassName()+".");a.inputNames.push(p.name),a.feedInputShapes.push(p.batchInputShape),a.feedInputNames.push(p.name)}for(var b=0,m=a.outputLayers;b<m.length;b++){p=m[b];a.outputNames.push(p.name)}a.internalInputShapes=a.inputs.map(function(e){return e.shape}),a.internalOutputShapes=a.outputs.map(function(e){return e.shape});for(var v={},w={},I={},N={},S={},x=[],O=function(e,t,n,o,s,u){null!=o&&null!=s&&null!=u||(o=e.sourceLayer,s=e.nodeIndex,u=e.tensorIndex);var l=o.inboundNodes[s];if(-1!==n.indexOf(l))throw new r.RuntimeError("The tensor "+e.name+' at layer "'+o.name+'" is part of a cycle.');if(-1===t.indexOf(l)){a.containerNodes.add(i.nodeKey(o,s)),o.id in S||(S[o.id]=Object.keys(S).length),-1===n.indexOf(l)&&n.push(l);for(var p=l.inboundLayers.length,h=0;h<p;h++){var d=l.inputTensors[h],c=l.inboundLayers[h],f=l.nodeIndices[h],y=l.tensorIndices[h];O(d,t,n,c,f,y)}for(t.push(l);n.indexOf(l)>=0;)n.splice(n.indexOf(l),1);x.push(l)}},T=[],_=[],k=0,A=a.outputs;k<A.length;k++){var E=A[k];O(E,T,_)}for(var W=0,C=x.slice().reverse();W<C.length;W++){w[(te=C[W]).id]=te,te.id in v||(v[te.id]=0);var V=v[te.id],j=null==I[te.outboundLayer.id]?0:I[te.outboundLayer.id];V=Math.max(V,j),I[te.outboundLayer.id]=V,N[te.outboundLayer.id]=te.outboundLayer,v[te.id]=V;for(y=0;y<te.inboundLayers.length;y++){var M=te.inboundLayers[y],z=(h=te.nodeIndices[y],M.inboundNodes[h]),P=null==v[z.id]?0:v[z.id];v[z.id]=Math.max(V+1,P),w[z.id]=z}}var D={};for(var R in v){(V=v[R])in D||(D[V]=[]),D[V].push(w[R])}var q={};for(var K in I){(V=I[K])in q||(q[V]=[]),q[V].push(N[K])}var H=Object.keys(q).map(function(e){return parseInt(e,10)}).sort(s.reverseNumberCompare);a.layers=[];for(var J=0,B=H;J<B.length;J++){var G=q[V=B[J]];G.sort(function(e,t){var n=S[e.id],r=S[t.id];return n<r?-1:n>r?1:0});for(var U=0,F=G;U<F.length;U++){p=F[U];a.layers.push(p)}}a.layersByDepth=q,H=Object.keys(D).map(function(e){return parseInt(e,10)}).sort(s.reverseNumberCompare);for(var Y=a.inputs.slice(),$=[],Q=0,X=H;Q<X.length;Q++)for(var Z=0,ee=D[V=X[Q]];Z<ee.length;Z++){var te;if(null!=(p=(te=ee[Z]).outboundLayer)){for(var ne=0,re=te.inputTensors;ne<re.length;ne++){E=re[ne];if(-1===Y.indexOf(E))throw new r.RuntimeError("Graph disconnected: cannot obtain value for tensor "+E+' at layer "'+p.name+'". The following previous layers were accessed without issue: '+$)}for(var ae=0,ie=te.outputTensors;ae<ie.length;ae++){E=ie[ae];Y.push(E)}$.push(p.name)}}a.nodesByDepth=D;for(var oe=a.layers.map(function(e){return e.name}),se=function(e){var t=oe.filter(function(t){return t===e}).length;if(1!==t)throw new r.RuntimeError('The name "'+e+'" is used '+t+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(oe))},ue=0,le=oe;ue<le.length;ue++){se(le[ue])}return a.outboundNodes=[],a.inboundNodes=[],new g({outboundLayer:a,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:a.inputs,outputTensors:a.outputs,inputMasks:a.inputs.map(function(e){return null}),outputMasks:a.outputs.map(function(e){return null}),inputShapes:a.inputs.map(function(e){return e.shape}),outputShapes:a.outputs.map(function(e){return e.shape})}),a.built=!0,a}return d(i,t),Object.defineProperty(i.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new r.ValueError("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var e=[],t=0,n=this.layers;t<n.length;t++){var a=n[t];e=e.concat(a.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nonTrainableWeights",{get:function(){for(var e=[],t=0,n=this.layers;t<n.length;t++){var r=n[t];e.push.apply(e,r.nonTrainableWeights)}if(!this.trainable){for(var a=[],i=0,o=this.layers;i<o.length;i++){r=o[i];a.push.apply(a,r.trainableWeights)}return a.concat(e)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),i.prototype.loadWeights=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),n?T(e,this.layers):_(e,this.layers,t)},i.prototype.updatedConfig=function(){var e=this.getConfig();return{className:this.getClassName(),config:e,kerasVersion:"tfjs-layers "+p.version,backend:"TensorFlow.js"}},i.prototype.toJSON=function(e,t){void 0===t&&(t=!0);var n=(0,u.convertTsToPythonic)(this.updatedConfig());return t?JSON.stringify(n):n},i.prototype.call=function(t,n){var r=this;return(0,e.tidy)(function(){var e;return t=s.toList(t),e="mask"in n?s.toList(n.mask):s.pyListRepeat(null,t.length),r.runInternalGraph(t,e)[0]})},i.prototype.computeMask=function(t,n){var r=this;return(0,e.tidy)(function(){var e;return t=s.toList(t),e=null==n?s.pyListRepeat(null,t.length):s.toList(n),r.runInternalGraph(t,e)[1]})},i.prototype.computeOutputShape=function(e){var t=s.normalizeShapeList(e);if(t.length!==this.inputLayers.length)throw new r.ValueError("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},a=0;a<t.length;a++){var i=this.inputLayers[a],o=t[a];n[O=i.name+"_0_0"]=o}var u=Object.keys(this.nodesByDepth).map(function(e){return parseInt(e,10)}).sort(s.reverseNumberCompare);if(u.length>1)for(var l=0,p=u;l<p.length;l++)for(var h=p[l],d=0,c=this.nodesByDepth[h];d<c.length;d++){var f=c[d];i=f.outboundLayer;if(-1===this.inputLayers.map(function(e){return e.id}).indexOf(i.id)){for(var y=[],g=0;g<f.inboundLayers.length;g++){var b=f.inboundLayers[g],m=f.nodeIndices[g],v=f.tensorIndices[g],w=n[O=b.name+"_"+m+"_"+v];y.push(w)}var L=i.computeOutputShape(s.singletonOrArray(y)),I=s.normalizeShapeList(L),N=i.inboundNodes.indexOf(f);for(g=0;g<I.length;g++){n[O=i.name+"_"+N+"_"+g]=I[g]}}}var S=[],x=[];for(a=0;a<this.outputLayers.length;a++){i=this.outputLayers[a],N=this.outputLayersNodeIndices[a],v=this.outputLayersTensorIndices[a];var O=i.name+"_"+N+"_"+v;x.push(O)}for(a=0;a<x.length;a++){var T=x[a];s.assert(T in n),S.push(n[T])}return s.singletonOrArray(S)},i.prototype.runInternalGraph=function(e,t){null==t&&(t=s.pyListRepeat(null,e.length));for(var n={},a=0;a<this.inputs.length;++a){var i=this.inputs[a],o=e[a],u=t[a];n[i.id]=[o,u]}for(var l=0,p=Object.keys(this.nodesByDepth).map(function(e){return parseInt(e,10)}).sort(s.reverseNumberCompare);l<p.length;l++)for(var h=p[l],d=0,c=this.nodesByDepth[h];d<c.length;d++){for(var f=c[d],y=f.outboundLayer,g=f.inputTensors,b=f.outputTensors,m=new Array,v=0,w=g;v<w.length;v++){(i=w[v]).id in n&&m.push(n[i.id])}if(m.length===g.length){var L={},I=void 0,N=void 0,S=void 0,x=void 0;if(null!=f.callArgs&&(L=f.callArgs),1===m.length){var O=m[0],T=O[0],_=O[1];null==L.mask&&(L.mask=_),S=s.toList(y.call(T,L)),x=s.toList(y.computeMask(T,_)),I=[T],N=[_]}else I=m.map(function(e){return e[0]}),N=m.map(function(e){return e[1]}),null==L.mask&&(L.mask=N),S=s.toList(y.call(I,L)),x=s.toList(y.computeMask(I,N));if(y.activityRegularizer)throw new r.NotImplementedError("Model invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(a=0;a<b.length;++a){i=b[a],o=S[a],u=x[a];n[i.id]=[o,u]}}}for(var k=[],A=[],E=[],W=0,C=this.outputs;W<C.length;W++){i=C[W];s.assert(i.id in n,"Could not compute output "+i.name+" : "+i.id);var V=n[i.id],j=V[0];u=V[1];E.push(j.shape),k.push(j),A.push(u)}return[k,A,E]},i.prototype.buildNodeConversionMap=function(e){for(var t,n={},r=0,a=this.layers;r<a.length;r++){var o=a[r];t=o instanceof i?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=i.nodeKey(o,s);u in this.containerNodes&&(n[u]=t,t+=1)}}return n},i.prototype.getLayer=function(e,t){if(null!=t){if(this.layers.length<=t)throw new r.ValueError("Was asked to retrieve layer at index "+t+", but model only has "+this.layers.length+" layer(s).");return this.layers[t]}if(null==e)throw new r.ValueError("Provide either a layer name or layer index");for(var n=0,a=this.layers;n<a.length;n++){var i=a[n];if(i.name===e)return i}throw new r.ValueError("No such layer: "+e)},i.prototype.calculateLosses=function(){var t=this;return(0,e.tidy)(function(){for(var e=[],n=0,r=t.layers;n<r.length;n++)for(var a=r[n],o=0;o<a.inboundNodes.length;++o){var s=i.nodeKey(a,o);t.containerNodes.has(s)&&e.push.apply(e,a.calculateLosses())}return e})},i.prototype.getConfig=function(){for(var e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[],r=0,a=this.layers;r<a.length;r++){for(var o=(v=a[r]).getClassName(),s=v.getConfig(),u=[],l=0;l<v.inboundNodes.length;l++){var p=v.inboundNodes[l],h=i.nodeKey(v,l),d={};if(this.containerNodes.has(h)){if(p.callArgs)-1===JSON.stringify(p.callArgs).indexOf("undefined")?d=p.callArgs:(console.warn("Layer "+v.name+" was passed non-serializable keyword arguments: "+p.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),d={});if(p.inboundLayers.length>0){for(var c=[],f=0;f<p.inboundLayers.length;f++){var y=p.inboundLayers[f],g=p.nodeIndices[f],b=p.tensorIndices[f];null==(L=t[i.nodeKey(y,g)])&&(L=0),c.push([y.name,L,b,d])}u.push(c)}}}n.push({name:v.name,className:o,config:s,inboundNodes:u})}e.layers=n;var m=[];for(f=0;f<this.inputLayers.length;f++){var v=this.inputLayers[f];g=this.inputLayersNodeIndices[f],h=i.nodeKey(v,g);if(this.containerNodes.has(h)){null==(L=t[h])&&(L=0);b=this.inputLayersTensorIndices[f];m.push([v.name,L,b])}}e.inputLayers=m;var w=[];for(f=0;f<this.outputLayers.length;f++){v=this.outputLayers[f],g=this.outputLayersNodeIndices[f],h=i.nodeKey(v,g);if(this.containerNodes.has(h)){var L;null==(L=t[h])&&(L=0);b=this.outputLayersTensorIndices[f];w.push([v.name,L,b])}}return e.outputLayers=w,e},i.fromConfig=function(e,t){var n={},i={};function o(e,t){e.name in i?i[e.name].push(t):i[e.name]=[t]}function u(e,t){for(var a,i=[],u=0,l=t;u<l.length;u++){var p=l[u],h=p[0],d=p[1],c=p[2];if(3===p.length)a={};else{if(4!==p.length)throw new r.ValueError("Improperly formatted model config for layer "+JSON.stringify(e)+": "+JSON.stringify(p));a=p[3]}if(!(h in n))return void o(e,t);var f=n[h];if(f.inboundNodes.length<=d)return void o(e,t);var y=f.inboundNodes[d];i.push(y.outputTensors[c])}i.length>0&&e.apply(s.singletonOrArray(i),a)}function l(e){var i=e.name,s=(0,a.deserialize)(e,null!=t.customObjects?t.customObjects:{});n[i]=s;for(var u=0,l=e.inboundNodes;u<l.length;u++){var p=l[u];if(!(p instanceof Array))throw new r.ValueError("Corrupted configuration, expected array for nodeData: "+p);o(s,p)}}for(var p=t.name,h=t.layers,d=0,c=h;d<c.length;d++){l(g=c[d])}for(;!s.isObjectEmpty(i);)for(var f=0,y=h;f<y.length;f++){var g=y[f];if((k=n[g.name]).name in i){for(var b=0,m=i[k.name];b<m.length;b++){u(k,m[b])}delete i[k.name]}}for(var v=[],w=[],L=0,I=t.inputLayers;L<I.length;L++){var N=(g=I[L])[0],S=g[1],x=g[2];s.assert(N in n);var O=(k=n[N]).inboundNodes[S].outputTensors;v.push(O[x])}for(var T=0,_=t.outputLayers;T<_.length;T++){N=(g=_[T])[0],S=g[1],x=g[2];s.assert(N in n);var k;O=(k=n[N]).inboundNodes[S].outputTensors;w.push(O[x])}return new e({inputs:v,outputs:w,name:p})},Object.defineProperty(i.prototype,"stateful",{get:function(){if(this._stateful)throw new r.ValueError("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var e=0,t=this.layers;e<t.length;e++){if(t[e].stateful)return!0}return!1},enumerable:!0,configurable:!0}),c([(0,e.doc)({heading:"Layers",subheading:"Classes",namespace:"layers",subclasses:["Model"]})],i.prototype,"getLayer",null),i}(m);function S(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++)for(var o=0,s=S(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]);o<s.length;o++){var u=s[o];-1===a.indexOf(u)&&a.push(u)}return a}function x(t,n,r){var a=s.stringToDType(t);return e.Tensor.make(n,{values:0===n.length?r:e.util.flatten(r)},a)}function O(e,t,n,a){if(!n.startsWith("2."))throw new r.ValueError("Unsupported Keras version in weights being loaded: "+n);return t}function T(e,t){for(var n={},a=0,i=0,o=t;i<o.length;i++)for(var s=0,u=o[i].weights;s<u.length;s++){var p=u[s];if(null!=n[p.originalName])throw new r.ValueError("Duplicate weight name: "+p.originalName);n[p.originalName]=p,a++}var h=[];for(var d in e)h.push([n[d],e[d]]),delete n[d];var c=[];for(var f in n)c.push(f);if(c.length>0)throw new r.ValueError(c.length+" of "+a+" weights are not set: "+c);(0,l.batchSetValue)(h)}function _(t,n,a){void 0===a&&(a=!1);for(var i=t.keras_version,o=t.backend,s=n.map(function(e){return e.name}),u={},p=0,h=n;p<h.length;p++){null!=(I=h[p]).name&&(null==u[I.name]&&(u[I.name]=[]),u[I.name].push(I))}for(var d=t.weights,c=[],f=0;f<s.length;++f){var y=s[f],g=d[y];null==g&&(g=[]);for(var b=[],m=0;m<g.length;++m){var v=g[m];b.push(new l.LayerVariable(x(v.dtype,v.shape,v.value)))}for(var w=0,L=u[y];w<L.length;w++){var I,N=(I=L[w]).weights;if((b=O(I,b,i,o)).length!==N.length){if(!a)throw new r.ValueError("Layer #"+f+' (named "'+I.name+'") expects '+N.length+" weight(s), but the saved weights have "+b.length+" element(s).");console.warn("Skipping loading of weights of layer "+I.name+" due to mismatch in number of weights: ("+b.length+" vs "+N.length+").")}for(var S=0;S<b.length;++S)!a||e.util.arraysEqual(N[S].shape,b[S].shape)?c.push([N[S],b[S].read()]):console.warn("Skipping loading of weights for layer "+I.name+" due to mismatch in shape ("+N[S].shape+" vs "+b[S].shape+")")}}(0,l.batchSetValue)(c)}exports.Container=N;
},{"@tensorflow/tfjs-core":49,"../backend/tfjs_backend":197,"../errors":200,"../layers/serialization":202,"../types":92,"../utils/generic_utils":198,"../utils/serialization_utils":203,"../variables":349,"../version":93}],90:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomCallback=exports.History=exports.BaseLogger=exports.CallbackList=exports.Callback=void 0,exports.resolveScalarsInLogs=f,exports.disposeTensorsInLogs=p,exports.standardizeCallbacks=b;var t=require("@tensorflow/tfjs-core"),n=require("./backend/tfjs_backend"),e=i(n),r=require("./utils/generic_utils"),o=i(r);function i(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}var s=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),u=function(t,n,e,r){return new(e||(e=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new e(function(n){n(t.value)}).then(s,u)}c((r=r.apply(t,n||[])).next())})},c=function(t,n){var e,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(t,s)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=function(){function t(){this.validationData=null,this.model=null}return t.prototype.setParams=function(t){this.params=t},t.prototype.setModel=function(t){this.model=t},t.prototype.onEpochBegin=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},t.prototype.onEpochEnd=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},t.prototype.onBatchBegin=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},t.prototype.onBatchEnd=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},t.prototype.onTrainBegin=function(t){return u(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},t.prototype.onTrainEnd=function(t){return u(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},t}();exports.Callback=a;var l=function(){function t(t,n){void 0===n&&(n=10),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return t.prototype.append=function(t){this.callbacks.push(t)},t.prototype.setParams=function(t){for(var n=0,e=this.callbacks;n<e.length;n++){e[n].setParams(t)}},t.prototype.setModel=function(t){for(var n=0,e=this.callbacks;n<e.length;n++){e[n].setModel(t)}},t.prototype.onEpochBegin=function(t,n){return u(this,void 0,void 0,function(){var e,r;return c(this,function(o){switch(o.label){case 0:null==n&&(n={}),e=0,r=this.callbacks,o.label=1;case 1:return e<r.length?[4,r[e].onEpochBegin(t,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.onEpochEnd=function(t,n){return u(this,void 0,void 0,function(){var e,r;return c(this,function(o){switch(o.label){case 0:null==n&&(n={}),e=0,r=this.callbacks,o.label=1;case 1:return e<r.length?[4,r[e].onEpochEnd(t,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.onBatchBegin=function(t,n){return u(this,void 0,void 0,function(){var e,r;return c(this,function(o){switch(o.label){case 0:null==n&&(n={}),e=0,r=this.callbacks,o.label=1;case 1:return e<r.length?[4,r[e].onBatchBegin(t,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.onBatchEnd=function(t,n){return u(this,void 0,void 0,function(){var e,r;return c(this,function(o){switch(o.label){case 0:null==n&&(n={}),e=0,r=this.callbacks,o.label=1;case 1:return e<r.length?[4,r[e].onBatchEnd(t,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.onTrainBegin=function(t){return u(this,void 0,void 0,function(){var n,e;return c(this,function(r){switch(r.label){case 0:null==t&&(t={}),n=0,e=this.callbacks,r.label=1;case 1:return n<e.length?[4,e[n].onTrainBegin(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.onTrainEnd=function(t){return u(this,void 0,void 0,function(){var n,e;return c(this,function(r){switch(r.label){case 0:null==t&&(t={}),n=0,e=this.callbacks,r.label=1;case 1:return n<e.length?[4,e[n].onTrainEnd(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t}();exports.CallbackList=l;var h=function(n){function r(){return n.call(this)||this}return s(r,n),r.prototype.onEpochBegin=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(t){return this.seen=0,this.totals={},[2]})})},r.prototype.onBatchEnd=function(n,r){return u(this,void 0,void 0,function(){var n,o,i,s,u=this;return c(this,function(c){for(s in null==r&&(r={}),n=null==r.size?0:r.size,this.seen+=n,o=function(o){var s=r[o];if("number"==typeof s)i.totals.hasOwnProperty(o)||(i.totals[o]=0),i.totals[o]=i.totals[o]+s*n;else{var c=void 0;o in i.totals?c=i.totals[o]:i.totals[o]=e.getScalar(0),i.totals[o]=(0,t.tidy)(function(){return e.scalarPlusArray(u.totals[o],(0,t.mul)(s,e.getScalar(n)))}),null!=c&&c.dispose()}},i=this,r)o(s);return[2]})})},r.prototype.onEpochEnd=function(n,r){return u(this,void 0,void 0,function(){var n,o,i,s,u,a=this;return c(this,function(c){if(null!=r)for(n=function(n){if(null==o.totals[n])return"continue";"number"==typeof o.totals[n]?r[n]=o.totals[n]/o.seen:(0,t.tidy)(function(){r[n]=e.scalarTimesArray((0,t.div)(e.getScalar(1),e.getScalar(a.seen)),a.totals[n]),a.totals[n].dispose(),(0,t.keep)(r[n])})},o=this,i=0,s=this.params.metrics;i<s.length;i++)u=s[i],n(u);return[2]})})},r}(a);function f(t){return u(this,void 0,void 0,function(){var n,e,r,o,i,s,u;return c(this,function(c){switch(c.label){case 0:if(null==t)return[2];for(r in n=[],e=[],t)"number"!=typeof(o=t[r])&&(i=o,n.push(i.data()),e.push(r));return[4,Promise.all(n)];case 1:for(s=c.sent(),u=0;u<s.length;++u)t[e[u]]=s[u][0];return[2]}})})}function p(t){if(null!=t)for(var n in t){var e=t[n];"number"!=typeof e&&e.dispose()}}exports.BaseLogger=h;var d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return s(n,t),n.prototype.onTrainBegin=function(t){return u(this,void 0,void 0,function(){return c(this,function(t){return this.epoch=[],this.history={},[2]})})},n.prototype.onEpochEnd=function(t,n){return u(this,void 0,void 0,function(){var e;return c(this,function(r){for(e in null==n&&(n={}),this.epoch.push(t),n)null==this.history[e]&&(this.history[e]=[]),this.history[e].push(n[e]);return[2]})})},n.prototype.syncData=function(){return u(this,void 0,void 0,function(){var t,n,e,r,o,i,s,u,a;return c(this,function(c){switch(c.label){case 0:for(r in t=[],n=[],e=[],this.history)for(o=this.history[r],i=0;i<o.length;++i)"number"!=typeof o[i]&&(s=o[i],t.push(s.data()),n.push(r),e.push(i));return[4,Promise.all(t)];case 1:for(u=c.sent(),a=0;a<u.length;++a)this.history[n[a]][e[a]].dispose(),this.history[n[a]][e[a]]=u[a][0];return[2]}})})},n}(a);exports.History=d;var v=function(t){function n(n){var e=t.call(this)||this;return e.trainBegin=n.onTrainBegin,e.trainEnd=n.onTrainEnd,e.epochBegin=n.onEpochBegin,e.epochEnd=n.onEpochEnd,e.batchBegin=n.onBatchBegin,e.batchEnd=n.onBatchEnd,e}return s(n,t),n.prototype.onEpochBegin=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return null==this.epochBegin?[3,3]:[4,f(n)];case 1:return e.sent(),[4,this.epochBegin(t,n)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},n.prototype.onEpochEnd=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return null==this.epochEnd?[3,3]:[4,f(n)];case 1:return e.sent(),[4,this.epochEnd(t,n)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},n.prototype.onBatchBegin=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return null==this.batchBegin?[3,3]:[4,f(n)];case 1:return e.sent(),[4,this.batchBegin(t,n)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},n.prototype.onBatchEnd=function(t,n){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return null==this.batchEnd?[3,3]:[4,f(n)];case 1:return e.sent(),[4,this.batchEnd(t,n)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},n.prototype.onTrainBegin=function(t){return u(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return null==this.trainBegin?[3,3]:[4,f(t)];case 1:return n.sent(),[4,this.trainBegin(t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},n.prototype.onTrainEnd=function(t){return u(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return null==this.trainEnd?[3,3]:[4,f(t)];case 1:return n.sent(),[4,this.trainEnd(t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},n}(a);function b(t){return null==t?null:t instanceof a?[t]:Array.isArray(t)&&t[0]instanceof a?t:o.toList(t).map(function(t){return new v(t)})}exports.CustomCallback=v;
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./utils/generic_utils":198}],266:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cosine=exports.KLD=exports.kld=exports.MSLE=exports.msle=exports.MAPE=exports.mape=exports.MAE=exports.mae=exports.MSE=exports.mse=void 0,exports.l2Normalize=a,exports.meanSquaredError=u,exports.meanAbsoluteError=i,exports.meanAbsolutePercentageError=l,exports.meanSquaredLogarithmicError=c,exports.squaredHinge=p,exports.hinge=m,exports.categoricalHinge=f,exports.logcosh=g,exports.categoricalCrossentropy=x,exports.sparseCategoricalCrossentropy=d,exports.sigmoidCrossEntropyWithLogits=y,exports.binaryCrossentropy=b,exports.kullbackLeiblerDivergence=v,exports.poisson=A,exports.cosineProximity=E,exports.get=w;var r=require("@tensorflow/tfjs-core"),e=s(r),t=require("./backend/tfjs_backend"),n=s(t),o=require("./errors");function s(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function a(t,o){return(0,r.tidy)(function(){var s=e.sum(n.square(t),o,!0),a=n.scalarTimesArray((0,r.scalar)(n.epsilon()),e.onesLike(t)),u=e.sqrt(e.maximum(s,a));return e.div(t,u)})}function u(t,o){return(0,r.tidy)(function(){return e.mean(n.square(e.sub(o,t)),-1)})}function i(t,n){return(0,r.tidy)(function(){return e.mean(e.abs(e.sub(n,t)),-1)})}function l(t,o){return(0,r.tidy)(function(){var r=e.sub(t,o),s=e.clipByValue(e.abs(t),n.epsilon(),Number.MAX_VALUE),a=e.abs(e.div(r,s));return n.scalarTimesArray(n.getScalar(100),e.mean(a,-1))})}function c(t,o){return(0,r.tidy)(function(){var r=n.getScalar(1),s=e.clipByValue(o,n.epsilon(),Number.MAX_VALUE),a=e.log(n.scalarPlusArray(r,s)),u=e.clipByValue(t,n.epsilon(),Number.MAX_VALUE),i=e.log(n.scalarPlusArray(r,u));return e.mean(n.square(e.sub(a,i)),-1)})}function p(t,o){return(0,r.tidy)(function(){var r=n.getScalar(0),s=n.getScalar(1),a=e.maximum(r,e.sub(s,e.mul(t,o)));return e.mean(n.square(a),-1)})}function m(t,o){return(0,r.tidy)(function(){var r=n.getScalar(0),s=n.getScalar(1),a=e.maximum(r,e.sub(s,e.mul(t,o)));return e.mean(a,-1)})}function f(t,o){return(0,r.tidy)(function(){var r=n.getScalar(0),s=n.getScalar(1),a=e.sum(e.mul(t,o),-1),u=e.max(e.mul(e.sub(s,t),o),-1);return e.maximum(r,n.scalarPlusArray(s,e.sub(u,a)))})}function g(t,o){return(0,r.tidy)(function(){var r=n.getScalar(Math.log(2)),s=e.sub(o,t),a=e.sub(e.add(s,e.softplus(n.scalarTimesArray(n.getScalar(-2),s))),r);return e.mean(a,-1)})}function x(t,o,s){return void 0===s&&(s=!1),(0,r.tidy)(function(){if(s)o=e.softmax(o);else{var r=e.sum(o,n.shape(o).length-1,!0);o=e.div(o,r)}return o=e.clipByValue(o,n.epsilon(),1-n.epsilon()),e.neg(e.sum(e.mul(t.toFloat(),e.log(o)),n.shape(o).length-1))})}function d(t,o,s){return void 0===s&&(s=!1),(0,r.tidy)(function(){var r=e.floor(n.flatten(t)).toInt(),a=n.shape(o);return x(e.oneHot(r,a[a.length-1]).reshape(a),o,s)})}function y(t,o){return(0,r.tidy)(function(){var r=e.maximum(o,e.zerosLike(o)),s=e.mul(o,t),a=e.log(e.add(n.getScalar(1),e.exp(e.neg(e.abs(o)))));return e.add(e.sub(r,s),a)})}function b(t,o){return(0,r.tidy)(function(){var r;return r=e.clipByValue(o,n.epsilon(),1-n.epsilon()),r=e.log(e.div(r,e.sub(e.onesLike(r),r))),e.mean(y(t,r),-1)})}function v(t,o){return(0,r.tidy)(function(){var r=e.clipByValue(t,n.epsilon(),1),s=e.clipByValue(o,n.epsilon(),1);return e.sum(e.mul(t,e.log(e.div(r,s))),-1)})}function A(t,o){return(0,r.tidy)(function(){var r=e.log(n.scalarPlusArray(n.getScalar(n.epsilon()),o));return e.mean(e.sub(o,e.mul(t,r)),-1)})}function E(t,n){return(0,r.tidy)(function(){var r=a(t,-1),o=a(n,-1),s=e.mul(r,o);return e.neg(e.sum(s,-1))})}var S=exports.mse=u,h=exports.MSE=u,L=exports.mae=i,q=exports.MAE=i,M=exports.mape=l,k=exports.MAPE=l,P=exports.msle=c,V=exports.MSLE=c,C=exports.kld=v,_=exports.KLD=v,B=exports.cosine=E;function w(r){var e={meanSquaredError:u,meanAbsoluteError:i,meanAbsolutePercentageError:l,meanSquaredLogarithmicError:c,squaredHinge:p,hinge:m,categoricalHinge:f,logcosh:g,categoricalCrossentropy:x,sparseCategoricalCrossentropy:d,binaryCrossentropy:b,kullbackLeiblerDivergence:v,poisson:A,cosineProximity:E};if("string"==typeof r){if(r in e)return e[r];throw new o.ValueError("Unknown loss "+r)}return r}
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./errors":200}],267:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sparseCategoricalCrossentropy=exports.cosine=exports.categoricalCrossentropy=exports.MAPE=exports.mape=exports.MAE=exports.mae=exports.MSE=exports.mse=void 0,exports.binaryAccuracy=c,exports.categoricalAccuracy=p,exports.binaryCrossentropy=i,exports.sparseCategoricalAccuracy=u,exports.topKCategoricalAccuracy=l,exports.sparseTopKCategoricalAccuracy=y,exports.get=b;var r=require("@tensorflow/tfjs-core"),e=n(r),o=require("./backend/tfjs_backend"),t=n(o),a=require("./errors"),s=require("./losses");function n(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e.default=r,e}function c(o,a){return(0,r.tidy)(function(){var r=t.scalarTimesArray(t.getScalar(.5),e.onesLike(a)),s=t.cast(e.greater(a,r),o.dtype);return e.mean(e.equal(o,s),-1)})}function p(o,a){return(0,r.tidy)(function(){return t.cast(e.equal(e.argMax(o,-1),e.argMax(a,-1)),"float32")})}function i(r,e){return(0,s.binaryCrossentropy)(r,e)}function u(r,e){throw new a.NotImplementedError}function l(r,e){throw new a.NotImplementedError}function y(r,e){throw new a.NotImplementedError}var x=exports.mse=s.meanSquaredError,m=exports.MSE=s.meanSquaredError,f=exports.mae=s.meanAbsoluteError,g=exports.MAE=s.meanAbsoluteError,E=exports.mape=s.meanAbsolutePercentageError,A=exports.MAPE=s.meanAbsolutePercentageError,C=exports.categoricalCrossentropy=s.categoricalCrossentropy,d=exports.cosine=s.cosineProximity,M=exports.sparseCategoricalCrossentropy=s.sparseCategoricalCrossentropy;function b(r){var e={binaryAccuracy:c,categoricalAccuracy:p,categoricalCrossentropy:C,sparseCategoricalCrossentropy:M,mse:x,MSE:m,mae:f,MAE:g,mape:E,MAPE:A,cosine:d};if("string"==typeof r&&r in e)return e[r];if("string"!=typeof r&&null!=r)return r;throw new a.ValueError("Unknown metric "+r)}
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./errors":200,"./losses":266}],309:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOptimizer=o;var r=require("@tensorflow/tfjs-core"),e=require("./backend/tfjs_backend"),n=a(e),t=require("./errors");function a(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}function o(e){var a={Adagrad:function(){return r.train.adagrad(.01)},Adam:function(){return r.train.adam(.001,.9,.999,n.epsilon())},RMSProp:function(){return r.train.rmsprop(.001,.9,null,n.epsilon())},SGD:function(){return r.train.sgd(.01)}};if(a.adagrad=a.Adagrad,a.adam=a.Adam,a.rmsprop=a.RMSProp,a.sgd=a.SGD,e in a)return a[e]();throw new t.ValueError("Unknown Optimizer "+e)}
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./errors":200}],311:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FeedDict=void 0,exports.execute=a;var e=require("../errors"),r=require("./topology");function t(r,t){if(null!=r.dtype&&r.dtype!==t.dtype)throw new e.ValueError("The dtype of the feed ("+t.dtype+") is incompatible with that of the key '"+r.name+"' ("+r.dtype+").");if(null!=r.shape){if(r.shape.length!==t.shape.length)throw new e.ValueError("The rank of feed ("+t.shape.length+") does not match the rank of the key ("+r.shape.length+").");for(var n=0;n<r.shape.length;++n)if(null!=r.shape[n]&&r.shape[n]!==t.shape[n])throw new e.ValueError("The "+n+"-th dimension of the feed ("+t.shape[n]+") is incompatible with that of the key ("+r.shape[n]+").")}}var n=function(){function r(e){if(this.id2Value={},e instanceof r)for(var t in e.id2Value)this.id2Value[t]=e.id2Value[t];else{if(null==e)return;for(var n=0,a=e;n<a.length;n++){var o=a[n];this.add(o.key,o.value)}}}return r.prototype.add=function(r,n){if(t(r,n),null!=this.id2Value[r.id])throw new e.ValueError("Duplicate key: name="+r.name+", id="+r.id);return this.id2Value[r.id]=n,this},r.prototype.addFeed=function(e){this.add(e.key,e.value)},r.prototype.hasKey=function(e){return null!=this.id2Value[e.id]},r.prototype.getValue=function(r){if(null==this.id2Value[r.id])throw new e.ValueError("Nonexistent key: "+JSON.stringify(r));return this.id2Value[r.id]},r}();function a(e,r,t){for(var a=Array.isArray(e),i=a?e:[e],u=[],s=new n(r),h=0,l=i;h<l.length;h++){var d=l[h];u.push(o(d,s,t))}return a?u:u[0]}function o(t,n,a){if(n.hasKey(t))return n.getValue(t);if(t.sourceLayer instanceof r.InputLayer)throw new e.ValueError("Missing a feed value for SymbolicTensor from InputLayer '"+r.InputLayer.name+"'");for(var u=[],s=0,h=t.inputs;s<h.length;s++){var l=o(h[s],n,a);u.push(l)}var d=t.sourceLayer.apply(u,a);Array.isArray(d)||(d=[d]);for(var f=i(t),p=Array.isArray(f)?f:[f],y=0;y<p.length;++y)n.add(p[y],d[y]);return 1===d.length?d[0]:d[t.outputTensorIndex]}function i(e){var r;if(1===e.sourceLayer.inboundNodes.length)r=e.sourceLayer.output;else{for(var t=null,n=0;n<e.sourceLayer.inboundNodes.length;++n)for(var a=0,o=e.sourceLayer.inboundNodes[n].outputTensors;a<o.length;a++){if(o[a].id===e.id){t=n;break}}r=e.sourceLayer.getOutputAt(t)}return r}exports.FeedDict=n;
},{"../errors":200,"./topology":201}],106:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Model=exports.ModelLoggingVerbosity=void 0,exports.isDataTensor=E,exports.isDataArray=x,exports.isDataDict=O,exports.standardizeInputData=S,exports.checkArrayLengths=T,exports.makeBatches=N,exports.sliceArraysByIndices=V;var e=require("@tensorflow/tfjs-core"),t=m(e),r=require("../backend/tfjs_backend"),n=m(r),s=require("../callbacks"),o=require("../errors"),i=require("../losses"),a=m(i),l=require("../metrics"),u=m(l),c=require("../optimizers"),h=m(c),p=require("../utils/generic_utils"),f=require("../utils/math_utils"),d=require("./executor"),g=require("./topology");function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var y=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),v=function(e,t,r,n){var s,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},w=function(e,t,r,n){return new(r||(r=Promise))(function(s,o){function i(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(i,a)}l((n=n.apply(e,t||[])).next())})},b=function(e,t){var r,n,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(s=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[0,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(s=(s=i.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){i.label=o[1];break}if(6===o[0]&&i.label<s[1]){i.label=s[1],s=o;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(o);break}s[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function E(t){return t instanceof e.Tensor}function x(e){return Array.isArray(e)}function O(e){return!E(e)&&!x(e)}function S(e,t,r,s,i){if(void 0===s&&(s=!0),void 0===i&&(i=""),null==t||0===t.length){if(null!=e){var a=!1;if(x(e)&&e.length>0)a=!0;else if(O(e)){for(var l in e)if(e.hasOwnProperty(l)){a=!0;break}}else a=!0;if(a)throw new o.ValueError("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(null==e)return t.map(function(e){return null});var u;if(O(e)){e=e,u=[];for(var c=0,h=t;c<h.length;c++){var p=h[c];if(null==e[p])throw new o.ValueError('No data provided for "'+p+'". Need data for each key in: '+t);u.push(e[p])}}else if(x(e)){if((e=e).length!==t.length)throw new o.ValueError("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);u=e}else{if(e=e,t.length>1)throw new o.ValueError("The model "+i+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);u=[e]}for(var f=0;f<t.length;++f){1===(d=u[f]).shape.length&&(u[f]=n.expandDims(d,1))}if(null!=r)for(f=0;f<t.length;++f)if(null!=r[f]){var d;if((d=u[f]).shape.length!==r[f].length)throw new o.ValueError("Error when checking "+i+": expected "+t[f]+" to have "+r[f].length+" dimension(s). but got array with shape "+d.shape);for(var g=0;g<r[f].length;++g)if(0!==g||s){var m=d.shape[g],y=r[f][g];if(null!=y&&y>=0&&m!==y)throw new o.ValueError("Error when checking "+i+": expected "+t[f]+" to have shape ["+r[f]+"], but got array with shape ["+d.shape+"].")}}return u}function T(t,r,n){var s=(0,p.unique)(t.map(function(e){return e.shape[0]}));s.sort();var i=(0,p.unique)(r.map(function(e){return e.shape[0]}));if(i.sort(),s.length>1)throw new o.ValueError("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(e){return e.shape})));if(i.length>1)throw new o.ValueError("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(r.map(function(e){return e.shape})));if(s.length>0&&i.length>0&&!e.util.arraysEqual(s,i))throw new o.ValueError("Input Tensors should have the same number of samples as target Tensors. Found "+s[0]+" input sample(s) and "+i[0]+" target sample(s).")}function A(e,t,r){for(var n=[a.meanSquaredError,a.binaryCrossentropy,a.categoricalCrossentropy],s=0;s<e.length;++s){var i=e[s],l=t[s],u=r[s];if(null!=l){if(l===a.categoricalCrossentropy&&1===i.shape[i.shape.length-1])throw new o.ValueError("You are passing a target array of shape "+i.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==n.indexOf(l))for(var c=i.shape.slice(1),h=u.slice(1),p=0;p<c.length;++p){var f=c[p],d=h[p];if(null!=d&&f!==d)throw new o.ValueError("A target Tensor with shape "+i.shape+" was passed for an output of shape "+u+", while using a loss function that expects targets to have the same shape as the output.")}}}}function N(e,t){for(var r=[],n=0,s=null;n<e;)(s=n+t)>=e&&(s=e),r.push([n,s]),n=s;return r}function k(e,t,r){return null==e?[null]:Array.isArray(e)?e.map(function(e){return n.sliceAlongFirstAxis(e,t,r-t)}):n.sliceAlongFirstAxis(e,t,r-t)}function V(e,r){return t.tidy(function(){return null==e?null:Array.isArray(e)?e.map(function(e){return V(e,r)}):n.gather(e,"int32"===r.dtype?r:r.toInt())})}function z(e,t,r,n,s){var i;if(void 0===n&&(n=!0),void 0===s&&(s=""),Array.isArray(e)){if(e.length!==t.length)throw new o.ValueError("Error when checking model "+s+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");i=e}else{if(t.length>1)throw new o.ValueError("The model expects "+t.length+" "+s+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");i=[e]}if(null!=r)for(var a=0;a<t.length;++a)if(null!=r[a]){var l=i[a];if(l.shape.length!==r[a].length)throw new o.ValueError("Error when checking "+s+": expected "+t[a]+" to have "+r[a].length+" dimension(s), but got array with shape "+JSON.stringify(l.shape));for(var u=0;u<r[a].length;++u)if(0!==u||n){var c=l.shape[u],h=r[a][u];if(null!=h&&h!==c)throw new o.ValueError("Error when checking "+s+": expected "+t[a]+" to have shape "+JSON.stringify(r[a])+" but got array with shape "+JSON.stringify(l.shape)+".")}}}function F(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map(function(e){return[]});if(Array.isArray(e))return t.map(function(t){return e});if(null!=e){for(var r=[],n=0,s=t;n<s.length;n++){var o=s[n],i=e.hasOwnProperty(o)?e[o]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}throw new TypeError("Type of metrics argument not understood. Expected an Array or Object, found: "+e)}var C=exports.ModelLoggingVerbosity=void 0;!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(C||(exports.ModelLoggingVerbosity=C={}));var D=function(r){function i(e){return r.call(this,e)||this}return y(i,r),i.prototype.compile=function(t){var r=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer=h.getOptimizer(t.optimizer);else{if(!(t.optimizer instanceof e.Optimizer))throw new o.ValueError("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer=t.optimizer}var s=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new o.ValueError("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");var i=t.loss;s=i.map(function(e){return a.get(e)})}else{var l=a.get(t.loss);this.outputs.map(function(e){s.push(l)})}else{for(var c in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(c))throw new o.ValueError('Unknown entry in loss dictionary: "'+c+'". Only expect the following keys: '+this.outputNames);for(var p in this.outputNames)null==t.loss[p]&&console.warn('Output "'+p+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+p+" during training"),s.push(a.get(t.loss[p]))}this.lossFunctions=s,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var f=0;f<this.outputs.length;++f){var d=this.internalOutputShapes[f],g=this.outputNames[f];this.feedOutputNames.push(g),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[f])}var m=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],n.nameScope("loss",function(){for(var e=0;e<r.outputs.length;++e)if(-1===m.indexOf(e)){var t=r.lossFunctions[e];r.outputs.length>1&&(r.metricsTensors.push([t,e]),r.metricsNames.push(r.outputNames[e]+"_loss"))}});var y=F(t.metrics,this.outputNames);n.nameScope("metric",function(){for(var e=function(e){if(-1!==m.indexOf(e))return"continue";!function(t){for(var s,o,i,l=function(t){if(-1!==["accuracy","acc","crossentropy","ce"].indexOf(t)){var l=r.internalOutputShapes[e];1===l[l.length-1]||r.lossFunctions[e]===a.binaryCrossentropy?-1!==["accuracy","acc"].indexOf(t)?o=u.binaryAccuracy:-1!==["crossentropy","ce"].indexOf(t)&&(o=u.binaryCrossentropy):r.lossFunctions[e]===a.sparseCategoricalCrossentropy?-1!==["accuracy","acc"].indexOf(t)?o=u.sparseCategoricalAccuracy:-1!==["crossentropy","ce"].indexOf(t)&&(o=u.sparseCategoricalCrossentropy):-1!==["accuracy","acc"].indexOf(t)?o=u.categoricalAccuracy:-1!==["crossentropy","ce"].indexOf(t)&&(o=u.categoricalCrossentropy);var c=void 0;-1!==["accuracy","acc"].indexOf(t)?c="acc":-1!==["crossentropy","ce"].indexOf(t)&&(c="ce"),i=o,s=""+c}else{var h=u.get(t);i=h,s=""+t}var p;n.nameScope(s,function(){p=i}),function(e,t,n){r.outputNames.length>1&&(t=r.outputNames[e]+"_"+t),r.metricsNames.push(t),r.metricsTensors.push([n,e])}(e,s,p)},c=0,h=t;c<h.length;c++)l(h[c])}(y[e])},t=0;t<r.outputs.length;++t)e(t)}),this.collectedTrainableWeights=this.trainableWeights},i.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},i.prototype.evaluate=function(e,t,r){void 0===r&&(r={});var n=null==r.batchSize?32:r.batchSize,s=this.standardizeUserData(e,t,!0,n),o=s[0].concat(s[1]);this.makeTestFunction();var i=this.testFunction,a=this.testLoop(i,o,n,r.verbose,r.steps);return(0,p.singletonOrArray)(a)},i.prototype.checkNumSamples=function(e,t,r,n){var s;if(void 0===n&&(n="steps"),null!=r){if(s=null,null!=t)throw new o.ValueError("If "+n+" is set, batchSize must be null or undefined.Got batchSize = "+t)}else{if(null==e)throw new o.ValueError("Either the input data should have a defined shape, or "+n+" shoud be specified.");s=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return s},i.prototype.predictLoop=function(e,r,s){var i=this;void 0===r&&(r=32),void 0===s&&(s=!1);var a=this.checkNumSamples(e);if(s)throw new o.NotImplementedError("Verbose predictLoop() is not implemented yet.");for(var l=N(a,r),u=[],c=function(r){var s=t.tidy(function(){var t=l[r][0],n=l[r][1],s=k(e,t,n),o=[];if(Array.isArray(s))for(var a=0;a<s.length;++a)o.push({key:i.inputs[a],value:s[a]});else o.push({key:i.inputs[0],value:s});var u=new d.FeedDict(o);return(0,d.execute)(i.outputs,u)});if(0===r)for(var o=0,a=s;o<a.length;o++){var c=a[o];u.push(c)}else for(var h=0;h<s.length;++h)u[h]=n.concatAlongFirstAxis(u[h],s[h])},h=0;h<l.length;++h)c(h);return(0,p.singletonOrArray)(u)},i.prototype.predict=function(e,t){void 0===t&&(t={}),z(e,this.inputNames,this.feedInputShapes,!1);var r=null==t.batchSize?32:t.batchSize;return this.predictLoop(e,r)},i.prototype.predictOnBatch=function(e){return z(e,this.inputNames,this.feedInputShapes,!0),this.predictLoop(e,e.shape[0])},i.prototype.standardizeUserData=function(e,t,r,n){if(void 0===r&&(r=!0),null==this.optimizer)throw new o.RuntimeError("You must compile a model before training/testing. Use Model.compile(modelCompileConfig).");for(var s=[],i=0;i<this.feedOutputShapes.length;++i){var l=this.feedOutputShapes[i];this.feedLossFns[i]===a.sparseCategoricalCrossentropy?s.push(l.slice(0,l.length-1).concat([1])):s.push(l)}if(T(e=S(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=S(t,this.feedOutputNames,s,!1,"target"),null),A(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!=0)throw new o.ValueError("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+n+". Found: "+e[0].shape[0]+" sample(s).");return[e,t,null]},i.prototype.fitLoop=function(r,i,a,l,u,c,h,p,d,g,m,y,v,E){return void 0===y&&(y=0),w(this,void 0,void 0,function(){var w,x,O,S,T,A,k,z=this;return b(this,function(F){switch(F.label){case 0:if(null==l&&(l=32),null==u&&(u=1),null==g&&(g=!0),null==y&&(y=0),w=!1,null!=p&&null!=d&&(w=!0),null!=E&&(w=!0,null==v))throw new o.ValueError("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");if(null!=(x=this.checkNumSamples(i,l,v,"steps_per_epoch"))&&(O=(0,f.range)(0,x)),this.history=new s.History,h=(h=null==h?[new s.BaseLogger]:[new s.BaseLogger].concat(h)).concat([this.history]),c>0)throw new o.NotImplementedError("Verbose mode is not implemented yet.");return(S=new s.CallbackList(h)).setModel(this),S.setParams({epochs:u,steps:v,verbose:c,doValidation:w,metrics:m}),[4,S.onTrainBegin()];case 1:F.sent(),this.stopTraining=!1,T=function(u){var c,h,f,m,y;return b(this,function(E){switch(E.label){case 0:return[4,S.onEpochBegin(u)];case 1:if(E.sent(),c={},null==v)return[3,2];throw new o.NotImplementedError("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===g)throw new o.NotImplementedError("batch shuffling is not implemneted yet");g&&e.util.shuffle(O),h=(0,e.tensor1d)(O),f=N(x,l),m=function(e){var o;return b(this,function(u){switch(u.label){case 0:return o={},[4,S.onBatchBegin(e,o)];case 1:return u.sent(),t.tidy(function(){var s=f[e][0],u=f[e][1],g=n.sliceAlongFirstAxis(h,s,u-s);o.batch=e,o.size=u-s;for(var m=V(i,g),y=r(m),v=0;v<a.length;++v){var b=a[v],E=y[v];o[b]=E,t.keep(E)}if(e===f.length-1&&w){var x=z.testLoop(p,d,l);for(v=0;v<a.length;++v){b=a[v],E=x[v];t.keep(E),c["val_"+b]=E}}}),[4,S.onBatchEnd(e,o)];case 2:return u.sent(),(0,s.disposeTensorsInLogs)(o),A.stopTraining?[2,"break"]:[2]}})},y=0,E.label=3;case 3:return y<f.length?[5,m(y)]:[3,6];case 4:if("break"===E.sent())return[3,6];E.label=5;case 5:return++y,[3,3];case 6:h.dispose(),E.label=7;case 7:return[4,S.onEpochEnd(u,c)];case 8:return E.sent(),A.stopTraining?[2,"break"]:[2]}})},A=this,k=y,F.label=2;case 2:return k<u?[5,T(k)]:[3,5];case 3:if("break"===F.sent())return[3,5];F.label=4;case 4:return++k,[3,2];case 5:return[4,S.onTrainEnd()];case 6:return F.sent(),[4,this.history.syncData()];case 7:return F.sent(),[2,this.history]}})})},i.prototype.testLoop=function(r,s,i,a,l){void 0===a&&(a=0);var u=this.checkNumSamples(s,i,l,"steps"),c=[];if(1===a)throw new o.NotImplementedError("Verbose mode is not implemented yet.");if(null!=l)throw new o.NotImplementedError("steps mode in testLoop() is not implemented yet");for(var h=N(u,i),p=(0,e.tensor1d)((0,f.range)(0,u)),d=0;d<h.length;++d){var g=h[d][0],m=h[d][1],y=r(V(s,n.sliceAlongFirstAxis(p,g,m-g)));if(0===d)for(var v=0;v<y.length;++v)c.push(n.getScalar(0));for(v=0;v<y.length;++v){var w=y[v];c[v]=t.add(c[v],n.scalarTimesArray(n.getScalar(m-g),w))}}for(v=0;v<c.length;++v)c[v]=t.div(c[v],n.getScalar(u));return c},i.prototype.getDedupedMetricsNames=function(){for(var e=this.metricsNames,t=[],r=0;r<e.length;++r){var n=e[r],s=n;if((0,p.count)(e,n)>1)s+="_"+(0,p.count)(e.slice(0,r),n);t.push(s)}return t},i.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(r){return t.tidy(function(){for(var n,s=[],o=r.slice(0,e.inputs.length),i=r.slice(e.inputs.length,e.inputs.length+e.outputs.length),a=[],l=0;l<e.inputs.length;++l)a.push({key:e.inputs[l],value:o[l]});var u=new d.FeedDict(a),c=(0,d.execute)(e.outputs,u);for(l=0;l<e.lossFunctions.length;++l){var h=e.lossFunctions[l],p=t.mean(h(i[l],c[l]));n=0===l?p:t.add(n,p),s.push(n)}for(l=0;l<e.metricsTensors.length;++l){var f=e.metricsTensors[l][0],g=e.metricsTensors[l][1],m=t.mean(f(i[g],c[g]));s.push(m)}return s})}},i.prototype.fit=function(e,r,n){return void 0===n&&(n={}),w(this,void 0,void 0,function(){var i,a,l,u,c,h,p,f,g,m,y,v,w,E,x,O,S,T,A,N=this;return b(this,function(b){switch(b.label){case 0:if(i=null==n.batchSize?32:n.batchSize,a=this.standardizeUserData(e,r,!1,i),l=a[0],u=a[1],c=!1,g=!1,null!=n.validationData&&n.validationData.length>0){if(c=!0,2!==n.validationData.length)throw 3===n.validationData.length?new o.NotImplementedError("validationData including sample weights is not supported yet."):new o.ValueError("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+n.validationData+" is invalid.");h=n.validationData[0],p=n.validationData[1],m=this.standardizeUserData(h,p,!0,i),h=m[0],p=m[1],f=h.concat(p)}else null!=n.validationSplit&&n.validationSplit>0&&n.validationSplit<1?(c=!0,y=Math.floor(l[0].shape[0]*(1-n.validationSplit)),v=l[0].shape[0],h=k(l,y,v),l=k(l,0,y),p=k(u,y,v),u=k(u,0,y),g=!0,f=h.concat(p)):null!=n.validationSteps&&(c=!0);return w=l.concat(u),this.checkTrainableWeightsConsistency(),E=function(e){var r=[],n=[],s=e.slice(0,N.inputs.length),o=e.slice(N.inputs.length,N.inputs.length+N.outputs.length),i=[],a=N.collectedTrainableWeights.map(function(e){return e.read()});return[N.optimizer.minimize(function(){for(var e=[],a=0;a<N.inputs.length;++a)e.push({key:N.inputs[a],value:s[a]});var l,u=new d.FeedDict(e),c=(0,d.execute)(N.outputs,u,{training:!0});for(a=0;a<N.lossFunctions.length;++a){var h=(0,N.lossFunctions[a])(o[a],c[a]);r.push(h);var p=t.mean(h);n.push(p),l=0===a?h:t.add(l,h)}for(a=0;a<N.metricsTensors.length;++a){var f=N.metricsTensors[a][0],g=N.metricsTensors[a][1],m=t.mean(f(o[g],c[g]));t.keep(m),i.push(m)}return l=t.mean(l),N.calculateLosses().forEach(function(e){l=t.add(l,e)}),l},!0,a)].concat(i)},x=this.getDedupedMetricsNames(),c?(this.makeTestFunction(),O=this.testFunction,S=x.slice().concat(x.map(function(e){return"val_"+e}))):(O=null,f=[],S=x.slice()),T=(0,s.standardizeCallbacks)(n.callbacks),[4,this.fitLoop(E,w,x,i,n.epochs,n.verbose,T,O,f,n.shuffle,S,null,null,null)];case 1:return A=b.sent(),g&&(f.forEach(function(e){return e.dispose()}),l.forEach(function(e){return e.dispose()}),u.forEach(function(e){return e.dispose()})),[2,A]}})})},i.prototype.getNamedWeights=function(e){for(var t={},r=null!=e&&e.trainableOnly,n=r?this.trainableWeights:this.weights,s=this.getWeights(r),o=0;o<n.length;++o)r&&!n[o].trainable||(t[n[o].originalName]=s[o]);return t},i.prototype.save=function(t,r){return w(this,void 0,void 0,function(){var n,s,i;return b(this,function(a){switch(a.label){case 0:if("string"==typeof t){if(0===(n=e.io.getSaveHandlers(t)).length)throw new o.ValueError("Cannot find any save handlers for URL '"+t+"'");if(n.length>1)throw new o.ValueError("Found more than one ("+n.length+") save handlers for URL '"+t+"'");t=n[0]}if(null==t.save)throw new o.ValueError("Model.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,e.io.encodeWeights(this.getNamedWeights(r))];case 1:return s=a.sent(),!1,null,i=this.toJSON(null,!1),[2,t.save({modelTopology:i,weightData:s.data,weightSpecs:s.specs})]}})})},i.className="Model",v([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[0]})],i.prototype,"compile",null),v([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[2]})],i.prototype,"evaluate",null),v([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[1]})],i.prototype,"predict",null),v([(0,e.doc)({heading:"Models",subheading:"Classes"})],i.prototype,"predictOnBatch",null),v([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[2]})],i.prototype,"fit",null),i=v([(0,e.doc)({heading:"Models",subheading:"Classes"})],i)}(g.Container);exports.Model=D,e.serialization.SerializationMap.register(D);
},{"@tensorflow/tfjs-core":49,"../backend/tfjs_backend":197,"../callbacks":90,"../errors":200,"../losses":266,"../metrics":267,"../optimizers":309,"../utils/generic_utils":198,"../utils/math_utils":310,"./executor":311,"./topology":201}],265:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP=exports.Orthogonal=exports.LeCunNormal=exports.HeNormal=exports.GlorotNormal=exports.GlorotUniform=exports.VarianceScaling=exports.Identity=exports.TruncatedNormal=exports.RandomNormal=exports.RandomUniform=exports.Constant=exports.Ones=exports.Zeros=exports.Initializer=exports.VALID_DISTRIBUTION_VALUES=exports.VALID_FAN_MODE_VALUES=void 0,exports.checkFanMode=p,exports.checkDistribution=d,exports.serializeInitializer=b,exports.getInitializer=U;var e=require("@tensorflow/tfjs-core"),t=require("./backend/tfjs_backend"),r=s(t),n=require("./common"),o=require("./errors"),a=require("./utils/generic_utils"),i=require("./utils/math_utils");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},c=exports.VALID_FAN_MODE_VALUES=["fanIn","fanOut","fanAvg"];function p(e){(0,a.checkStringTypeUnionValue)(c,"FanMode",e)}var m=exports.VALID_DISTRIBUTION_VALUES=["normal","uniform"];function d(e){(0,a.checkStringTypeUnionValue)(m,"Distribution",e)}var f=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return l(r,t),r.prototype.fromConfigUsesCustomObjects=function(){return!1},r.prototype.getConfig=function(){return{}},r=u([(0,e.doc)({heading:"Initializers",subheading:"Classes",namespace:"initializers"})],r)}(e.serialization.Serializable);exports.Initializer=f;var h=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return l(r,t),r.prototype.apply=function(t,r){return(0,e.zeros)(t,r)},r.className="Zeros",r}(f);exports.Zeros=h,e.serialization.SerializationMap.register(h);var g=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return l(r,t),r.prototype.apply=function(t,r){return(0,e.ones)(t,r)},r.className="Ones",r}(f);exports.Ones=g,e.serialization.SerializationMap.register(g);var v=function(t){function n(e){var r=t.call(this)||this;return r.value=e.value,r}return l(n,t),n.prototype.apply=function(t,n){var o=this;return(0,e.tidy)(function(){return r.scalarTimesArray((0,e.scalar)(o.value),(0,e.ones)(t,n))})},n.prototype.getConfig=function(){return{value:this.value}},n.className="Constant",n}(f);exports.Constant=v,e.serialization.SerializationMap.register(v);var y=function(t){function r(e){var r=t.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return l(r,t),r.prototype.apply=function(t,r){return(0,e.randomUniform)(t,this.minval,this.maxval,r)},r.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},r.className="RandomUniform",r}(f);exports.RandomUniform=y,e.serialization.SerializationMap.register(y);var N=function(e){function t(t){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=t.mean||r.DEFAULT_MEAN,r.stddev=t.stddev||r.DEFAULT_STDDEV,r.seed=t.seed,r}return l(t,e),t.prototype.apply=function(e,t){if("bool"===t)throw new o.NotImplementedError("randomNormal does not support dType bool.");return r.randomNormal(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(f);exports.RandomNormal=N,e.serialization.SerializationMap.register(N);var I=function(t){function r(e){var r=t.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return l(r,t),r.prototype.apply=function(t,r){if("bool"===r)throw new o.NotImplementedError("truncatedNormal does not support dType bool.");return(0,e.truncatedNormal)(t,this.mean,this.stddev,r,this.seed)},r.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},r.className="TruncatedNormal",r}(f);exports.TruncatedNormal=I,e.serialization.SerializationMap.register(I);var x=function(t){function n(n){var o=t.call(this)||this;return o.gain=null!=n.gain?(0,e.scalar)(n.gain):r.getScalar(1),o}return l(n,t),n.prototype.apply=function(t,n){var a=this;return(0,e.tidy)(function(){if(2!==t.length||t[0]!==t[1])throw new o.ValueError("Identity matrix initializer can only be used for 2D square matrices.");return r.scalarTimesArray(a.gain,(0,e.eye)(t[0]))})},n.prototype.getConfig=function(){return{gain:this.gain.get()}},n.className="Identity",n}(f);function A(e,t){var r,o;if(void 0===t&&(t="channelsLast"),(0,n.checkDataFormat)(t),2===e.length)r=e[0],o=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===t){var a=(0,i.arrayProd)(e,2);r=e[1]*a,o=e[0]*a}else if("channelsLast"===t){a=(0,i.arrayProd)(e,0,e.length-2);r=e[e.length-2]*a,o=e[e.length-1]*a}}else{var s=(0,i.arrayProd)(e);r=Math.sqrt(s),o=Math.sqrt(s)}return[r,o]}exports.Identity=x,e.serialization.SerializationMap.register(x);var _=function(t){function r(e){var r=t.call(this)||this;if(e.scale<0)throw new o.ValueError("scale must be a positive float. Got: "+e.scale);return r.scale=null==e.scale?1:e.scale,r.mode=e.mode,p(r.mode),r.distribution=e.distribution,d(r.distribution),r.seed=e.seed,r}return l(r,t),r.prototype.apply=function(t,r){var n=A(t),a=n[0],i=n[1],s=this.scale;if("fanIn"===this.mode?s/=Math.max(1,a):"fanOut"===this.mode?s/=Math.max(1,i):s/=Math.max(1,(a+i)/2),"normal"===this.distribution){var l=Math.sqrt(s);if("bool"===r)throw new o.NotImplementedError(this.getClassName()+" does not support dType bool.");return(0,e.truncatedNormal)(t,0,l,r,this.seed)}var u=Math.sqrt(3*s);return(0,e.randomUniform)(t,-u,u,r)},r.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},r.className="VarianceScaling",r}(f);exports.VarianceScaling=_,e.serialization.SerializationMap.register(_);var E=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})||this}return l(t,e),t.prototype.getClassName=function(){return _.className},t}(_);exports.GlorotUniform=E;var T=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})||this}return l(t,e),t.prototype.getClassName=function(){return _.className},t}(_);exports.GlorotNormal=T;var z=function(e){function t(t){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})||this}return l(t,e),t.prototype.getClassName=function(){return _.className},t}(_);exports.HeNormal=z;var D=function(e){function t(t){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})||this}return l(t,e),t.prototype.getClassName=function(){return _.className},t}(_);exports.LeCunNormal=D;var M=function(t){function n(e){var r=t.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new o.NotImplementedError("Random seed is not implemented for Orthogonal Initializer yet.");return r}return l(n,t),n.prototype.apply=function(t,n){var a=this;return(0,e.tidy)(function(){if(2!==t.length)throw new o.NotImplementedError("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var n=t[0]>t[1]?[t[1],t[0]]:t,i=r.randomNormal(n,0,1,"float32"),s=e.linalg.gramSchmidt(i);return t[0]>t[1]&&(s=s.transpose()),r.scalarTimesArray(r.getScalar(a.gain),s)})},n.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},n.className="Orthogonal",n}(f);exports.Orthogonal=M,e.serialization.SerializationMap.register(M);var L=exports.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",identity:"Identity",leCunNormal:"LeCunNormal",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function S(t,r){return void 0===r&&(r={}),(0,a.deserializeKerasObject)(t,e.serialization.SerializationMap.getMap().classNameMap,r,"initializer")}function b(e){return(0,a.serializeKerasObject)(e)}function U(e){if("string"==typeof e){var t=e in L?L[e]:e;return"GlorotUniform"===t?new E:"GlorotNormal"===t?new T:"HeNormal"===t?new z:"LeCunNormal"===t?new D:S({className:t,config:{}})}return e instanceof f?e:S(e)}
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./common":199,"./errors":200,"./utils/generic_utils":198,"./utils/math_utils":310}],353:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Softmax=exports.Tanh=exports.Softsign=exports.Softplus=exports.HardSigmoid=exports.Sigmoid=exports.Linear=exports.Relu6=exports.Relu=exports.Selu=exports.Elu=exports.Activation=void 0,exports.serializeActivation=v,exports.deserializeActivation=S,exports.getActivation=d;var t=require("@tensorflow/tfjs-core"),r=o(t),i=require("./backend/tfjs_backend"),e=o(i),n=require("./utils/generic_utils");function o(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i]);return r.default=t,r}var a=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])};return function(r,i){function e(){this.constructor=r}t(r,i),r.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),r.prototype.getConfig=function(){return{}},r}(t.serialization.Serializable);exports.Activation=s;var u=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),r.prototype.apply=function(t,r){return void 0===r&&(r=1),e.elu(t,r)},r.className="elu",r}(s);exports.Elu=u,t.serialization.SerializationMap.register(u);var p=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.apply=function(t){return r.selu(t)},i.className="selu",i}(s);exports.Selu=p,t.serialization.SerializationMap.register(p);var l=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.apply=function(t){return r.relu(t)},i.className="relu",i}(s);exports.Relu=l,t.serialization.SerializationMap.register(l);var c=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return a(n,i),n.prototype.apply=function(i){return(0,t.tidy)(function(){return r.minimum(e.getScalar(6),r.relu(i))})},n.className="relu6",n}(s);exports.Relu6=c,t.serialization.SerializationMap.register(c);var f=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),r.prototype.apply=function(t){return t},r.className="linear",r}(s);exports.Linear=f,t.serialization.SerializationMap.register(f);var y=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.apply=function(t){return r.sigmoid(t)},i.className="sigmoid",i}(s);exports.Sigmoid=y,t.serialization.SerializationMap.register(y);var g=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),r.prototype.apply=function(t){return e.hardSigmoid(t)},r.className="hardSigmoid",r}(s);exports.HardSigmoid=g,t.serialization.SerializationMap.register(g);var h=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.apply=function(t){return r.softplus(t)},i.className="softplus",i}(s);exports.Softplus=h,t.serialization.SerializationMap.register(h);var x=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),r.prototype.apply=function(t){return e.softsign(t)},r.className="softsign",r}(s);exports.Softsign=x,t.serialization.SerializationMap.register(x);var m=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.apply=function(t){return r.tanh(t)},i.className="tanh",i}(s);exports.Tanh=m,t.serialization.SerializationMap.register(m);var z=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.apply=function(t,i){return void 0===i&&(i=-1),r.softmax(t,i)},i.className="softmax",i}(s);function v(t){return t.getClassName()}function S(r,i){return void 0===i&&(i={}),(0,n.deserializeKerasObject)(r,t.serialization.SerializationMap.getMap().classNameMap,i,"activation")}function d(t){return null==t?S({className:"linear",config:{}}):"string"==typeof t?S({className:t,config:{}}):t instanceof s?t:S(t)}exports.Softmax=z,t.serialization.SerializationMap.register(z);
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./utils/generic_utils":198}],269:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Softmax=exports.ThresholdedReLU=exports.ELU=exports.LeakyReLU=void 0;var t=require("@tensorflow/tfjs-core"),e=require("../activations"),r=require("../backend/tfjs_backend"),a=require("../engine/topology"),o=require("../errors"),n=require("../utils/generic_utils"),i=l(n);function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var u=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),p=function(e){function r(t){var r=e.call(this,null==t?{}:t)||this;return r.DEFAULT_ALPHA=.3,null==t&&(t={}),r.alpha=null==t.alpha?r.DEFAULT_ALPHA:t.alpha,r}return u(r,e),r.prototype.call=function(e,r){var a=i.getExactlyOneTensor(e);return(0,t.leakyRelu)(a,this.alpha)},r.prototype.computeOutputShape=function(t){return t},r.prototype.getConfig=function(){var t={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(t,r),t},r.className="LeakyReLU",r}(a.Layer);exports.LeakyReLU=p,t.serialization.SerializationMap.register(p);var s=function(e){function r(t){var r=e.call(this,null==t?{}:t)||this;if(r.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==r.DEFAULT_ALPHA)throw new o.NotImplementedError("Non-default alpha value ("+t.alpha+") is not supported by the ELU layer yet.");return r.alpha=null==t.alpha?r.DEFAULT_ALPHA:t.alpha,r}return u(r,e),r.prototype.call=function(e,r){var a=i.getExactlyOneTensor(e);return(0,t.elu)(a)},r.prototype.computeOutputShape=function(t){return t},r.prototype.getConfig=function(){var t={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(t,r),t},r.className="ELU",r}(a.Layer);exports.ELU=s,t.serialization.SerializationMap.register(s);var c=function(t){function e(e){var a=t.call(this,null==e?{}:e)||this;return a.DEFAULT_THETA=1,null==e&&(e={}),a.theta=null==e.theta?a.DEFAULT_THETA:e.theta,a.thetaTensor=(0,r.getScalar)(a.theta),a}return u(e,t),e.prototype.call=function(t,e){var a=i.getExactlyOneTensor(t);return a.mul((0,r.cast)(a.greater(this.thetaTensor),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={theta:this.theta},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},e.className="ThresholdedReLU",e}(a.Layer);exports.ThresholdedReLU=c,t.serialization.SerializationMap.register(c);var h=function(t){function r(r){var a=t.call(this,null==r?{}:r)||this;return a.DEFAULT_AXIS=1,null==r&&(r={}),a.softmax=(new e.Softmax).apply,a.axis=null==r.axis?a.DEFAULT_AXIS:r.axis,a}return u(r,t),r.prototype.call=function(t,e){var r=i.getExactlyOneTensor(t);return this.softmax(r,this.axis)},r.prototype.computeOutputShape=function(t){return t},r.prototype.getConfig=function(){var e={axis:this.axis},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},r.className="Softmax",r}(a.Layer);exports.Softmax=h,t.serialization.SerializationMap.register(h);
},{"@tensorflow/tfjs-core":49,"../activations":353,"../backend/tfjs_backend":197,"../engine/topology":201,"../errors":200,"../utils/generic_utils":198}],268:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP=exports.L1L2=exports.Regularizer=void 0,exports.l1=s,exports.l2=c,exports.serializeRegularizer=p,exports.deserializeRegularizer=g,exports.getRegularizer=y;var e=require("@tensorflow/tfjs-core"),r=require("./backend/tfjs_backend"),t=l(r),n=require("./utils/generic_utils");function l(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var a=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),i=function(e,r,t,n){var l,a=arguments.length,i=a<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,n);else for(var o=e.length-1;o>=0;o--)(l=e[o])&&(i=(a<3?l(i):a>3?l(r,t,i):l(r,t))||i);return a>3&&i&&Object.defineProperty(r,t,i),i},o=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return a(r,e),r}(e.serialization.Serializable);exports.Regularizer=o;var u=function(r){function n(e){var n=r.call(this)||this,l=null==e||null==e.l1?.01:e.l1,a=null==e||null==e.l2?.01:e.l2;return n.hasL1=0!==l,n.hasL2=0!==a,n.l1=t.getScalar(l),n.l2=t.getScalar(a),n}return a(n,r),n.prototype.apply=function(r){var n=this;return(0,e.tidy)(function(){var l=(0,e.zeros)([1]);return n.hasL1&&(l=(0,e.add)(l,(0,e.sum)(t.scalarTimesArray(n.l1,(0,e.abs)(r))))),n.hasL2&&(l=(0,e.add)(l,(0,e.sum)(t.scalarTimesArray(n.l2,t.square(r))))),l.asScalar()})},n.prototype.getConfig=function(){return{l1:this.l1.dataSync()[0],l2:this.l2.dataSync()[0]}},n.fromConfig=function(e,r){return new e({l1:r.l1,l2:r.l2})},n.className="L1L2",n=i([(0,e.doc)({heading:"Regularizers",namespace:"regularizers"})],n)}(o);function s(e){return new u({l1:null!=e?e.l1:null,l2:0})}function c(e){return new u({l2:null!=e?e.l2:null,l1:0})}exports.L1L2=u,e.serialization.SerializationMap.register(u);var f=exports.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={l1l2:"L1L2"};function p(e){return(0,n.serializeKerasObject)(e)}function g(r,t){return void 0===t&&(t={}),(0,n.deserializeKerasObject)(r,e.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}function y(e){return null==e?null:"string"==typeof e?g({className:e in f?f[e]:e,config:{}}):e instanceof o?e:g(e)}
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./utils/generic_utils":198}],385:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeArray=n,exports.convOutputLength=u,exports.deconvLength=i;var e=require("../errors"),r=require("./generic_utils"),t=require("./math_utils");function n(n,u,i){if("number"==typeof n)return(0,r.pyListRepeat)(n,u);if(n.length!==u)throw new e.ValueError("The "+i+" argument must be a tuple of "+u+" integers. Received: "+n.length+" elements.");for(var o=0;o<u;++o){var a=n[o];if(!(0,t.isInteger)(a))throw new e.ValueError("The "+i+" argument must be a tuple of "+u+" integers. Received: "+JSON.stringify(n)+" including a non-integer number "+a)}return n}function u(e,r,t,n,u){return void 0===u&&(u=1),null==e?e:(i="same"===t?e:e-(r+(r-1)*(u-1))+1,Math.floor((i+n-1)/n));var i}function i(r,n,u,i){if(null==r)return null;if("valid"===i)r=r*n+(0,t.max)([u-n,0]);else{if("same"!==i)throw new e.ValueError("Unsupport padding mode: "+i+".");r*=n}return r}
},{"../errors":200,"./generic_utils":198,"./math_utils":310}],270:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpSampling2D=exports.Cropping2D=exports.Conv1D=exports.SeparableConv2D=exports.SeparableConv=exports.Conv2DTranspose=exports.Conv2D=exports.Conv=void 0,exports.preprocessConv2DInput=z,exports.conv1dWithBias=m,exports.conv1d=b,exports.conv2d=k,exports.conv2dWithBias=w;var e=require("@tensorflow/tfjs-core"),i=f(e),t=require("../activations"),r=require("../backend/common"),n=require("../backend/tfjs_backend"),a=f(n),s=require("../common"),o=require("../constraints"),l=require("../engine/topology"),p=require("../errors"),u=require("../initializers"),h=require("../regularizers"),d=require("../utils/conv_utils"),c=require("../utils/generic_utils"),g=f(c);function f(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t]);return i.default=e,i}var v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])};return function(i,t){function r(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();function z(t,r){return(0,e.tidy)(function(){return(0,s.checkDataFormat)(r),"channelsFirst"===r?i.transpose(t,[0,2,3,1]):t})}function m(t,n,o,l,u,h,d){return void 0===l&&(l=1),void 0===u&&(u="valid"),void 0===d&&(d=1),(0,e.tidy)(function(){if(null==h&&(h=(0,r.imageDataFormat)()),(0,s.checkDataFormat)(h),3!==t.shape.length)throw new p.ValueError("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==n.shape.length)throw new p.ValueError("The kernel for a conv1dWithBias operation should be 3, but is "+n.shape.length+" instead");if(null!=o&&1!==o.shape.length)throw new p.ValueError("The bias for a conv1dWithBias operation should be 1, but is "+n.shape.length+" instead");if("channelsFirst"===h&&(t=i.transpose(t,[0,2,1])),"causal"===u)throw new p.NotImplementedError("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var e=i.conv1d(t,n,l,"same"===u?"same":"valid","NWC",d);return null!=o&&(e=a.biasAdd(e,o)),e})}function b(i,t,r,n,a,o){return void 0===r&&(r=1),void 0===n&&(n="valid"),void 0===o&&(o=1),(0,e.tidy)(function(){return(0,s.checkDataFormat)(a),m(i,t,null,r,n,a,o)})}function k(i,t,r,n,a,o){return void 0===r&&(r=[1,1]),void 0===n&&(n="valid"),(0,e.tidy)(function(){return(0,s.checkDataFormat)(a),w(i,t,null,r,n,a,o)})}function w(t,n,o,l,u,h,d){return void 0===l&&(l=[1,1]),void 0===u&&(u="valid"),(0,e.tidy)(function(){if(null==h&&(h=(0,r.imageDataFormat)()),(0,s.checkDataFormat)(h),3!==t.rank&&4!==t.rank)throw new p.ValueError("conv2dWithBias expects input to be of rank 3 or 4, but received "+t.rank+".");if(3!==n.rank&&4!==n.rank)throw new p.ValueError("conv2dWithBias expects kernel to be of rank 3 or 4, but received "+t.rank+".");var e=z(t,h);if("causal"===u)throw new p.NotImplementedError("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return e=i.conv2d(e,n,l,"same"===u?"same":"valid","NHWC",d),null!=o&&(e=a.biasAdd(e,o)),"channelsFirst"===h&&(e=i.transpose(e,[0,3,1,2])),e})}var y=function(i){function r(e,r){var n=i.call(this,r)||this;if(n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.rank=e,1!==n.rank&&2!==n.rank)throw new p.NotImplementedError("Convolution layer for rank other than 1 or 2 ("+n.rank+") is not implemented yet.");if(n.filters=r.filters,n.kernelSize=(0,d.normalizeArray)(r.kernelSize,e,"kernelSize"),n.strides=(0,d.normalizeArray)(null==r.strides?1:r.strides,e,"strides"),n.padding=null==r.padding?"valid":r.padding,(0,s.checkPaddingMode)(n.padding),n.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,(0,s.checkDataFormat)(n.dataFormat),n.dilationRate=null==r.dilationRate?1:r.dilationRate,1===n.rank&&Array.isArray(n.dilationRate)&&1!==n.dilationRate.length)throw new p.ValueError("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(n.dilationRate));if(2===n.rank)if("number"==typeof n.dilationRate)n.dilationRate=[n.dilationRate,n.dilationRate];else if(2!==n.dilationRate.length)throw new p.ValueError("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(n.dilationRate));return n.activation=(0,t.getActivation)(r.activation),n.useBias=null==r.useBias||r.useBias,n.kernelInitializer=(0,u.getInitializer)(r.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=(0,u.getInitializer)(r.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=(0,o.getConstraint)(r.kernelConstraint),n.biasConstraint=(0,o.getConstraint)(r.biasConstraint),n.kernelRegularizer=(0,h.getRegularizer)(r.kernelRegularizer),n.biasRegularizer=(0,h.getRegularizer)(r.biasRegularizer),n.activityRegularizer=(0,h.getRegularizer)(r.activityRegularizer),n}return v(r,i),r.prototype.build=function(e){e=g.getExactlyOneShape(e);var i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i])throw new p.ValueError("The channel dimension of the input should be defined. Found "+e[i]);var t,r=e[i],n=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",n,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(t={},t[i]=r,t)}],this.built=!0},r.prototype.call=function(i,t){var r=this;return(0,e.tidy)(function(){var e;i=g.getExactlyOneTensor(i);var t=null==r.bias?null:r.bias.read();if(1===r.rank)e=m(i,r.kernel.read(),t,r.strides[0],r.padding,r.dataFormat,r.dilationRate);else if(2===r.rank)e=w(i,r.kernel.read(),t,r.strides,r.padding,r.dataFormat,r.dilationRate);else if(3===r.rank)throw new p.NotImplementedError("3D convolution is not implemented yet.");return null!=r.activation&&(e=r.activation.apply(e)),e})},r.prototype.computeOutputShape=function(e){e=g.getExactlyOneShape(e);for(var i=[],t="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<t.length;++r){var n=(0,d.convOutputLength)(t[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);i.push(n)}var a=[e[0]];return"channelsLast"===this.dataFormat?(a=a.concat(i)).push(this.filters):(a.push(this.filters),a=a.concat(i)),a},r.prototype.getConfig=function(){var e={rank:this.rank,filters:this.filters,kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:(0,t.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,u.serializeInitializer)(this.kernelInitializer),biasInitializer:(0,u.serializeInitializer)(this.biasInitializer),kernelRegularizer:(0,h.serializeRegularizer)(this.kernelRegularizer),biasRegularizer:(0,h.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,h.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,o.serializeConstraint)(this.kernelConstraint),biasConstraint:(0,o.serializeConstraint)(this.biasConstraint)},r=i.prototype.getConfig.call(this);return Object.assign(e,r),e},r}(l.Layer);exports.Conv=y;var I=function(e){function i(i){return e.call(this,2,i)||this}return v(i,e),i.prototype.getConfig=function(){var i=e.prototype.getConfig.call(this);return delete i.rank,i},i.className="Conv2D",i}(y);exports.Conv2D=I,e.serialization.SerializationMap.register(I);var C=function(e){function t(i){var t=e.call(this,i)||this;if(t.inputSpec=[new l.InputSpec({ndim:4})],"same"!==t.padding&&"valid"!==t.padding)throw new p.ValueError("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+t.padding);return t}return v(t,e),t.prototype.build=function(e){if(4!==(e=g.getExactlyOneShape(e)).length)throw new p.ValueError("Input should have rank 4; Received input shape: "+JSON.stringify(e));var i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i])throw new p.ValueError("The channel dimension of the inputs should be defined. Found `None`.");var t,r=e[i],n=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",n,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new l.InputSpec({ndim:4,axes:(t={},t[i]=r,t)})],this.built=!0},t.prototype.call=function(e,t){var r=this;return i.tidy(function(){var t=g.getExactlyOneTensor(e);if(4!==t.shape.length)throw new p.ValueError("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+t.shape.length);var n,s,o=t.shape,l=o[0];"channelsFirst"===r.dataFormat?(n=2,s=3):(n=1,s=2);var u=o[n],h=o[s],c=r.kernelSize[0],f=r.kernelSize[1],v=r.strides[0],z=r.strides[1],m=[l,(0,d.deconvLength)(u,v,c,r.padding),(0,d.deconvLength)(h,z,f,r.padding),r.filters];"channelsLast"!==r.dataFormat&&(t=i.transpose(t,[0,2,3,1]));var b=i.conv2dTranspose(t,r.kernel.read(),m,r.strides,r.padding);return"channelsLast"!==r.dataFormat&&(b=i.transpose(b,[0,3,1,2])),null!=r.bias&&(b=a.biasAdd(b,r.bias.read(),r.dataFormat)),null!=r.activation&&(b=r.activation.apply(b)),b})},t.prototype.computeOutputShape=function(e){var i,t,r,n=(e=g.getExactlyOneShape(e)).slice();"channelsFirst"===this.dataFormat?(i=1,t=2,r=3):(i=3,t=1,r=2);var a=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return n[i]=this.filters,n[t]=(0,d.deconvLength)(n[t],o,a,this.padding),n[r]=(0,d.deconvLength)(n[r],l,s,this.padding),n},t.prototype.getConfig=function(){var i=e.prototype.getConfig.call(this);return delete i.dilationRate,i},t.className="Conv2DTranspose",t}(I);exports.Conv2DTranspose=C,e.serialization.SerializationMap.register(C);var R=function(t){function r(e,i){var r=t.call(this,e,i)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==i.filters)throw new p.ValueError("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=i.kernelInitializer||null!=i.kernelRegularizer||null!=i.kernelConstraint)throw new p.ValueError("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=i.padding&&"same"!==i.padding&&"valid"!==i.padding)throw new p.ValueError("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(i.padding));return r.depthMultiplier=null==i.depthMultiplier?1:i.depthMultiplier,r.depthwiseInitializer=(0,u.getInitializer)(i.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=(0,h.getRegularizer)(i.depthwiseRegularizer),r.depthwiseConstraint=(0,o.getConstraint)(i.depthwiseConstraint),r.pointwiseInitializer=(0,u.getInitializer)(i.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=(0,h.getRegularizer)(i.pointwiseRegularizer),r.pointwiseConstraint=(0,o.getConstraint)(i.pointwiseConstraint),r}return v(r,t),r.prototype.build=function(e){if((e=g.getExactlyOneShape(e)).length<this.rank+2)throw new p.ValueError("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(e));var i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i]||e[i]<0)throw new p.ValueError("The channel dimension of the inputs should be defined, but found "+JSON.stringify(e[i]));for(var t=e[i],r=this.kernelSize.concat([t,this.depthMultiplier]),n=[],a=0;a<this.rank;++a)n.push(1);n.push(t*this.depthMultiplier,this.filters);var s;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",n,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new l.InputSpec({ndim:this.rank+2,axes:(s={},s[i]=t,s)})],this.built=!0},r.prototype.call=function(t,r){var n=this;return(0,e.tidy)(function(){var e;if(t=g.getExactlyOneTensor(t),1===n.rank)throw new p.NotImplementedError("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=i.transpose(t,[0,2,3,1])),e=i.separableConv2d(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=a.biasAdd(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=i.transpose(e,[0,3,1,2])),e})},r.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=(0,u.serializeInitializer)(this.depthwiseInitializer),e.pointwiseInitializer=(0,u.serializeInitializer)(this.pointwiseInitializer),e.depthwiseRegularizer=(0,h.serializeRegularizer)(this.depthwiseRegularizer),e.pointwiseRegularizer=(0,h.serializeRegularizer)(this.pointwiseRegularizer),e.depthwiseConstraint=(0,o.serializeConstraint)(this.depthwiseConstraint),e.pointwiseConstraint=(0,o.serializeConstraint)(this.pointwiseConstraint),e},r.className="SeparableConv",r}(y);exports.SeparableConv=R;var F=function(e){function i(i){return e.call(this,2,i)||this}return v(i,e),i.className="SeparableConv2D",i}(R);exports.SeparableConv2D=F,e.serialization.SerializationMap.register(F);var S=function(e){function i(i){var t=e.call(this,1,i)||this;return t.inputSpec=[{ndim:3}],t}return v(i,e),i.prototype.getConfig=function(){var i=e.prototype.getConfig.call(this);return delete i.rank,delete i.dataFormat,i},i.className="Conv1D",i}(y);exports.Conv1D=S,e.serialization.SerializationMap.register(S);var E=function(i){function t(e){var t=i.call(this,e)||this;return"number"==typeof e.cropping?t.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?t.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:t.cropping=e.cropping,t.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,t.inputSpec=[{ndim:4}],t}return v(t,i),t.prototype.computeOutputShape=function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]},t.prototype.call=function(i,t){var r=this;return(0,e.tidy)(function(){if(i=g.getExactlyOneTensor(i),"channelsLast"===r.dataFormat){var e=a.sliceAlongAxis(i,r.cropping[0][0],i.shape[1]-r.cropping[0][0]-r.cropping[0][1],2);return a.sliceAlongAxis(e,r.cropping[1][0],i.shape[2]-r.cropping[1][1]-r.cropping[1][0],3)}e=a.sliceAlongAxis(i,r.cropping[0][0],i.shape[2]-r.cropping[0][0]-r.cropping[0][1],3);return a.sliceAlongAxis(e,r.cropping[1][0],i.shape[3]-r.cropping[1][1]-r.cropping[1][0],4)})},t.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=i.prototype.getConfig.call(this);return Object.assign(e,t),e},t.className="Cropping2D",t}(l.Layer);exports.Cropping2D=E,e.serialization.SerializationMap.register(E);var D=function(e){function t(i){var t=e.call(this,i)||this;return t.DEFAULT_SIZE=[2,2],t.inputSpec=[{ndim:4}],t.size=void 0===i.size?t.DEFAULT_SIZE:i.size,t.dataFormat=void 0===i.dataFormat?"channelsLast":i.dataFormat,t}return v(t,e),t.prototype.computeOutputShape=function(e){if("channelsFirst"===this.dataFormat){var i=this.size[0]*e[2],t=this.size[1]*e[3];return[e[0],e[1],i,t]}i=this.size[0]*e[1],t=this.size[1]*e[2];return[e[0],i,t,e[3]]},t.prototype.call=function(e,t){var r=this;return i.tidy(function(){var t=g.getExactlyOneTensor(e),n=t.shape;if("channelsFirst"===r.dataFormat){t=i.transpose(t,[0,2,3,1]);var a=r.size[0]*n[2],s=r.size[1]*n[3],o=t.resizeNearestNeighbor([a,s]);return i.transpose(o,[0,3,1,2])}a=r.size[0]*n[1],s=r.size[1]*n[2];return t.resizeNearestNeighbor([a,s])})},t.prototype.getConfig=function(){var i={size:this.size,dataFormat:this.dataFormat},t=e.prototype.getConfig.call(this);return Object.assign(i,t),i},t.className="UpSampling2D",t}(l.Layer);exports.UpSampling2D=D,e.serialization.SerializationMap.register(D);
},{"@tensorflow/tfjs-core":49,"../activations":353,"../backend/common":350,"../backend/tfjs_backend":197,"../common":199,"../constraints":264,"../engine/topology":201,"../errors":200,"../initializers":265,"../regularizers":268,"../utils/conv_utils":385,"../utils/generic_utils":198}],271:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DepthwiseConv2D=void 0,exports.depthwiseConv2d=w;var e=require("@tensorflow/tfjs-core"),t=c(e),i=require("../backend/common"),r=require("../backend/tfjs_backend"),n=c(r),s=require("../common"),a=require("../constraints"),o=require("../errors"),l=require("../initializers"),u=require("../regularizers"),h=require("../utils/conv_utils"),p=require("../utils/generic_utils"),d=require("./convolutional");function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function w(r,n,a,l,u,h){return void 0===a&&(a=[1,1]),void 0===l&&(l="valid"),(0,e.tidy)(function(){null==u&&(u=(0,i.imageDataFormat)()),(0,s.checkDataFormat)(u);var e=(0,d.preprocessConv2DInput)(r,u);if(4!==r.rank)throw new o.ValueError("Input for depthwiseConv2d is required to be 4-D, but is instead "+r.rank+"-D");if(4!==n.rank)throw new o.ValueError("depthwiseKernel is required to be 4-D, but is instead "+n.rank+"-D");return e=t.depthwiseConv2d(e,n,a,"same"===l?"same":"valid","NHWC",h),"channelsFirst"===u&&(e=t.transpose(e,[0,3,1,2])),e})}var f=function(t){function i(e){var i=t.call(this,e)||this;return i.depthwiseKernel=null,i.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,i.depthwiseInitializer=(0,l.getInitializer)(e.depthwiseInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.depthwiseConstraint=(0,a.getConstraint)(e.depthwiseConstraint),i.depthwiseRegularizer=(0,u.getRegularizer)(e.depthwiseRegularizer),i}return v(i,t),i.prototype.build=function(e){if((e=(0,p.getExactlyOneShape)(e)).length<4)throw new o.ValueError("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(e)+".");var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new o.ValueError("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+e[t]+").");var i=e[t],r=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},i.prototype.call=function(t,i){var r=this;return(0,e.tidy)(function(){var e=w(t=(0,p.getExactlyOneTensor)(t),r.depthwiseKernel.read(),r.strides,r.padding,r.dataFormat,null);return r.useBias&&(e=n.biasAdd(e,r.bias.read(),r.dataFormat)),null!=r.activation&&(e=r.activation.apply(e)),e})},i.prototype.computeOutputShape=function(e){e=(0,p.getExactlyOneShape)(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],i="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,n=(0,h.convOutputLength)(t,this.kernelSize[0],this.padding,this.strides[0]),s=(0,h.convOutputLength)(i,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,n,s]:[e[0],n,s,r]},i.className="DepthwiseConv2D",i}(d.Conv2D);exports.DepthwiseConv2D=f,e.serialization.SerializationMap.register(f);
},{"@tensorflow/tfjs-core":49,"../backend/common":350,"../backend/tfjs_backend":197,"../common":199,"../constraints":264,"../errors":200,"../initializers":265,"../regularizers":268,"../utils/conv_utils":385,"../utils/generic_utils":198,"./convolutional":270}],272:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Reshape=exports.RepeatVector=exports.Activation=exports.Flatten=exports.Dense=exports.Dropout=void 0;var e=require("@tensorflow/tfjs-core"),t=require("../activations"),i=require("../backend/tfjs_backend"),r=g(i),n=require("../constraints"),a=require("../engine/topology"),o=require("../errors"),s=require("../initializers"),l=require("../regularizers"),u=require("../utils/generic_utils"),p=g(u),c=require("../utils/math_utils"),h=g(c);function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var f=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),y=function(t){function i(e){var i=t.call(this,e)||this;if(i.rate=Math.max(Math.min(e.rate,1),0),i.rateScalar=r.getScalar(i.rate),i.noiseShape=e.noiseShape,i.seed=e.seed,null!=i.seed)throw new o.NotImplementedError("Non-default seed is not implemented in Dropout layer yet: "+i.seed);return i.supportsMasking=!0,i}return f(i,t),i.prototype.getNoiseShape=function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,i=[],r=0;r<this.noiseShape.length;++r)i.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return i},i.prototype.call=function(t,i){var n=this;return(0,e.tidy)(function(){n.invokeCallHook(t,i);var a=p.getExactlyOneTensor(t);if(null!=n.noiseShape&&!e.util.arraysEqual(a.shape,n.noiseShape))throw new o.NotImplementedError("Non-default noise shape is not implemented in Dropout layer yet: "+JSON.stringify(n.noiseShape));if(0<n.rate&&n.rate<1){var s=null!=i.training&&i.training,l=n.getNoiseShape(a);return r.inTrainPhase(function(){return r.dropout(a,n.rateScalar,l,n.seed)},function(){return a},s)}return t})},i.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},i.className="Dropout",i}(a.Layer);exports.Dropout=y,e.serialization.SerializationMap.register(y);var v=function(i){function a(e){var r=i.call(this,e)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,r.activation=(0,t.getActivation)(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=(0,s.getInitializer)(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=(0,s.getInitializer)(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=(0,n.getConstraint)(e.kernelConstraint),r.biasConstraint=(0,n.getConstraint)(e.biasConstraint),r.kernelRegularizer=(0,l.getRegularizer)(e.kernelRegularizer),r.biasRegularizer=(0,l.getRegularizer)(e.biasRegularizer),r.activityRegularizer=(0,l.getRegularizer)(e.activityRegularizer),r.inputSpec=[{minNDim:2}],r}return f(a,i),a.prototype.build=function(e){var t,i=(e=p.getExactlyOneShape(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(t={},t[-1]=i,t)}],this.built=!0},a.prototype.computeOutputShape=function(e){var t=(e=p.getExactlyOneShape(e)).slice();return t[t.length-1]=this.units,t},a.prototype.call=function(t,i){var n=this;return(0,e.tidy)(function(){n.invokeCallHook(t,i);var e=p.getExactlyOneTensor(t),a=r.dot(e,n.kernel.read());return null!=n.bias&&(a=r.biasAdd(a,n.bias.read())),null!=n.activation&&(a=n.activation.apply(a)),a})},a.prototype.getConfig=function(){var e={units:this.units,activation:(0,t.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,s.serializeInitializer)(this.kernelInitializer),biasInitializer:(0,s.serializeInitializer)(this.biasInitializer),kernelRegularizer:(0,l.serializeRegularizer)(this.kernelRegularizer),biasRegularizer:(0,l.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,l.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,n.serializeConstraint)(this.kernelConstraint),biasConstraint:(0,n.serializeConstraint)(this.biasConstraint)},r=i.prototype.getConfig.call(this);return Object.assign(e,r),e},a.className="Dense",a}(a.Layer);exports.Dense=v,e.serialization.SerializationMap.register(v);var z=function(t){function i(e){var i=t.call(this,e||{})||this;return i.inputSpec=[{minNDim:3}],i}return f(i,t),i.prototype.computeOutputShape=function(e){for(var t=0,i=(e=p.getExactlyOneShape(e)).slice(1);t<i.length;t++){if(null==i[t])throw new o.ValueError('The shape of the input to "Flatten" is not fully defined (got '+e.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.')}return[e[0],h.arrayProd(e,1)]},i.prototype.call=function(t,i){var n=this;return(0,e.tidy)(function(){return n.invokeCallHook(t,i),r.batchFlatten(p.getExactlyOneTensor(t))})},i.className="Flatten",i}(a.Layer);exports.Flatten=z,e.serialization.SerializationMap.register(z);var S=function(i){function r(e){var r=i.call(this,e)||this;return r.supportsMasking=!0,r.activation=(0,t.getActivation)(e.activation),r}return f(r,i),r.prototype.call=function(t,i){var r=this;return(0,e.tidy)(function(){r.invokeCallHook(t,i);var e=p.getExactlyOneTensor(t);return r.activation.apply(e)})},r.prototype.getConfig=function(){var e={activation:(0,t.serializeActivation)(this.activation)},r=i.prototype.getConfig.call(this);return Object.assign(e,r),e},r.className="Activation",r}(a.Layer);exports.Activation=S,e.serialization.SerializationMap.register(S);var d=function(t){function i(e){var i=t.call(this,e)||this;return i.n=e.n,i.inputSpec=[{ndim:2}],i}return f(i,t),i.prototype.computeOutputShape=function(e){return[e[0],this.n,e[1]]},i.prototype.call=function(t,i){var n=this;return(0,e.tidy)(function(){return t=(0,u.getExactlyOneTensor)(t),r.repeat(t,n.n)})},i.prototype.getConfig=function(){var e={n:this.n},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},i.className="RepeatVector",i}(a.Layer);exports.RepeatVector=d,e.serialization.SerializationMap.register(d);var k=function(t){function i(e){var i=t.call(this,e)||this;i.targetShape=e.targetShape;for(var r=0;r<i.targetShape.length;++r)i.isUnknown(i.targetShape[r])&&(i.targetShape[r]=null);return i}return f(i,t),i.prototype.isUnknown=function(e){return e<0||null==e},i.prototype.fixUnknownDimension=function(e,t){for(var i="Total size of new array must be unchanged.",r=t.slice(),n=1,a=null,s=0;s<r.length;++s){var l=r[s];if(this.isUnknown(l)){if(null!==a)throw new o.ValueError("Can only specifiy one unknown dimension.");a=s}else n*=l}var u=h.arrayProd(e);if(null!==a){if(0===n||u%n!=0)throw new o.ValueError(i);r[a]=u/n}else if(u!==n)throw new o.ValueError(i);return r},i.prototype.computeOutputShape=function(e){for(var t=!1,i=0;i<e.length;++i)if(this.isUnknown(e[i])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))},i.prototype.call=function(t,i){var n=this;return(0,e.tidy)(function(){n.invokeCallHook(t,i);var e=p.getExactlyOneTensor(t),a=r.shape(e),o=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return e.reshape(o)})},i.prototype.getConfig=function(){var e={targetShape:this.targetShape},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},i.className="Reshape",i}(a.Layer);exports.Reshape=k,e.serialization.SerializationMap.register(k);
},{"@tensorflow/tfjs-core":49,"../activations":353,"../backend/tfjs_backend":197,"../constraints":264,"../engine/topology":201,"../errors":200,"../initializers":265,"../regularizers":268,"../utils/generic_utils":198,"../utils/math_utils":310}],273:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Embedding=void 0;var e=require("@tensorflow/tfjs-core"),t=require("../backend/tfjs_backend"),i=p(t),n=require("../constraints"),r=require("../engine/topology"),u=require("../errors"),a=require("../initializers"),o=require("../regularizers"),s=require("../utils/generic_utils"),l=p(s);function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var h=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),g=function(t){function r(e){var i=t.call(this,e)||this;if(i.embeddings=null,i.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var r=null;null!=e.batchSize&&(r=e.batchSize),null==e.inputLength?i.batchInputShape=[r,null]:i.batchInputShape=[r].concat(l.toList(e.inputLength))}return i.inputDim=e.inputDim,i.outputDim=e.outputDim,i.embeddingsInitializer=(0,a.getInitializer)(e.embeddingsInitializer||i.DEFAULT_EMBEDDINGS_INITIALIZER),i.embeddingsRegularizer=(0,o.getRegularizer)(e.embeddingsRegularizer),i.activityRegularizer=(0,o.getRegularizer)(e.activityRegularizer),i.embeddingsConstraint=(0,n.getConstraint)(e.embeddingsConstraint),i.maskZero=e.maskZero,i.inputLength=e.inputLength,i}return h(r,t),r.prototype.build=function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},r.prototype.computeMask=function(e,t){throw new u.NotImplementedError("computeMask has not been implemented for Embedding yet")},r.prototype.computeOutputShape=function(e){if(e=l.getExactlyOneShape(e),null==this.inputLength)return e.concat([this.outputDim]);var t=l.toList(this.inputLength);if(t.length!==e.length-1)throw new u.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);for(var i=0,n=0;n<t.length;++n){var r=t[n],a=e[n+1];if(null!=r&&null!=a&&r!==a)throw new u.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);null==r&&(t[i]=a),i++}return[e[0]].concat(t,[this.outputDim])},r.prototype.call=function(t,n){var r=this;return(0,e.tidy)(function(){r.invokeCallHook(t,n);var e=l.getExactlyOneTensor(t);return"int32"!==i.dtype(e)&&(e=i.cast(e,"int32")),i.gather(r.embeddings.read(),e.as1D()).reshape((0,s.getExactlyOneShape)(r.computeOutputShape(e.shape)))})},r.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:(0,a.serializeInitializer)(this.embeddingsInitializer),embeddingsRegularizer:(0,o.serializeRegularizer)(this.embeddingsRegularizer),activityRegularizer:(0,o.serializeRegularizer)(this.activityRegularizer),embeddingsConstraint:(0,n.serializeConstraint)(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},r.className="Embedding",r}(r.Layer);exports.Embedding=g,e.serialization.SerializationMap.register(g);
},{"@tensorflow/tfjs-core":49,"../backend/tfjs_backend":197,"../constraints":264,"../engine/topology":201,"../errors":200,"../initializers":265,"../regularizers":268,"../utils/generic_utils":198}],274:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Concatenate=exports.Minimum=exports.Maximum=exports.Average=exports.Multiply=exports.Add=exports.Merge=void 0,exports.add=y,exports.multiply=m,exports.average=d,exports.maximum=A,exports.minimum=O,exports.concatenate=S;var r=require("@tensorflow/tfjs-core"),e=p(r),t=require("../backend/tfjs_backend"),n=p(t),i=require("../engine/topology"),a=require("../errors"),o=require("../utils/generic_utils"),u=p(o),s=require("../utils/math_utils"),l=p(s);function p(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var c=function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),h=function(t){function i(r){var e=t.call(this,r||{})||this;return e.supportsMasking=!0,e}return c(i,t),i.prototype.mergeFunction=function(r){throw new a.NotImplementedError},i.prototype.computeElementwiseOpOutputShape=function(r,e){if(null==r||null==e)return null;if(r.length<e.length)return this.computeElementwiseOpOutputShape(e,r);if(0===e.length)return r;for(var t=r.slice(0,r.length-e.length),n=0;n<e.length;++n){var i=r[r.length-e.length+n],o=e[n];if(null==i||null==o||i<0||o<0)t.push(null);else if(1===i)t.push(o);else if(1===o)t.push(i);else{if(i!==o)throw new a.ValueError("Operands could not be broadcast together with shapes "+JSON.stringify(r)+" "+JSON.stringify(e));t.push(i)}}return t},i.prototype.build=function(r){if(Array.isArray(r)&&!Array.isArray(r[0])&&(r=[u.getExactlyOneShape(r)]),(r=r).length<2)throw new a.ValueError("A merge layer should be called on an Array of at least 2 inputs. Got "+r.length+" input(s).");for(var e=[],t=0,n=r;t<n.length;t++){null!=(s=n[t])&&null!==s[0]&&e.push(s[0])}if((e=u.unique(e)).length>1)throw new a.ValueError("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(r)+".");for(var i=null==r[0]?null:r[0].slice(1),o=1;o<r.length;++o){var s=null==r[o]?null:r[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var l=r.map(function(r){return r.length});-1===r.indexOf(null)&&1===u.unique(l).length?this.reshapeRequired=!1:this.reshapeRequired=!0},i.prototype.call=function(t,i){var a=this;return(0,r.tidy)(function(){if(t=t,a.reshapeRequired){var r=[],i=t.map(function(r){return r.rank});if(-1===i.indexOf(null)){for(var o=l.max(i),u=0,s=t;u<s.length;u++){for(var p=(g=s[u]).rank,c=0;c<o-p;++c)g=n.expandDims(g,1);r.push(g)}return a.mergeFunction(r)}for(var h=!1,f=0,y=t;f<y.length;f++){var g;if(null==(p=(g=y[f]).rank)){var m=n.shape(g),v=m[0],d=m.slice(1).concat([v]),x=g.reshape([v].concat(l.arrayProd(m.slice(1))));x=(x=e.transpose(x,[1,0])).reshape(d),r.push(x),h=!0}else if(p>1){var A=l.range(1,p).concat([0]);r.push(e.transpose(g,A)),h=!0}else r.push(g)}var w=a.mergeFunction(r),O=w.rank;if(h)if(null==O){var M=n.shape(w);d=[v=M[M.length-1]].concat(M.slice(0,M.length-1));w=e.transpose(w.reshape([-1,v]),[1,0]).reshape(d)}else if(O>1){A=[O-1].concat(l.range(0,O-1));w=e.transpose(w,A)}return w}return a.mergeFunction(t)})},i.prototype.computeOutputShape=function(r){var e;e=null==(r=r)[0]?null:r[0].slice(1);for(var t=1;t<r.length;++t){var n=null==r[t]?null:r[t].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}for(var i=[],a=0,o=r;a<o.length;a++){null!=(n=o[a])&&null!==n[0]&&i.push(n[0])}return e=1===(i=u.unique(i)).length?i.concat(e):[null].concat(e)},i}(i.Layer);exports.Merge=h;var f=function(t){function n(r){return t.call(this,r)||this}return c(n,t),n.prototype.mergeFunction=function(t){return(0,r.tidy)(function(){for(var r=e.zeros(t[0].shape),n=0,i=t;n<i.length;n++){var a=i[n];r=e.add(r,a)}return r})},n.className="Add",n}(h);function y(r){return Array.isArray(r)?new f({}).apply(r):new f(r)}exports.Add=f,r.serialization.SerializationMap.register(f);var g=function(t){function n(r){return t.call(this,r)||this}return c(n,t),n.prototype.mergeFunction=function(t){return(0,r.tidy)(function(){for(var r=e.ones(t[0].shape),n=0,i=t;n<i.length;n++){var a=i[n];r=e.mul(r,a)}return r})},n.className="Multiply",n}(h);function m(r){return Array.isArray(r)?new g({}).apply(r):new g(r)}exports.Multiply=g,r.serialization.SerializationMap.register(g);var v=function(t){function i(r){return t.call(this,r)||this}return c(i,t),i.prototype.mergeFunction=function(t){return(0,r.tidy)(function(){for(var r=e.zeros(t[0].shape),i=0,a=t;i<a.length;i++){var o=a[i];r=e.add(r,o)}return n.scalarTimesArray(n.getScalar(1/t.length),r)})},i.className="Average",i}(h);function d(r){return Array.isArray(r)?new v({}).apply(r):new v(r)}exports.Average=v,r.serialization.SerializationMap.register(v);var x=function(t){function n(r){return t.call(this,r)||this}return c(n,t),n.prototype.mergeFunction=function(t){return(0,r.tidy)(function(){for(var r=t[0],n=1;n<t.length;++n)r=e.maximum(r,t[n]);return r})},n.className="Maximum",n}(h);function A(r){return Array.isArray(r)?new x({}).apply(r):new x(r)}exports.Maximum=x,r.serialization.SerializationMap.register(x);var w=function(t){function n(r){return t.call(this,r)||this}return c(n,t),n.prototype.mergeFunction=function(t){return(0,r.tidy)(function(){for(var r=t[0],n=1;n<t.length;++n)r=e.minimum(r,t[n]);return r})},n.className="Minimum",n}(h);function O(r){return Array.isArray(r)?new w({}).apply(r):new w(r)}exports.Minimum=w,r.serialization.SerializationMap.register(w);var M=function(e){function t(r){var t=e.call(this,r)||this;return t.DEFAULT_AXIS=-1,null==r&&(r={}),t.axis=null==r.axis?t.DEFAULT_AXIS:r.axis,t.supportsMasking=!0,t.reshapeRequired=!1,t}return c(t,e),t.prototype.build=function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new a.ValueError("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var t=!0,n=0,i=e=e;n<i.length;n++){if(null!=(h=i[n])){t=!1;break}}if(!t){for(var o=[],u=0;u<e.length;++u){var s=e[u].slice();s.splice(this.axis,1);for(var l=!1,p=0,c=o;p<c.length;p++){var h=c[p];if(r.util.arraysEqual(h,s)){l=!0;break}}l||o.push(s)}if(o.length>1)throw new a.ValueError("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}},t.prototype.mergeFunction=function(e){var t=this;return(0,r.tidy)(function(){return n.concatenate(e,t.axis)})},t.prototype.computeOutputShape=function(r){if(!Array.isArray(r)||!Array.isArray(r[0]))throw new a.ValueError("A `Concatenate` layer should be called on a list of inputs.");for(var e=r,t=e[0].slice(),n=this.axis<0?t.length+this.axis:this.axis,i=0,o=e.slice(1);i<o.length;i++){var u=o[i];if(null==t[n]||null==u[n]){t[n]=null;break}t[n]+=u[n]}return t},t.prototype.getConfig=function(){var r={axis:this.axis},t=e.prototype.getConfig.call(this);return Object.assign(r,t),r},t.className="Concatenate",t}(h);function S(r){return Array.isArray(r)?new M({}).apply(r):new M(r)}exports.Concatenate=M,r.serialization.SerializationMap.register(M);
},{"@tensorflow/tfjs-core":49,"../backend/tfjs_backend":197,"../engine/topology":201,"../errors":200,"../utils/generic_utils":198,"../utils/math_utils":310}],275:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BatchNormalization=void 0,exports.batchNormalization=z,exports.normalizeBatchInTraining=f;var e=require("@tensorflow/tfjs-core"),i=h(e),a=require("../backend/tfjs_backend"),t=h(a),r=require("../constraints"),n=require("../engine/topology"),o=require("../errors"),l=require("../initializers"),s=require("../regularizers"),u=require("../utils/generic_utils"),m=h(u),g=require("../utils/math_utils"),c=h(g);function h(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i[a]=e[a]);return i.default=e,i}var p=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var a in i)i.hasOwnProperty(a)&&(e[a]=i[a])};return function(i,a){function t(){this.constructor=i}e(i,a),i.prototype=null===a?Object.create(a):(t.prototype=a.prototype,new t)}}();function z(e,a,t,r,n,l){var s;if(void 0===l&&(l=.001),2===e.rank)s=i.batchNormalization2d(e,a,t,l,n,r);else if(3===e.rank)s=i.batchNormalization3d(e,a,t,l,n,r);else{if(4!==e.rank)throw new o.NotImplementedError("batchNormalization is not implememnted for array of rank "+e.rank+" yet");s=i.batchNormalization4d(e,a,t,l,n,r)}return s}function v(a,t,r,n,o){return void 0===o&&(o=.001),(0,e.tidy)(function(){var e=i.moments(a,n),l=e.mean,s=e.variance;return[z(a,l,s,r,t,o),l,s]})}function d(a,t,r,n,o){return void 0===o&&(o=.001),(0,e.tidy)(function(){for(var e=i.moments(a,n),l=e.mean,s=e.variance,u=[],m=0,g=c.range(0,a.rank);m<g.length;m++){var h=g[m];-1!==n.indexOf(h)?u.push(1):u.push(a.shape[h])}var p=l.reshape(u),v=s.reshape(u),d=null==t?null:t.reshape(u),f=null==r?null:r.reshape(u);return[z(a,p,v,f,d,o),l,s]})}function f(i,a,t,r,n){return void 0===n&&(n=.001),e.util.arraysEqual(r.slice().sort(),c.range(0,i.rank-1))?v(i,a,t,r,n):d(i,a,t,r,n)}var b=function(a){function u(e){var i=a.call(this,e)||this;return i.supportsMasking=!0,i.axis=null==e.axis?-1:e.axis,i.momentum=null==e.momentum?.99:e.momentum,i.epsilon=null==e.epsilon?.001:e.epsilon,i.center=null==e.center||e.center,i.scale=null==e.scale||e.scale,i.betaInitializer=(0,l.getInitializer)(e.betaInitializer||"zeros"),i.gammaInitializer=(0,l.getInitializer)(e.gammaInitializer||"ones"),i.movingMeanInitializer=(0,l.getInitializer)(e.movingMeanInitializer||"zeros"),i.movingVarianceInitializer=(0,l.getInitializer)(e.movingVarianceInitializer||"ones"),i.betaConstraint=(0,r.getConstraint)(e.betaConstraint),i.gammaConstraint=(0,r.getConstraint)(e.gammaConstraint),i.betaRegularizer=(0,s.getRegularizer)(e.betaRegularizer),i.gammaRegularizer=(0,s.getRegularizer)(e.gammaRegularizer),i.stepCount=0,i}return p(u,a),u.prototype.build=function(e){e=m.getExactlyOneShape(e);var i=this.axis>=0?this.axis:this.axis+e.length,a=e[i];if(null==a)throw new o.ValueError("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(e)+".");this.inputSpec=[new n.InputSpec({ndim:e.length,axes:(t={},t[i]=a,t)})];var t,r=[a];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0},u.prototype.call=function(a,r){var n=this;return(0,e.tidy)(function(){var o=null!=r.training&&r.training,l=m.getExactlyOneTensor(a),s=t.shape(l),u=s.length,g=c.range(0,u),h=n.axis>=0?n.axis:n.axis+u;g.splice(h,1);var p=m.pyListRepeat(1,u);p[h]=s[h];var v=g.slice();v.sort();var d=!e.util.arraysEqual(v,c.range(0,u).slice(0,u-1));if(!o)return function(){if(d){var e=n.movingMean.read().reshape(p),i=n.movingVariance.read().reshape(p),a=n.center?n.beta.read().reshape(p):null,t=n.scale?n.gamma.read().reshape(p):null;return z(l,e,i,a,t,n.epsilon)}return z(l,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var b=f(l,n.gamma.read(),n.beta.read(),g,n.epsilon),I=b[0],y=b[1],x=b[2],C=c.arrayProd(g.map(function(e){return l.shape[e]})),_=x.mul(t.getScalar(C/(C-(1+n.epsilon))));return function(){n.stepCount++;var e=i.movingAverage(n.movingMean.read(),y,n.momentum,n.stepCount);n.movingMean.write(e);var a=i.movingAverage(n.movingVariance.read(),_,n.momentum,n.stepCount);n.movingVariance.write(a)}(),I})},u.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,l.serializeInitializer)(this.betaInitializer),gammaInitializer:(0,l.serializeInitializer)(this.gammaInitializer),movingMeanInitializer:(0,l.serializeInitializer)(this.movingMeanInitializer),movingVarianceInitializer:(0,l.serializeInitializer)(this.movingVarianceInitializer),betaRegularizer:(0,s.serializeRegularizer)(this.betaRegularizer),gammaRegularizer:(0,s.serializeRegularizer)(this.gammaRegularizer),betaConstraint:(0,r.serializeConstraint)(this.betaConstraint),gammaConstraint:(0,r.serializeConstraint)(this.gammaConstraint)},i=a.prototype.getConfig.call(this);return Object.assign(e,i),e},u.className="BatchNormalization",u}(n.Layer);exports.BatchNormalization=b,e.serialization.SerializationMap.register(b);
},{"@tensorflow/tfjs-core":49,"../backend/tfjs_backend":197,"../constraints":264,"../engine/topology":201,"../errors":200,"../initializers":265,"../regularizers":268,"../utils/generic_utils":198,"../utils/math_utils":310}],276:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ZeroPadding2D=void 0,exports.temporalPadding=p,exports.spatial2dPadding=l;var t=require("@tensorflow/tfjs-core"),n=d(t),e=require("../backend/common"),a=require("../engine/topology"),r=require("../errors"),i=require("../utils/generic_utils");function d(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}var o=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])};return function(n,e){function a(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}}();function p(e,a){return(0,t.tidy)(function(){if(3!==e.rank)throw new r.ValueError("temporalPadding expects input tensor to be 3-D, but received a "+e.rank+"-D tensor.");if(null==a&&(a=[1,1]),2!==a.length)throw new r.ValueError("temporalPadding expects input padding pattern to be a length-2 array, but received a length-"+a.length+" array.");var t=[[0,0],a,[0,0]];return n.pad(e,t)})}function l(a,i,d){return(0,t.tidy)(function(){if(4!==a.rank)throw new r.ValueError("temporalPadding expects input tensor to be 4-D, but received a "+a.rank+"-D tensor.");if(null==i&&(i=[[1,1],[1,1]]),2!==i.length||2!==i[0].length||2!==i[1].length)throw new r.ValueError("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==d&&(d=(0,e.imageDataFormat)()),"channelsLast"!==d&&"channelsFirst"!==d)throw new r.ValueError("Unknown data format: "+d+". Supported data formats are 'channelsLast' and 'channelsFirst.");var t;return t="channelsFirst"===d?[[0,0],[0,0],i[0],i[1]]:[[0,0],i[0],i[1],[0,0]],n.pad(a,t)})}var g=function(n){function d(t){var i=this;if(null==t&&(t={}),(i=n.call(this,t)||this).dataFormat=null==t.dataFormat?(0,e.imageDataFormat)():t.dataFormat,null==t.padding)i.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)i.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new r.ValueError("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+t.padding.length+" array.");var d=void 0,o=void 0;if("number"==typeof t.padding[0])d=[t.padding[0],t.padding[0]],o=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new r.ValueError("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+t.padding[0].length+" array.");if(d=t.padding[0],2!==t.padding[1].length)throw new r.ValueError("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+t.padding[1].length+" array.");o=t.padding[1]}i.padding=[d,o]}return i.inputSpec=[new a.InputSpec({ndim:4})],i}return o(d,n),d.prototype.computeOutputShape=function(t){var n,e;return t=(0,i.getExactlyOneShape)(t),"channelsFirst"===this.dataFormat?(n=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,e=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],n,e]):(n=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,e=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],n,e,t[3]])},d.prototype.call=function(n,e){var a=this;return(0,t.tidy)(function(){return l((0,i.getExactlyOneTensor)(n),a.padding,a.dataFormat)})},d.prototype.getConfig=function(){var t={padding:this.padding,dataFormat:this.dataFormat},e=n.prototype.getConfig.call(this);return Object.assign(t,e),t},d.className="ZeroPadding2D",d}(a.Layer);exports.ZeroPadding2D=g,t.serialization.SerializationMap.register(g);
},{"@tensorflow/tfjs-core":49,"../backend/common":350,"../engine/topology":201,"../errors":200,"../utils/generic_utils":198}],277:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlobalMaxPooling2D=exports.GlobalAveragePooling2D=exports.GlobalPooling2D=exports.GlobalMaxPooling1D=exports.GlobalAveragePooling1D=exports.GlobalPooling1D=exports.AveragePooling2D=exports.MaxPooling2D=exports.Pooling2D=exports.AveragePooling1D=exports.MaxPooling1D=exports.Pooling1D=void 0,exports.pool2d=h;var t=require("@tensorflow/tfjs-core"),o=d(t),e=require("../backend/common"),r=require("../backend/tfjs_backend"),n=d(r),i=require("../common"),a=require("../engine/topology"),l=require("../errors"),s=require("../utils/conv_utils"),p=require("../utils/generic_utils"),u=d(p),c=require("./convolutional");function d(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e]);return o.default=t,o}var g=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();function h(r,n,a,l,s,p){return(0,t.tidy)(function(){var t;(0,i.checkDataFormat)(s),(0,i.checkPoolMode)(p),(0,i.checkPaddingMode)(l),null==a&&(a=[1,1]),null==l&&(l="valid"),null==s&&(s=(0,e.imageDataFormat)()),null==p&&(p="max"),r=(0,c.preprocessConv2DInput)(r,s);var u="same"===l?"same":"valid";return t="max"===p?o.maxPool(r,n,a,u):o.avgPool(r,n,a,u),"channelsFirst"===s&&(t=o.transpose(t,[0,3,1,2])),t})}var f=function(e){function r(t){var o=this;if(null==t.poolSize&&(t.poolSize=2),o=e.call(this,t)||this,"number"==typeof t.poolSize)o.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new l.ValueError("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));o.poolSize=t.poolSize}if(null==t.strides)o.strides=o.poolSize;else if("number"==typeof t.strides)o.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new l.ValueError("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));o.strides=t.strides}return o.padding=null==t.padding?"valid":t.padding,(0,i.checkPaddingMode)(o.padding),o.inputSpec=[new a.InputSpec({ndim:3})],o}return g(r,e),r.prototype.computeOutputShape=function(t){t=u.getExactlyOneShape(t);var o=(0,s.convOutputLength)(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],o,t[2]]},r.prototype.call=function(e,r){var i=this;return(0,t.tidy)(function(){i.invokeCallHook(e,r),e=n.expandDims(u.getExactlyOneTensor(e),2);var t=i.poolingFunction(u.getExactlyOneTensor(e),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return o.squeeze(t,[2])})},r.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},o=e.prototype.getConfig.call(this);return Object.assign(t,o),t},r}(a.Layer);exports.Pooling1D=f;var m=function(t){function o(o){return t.call(this,o)||this}return g(o,t),o.prototype.poolingFunction=function(t,o,e,r,n){return(0,i.checkDataFormat)(n),(0,i.checkPaddingMode)(r),h(t,o,e,r,n,"max")},o.className="MaxPooling1D",o}(f);exports.MaxPooling1D=m,t.serialization.SerializationMap.register(m);var v=function(t){function o(o){return t.call(this,o)||this}return g(o,t),o.prototype.poolingFunction=function(t,o,e,r,n){return(0,i.checkDataFormat)(n),(0,i.checkPaddingMode)(r),h(t,o,e,r,n,"avg")},o.className="AveragePooling1D",o}(f);exports.AveragePooling1D=v,t.serialization.SerializationMap.register(v);var y=function(o){function e(t){var e=this;return null==t.poolSize&&(t.poolSize=[2,2]),(e=o.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],e.strides=null==t.strides?e.poolSize:t.strides,e.padding=null==t.padding?"valid":t.padding,e.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,(0,i.checkDataFormat)(e.dataFormat),(0,i.checkPaddingMode)(e.padding),e.inputSpec=[new a.InputSpec({ndim:4})],e}return g(e,o),e.prototype.computeOutputShape=function(t){t=u.getExactlyOneShape(t);var o="channelsFirst"===this.dataFormat?t[2]:t[1],e="channelsFirst"===this.dataFormat?t[3]:t[2];return o=(0,s.convOutputLength)(o,this.poolSize[0],this.padding,this.strides[0]),e=(0,s.convOutputLength)(e,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],o,e]:[t[0],o,e,t[3]]},e.prototype.call=function(o,e){var r=this;return(0,t.tidy)(function(){return r.invokeCallHook(o,e),r.poolingFunction(u.getExactlyOneTensor(o),r.poolSize,r.strides,r.padding,r.dataFormat)})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=o.prototype.getConfig.call(this);return Object.assign(t,e),t},e}(a.Layer);exports.Pooling2D=y;var x=function(t){function o(o){return t.call(this,o)||this}return g(o,t),o.prototype.poolingFunction=function(t,o,e,r,n){return(0,i.checkDataFormat)(n),(0,i.checkPaddingMode)(r),h(t,o,e,r,n,"max")},o.className="MaxPooling2D",o}(y);exports.MaxPooling2D=x,t.serialization.SerializationMap.register(x);var S=function(t){function o(o){return t.call(this,o)||this}return g(o,t),o.prototype.poolingFunction=function(t,o,e,r,n){return(0,i.checkDataFormat)(n),(0,i.checkPaddingMode)(r),h(t,o,e,r,n,"avg")},o.className="AveragePooling2D",o}(y);exports.AveragePooling2D=S,t.serialization.SerializationMap.register(S);var z=function(t){function o(o){var e=t.call(this,o)||this;return e.inputSpec=[new a.InputSpec({ndim:3})],e}return g(o,t),o.prototype.computeOutputShape=function(t){return[t[0],t[2]]},o.prototype.call=function(t,o){throw new l.NotImplementedError},o}(a.Layer);exports.GlobalPooling1D=z;var P=function(e){function r(t){return e.call(this,t)||this}return g(r,e),r.prototype.call=function(e,r){return(0,t.tidy)(function(){var t=u.getExactlyOneTensor(e);return o.mean(t,1)})},r.className="GlobalAveragePooling1D",r}(z);exports.GlobalAveragePooling1D=P,t.serialization.SerializationMap.register(P);var D=function(e){function r(t){return e.call(this,t)||this}return g(r,e),r.prototype.call=function(e,r){return(0,t.tidy)(function(){var t=u.getExactlyOneTensor(e);return o.max(t,1)})},r.className="GlobalMaxPooling1D",r}(z);exports.GlobalMaxPooling1D=D,t.serialization.SerializationMap.register(D);var b=function(t){function o(o){var e=t.call(this,o)||this;return e.dataFormat=null==o.dataFormat?"channelsLast":o.dataFormat,(0,i.checkDataFormat)(e.dataFormat),e.inputSpec=[new a.InputSpec({ndim:4})],e}return g(o,t),o.prototype.computeOutputShape=function(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},o.prototype.call=function(t,o){throw new l.NotImplementedError},o.prototype.getConfig=function(){var o={dataFormat:this.dataFormat},e=t.prototype.getConfig.call(this);return Object.assign(o,e),o},o}(a.Layer);exports.GlobalPooling2D=b;var F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return g(r,e),r.prototype.call=function(e,r){var n=this;return(0,t.tidy)(function(){var t=u.getExactlyOneTensor(e);return"channelsLast"===n.dataFormat?o.mean(t,[1,2]):o.mean(t,[2,3])})},r.className="GlobalAveragePooling2D",r}(b);exports.GlobalAveragePooling2D=F,t.serialization.SerializationMap.register(F);var M=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return g(r,e),r.prototype.call=function(e,r){var n=this;return(0,t.tidy)(function(){var t=u.getExactlyOneTensor(e);return"channelsLast"===n.dataFormat?o.max(t,[1,2]):o.max(t,[2,3])})},r.className="GlobalMaxPooling2D",r}(b);exports.GlobalMaxPooling2D=M,t.serialization.SerializationMap.register(M);
},{"@tensorflow/tfjs-core":49,"../backend/common":350,"../backend/tfjs_backend":197,"../common":199,"../engine/topology":201,"../errors":200,"../utils/conv_utils":385,"../utils/generic_utils":198,"./convolutional":270}],107:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StackedRNNCells=exports.LSTM=exports.LSTMCell=exports.GRU=exports.GRUCell=exports.SimpleRNN=exports.SimpleRNNCell=exports.RNNCell=exports.RNN=void 0,exports.rnn=I;var e=require("@tensorflow/tfjs-core"),t=d(e),r=require("../activations"),i=require("../backend/tfjs_backend"),n=d(i),a=require("../constraints"),l=require("../engine/topology"),s=require("../errors"),o=require("../initializers"),u=require("../regularizers"),c=require("../types"),p=require("../utils/generic_utils"),h=d(p),g=require("../utils/math_utils"),f=d(g),z=require("../variables"),b=require("./serialization");function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var y=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),m=function(e,t,r,i){var n,a=arguments.length,l=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(a<3?n(l):a>3?n(t,r,l):n(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l};function I(e,r,i,a,l,o,u,c){void 0===a&&(a=!1),void 0===u&&(u=!1);var p=r.shape.length;if(p<3)throw new s.ValueError("Input should be at least 3D, but is "+p+"D.");var h,g,z=[1,0].concat(f.range(2,p));if(r=t.transpose(r,z),null!=l)throw new s.NotImplementedError("The rnn() function of the deeplearn.js backend does not support masking yet.");if(null!=o)throw new s.NotImplementedError("The rnn() functoin of the deeplearn.js backend does not support constants yet.");u&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a&&(r=t.reverse(r,0));for(var b=i,d=r.shape[0],y=0;y<d;++y){var m=n.sliceAlongFirstAxis(r,y,1),I=e(m=m.reshape(m.shape.slice(1)),b);g=I[0],h=0===y?g.reshape([1].concat(g.shape)):n.concatAlongFirstAxis(h,g.reshape([1].concat(g.shape))),b=I[1]}return[g,t.transpose(h,[1,0].concat(f.range(2,h.shape.length))),b]}var R=function(r){function i(e){var t,i=r.call(this,e)||this;if(null==e.cell)throw new s.ValueError("cell property is missing for the constructor of RNN.");if(null==(t=Array.isArray(e.cell)?new T({cells:e.cell}):e.cell).stateSize)throw new s.ValueError("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=t,i.returnSequences=null!=e.returnSequences&&e.returnSequences,i.returnState=null!=e.returnState&&e.returnState,i.goBackwards=null!=e.goBackwards&&e.goBackwards,i._stateful=null!=e.stateful&&e.stateful,i.unroll=null!=e.unroll&&e.unroll,i.supportsMasking=!0,i.inputSpec=[new l.InputSpec({ndim:3})],i.stateSpec=null,i.states=null,i.numConstants=null,i}return y(i,r),i.prototype.getStates=function(){if(null==this.states){var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return f.range(0,e).map(function(e){return null})}return this.states},i.prototype.setStates=function(e){this.states=e},i.prototype.computeOutputShape=function(e){h.isArrayOfShapes(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var r,i=t[0];if(r=this.returnSequences?[e[0],e[1],i]:[e[0],i],this.returnState){for(var n=[],a=0,l=t;a<l.length;a++){var s=l[a];n.push([e[0],s])}return[r].concat(n)}return r},i.prototype.computeMask=function(e,t){throw new s.NotImplementedError("computeMask has not been implemented for RNN yet")},i.prototype.build=function(t){if(null!=this.numConstants)throw new s.NotImplementedError("Constants support is not implemented in RNN yet.");h.isArrayOfShapes(t)&&(t=t[0]),t=t;var r=this.stateful?t[0]:null,i=t[t.length-1];this.inputSpec[0]=new l.InputSpec({shape:[r,null,i]});var n,a=[t[0]].concat(t.slice(2));if(this.cell.build(a),n=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!e.util.arraysEqual(this.stateSpec.map(function(e){return e.shape[e.shape.length-1]}),n))throw new s.ValueError("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=n.map(function(e){return new l.InputSpec({shape:[null,e]})});if(this.stateful)throw new s.NotImplementedError("stateful RNN layer is not implemented yet")},i.prototype.resetStates=function(r){var i=this;(0,e.tidy)(function(){if(!i.stateful)throw new s.AttributeError("Cannot call resetState() on an RNN Layer that is not stateful.");var n=i.inputSpec[0].shape[0];if(null==n)throw new s.ValueError("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==i.states)Array.isArray(i.cell.stateSize)?i.states=i.cell.stateSize.map(function(e){return t.zeros([n,e])}):i.states=[t.zeros([n,i.cell.stateSize])];else if(null==r)Array.isArray(i.cell.stateSize)?i.states=i.cell.stateSize.map(function(e){return t.zeros([n,e])}):i.states[0]=t.zeros([n,i.cell.stateSize]);else{if(Array.isArray(r)||(r=[r]),r.length!==i.states.length)throw new s.ValueError("Layer "+i.name+" expects "+i.states.length+" state(s), but it received "+r.length+" state value(s). Input received: "+r);for(var a=0;a<i.states.length;++a){var l=r[a],o=Array.isArray(i.cell.stateSize)?i.cell.stateSize[a]:i.cell.stateSize,u=[n,o];if(!e.util.arraysEqual(l.shape,u))throw new s.ValueError("State "+a+" is incompatible with layer "+i.name+": expected shape="+u+", received shape="+l.shape);i.states[a]=l}}})},i.prototype.standardizeArgs=function(e,t,r){if(Array.isArray(e)){if(null!=t||null!=r)throw new s.ValueError("When inputs is an array, neither initialState or constants should be provided");null!=this.numConstants&&(r=e.slice(e.length-this.numConstants,e.length),e=e.slice(0,e.length-this.numConstants)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=i(t),constants:r=i(r)}},i.prototype.apply=function(e,t){var i=null==t?null:t.initialState,n=null==t?null:t.constants;null==t&&(t={});var a=this.standardizeArgs(e,i,n);e=a.inputs,i=a.initialState,n=a.constants;var s=[],o=[];if(null!=i){t.initialState=i,s=s.concat(i),this.stateSpec=[];for(var u=0,p=i;u<p.length;u++){var h=p[u];this.stateSpec.push(new l.InputSpec({shape:h.shape}))}o=o.concat(this.stateSpec)}if(null!=n&&(t.constants=n,s=s.concat(n),this.numConstants=n.length),s[0]instanceof c.SymbolicTensor){var g=[e].concat(s),f=this.inputSpec.concat(o),z=this.inputSpec;this.inputSpec=f;var b=r.prototype.apply.call(this,g,t);return this.inputSpec=z,b}return r.prototype.apply.call(this,e,t)},i.prototype.call=function(t,r){var i=this;return(0,e.tidy)(function(){var e=null==r?null:r.mask,n=null==r?null:r.training,a=null==r?null:r.initialState;if(t=h.getExactlyOneTensor(t),null==a){if(i.stateful)throw new s.NotImplementedError("stateful RNN layer is not implemented yet.");a=i.getInitialState(t)}if(null!=e)throw new s.NotImplementedError("Masking is not implemented for RNN yet");var l=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(a.length!==l)throw new s.ValueError("RNN Layer has "+l+" state(s) but was passed "+a.length+" initial state(s).");var o=t.shape[1];i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var u={training:n},c=I(function(e,t){var r=i.cell.call([e].concat(t),u);return[r[0],r.slice(1)]},t,a,i.goBackwards,null,null,i.unroll,o),p=c[0],g=c[1],f=c[2];if(i.stateful)throw new s.NotImplementedError("stateful RNN layer is not implemented yet");var z=i.returnSequences?g:p;return i.returnState?[z].concat(f):z})},i.prototype.getInitialState=function(r){var i=this;return(0,e.tidy)(function(){var e=t.zeros(r.shape);return e=t.sum(e,[1,2]),e=n.expandDims(e),Array.isArray(i.cell.stateSize)?i.cell.stateSize.map(function(t){return t>1?n.tile(e,[1,t]):e}):i.cell.stateSize>1?[n.tile(e,[1,i.cell.stateSize])]:[e]})},Object.defineProperty(i.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),i.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var t=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:t};var i=r.prototype.getConfig.call(this);return Object.assign(e,i),e},i.className="RNN",i}(l.Layer);exports.RNN=R,e.serialization.SerializationMap.register(R);var A=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return y(r,t),r=m([(0,e.doc)({heading:"Layers",subheading:"Classes"})],r)}(l.Layer);exports.RNNCell=A;var v=function(i){function l(e){var t=i.call(this,e)||this;return t.DEFAULT_ACTIVATION="tanh",t.DEFAULT_KERNEL_INITIALIZER="glorotNormal",t.DEFAULT_RECURRENT_INITIALIZER="orthogonal",t.DEFAULT_BIAS_INITIALIZER="zeros",t.units=e.units,t.activation=(0,r.getActivation)(null==e.activation?t.DEFAULT_ACTIVATION:e.activation),t.useBias=null==e.useBias||e.useBias,t.kernelInitializer=(0,o.getInitializer)(e.kernelInitializer||t.DEFAULT_KERNEL_INITIALIZER),t.recurrentInitializer=(0,o.getInitializer)(e.recurrentInitializer||t.DEFAULT_RECURRENT_INITIALIZER),t.biasInitializer=(0,o.getInitializer)(e.biasInitializer||t.DEFAULT_BIAS_INITIALIZER),t.kernelRegularizer=(0,u.getRegularizer)(e.kernelRegularizer),t.recurrentRegularizer=(0,u.getRegularizer)(e.recurrentRegularizer),t.biasRegularizer=(0,u.getRegularizer)(e.biasRegularizer),t.kernelConstraint=(0,a.getConstraint)(e.kernelConstraint),t.recurrentConstraint=(0,a.getConstraint)(e.recurrentConstraint),t.biasConstraint=(0,a.getConstraint)(e.biasConstraint),t.dropout=f.min([1,f.max([0,null==e.dropout?0:e.dropout])]),t.recurrentDropout=f.min([1,f.max([0,null==e.recurrentDropout?0:e.recurrentDropout])]),t.stateSize=t.units,t}return y(l,i),l.prototype.build=function(e){e=h.getExactlyOneShape(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},l.prototype.call=function(r,i){var a=this;return(0,e.tidy)(function(){if(2!==(r=r).length)throw new s.ValueError("SimpleRNNCell expects 2 input Tensors, got "+r.length+".");var e=r[1];if(r=r[0],0!==a.dropout||0!==a.recurrentDropout)throw new s.NotImplementedError("Dropout is not implemented for SimpleRNNCell yet");var i=n.dot(r,a.kernel.read());null!=a.bias&&(i=n.biasAdd(i,a.bias.read()));var l=t.add(i,n.dot(e,a.recurrentKernel.read()));return null!=a.activation&&(l=a.activation.apply(l)),[l,l]})},l.prototype.getConfig=function(){var e={units:this.units,activation:(0,r.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,o.serializeInitializer)(this.kernelInitializer),recurrentInitializer:(0,o.serializeInitializer)(this.recurrentInitializer),biasInitializer:(0,o.serializeInitializer)(this.biasInitializer),kernelRegularizer:(0,u.serializeRegularizer)(this.kernelRegularizer),recurrentRegularizer:(0,u.serializeRegularizer)(this.recurrentRegularizer),biasRegularizer:(0,u.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,u.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,a.serializeConstraint)(this.kernelConstraint),recurrentConstraint:(0,a.serializeConstraint)(this.recurrentConstraint),biasConstraint:(0,a.serializeConstraint)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},t=i.prototype.getConfig.call(this);return Object.assign(e,t),e},l.className="SimpleRNNCell",l}(A);exports.SimpleRNNCell=v,e.serialization.SerializationMap.register(v);var C=function(t){function i(e){return e.cell=new v(e),t.call(this,e)||this}return y(i,t),i.prototype.call=function(r,i){var n=this;return(0,e.tidy)(function(){var e=null==i?null:i.mask,a=null==i?null:i.training,l=null==i?null:i.initialState;return t.prototype.call.call(n,r,{mask:e,training:a,initialState:l})})},Object.defineProperty(i.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),i.prototype.getConfig=function(){var e={units:this.units,activation:(0,r.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,o.serializeInitializer)(this.kernelInitializer),recurrentInitializer:(0,o.serializeInitializer)(this.recurrentInitializer),biasInitializer:(0,o.serializeInitializer)(this.biasInitializer),kernelRegularizer:(0,u.serializeRegularizer)(this.kernelRegularizer),recurrentRegularizer:(0,u.serializeRegularizer)(this.recurrentRegularizer),biasRegularizer:(0,u.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,u.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,a.serializeConstraint)(this.kernelConstraint),recurrentConstraint:(0,a.serializeConstraint)(this.recurrentConstraint),biasConstraint:(0,a.serializeConstraint)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},i=t.prototype.getConfig.call(this);return delete i.cell,Object.assign(e,i),e},i.className="SimpleRNN",i}(R);exports.SimpleRNN=C,e.serialization.SerializationMap.register(C);var S=function(i){function l(e){var t=i.call(this,e)||this;return t.DEFAULT_ACTIVATION="tanh",t.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",t.DEFAULT_KERNEL_INITIALIZER="glorotNormal",t.DEFAULT_RECURRENT_INITIALIZER="orthogonal",t.DEFAULT_BIAS_INITIALIZER="zeros",t.units=e.units,t.activation=(0,r.getActivation)(void 0===e.activation?t.DEFAULT_ACTIVATION:e.activation),t.recurrentActivation=(0,r.getActivation)(void 0===e.activation?t.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),t.useBias=null==e.useBias||e.useBias,t.kernelInitializer=(0,o.getInitializer)(e.kernelInitializer||t.DEFAULT_KERNEL_INITIALIZER),t.recurrentInitializer=(0,o.getInitializer)(e.recurrentInitializer||t.DEFAULT_RECURRENT_INITIALIZER),t.biasInitializer=(0,o.getInitializer)(e.biasInitializer||t.DEFAULT_BIAS_INITIALIZER),t.kernelRegularizer=(0,u.getRegularizer)(e.kernelRegularizer),t.recurrentRegularizer=(0,u.getRegularizer)(e.recurrentRegularizer),t.biasRegularizer=(0,u.getRegularizer)(e.biasRegularizer),t.kernelConstraint=(0,a.getConstraint)(e.kernelConstraint),t.recurrentConstraint=(0,a.getConstraint)(e.recurrentConstraint),t.biasConstraint=(0,a.getConstraint)(e.biasConstraint),t.dropout=f.min([1,f.max([0,null==e.dropout?0:e.dropout])]),t.recurrentDropout=f.min([1,f.max([0,null==e.recurrentDropout?0:e.recurrentDropout])]),t.implementation=e.implementation,t.stateSize=t.units,t}return y(l,i),l.prototype.build=function(e){var t=(e=h.getExactlyOneShape(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},l.prototype.call=function(r,i){var a=this;return(0,e.tidy)(function(){if(0!==a.dropout||0!==a.recurrentDropout)throw new s.NotImplementedError("Dropout is not implemented for GRUCell yet");if(2!==(r=r).length)throw new s.ValueError("GRUCell expects 2 input Tensors (inputs, h, c), got "+r.length+".");var e,i,l,o=r[1];if(r=r[0],1===a.implementation){var u=n.sliceAlongLastAxis(a.kernel.read(),0,a.units),c=n.sliceAlongLastAxis(a.kernel.read(),a.units,a.units),p=n.sliceAlongLastAxis(a.kernel.read(),2*a.units,a.units),h=n.sliceAlongLastAxis(a.recurrentKernel.read(),0,a.units),g=n.sliceAlongLastAxis(a.recurrentKernel.read(),a.units,a.units),f=n.sliceAlongLastAxis(a.recurrentKernel.read(),2*a.units,a.units),z=r,b=r,d=r,y=n.dot(z,u),m=n.dot(b,c),I=n.dot(d,p);if(a.useBias){var R=n.sliceAlongFirstAxis(a.bias.read(),0,a.units),A=n.sliceAlongFirstAxis(a.bias.read(),a.units,a.units),v=n.sliceAlongFirstAxis(a.bias.read(),2*a.units,a.units);y=n.biasAdd(y,R),m=n.biasAdd(m,A),I=n.biasAdd(I,v)}var C=o,S=o,k=o;e=a.recurrentActivation.apply(t.add(y,n.dot(C,h))),i=a.recurrentActivation.apply(t.add(m,n.dot(S,g))),l=a.activation.apply(t.add(I,n.dot(t.mul(i,k),f)))}else{var N=n.dot(r,a.kernel.read());a.useBias&&(N=n.biasAdd(N,a.bias.read()));var E=n.dot(o,n.sliceAlongLastAxis(a.recurrentKernel.read(),0,2*a.units)),T=(y=n.sliceAlongLastAxis(N,0,a.units),m=n.sliceAlongLastAxis(N,a.units,a.units),n.sliceAlongLastAxis(E,0,a.units)),L=n.sliceAlongLastAxis(E,a.units,a.units);e=a.recurrentActivation.apply(t.add(y,T)),i=a.recurrentActivation.apply(t.add(m,L));I=n.sliceAlongLastAxis(N,2*a.units,a.units);var w=n.dot(t.mul(i,o),n.sliceAlongLastAxis(a.recurrentKernel.read(),2*a.units,a.units));l=a.activation.apply(t.add(I,w))}var O=t.add(t.mul(e,o),t.mul(n.scalarPlusArray(n.getScalar(1),t.neg(e)),l));return[O,O]})},l.prototype.getConfig=function(){var e={units:this.units,activation:(0,r.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,o.serializeInitializer)(this.kernelInitializer),recurrentInitializer:(0,o.serializeInitializer)(this.recurrentInitializer),biasInitializer:(0,o.serializeInitializer)(this.biasInitializer),kernelRegularizer:(0,u.serializeRegularizer)(this.kernelRegularizer),recurrentRegularizer:(0,u.serializeRegularizer)(this.recurrentRegularizer),biasRegularizer:(0,u.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,u.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,a.serializeConstraint)(this.kernelConstraint),recurrentConstraint:(0,a.serializeConstraint)(this.recurrentConstraint),biasConstraint:(0,a.serializeConstraint)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},t=i.prototype.getConfig.call(this);return Object.assign(e,t),e},l.className="GRUCell",l}(A);exports.GRUCell=S,e.serialization.SerializationMap.register(S);var k=function(t){function i(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new S(e),t.call(this,e)||this}return y(i,t),i.prototype.call=function(r,i){var n=this;return(0,e.tidy)(function(){var e=null==i?null:i.mask,a=null==i?null:i.training,l=null==i?null:i.initialState;return t.prototype.call.call(n,r,{mask:e,training:a,initialState:l})})},Object.defineProperty(i.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),i.prototype.getConfig=function(){var e={units:this.units,activation:(0,r.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,o.serializeInitializer)(this.kernelInitializer),recurrentInitializer:(0,o.serializeInitializer)(this.recurrentInitializer),biasInitializer:(0,o.serializeInitializer)(this.biasInitializer),kernelRegularizer:(0,u.serializeRegularizer)(this.kernelRegularizer),recurrentRegularizer:(0,u.serializeRegularizer)(this.recurrentRegularizer),biasRegularizer:(0,u.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,u.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,a.serializeConstraint)(this.kernelConstraint),recurrentConstraint:(0,a.serializeConstraint)(this.recurrentConstraint),biasConstraint:(0,a.serializeConstraint)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},i=t.prototype.getConfig.call(this);return delete i.cell,Object.assign(e,i),e},i.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},i.className="GRU",i}(R);exports.GRU=k,e.serialization.SerializationMap.register(k);var N=function(i){function l(e){var t=i.call(this,e)||this;return t.DEFAULT_ACTIVATION="tanh",t.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",t.DEFAULT_KERNEL_INITIALIZER="glorotNormal",t.DEFAULT_RECURRENT_INITIALIZER="orthogonal",t.DEFAULT_BIAS_INITIALIZER="zeros",t.units=e.units,t.activation=(0,r.getActivation)(void 0===e.activation?t.DEFAULT_ACTIVATION:e.activation),t.recurrentActivation=(0,r.getActivation)(void 0===e.activation?t.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),t.useBias=null==e.useBias||e.useBias,t.kernelInitializer=(0,o.getInitializer)(e.kernelInitializer||t.DEFAULT_KERNEL_INITIALIZER),t.recurrentInitializer=(0,o.getInitializer)(e.recurrentInitializer||t.DEFAULT_RECURRENT_INITIALIZER),t.biasInitializer=(0,o.getInitializer)(e.biasInitializer||t.DEFAULT_BIAS_INITIALIZER),t.unitForgetBias=e.unitForgetBias,t.kernelRegularizer=(0,u.getRegularizer)(e.kernelRegularizer),t.recurrentRegularizer=(0,u.getRegularizer)(e.recurrentRegularizer),t.biasRegularizer=(0,u.getRegularizer)(e.biasRegularizer),t.kernelConstraint=(0,a.getConstraint)(e.kernelConstraint),t.recurrentConstraint=(0,a.getConstraint)(e.recurrentConstraint),t.biasConstraint=(0,a.getConstraint)(e.biasConstraint),t.dropout=f.min([1,f.max([0,null==e.dropout?0:e.dropout])]),t.recurrentDropout=f.min([1,f.max([0,null==e.recurrentDropout?0:e.recurrentDropout])]),t.implementation=e.implementation,t.stateSize=[t.units,t.units],t}return y(l,i),l.prototype.build=function(e){var t,r,i=(e=h.getExactlyOneShape(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[i,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,l=this.units;t=new((r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.apply=function(e,t){var r=a.apply([l]),i=(new o.Ones).apply([l]),s=a.apply([2*l]);return n.concatAlongFirstAxis(n.concatAlongFirstAxis(r,i),s)},t}(o.Initializer)).className="CustomInit",r)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,t,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},l.prototype.call=function(r,i){var a=this;return(0,e.tidy)(function(){if(0!==a.dropout||0!==a.recurrentDropout)throw new s.NotImplementedError("Dropout is not implemented for LSTMCell yet");if(3!==(r=r).length)throw new s.ValueError("LSTMCell expects 3 input Tensors (inputs, h, c), got "+r.length+".");var e,i,l,o,u=r[1],c=r[2];if(r=r[0],1===a.implementation){var p=n.sliceAlongLastAxis(a.kernel.read(),0,a.units),h=n.sliceAlongLastAxis(a.kernel.read(),a.units,a.units),g=n.sliceAlongLastAxis(a.kernel.read(),2*a.units,a.units),f=n.sliceAlongLastAxis(a.kernel.read(),3*a.units,a.units),z=n.sliceAlongLastAxis(a.recurrentKernel.read(),0,a.units),b=n.sliceAlongLastAxis(a.recurrentKernel.read(),a.units,a.units),d=n.sliceAlongLastAxis(a.recurrentKernel.read(),2*a.units,a.units),y=n.sliceAlongLastAxis(a.recurrentKernel.read(),3*a.units,a.units),m=r,I=r,R=r,A=r,v=n.dot(m,p),C=n.dot(I,h),S=n.dot(R,g),k=n.dot(A,f);if(a.useBias){var N=n.sliceAlongFirstAxis(a.bias.read(),0,a.units),E=n.sliceAlongFirstAxis(a.bias.read(),a.units,a.units),T=n.sliceAlongFirstAxis(a.bias.read(),2*a.units,a.units),L=n.sliceAlongFirstAxis(a.bias.read(),3*a.units,a.units);v=n.biasAdd(v,N),C=n.biasAdd(C,E),S=n.biasAdd(S,T),k=n.biasAdd(k,L)}var w=u,O=u,x=u,j=u;e=a.recurrentActivation.apply(t.add(v,n.dot(w,z))),i=a.recurrentActivation.apply(t.add(C,n.dot(O,b))),l=t.add(t.mul(i,c),t.mul(e,a.activation.apply(t.add(S,n.dot(x,d))))),o=a.recurrentActivation.apply(t.add(k,n.dot(j,y)))}else{var _=n.dot(r,a.kernel.read());_=t.add(_,n.dot(u,a.recurrentKernel.read())),a.useBias&&(_=n.biasAdd(_,a.bias.read()));var D=n.sliceAlongLastAxis(_,0,a.units),P=n.sliceAlongLastAxis(_,a.units,a.units),B=n.sliceAlongLastAxis(_,2*a.units,a.units),F=n.sliceAlongLastAxis(_,3*a.units,a.units);e=a.recurrentActivation.apply(D),i=a.recurrentActivation.apply(P),l=t.add(t.mul(i,c),t.mul(e,a.activation.apply(B))),o=a.recurrentActivation.apply(F)}var U=t.mul(o,a.activation.apply(l));return[U,U,l]})},l.prototype.getConfig=function(){var e={units:this.units,activation:(0,r.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,o.serializeInitializer)(this.kernelInitializer),recurrentInitializer:(0,o.serializeInitializer)(this.recurrentInitializer),biasInitializer:(0,o.serializeInitializer)(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:(0,u.serializeRegularizer)(this.kernelRegularizer),recurrentRegularizer:(0,u.serializeRegularizer)(this.recurrentRegularizer),biasRegularizer:(0,u.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,u.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,a.serializeConstraint)(this.kernelConstraint),recurrentConstraint:(0,a.serializeConstraint)(this.recurrentConstraint),biasConstraint:(0,a.serializeConstraint)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},t=i.prototype.getConfig.call(this);return Object.assign(e,t),e},l.className="LSTMCell",l}(A);exports.LSTMCell=N,e.serialization.SerializationMap.register(N);var E=function(t){function i(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new N(e),t.call(this,e)||this}return y(i,t),i.prototype.call=function(r,i){var n=this;return(0,e.tidy)(function(){var e=null==i?null:i.mask,a=null==i?null:i.training,l=null==i?null:i.initialState;return t.prototype.call.call(n,r,{mask:e,training:a,initialState:l})})},Object.defineProperty(i.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),i.prototype.getConfig=function(){var e={units:this.units,activation:(0,r.serializeActivation)(this.activation),useBias:this.useBias,kernelInitializer:(0,o.serializeInitializer)(this.kernelInitializer),recurrentInitializer:(0,o.serializeInitializer)(this.recurrentInitializer),biasInitializer:(0,o.serializeInitializer)(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:(0,u.serializeRegularizer)(this.kernelRegularizer),recurrentRegularizer:(0,u.serializeRegularizer)(this.recurrentRegularizer),biasRegularizer:(0,u.serializeRegularizer)(this.biasRegularizer),activityRegularizer:(0,u.serializeRegularizer)(this.activityRegularizer),kernelConstraint:(0,a.serializeConstraint)(this.kernelConstraint),recurrentConstraint:(0,a.serializeConstraint)(this.recurrentConstraint),biasConstraint:(0,a.serializeConstraint)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},i=t.prototype.getConfig.call(this);return delete i.cell,Object.assign(e,i),e},i.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},i.className="LSTM",i}(R);exports.LSTM=E,e.serialization.SerializationMap.register(E);var T=function(t){function r(e){var r=t.call(this,e)||this;return r.cells=e.cells,r}return y(r,t),Object.defineProperty(r.prototype,"stateSize",{get:function(){for(var e=[],t=0,r=this.cells.slice().reverse();t<r.length;t++){var i=r[t];Array.isArray(i.stateSize)?e.push.apply(e,i.stateSize):e.push(i.stateSize)}return e},enumerable:!0,configurable:!0}),r.prototype.call=function(t,r){var i=this;return(0,e.tidy)(function(){for(var e=(t=t).slice(1),n=[],a=0,l=i.cells.slice().reverse();a<l.length;a++){var s=l[a];Array.isArray(s.stateSize)?n.push(e.splice(0,s.stateSize.length)):n.push(e.splice(0,1))}n.reverse();for(var o,u=[],c=0;c<i.cells.length;++c){s=i.cells[c];e=n[c],o=0===c?[t[0]].concat(e):[o[0]].concat(e),o=s.call(o,r),u.push(o.slice(1))}e=[];for(var p=0,h=u.slice().reverse();p<h.length;p++){var g=h[p];e.push.apply(e,g)}return[o[0]].concat(e)})},r.prototype.build=function(e){var t;h.isArrayOfShapes(e)&&(e=e[0]),e=e;for(var r=0,i=this.cells;r<i.length;r++){var n=i[r];n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}this.built=!0},r.prototype.getConfig=function(){for(var e=[],r=0,i=this.cells;r<i.length;r++){var n=i[r];e.push({className:this.getClassName(),config:n.getConfig()})}var a={cells:e},l=t.prototype.getConfig.call(this);return Object.assign(a,l),a},r.fromConfig=function(e,t,r){void 0===r&&(r={});for(var i=[],n=0,a=t.cells;n<a.length;n++){var l=a[n];i.push((0,b.deserialize)(l,r))}return new e({cells:i})},Object.defineProperty(r.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var e=[],t=0,r=this.cells;t<r.length;t++){var i=r[t];e.push.apply(e,i.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"nonTrainableWeights",{get:function(){for(var e=[],t=0,r=this.cells;t<r.length;t++){var i=r[t];e.push.apply(e,i.nonTrainableWeights)}if(!this.trainable){for(var n=[],a=0,l=this.cells;a<l.length;a++){i=l[a];n.push.apply(n,i.trainableWeights)}return n.concat(e)}return e},enumerable:!0,configurable:!0}),r.prototype.getWeights=function(){for(var e=[],t=0,r=this.cells;t<r.length;t++){var i=r[t];e.push.apply(e,i.weights)}return(0,z.batchGetValue)(e)},r.prototype.setWeights=function(e){for(var t=[],r=0,i=this.cells;r<i.length;r++)for(var n=i[r],a=n.weights.length,l=e.splice(a),s=0;s<n.weights.length;++s)t.push([n.weights[s],l[s]]);(0,z.batchSetValue)(t)},r.className="StackedRNNCells",r}(A);exports.StackedRNNCells=T,e.serialization.SerializationMap.register(T);
},{"@tensorflow/tfjs-core":49,"../activations":353,"../backend/tfjs_backend":197,"../constraints":264,"../engine/topology":201,"../errors":200,"../initializers":265,"../regularizers":268,"../types":92,"../utils/generic_utils":198,"../utils/math_utils":310,"../variables":349,"./serialization":202}],278:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Bidirectional=exports.VALID_BIDIRECTIONAL_MERGE_MODES=exports.TimeDistributed=exports.Wrapper=void 0,exports.checkBidirectionalMergeMode=h;var e=require("@tensorflow/tfjs-core"),t=u(e),r=require("../backend/tfjs_backend"),a=u(r),i=require("../engine/topology"),n=require("../errors"),o=require("../utils/generic_utils"),l=u(o),s=require("./recurrent"),c=require("./serialization");function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var p=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),y=function(e){function t(t){var r=e.call(this,t)||this;return r.layer=t.layer,r}return p(t,e),t.prototype.build=function(e){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(e){this.layer.setWeights(e)},t.prototype.getConfig=function(){var t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=e.prototype.getConfig.call(this);return Object.assign(t,r),t},t.fromConfig=function(e,t,r){void 0===r&&(r={});var a=t.layer,i=(0,c.deserialize)(a,r);delete t.layer;var n={layer:i};return Object.assign(n,t),new e(n)},t}(i.Layer);exports.Wrapper=y;var f=function(t){function r(e){var r=t.call(this,e)||this;return r.supportsMasking=!0,r}return p(r,t),r.prototype.build=function(e){if((e=l.getExactlyOneShape(e)).length<3)throw new n.ValueError("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),t.prototype.build.call(this,e)},r.prototype.computeOutputShape=function(e){var t=[(e=l.getExactlyOneShape(e))[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(t),a=e[1];return[r[0],a].concat(r.slice(1))},r.prototype.call=function(t,r){var a=this;return(0,e.tidy)(function(){t=l.getExactlyOneTensor(t);return(0,s.rnn)(function(e,t){return[a.layer.call(e,r),[]]},t,[],!1,null,null,!1,t.shape[1])[1]})},r.className="TimeDistributed",r}(y);exports.TimeDistributed=f,e.serialization.SerializationMap.register(f);var d=exports.VALID_BIDIRECTIONAL_MERGE_MODES=["sum","mul","concat","ave"];function h(e){l.checkStringTypeUnionValue(d,"BidirectionalMergeMode",e)}var g=function(r){function i(e){var t=r.call(this,e)||this,a=e.layer.getConfig();if(t.forwardLayer=(0,c.deserialize)({className:e.layer.getClassName(),config:a}),a.goBackwards=!0!==a.goBackwards,t.backwardLayer=(0,c.deserialize)({className:e.layer.getClassName(),config:a}),t.forwardLayer.name="forward_"+t.forwardLayer.name,t.backwardLayer.name="backward_"+t.backwardLayer.name,h(e.mergeMode),t.mergeMode=e.mergeMode,e.weights)throw new n.NotImplementedError("weights support is not implemented for Bidirectional layer yet.");return t._stateful=e.layer.stateful,t.returnSequences=e.layer.returnSequences,t.returnState=e.layer.returnState,t.supportsMasking=!0,t._trainable=!0,t.inputSpec=e.layer.inputSpec,t}return p(i,r),Object.defineProperty(i.prototype,"trainable",{get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)},enumerable:!0,configurable:!0}),i.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},i.prototype.setWeights=function(e){var t=e.length,r=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))},i.prototype.computeOutputShape=function(e){var t,r,a,i=this.forwardLayer.computeOutputShape(e);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(a=i.slice(1),t=i[0]):t=i[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,r=[t]):r=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?r.concat(a).concat(a.slice()):[t].concat(a).concat(a.slice()):l.singletonOrArray(r)},i.prototype.apply=function(e,t){var a=null;if(null!=t&&(a=t.initialState),Array.isArray(e)&&(a=e.slice(1),e=e[0]),null==a||0===a.length)return r.prototype.apply.call(this,e,t);throw new n.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.")},i.prototype.call=function(r,i){var o=this;return(0,e.tidy)(function(){if(null!=i.mask)throw new n.NotImplementedError("The support for masking is not implemented for Bidirectional layers yet.");if(null!=i.initialState)throw new n.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.");var e,l,s=o.forwardLayer.call(r,i),c=o.backwardLayer.call(r,i);return o.returnState&&(Array.isArray(s)&&(e=s.slice(1).concat(c.slice(1))),s=s[0],c=c[0]),o.returnSequences&&(c=t.reverse(c,1)),"concat"===o.mergeMode?l=a.concatenate([s,c]):"sum"===o.mergeMode?l=t.add(s,c):"ave"===o.mergeMode?l=a.scalarTimesArray(a.getScalar(.5),t.add(s,c)):"mul"===o.mergeMode?l=t.mul(s,c):null==o.mergeMode&&(l=[s,c]),o.returnState?null==o.mergeMode?l.concat(e):[l].concat(e):l})},i.prototype.resetStates=function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},i.prototype.build=function(e){var t=this;a.nameScope(this.forwardLayer.name,function(){t.forwardLayer.build(e)}),a.nameScope(this.backwardLayer.name,function(){t.backwardLayer.build(e)}),this.built=!0},Object.defineProperty(i.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),i.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},t=r.prototype.getConfig.call(this);return Object.assign(e,t),e},i.fromConfig=function(e,t){var r=(0,c.deserialize)(t.layer);if(delete t.layer,null!=t.numConstants)throw new n.NotImplementedError("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var a=t;return a.layer=r,new e(a)},i.className="Bidirectional",i}(y);exports.Bidirectional=g,e.serialization.SerializationMap.register(g);
},{"@tensorflow/tfjs-core":49,"../backend/tfjs_backend":197,"../engine/topology":201,"../errors":200,"../utils/generic_utils":198,"./recurrent":107,"./serialization":202}],91:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sequential=void 0,exports.modelFromJSON=m,exports.loadModelInternal=y,exports.loadModelFromIOHandler=g;var e=require("@tensorflow/tfjs-core"),t=require("./backend/tfjs_backend"),o=h(t),n=require("./engine/topology"),i=require("./engine/training"),s=require("./errors"),r=require("./layers/serialization"),u=require("./utils/generic_utils"),l=h(u),a=require("./utils/serialization_utils");function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}var d=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),p=function(e,t,o,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(r=(s<3?i(r):s>3?i(t,o,r):i(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r},c=function(e,t,o,n){return new(o||(o=Promise))(function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function u(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):new o(function(t){t(e.value)}).then(r,u)}l((n=n.apply(e,t||[])).next())})},f=function(e,t){var o,n,i,s,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(i=n[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],n=0}finally{o=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};function m(t,o){return c(this,void 0,void 0,function(){var n,i,s,u,l,h,d,p;return f(this,function(c){switch(c.label){case 0:return null!=(n=t.modelTopology).model_config&&(n=n.model_config),i=(0,a.convertPythonicToTs)(n),s=(0,r.deserialize)(i,o),null==t.weightsManifest?[3,2]:[4,e.io.loadWeights(t.weightsManifest,t.pathPrefix,s.weights.map(function(e){return e.originalName}))];case 1:for(u=c.sent(),l={},h=0,d=s.weights;h<d.length;h++)p=d[h],l[p.originalName]=u[p.originalName];null,!0,s.loadWeights(l,null,!0),c.label=2;case 2:return[2,s]}})})}function y(t){return c(this,void 0,void 0,function(){var o;return f(this,function(n){if("string"==typeof t){if(0===(o=e.io.getLoadHandlers(t)).length)o.push(e.io.browserHTTPRequest(t));else if(o.length>1)throw new s.ValueError("Found more than one ("+o.length+") load handlers for URL '"+t+"'");t=o[0]}return[2,g(t)]})})}function g(t,o){return c(this,void 0,void 0,function(){var n,i,u;return f(this,function(l){switch(l.label){case 0:if(null==t.load)throw new s.ValueError("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,t.load()];case 1:if(n=l.sent(),null!=(i=n.modelTopology).model_config&&(i=i.model_config),u=(0,r.deserialize)((0,a.convertPythonicToTs)(i),o),null!=n.weightData){if(null==n.weightSpecs)throw new s.ValueError("Model artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");!1,!0,u.loadWeights(e.io.decodeWeights(n.weightData,n.weightSpecs),!1,!0)}return[2,u]}})})}var b=function(t){function u(e){var n=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},n.trainable=!0,n._updatable=!0,n.built=!1,n.name=null!=e.name?e.name:o.getUid("sequential_"),null!=e.layers)for(var i=0,s=e.layers;i<s.length;i++){var r=s[i];n.add(r)}return n}return d(u,t),a=u,u.prototype.add=function(e){var t,o=e instanceof a||e instanceof i.Model;if(o){if(1!==(t=e).outputs.length)throw new s.ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new s.ValueError("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new s.ValueError("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var r=(0,n.Input)({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(o)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new s.ValueError("A layer added to a Sequential model must not already be connected somewhere else. Model received layer "+e.name+" which has "+e.inboundNodes.length+" pre-existing inbound connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new s.ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=(0,n.getSourceInputs)(this.outputs[0])}new n.Node({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:l.pyListRepeat(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(e){return e.shape}),outputShapes:this.outputs[0].shape})}else{var u=e.apply(this.outputs[0]);if(Array.isArray(u))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[u],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1},u.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},u.prototype.call=function(e,t){return null==this.model&&this.build(),this.model.call(e,t)},u.prototype.build=function(e){if(l.getExactlyOneShape(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new i.Model({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.model.updatable=this.updatable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},u.prototype.setWeights=function(e){null==this.model&&this.build(),this.model.setWeights(e)},Object.defineProperty(u.prototype,"updatable",{get:function(){return this._updatable},set:function(e){this.built&&(this.model.updatable=e),this._updatable=e},enumerable:!0,configurable:!0}),u.prototype.evaluate=function(e,t,o){if(void 0===o&&(o={}),!this.built)throw new s.RuntimeError("The model needs to be compiled before being used.");return this.model.evaluate(e,t,o)},u.prototype.predict=function(e,t){return void 0===t&&(t={}),null==this.model&&this.build(),this.model.predict(e,t)},u.prototype.predictOnBatch=function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)},u.prototype.compile=function(e){this.build(),this.model.compile(e),this.optimizer=this.model.optimizer,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},u.prototype.fit=function(e,t,o){return void 0===o&&(o={}),c(this,void 0,void 0,function(){return f(this,function(n){if(!this.built)throw new s.RuntimeError("The model needs to be compiled before being used.");return[2,this.model.fit(e,t,o)]})})},u.fromConfig=function(e,t){var o=new e({});if(!(o instanceof a))throw new s.ValueError("Sequential.fromConfig called on non-Sequential input: "+o);if(!(t instanceof Array))throw new s.ValueError("Sequential.fromConfig called without an array of configs");if(null==t[0].className||"Merge"===t[0].className)throw new s.ValueError("Legacy serialization format not supported yet.");for(var n=0,i=t;n<i.length;n++){var u=i[n],l=(0,r.deserialize)(u);o.add(l)}return o},u.prototype.getConfig=function(){for(var e=[],t=0,o=this.layers;t<o.length;t++){var n=o[t];e.push({className:n.getClassName(),config:n.getConfig()})}return e},u.className="Sequential",p([(0,e.doc)({heading:"Models",subheading:"Classes"})],u.prototype,"add",null),p([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[2]})],u.prototype,"evaluate",null),p([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[1]})],u.prototype,"predict",null),p([(0,e.doc)({heading:"Models",subheading:"Classes",configParamIndices:[2]})],u.prototype,"fit",null),u=a=p([(0,e.doc)({heading:"Models",subheading:"Classes"})],u);var a}(i.Model);exports.Sequential=b,e.serialization.SerializationMap.register(b);
},{"@tensorflow/tfjs-core":49,"./backend/tfjs_backend":197,"./engine/topology":201,"./engine/training":106,"./errors":200,"./layers/serialization":202,"./utils/generic_utils":198,"./utils/serialization_utils":203}],89:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RegularizerExports=exports.MetricExports=exports.InitializerExports=exports.ConstraintExports=exports.LayerExports=exports.ModelExports=void 0;var e=require("@tensorflow/tfjs-core"),n=require("./constraints"),r=require("./engine/topology"),a=require("./engine/training"),o=require("./initializers"),i=require("./layers/advanced_activations"),s=require("./layers/convolutional"),c=require("./layers/convolutional_depthwise"),l=require("./layers/core"),t=require("./layers/embeddings"),u=require("./layers/merge"),d=require("./layers/normalization"),m=require("./layers/padding"),g=require("./layers/pooling"),p=require("./layers/recurrent"),f=require("./layers/wrappers"),y=require("./losses"),h=require("./metrics"),P=require("./models"),D=require("./regularizers"),b=function(e,n,r,a){var o,i=arguments.length,s=i<3?n:null===a?a=Object.getOwnPropertyDescriptor(n,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,r,a);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(n,r,s):o(n,r))||s);return i>3&&s&&Object.defineProperty(n,r,s),s},I=function(){function n(){}return n.model=function(e){return new a.Model(e)},n.sequential=function(e){return new P.Sequential(e)},n.loadModel=function(e){return(0,P.loadModelInternal)(e)},n.input=function(e){return(0,r.Input)(e)},b([(0,e.doc)({heading:"Models",subheading:"Creation",configParamIndices:[0]})],n,"model",null),b([(0,e.doc)({heading:"Models",subheading:"Creation",configParamIndices:[0]})],n,"sequential",null),b([(0,e.doc)({heading:"Models",subheading:"Loading",useDocsFrom:"loadModelInternal"})],n,"loadModel",null),b([(0,e.doc)({heading:"Models",subheading:"Inputs",useDocsFrom:"Input",configParamIndices:[0]})],n,"input",null),n}();exports.ModelExports=I;var v=function(){function n(){}return n.inputLayer=function(e){return new r.InputLayer(e)},n.elu=function(e){return new i.ELU(e)},n.leakyReLU=function(e){return new i.LeakyReLU(e)},n.softmax=function(e){return new i.Softmax(e)},n.thresholdedReLU=function(e){return new i.ThresholdedReLU(e)},n.conv1d=function(e){return new s.Conv1D(e)},n.conv2d=function(e){return new s.Conv2D(e)},n.conv2dTranspose=function(e){return new s.Conv2DTranspose(e)},n.separableConv2d=function(e){return new s.SeparableConv2D(e)},n.cropping2D=function(e){return new s.Cropping2D(e)},n.upSampling2d=function(e){return new s.UpSampling2D(e)},n.depthwiseConv2d=function(e){return new c.DepthwiseConv2D(e)},n.activation=function(e){return new l.Activation(e)},n.dense=function(e){return new l.Dense(e)},n.dropout=function(e){return new l.Dropout(e)},n.flatten=function(e){return new l.Flatten(e)},n.repeatVector=function(e){return new l.RepeatVector(e)},n.reshape=function(e){return new l.Reshape(e)},n.embedding=function(e){return new t.Embedding(e)},n.add=function(e){return new u.Add(e)},n.average=function(e){return new u.Average(e)},n.concatenate=function(e){return new u.Concatenate(e)},n.maximum=function(e){return new u.Maximum(e)},n.minimum=function(e){return new u.Minimum(e)},n.multiply=function(e){return new u.Multiply(e)},n.batchNormalization=function(e){return new d.BatchNormalization(e)},n.zeroPadding2d=function(e){return new m.ZeroPadding2D(e)},n.averagePooling1d=function(e){return new g.AveragePooling1D(e)},n.avgPool1d=function(e){return n.averagePooling1d(e)},n.avgPooling1d=function(e){return n.averagePooling1d(e)},n.averagePooling2d=function(e){return new g.AveragePooling2D(e)},n.avgPool2d=function(e){return n.averagePooling2d(e)},n.avgPooling2d=function(e){return n.averagePooling2d(e)},n.globalAveragePooling1d=function(e){return new g.GlobalAveragePooling1D(e)},n.globalAveragePooling2d=function(e){return new g.GlobalAveragePooling2D(e)},n.globalMaxPooling1d=function(e){return new g.GlobalMaxPooling1D(e)},n.globalMaxPooling2d=function(e){return new g.GlobalMaxPooling2D(e)},n.maxPooling1d=function(e){return new g.MaxPooling1D(e)},n.maxPooling2d=function(e){return new g.MaxPooling2D(e)},n.gru=function(e){return new p.GRU(e)},n.gruCell=function(e){return new p.GRUCell(e)},n.lstm=function(e){return new p.LSTM(e)},n.lstmCell=function(e){return new p.LSTMCell(e)},n.simpleRNN=function(e){return new p.SimpleRNN(e)},n.simpleRNNCell=function(e){return new p.SimpleRNNCell(e)},n.rnn=function(e){return new p.RNN(e)},n.stackedRNNCells=function(e){return new p.StackedRNNCells(e)},n.bidirectional=function(e){return new f.Bidirectional(e)},n.timeDistributed=function(e){return new f.TimeDistributed(e)},n.Layer=r.Layer,n.RNN=p.RNN,n.RNNCell=p.RNNCell,n.input=I.input,b([(0,e.doc)({heading:"Layers",subheading:"Inputs",namespace:"layers",useDocsFrom:"InputLayer",configParamIndices:[0]})],n,"inputLayer",null),b([(0,e.doc)({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ELU",configParamIndices:[0]})],n,"elu",null),b([(0,e.doc)({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"LeakyReLU",configParamIndices:[0]})],n,"leakyReLU",null),b([(0,e.doc)({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"Softmax",configParamIndices:[0]})],n,"softmax",null),b([(0,e.doc)({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ThresholdedReLU",configParamIndices:[0]})],n,"thresholdedReLU",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv1D",configParamIndices:[0]})],n,"conv1d",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2D",configParamIndices:[0]})],n,"conv2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2DTranspose",configParamIndices:[0]})],n,"conv2dTranspose",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"SeparableConv2D",configParamIndices:[0]})],n,"separableConv2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Cropping2D",configParamIndices:[0]})],n,"cropping2D",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"UpSampling2D",configParamIndices:[0]})],n,"upSampling2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"DepthwiseConv2D",configParamIndices:[0]})],n,"depthwiseConv2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Activation",configParamIndices:[0]})],n,"activation",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dense",configParamIndices:[0]})],n,"dense",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dropout",configParamIndices:[0]})],n,"dropout",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Flatten",configParamIndices:[0]})],n,"flatten",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"RepeatVector",configParamIndices:[0]})],n,"repeatVector",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Reshape",configParamIndices:[0]})],n,"reshape",null),b([(0,e.doc)({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Embedding",configParamIndices:[0]})],n,"embedding",null),b([(0,e.doc)({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Add",configParamIndices:[0]})],n,"add",null),b([(0,e.doc)({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Average",configParamIndices:[0]})],n,"average",null),b([(0,e.doc)({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Concatenate",configParamIndices:[0]})],n,"concatenate",null),b([(0,e.doc)({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Maximum",configParamIndices:[0]})],n,"maximum",null),b([(0,e.doc)({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Minimum",configParamIndices:[0]})],n,"minimum",null),b([(0,e.doc)({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Multiply",configParamIndices:[0]})],n,"multiply",null),b([(0,e.doc)({heading:"Layers",subheading:"Normalization",namespace:"layers",useDocsFrom:"BatchNormalization",configParamIndices:[0]})],n,"batchNormalization",null),b([(0,e.doc)({heading:"Layers",subheading:"Padding",namespace:"layers",useDocsFrom:"ZeroPadding2D",configParamIndices:[0]})],n,"zeroPadding2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AveragePooling1D",configParamIndices:[0]})],n,"averagePooling1d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AveragePooling2D",configParamIndices:[0]})],n,"averagePooling2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling1D",configParamIndices:[0]})],n,"globalAveragePooling1d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling2D",configParamIndices:[0]})],n,"globalAveragePooling2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling1D",configParamIndices:[0]})],n,"globalMaxPooling1d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling2D",configParamIndices:[0]})],n,"globalMaxPooling2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling1D",configParamIndices:[0]})],n,"maxPooling1d",null),b([(0,e.doc)({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling2D",configParamIndices:[0]})],n,"maxPooling2d",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRU",configParamIndices:[0]})],n,"gru",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRUCell",configParamIndices:[0]})],n,"gruCell",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTM",configParamIndices:[0]})],n,"lstm",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTMCell",configParamIndices:[0]})],n,"lstmCell",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNN",configParamIndices:[0]})],n,"simpleRNN",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNNCell",configParamIndices:[0]})],n,"simpleRNNCell",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],n,"rnn",null),b([(0,e.doc)({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],n,"stackedRNNCells",null),b([(0,e.doc)({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"Bidirectional",configParamIndices:[0]})],n,"bidirectional",null),b([(0,e.doc)({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"TimeDistributed",configParamIndices:[0]})],n,"timeDistributed",null),n}();exports.LayerExports=v;var L=function(){function r(){}return r.maxNorm=function(e){return new n.MaxNorm(e)},r.unitNorm=function(e){return new n.UnitNorm(e)},r.nonNeg=function(){return new n.NonNeg},r.minMaxNorm=function(e){return new n.MinMaxNorm(e)},b([(0,e.doc)({heading:"Constraints",namespace:"constraints",useDocsFrom:"MaxNorm",configParamIndices:[0]})],r,"maxNorm",null),b([(0,e.doc)({heading:"Constraints",namespace:"constraints",useDocsFrom:"UnitNorm",configParamIndices:[0]})],r,"unitNorm",null),b([(0,e.doc)({heading:"Constraints",namespace:"constraints",useDocsFrom:"NonNeg"})],r,"nonNeg",null),b([(0,e.doc)({heading:"Constraints",namespace:"constraints",useDocsFrom:"MinMaxNormConfig",configParamIndices:[0]})],r,"minMaxNorm",null),r}();exports.ConstraintExports=L;var N=function(){function n(){}return n.zeros=function(){return new o.Zeros},n.ones=function(){return new o.Ones},n.constant=function(e){return new o.Constant(e)},n.randomUniform=function(e){return new o.RandomUniform(e)},n.randomNormal=function(e){return new o.RandomNormal(e)},n.truncatedNormal=function(e){return new o.TruncatedNormal(e)},n.identity=function(e){return new o.Identity(e)},n.varianceScaling=function(e){return new o.VarianceScaling(e)},n.glorotUniform=function(e){return new o.GlorotUniform(e)},n.glorotNormal=function(e){return new o.GlorotNormal(e)},n.heNormal=function(e){return new o.HeNormal(e)},n.leCunNormal=function(e){return new o.LeCunNormal(e)},n.orthogonal=function(e){return new o.Orthogonal(e)},b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"Zeros"})],n,"zeros",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"Ones"})],n,"ones",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"Constant",configParamIndices:[0]})],n,"constant",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomUniform",configParamIndices:[0]})],n,"randomUniform",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomNormal",configParamIndices:[0]})],n,"randomNormal",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"TruncatedNormal",configParamIndices:[0]})],n,"truncatedNormal",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"Identity",configParamIndices:[0]})],n,"identity",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"VarianceScaling",configParamIndices:[0]})],n,"varianceScaling",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotUniform",configParamIndices:[0]})],n,"glorotUniform",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotNormal",configParamIndices:[0]})],n,"glorotNormal",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"HeNormal",configParamIndices:[0]})],n,"heNormal",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"LeCunNormal",configParamIndices:[0]})],n,"leCunNormal",null),b([(0,e.doc)({heading:"Initializers",namespace:"initializers",useDocsFrom:"Orthogonal",configParamIndices:[0]})],n,"orthogonal",null),n}();exports.InitializerExports=N;var F=function(){function n(){}return n.binaryAccuracy=function(e,n){return(0,h.binaryAccuracy)(e,n)},n.binaryCrossentropy=function(e,n){return(0,h.binaryCrossentropy)(e,n)},n.categoricalAccuracy=function(e,n){return(0,h.categoricalAccuracy)(e,n)},n.categoricalCrossentropy=function(e,n){return(0,y.categoricalCrossentropy)(e,n)},n.cosineProximity=function(e,n){return(0,y.cosineProximity)(e,n)},n.prototype.meanAbsoluteError=function(e,n){return(0,y.meanAbsoluteError)(e,n)},n.prototype.meanAbsolutePercentageError=function(e,n){return(0,y.meanAbsolutePercentageError)(e,n)},n.prototype.MAPE=function(e,n){return(0,y.meanAbsolutePercentageError)(e,n)},n.prototype.mape=function(e,n){return(0,y.meanAbsolutePercentageError)(e,n)},n.meanSquaredError=function(e,n){return(0,y.meanSquaredError)(e,n)},n.MSE=function(e,n){return(0,y.meanSquaredError)(e,n)},n.mse=function(e,n){return(0,y.meanSquaredError)(e,n)},b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanAbsoluteError"})],n.prototype,"meanAbsoluteError",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanAbsolutePercentageError"})],n.prototype,"meanAbsolutePercentageError",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"binaryAccuracy"})],n,"binaryAccuracy",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"binaryCrossentropy"})],n,"binaryCrossentropy",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"categoricalAccuracy"})],n,"categoricalAccuracy",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"categoricalCrossentropy"})],n,"categoricalCrossentropy",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"cosineProximity"})],n,"cosineProximity",null),b([(0,e.doc)({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanSquaredError"})],n,"meanSquaredError",null),n}();exports.MetricExports=F;var w=function(){function n(){}return n.l1l2=function(e){return new D.L1L2(e)},n.l1=function(e){return(0,D.l1)(e)},n.l2=function(e){return(0,D.l2)(e)},b([(0,e.doc)({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2",configParamIndices:[0]})],n,"l1l2",null),b([(0,e.doc)({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2",configParamIndices:[0]})],n,"l1",null),b([(0,e.doc)({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2",configParamIndices:[0]})],n,"l2",null),n}();exports.RegularizerExports=w;
},{"@tensorflow/tfjs-core":49,"./constraints":264,"./engine/topology":201,"./engine/training":106,"./initializers":265,"./layers/advanced_activations":269,"./layers/convolutional":270,"./layers/convolutional_depthwise":271,"./layers/core":272,"./layers/embeddings":273,"./layers/merge":274,"./layers/normalization":275,"./layers/padding":276,"./layers/pooling":277,"./layers/recurrent":107,"./layers/wrappers":278,"./losses":266,"./metrics":267,"./models":91,"./regularizers":268}],48:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.regularizers=exports.metrics=exports.initializers=exports.constraints=exports.layers=exports.input=exports.loadModel=exports.sequential=exports.model=exports.version_layers=exports.SymbolicTensor=exports.Sequential=exports.RNN=exports.Model=exports.CustomCallback=exports.CallbackList=exports.Callback=void 0;var e=require("./callbacks");Object.defineProperty(exports,"Callback",{enumerable:!0,get:function(){return e.Callback}}),Object.defineProperty(exports,"CallbackList",{enumerable:!0,get:function(){return e.CallbackList}}),Object.defineProperty(exports,"CustomCallback",{enumerable:!0,get:function(){return e.CustomCallback}});var r=require("./engine/training");Object.defineProperty(exports,"Model",{enumerable:!0,get:function(){return r.Model}});var t=require("./layers/recurrent");Object.defineProperty(exports,"RNN",{enumerable:!0,get:function(){return t.RNN}});var o=require("./models");Object.defineProperty(exports,"Sequential",{enumerable:!0,get:function(){return o.Sequential}});var s=require("./types");Object.defineProperty(exports,"SymbolicTensor",{enumerable:!0,get:function(){return s.SymbolicTensor}});var n=require("./version");Object.defineProperty(exports,"version_layers",{enumerable:!0,get:function(){return n.version}});var i=require("./exports"),l=exports.model=i.ModelExports.model,a=exports.sequential=i.ModelExports.sequential,p=exports.loadModel=i.ModelExports.loadModel,u=exports.input=i.ModelExports.input,x=exports.layers=i.LayerExports,c=exports.constraints=i.ConstraintExports,b=exports.initializers=i.InitializerExports,d=exports.metrics=i.MetricExports,m=exports.regularizers=i.RegularizerExports;
},{"./exports":89,"./callbacks":90,"./engine/training":106,"./layers/recurrent":107,"./models":91,"./types":92,"./version":93}],258:[function(require,module,exports) {
var global = arguments[3];
var define;
var o,e=arguments[3];!function(n){var r="object"==typeof exports&&exports&&!exports.nodeType&&exports,t="object"==typeof module&&module&&!module.nodeType&&module,u="object"==typeof e&&e;u.global!==u&&u.window!==u&&u.self!==u||(n=u);var i,f,c=2147483647,l=36,s=1,p=26,a=38,d=700,h=72,v=128,g="-",w=/^xn--/,x=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=l-s,b=Math.floor,j=String.fromCharCode;function A(o){throw new RangeError(m[o])}function I(o,e){for(var n=o.length,r=[];n--;)r[n]=e(o[n]);return r}function E(o,e){var n=o.split("@"),r="";return n.length>1&&(r=n[0]+"@",o=n[1]),r+I((o=o.replace(y,".")).split("."),e).join(".")}function F(o){for(var e,n,r=[],t=0,u=o.length;t<u;)(e=o.charCodeAt(t++))>=55296&&e<=56319&&t<u?56320==(64512&(n=o.charCodeAt(t++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),t--):r.push(e);return r}function O(o){return I(o,function(o){var e="";return o>65535&&(e+=j((o-=65536)>>>10&1023|55296),o=56320|1023&o),e+=j(o)}).join("")}function S(o,e){return o+22+75*(o<26)-((0!=e)<<5)}function T(o,e,n){var r=0;for(o=n?b(o/d):o>>1,o+=b(o/e);o>C*p>>1;r+=l)o=b(o/C);return b(r+(C+1)*o/(o+a))}function L(o){var e,n,r,t,u,i,f,a,d,w,x,y=[],m=o.length,C=0,j=v,I=h;for((n=o.lastIndexOf(g))<0&&(n=0),r=0;r<n;++r)o.charCodeAt(r)>=128&&A("not-basic"),y.push(o.charCodeAt(r));for(t=n>0?n+1:0;t<m;){for(u=C,i=1,f=l;t>=m&&A("invalid-input"),((a=(x=o.charCodeAt(t++))-48<10?x-22:x-65<26?x-65:x-97<26?x-97:l)>=l||a>b((c-C)/i))&&A("overflow"),C+=a*i,!(a<(d=f<=I?s:f>=I+p?p:f-I));f+=l)i>b(c/(w=l-d))&&A("overflow"),i*=w;I=T(C-u,e=y.length+1,0==u),b(C/e)>c-j&&A("overflow"),j+=b(C/e),C%=e,y.splice(C++,0,j)}return O(y)}function M(o){var e,n,r,t,u,i,f,a,d,w,x,y,m,C,I,E=[];for(y=(o=F(o)).length,e=v,n=0,u=h,i=0;i<y;++i)(x=o[i])<128&&E.push(j(x));for(r=t=E.length,t&&E.push(g);r<y;){for(f=c,i=0;i<y;++i)(x=o[i])>=e&&x<f&&(f=x);for(f-e>b((c-n)/(m=r+1))&&A("overflow"),n+=(f-e)*m,e=f,i=0;i<y;++i)if((x=o[i])<e&&++n>c&&A("overflow"),x==e){for(a=n,d=l;!(a<(w=d<=u?s:d>=u+p?p:d-u));d+=l)I=a-w,C=l-w,E.push(j(S(w+I%C,0))),a=b(I/C);E.push(j(S(a,0))),u=T(n,m,r==t),n=0,++r}++n,++e}return E.join("")}if(i={version:"1.4.1",ucs2:{decode:F,encode:O},decode:L,encode:M,toASCII:function(o){return E(o,function(o){return x.test(o)?"xn--"+M(o):o})},toUnicode:function(o){return E(o,function(o){return w.test(o)?L(o.slice(4).toLowerCase()):o})}},"function"==typeof o&&"object"==typeof o.amd&&o.amd)o("punycode",function(){return i});else if(r&&t)if(module.exports==r)t.exports=i;else for(f in i)i.hasOwnProperty(f)&&(r[f]=i[f]);else n.punycode=i}(this);
},{}],257:[function(require,module,exports) {
"use strict";module.exports={isString:function(n){return"string"==typeof n},isObject:function(n){return"object"==typeof n&&null!==n},isNull:function(n){return null===n},isNullOrUndefined:function(n){return null==n}};
},{}],380:[function(require,module,exports) {
"use strict";function r(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(t,n,o,a){n=n||"&",o=o||"=";var s={};if("string"!=typeof t||0===t.length)return s;var p=/\+/g;t=t.split(n);var u=1e3;a&&"number"==typeof a.maxKeys&&(u=a.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var i=0;i<c;++i){var y,l,f,v,b=t[i].replace(p,"%20"),d=b.indexOf(o);d>=0?(y=b.substr(0,d),l=b.substr(d+1)):(y=b,l=""),f=decodeURIComponent(y),v=decodeURIComponent(l),r(s,f)?e(s[f])?s[f].push(v):s[f]=[s[f],v]:s[f]=v}return s};var e=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};
},{}],381:[function(require,module,exports) {
"use strict";var n=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};module.exports=function(o,u,c,a){return u=u||"&",c=c||"=",null===o&&(o=void 0),"object"==typeof o?r(t(o),function(t){var a=encodeURIComponent(n(t))+c;return e(o[t])?r(o[t],function(e){return a+encodeURIComponent(n(e))}).join(u):a+encodeURIComponent(n(o[t]))}).join(u):a?encodeURIComponent(n(a))+c+encodeURIComponent(n(o)):""};var e=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function r(n,e){if(n.map)return n.map(e);for(var r=[],t=0;t<n.length;t++)r.push(e(n[t],t));return r}var t=Object.keys||function(n){var e=[];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.push(r);return e};
},{}],259:[function(require,module,exports) {
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");
},{"./decode":380,"./encode":381}],234:[function(require,module,exports) {
"use strict";var t=require("punycode"),s=require("./util");function h(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=b,exports.resolve=O,exports.resolveObject=d,exports.format=q,exports.Url=h;var e=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,r=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,o=["<",">",'"',"`"," ","\r","\n","\t"],n=["{","}","|","\\","^","`"].concat(o),i=["'"].concat(n),l=["%","/","?",";","#"].concat(i),p=["/","?","#"],c=255,u=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=require("querystring");function b(t,e,a){if(t&&s.isObject(t)&&t instanceof h)return t;var r=new h;return r.parse(t,e,a),r}function q(t){return s.isString(t)&&(t=b(t)),t instanceof h?t.format():h.prototype.format.call(t)}function O(t,s){return b(t,!1,!0).resolve(s)}function d(t,s){return t?b(t,!1,!0).resolveObject(s):s}h.prototype.parse=function(h,a,o){if(!s.isString(h))throw new TypeError("Parameter 'url' must be a string, not "+typeof h);var n=h.indexOf("?"),b=-1!==n&&n<h.indexOf("#")?"?":"#",q=h.split(b);q[0]=q[0].replace(/\\/g,"/");var O=h=q.join(b);if(O=O.trim(),!o&&1===h.split("#").length){var d=r.exec(O);if(d)return this.path=O,this.href=O,this.pathname=d[1],d[2]?(this.search=d[2],this.query=a?y.parse(this.search.substr(1)):this.search.substr(1)):a&&(this.search="",this.query={}),this}var j=e.exec(O);if(j){var x=(j=j[0]).toLowerCase();this.protocol=x,O=O.substr(j.length)}if(o||j||O.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===O.substr(0,2);!A||j&&v[j]||(O=O.substr(2),this.slashes=!0)}if(!v[j]&&(A||j&&!g[j])){for(var C,I,w=-1,U=0;U<p.length;U++){-1!==(k=O.indexOf(p[U]))&&(-1===w||k<w)&&(w=k)}-1!==(I=-1===w?O.lastIndexOf("@"):O.lastIndexOf("@",w))&&(C=O.slice(0,I),O=O.slice(I+1),this.auth=decodeURIComponent(C)),w=-1;for(U=0;U<l.length;U++){var k;-1!==(k=O.indexOf(l[U]))&&(-1===w||k<w)&&(w=k)}-1===w&&(w=O.length),this.host=O.slice(0,w),O=O.slice(w),this.parseHost(),this.hostname=this.hostname||"";var N="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!N)for(var R=this.hostname.split(/\./),S=(U=0,R.length);U<S;U++){var $=R[U];if($&&!$.match(u)){for(var z="",H=0,L=$.length;H<L;H++)$.charCodeAt(H)>127?z+="x":z+=$[H];if(!z.match(u)){var Z=R.slice(0,U),_=R.slice(U+1),E=$.match(f);E&&(Z.push(E[1]),_.unshift(E[2])),_.length&&(O="/"+_.join(".")+O),this.hostname=Z.join(".");break}}}this.hostname.length>c?this.hostname="":this.hostname=this.hostname.toLowerCase(),N||(this.hostname=t.toASCII(this.hostname));var P=this.port?":"+this.port:"",T=this.hostname||"";this.host=T+P,this.href+=this.host,N&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==O[0]&&(O="/"+O))}if(!m[x])for(U=0,S=i.length;U<S;U++){var B=i[U];if(-1!==O.indexOf(B)){var D=encodeURIComponent(B);D===B&&(D=escape(B)),O=O.split(B).join(D)}}var F=O.indexOf("#");-1!==F&&(this.hash=O.substr(F),O=O.slice(0,F));var G=O.indexOf("?");if(-1!==G?(this.search=O.substr(G),this.query=O.substr(G+1),a&&(this.query=y.parse(this.query)),O=O.slice(0,G)):a&&(this.search="",this.query={}),O&&(this.pathname=O),g[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){P=this.pathname||"";var J=this.search||"";this.path=P+J}return this.href=this.format(),this},h.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var h=this.protocol||"",e=this.pathname||"",a=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(o=y.stringify(this.query));var n=this.search||o&&"?"+o||"";return h&&":"!==h.substr(-1)&&(h+=":"),this.slashes||(!h||g[h])&&!1!==r?(r="//"+(r||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):r||(r=""),a&&"#"!==a.charAt(0)&&(a="#"+a),n&&"?"!==n.charAt(0)&&(n="?"+n),h+r+(e=e.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(n=n.replace("#","%23"))+a},h.prototype.resolve=function(t){return this.resolveObject(b(t,!1,!0)).format()},h.prototype.resolveObject=function(t){if(s.isString(t)){var e=new h;e.parse(t,!1,!0),t=e}for(var a=new h,r=Object.keys(this),o=0;o<r.length;o++){var n=r[o];a[n]=this[n]}if(a.hash=t.hash,""===t.href)return a.href=a.format(),a;if(t.slashes&&!t.protocol){for(var i=Object.keys(t),l=0;l<i.length;l++){var p=i[l];"protocol"!==p&&(a[p]=t[p])}return g[a.protocol]&&a.hostname&&!a.pathname&&(a.path=a.pathname="/"),a.href=a.format(),a}if(t.protocol&&t.protocol!==a.protocol){if(!g[t.protocol]){for(var c=Object.keys(t),u=0;u<c.length;u++){var f=c[u];a[f]=t[f]}return a.href=a.format(),a}if(a.protocol=t.protocol,t.host||v[t.protocol])a.pathname=t.pathname;else{for(var m=(t.pathname||"").split("/");m.length&&!(t.host=m.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),a.pathname=m.join("/")}if(a.search=t.search,a.query=t.query,a.host=t.host||"",a.auth=t.auth,a.hostname=t.hostname||t.host,a.port=t.port,a.pathname||a.search){var y=a.pathname||"",b=a.search||"";a.path=y+b}return a.slashes=a.slashes||t.slashes,a.href=a.format(),a}var q=a.pathname&&"/"===a.pathname.charAt(0),O=t.host||t.pathname&&"/"===t.pathname.charAt(0),d=O||q||a.host&&t.pathname,j=d,x=a.pathname&&a.pathname.split("/")||[],A=(m=t.pathname&&t.pathname.split("/")||[],a.protocol&&!g[a.protocol]);if(A&&(a.hostname="",a.port=null,a.host&&(""===x[0]?x[0]=a.host:x.unshift(a.host)),a.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===m[0]?m[0]=t.host:m.unshift(t.host)),t.host=null),d=d&&(""===m[0]||""===x[0])),O)a.host=t.host||""===t.host?t.host:a.host,a.hostname=t.hostname||""===t.hostname?t.hostname:a.hostname,a.search=t.search,a.query=t.query,x=m;else if(m.length)x||(x=[]),x.pop(),x=x.concat(m),a.search=t.search,a.query=t.query;else if(!s.isNullOrUndefined(t.search)){if(A)a.hostname=a.host=x.shift(),(k=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=k.shift(),a.host=a.hostname=k.shift());return a.search=t.search,a.query=t.query,s.isNull(a.pathname)&&s.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=a.format(),a}if(!x.length)return a.pathname=null,a.search?a.path="/"+a.search:a.path=null,a.href=a.format(),a;for(var C=x.slice(-1)[0],I=(a.host||t.host||x.length>1)&&("."===C||".."===C)||""===C,w=0,U=x.length;U>=0;U--)"."===(C=x[U])?x.splice(U,1):".."===C?(x.splice(U,1),w++):w&&(x.splice(U,1),w--);if(!d&&!j)for(;w--;w)x.unshift("..");!d||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),I&&"/"!==x.join("/").substr(-1)&&x.push("");var k,N=""===x[0]||x[0]&&"/"===x[0].charAt(0);A&&(a.hostname=a.host=N?"":x.length?x.shift():"",(k=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=k.shift(),a.host=a.hostname=k.shift()));return(d=d||a.host&&x.length)&&!N&&x.unshift(""),x.length?a.pathname=x.join("/"):(a.pathname=null,a.path=null),s.isNull(a.pathname)&&s.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=t.auth||a.auth,a.slashes=a.slashes||t.slashes,a.href=a.format(),a},h.prototype.parseHost=function(){var t=this.host,s=a.exec(t);s&&(":"!==(s=s[0])&&(this.port=s.substr(1)),t=t.substr(0,t.length-s.length)),t&&(this.hostname=t)};
},{"punycode":258,"./util":257,"querystring":259}],412:[function(require,module,exports) {
"use strict";function n(n,e){for(var r=new Array(arguments.length-1),t=0,l=2,o=!0;l<arguments.length;)r[t++]=arguments[l++];return new Promise(function(l,u){r[t]=function(n){if(o)if(o=!1,n)u(n);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];l.apply(null,e)}};try{n.apply(e||null,r)}catch(n){o&&(o=!1,u(n))}})}module.exports=n;
},{}],415:[function(require,module,exports) {
"use strict";var r=exports;r.length=function(r){var e=r.length;if(!e)return 0;for(var a=0;--e%4>1&&"="===r.charAt(e);)++a;return Math.ceil(3*r.length)/4-a};for(var e=new Array(64),a=new Array(123),t=0;t<64;)a[e[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;r.encode=function(r,a,t){for(var n,i=null,o=[],c=0,s=0;a<t;){var h=r[a++];switch(s){case 0:o[c++]=e[h>>2],n=(3&h)<<4,s=1;break;case 1:o[c++]=e[n|h>>4],n=(15&h)<<2,s=2;break;case 2:o[c++]=e[n|h>>6],o[c++]=e[63&h],s=0}c>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),c=0)}return s&&(o[c++]=e[n],o[c++]=61,1===s&&(o[c++]=61)),i?(c&&i.push(String.fromCharCode.apply(String,o.slice(0,c))),i.join("")):String.fromCharCode.apply(String,o.slice(0,c))};var n="invalid encoding";r.decode=function(r,e,t){for(var i,o=t,c=0,s=0;s<r.length;){var h=r.charCodeAt(s++);if(61===h&&c>1)break;if(void 0===(h=a[h]))throw Error(n);switch(c){case 0:i=h,c=1;break;case 1:e[t++]=i<<2|(48&h)>>4,i=h,c=2;break;case 2:e[t++]=(15&i)<<4|(60&h)>>2,i=h,c=3;break;case 3:e[t++]=(3&i)<<6|h,c=0}}if(1===c)throw Error(n);return t-o},r.test=function(r){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r)};
},{}],414:[function(require,module,exports) {
"use strict";function t(){this._listeners={}}module.exports=t,t.prototype.on=function(t,s,e){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:s,ctx:e||this}),this},t.prototype.off=function(t,s){if(void 0===t)this._listeners={};else if(void 0===s)this._listeners[t]=[];else for(var e=this._listeners[t],i=0;i<e.length;)e[i].fn===s?e.splice(i,1):++i;return this},t.prototype.emit=function(t){var s=this._listeners[t];if(s){for(var e=[],i=1;i<arguments.length;)e.push(arguments[i++]);for(i=0;i<s.length;)s[i].fn.apply(s[i++].ctx,e)}return this};
},{}],413:[function(require,module,exports) {
"use strict";function n(n){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=128===t[3];function o(n,r,o){e[0]=n,r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2],r[o+3]=t[3]}function u(n,r,o){e[0]=n,r[o]=t[3],r[o+1]=t[2],r[o+2]=t[1],r[o+3]=t[0]}function i(n,r){return t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],t[3]=n[r+3],e[0]}function a(n,r){return t[3]=n[r],t[2]=n[r+1],t[1]=n[r+2],t[0]=n[r+3],e[0]}n.writeFloatLE=r?o:u,n.writeFloatBE=r?u:o,n.readFloatLE=r?i:a,n.readFloatBE=r?a:i}():function(){function u(n,e,t,r){var o=e<0?1:0;if(o&&(e=-e),0===e)n(1/e>0?0:2147483648,t,r);else if(isNaN(e))n(2143289344,t,r);else if(e>3.4028234663852886e38)n((o<<31|2139095040)>>>0,t,r);else if(e<1.1754943508222875e-38)n((o<<31|Math.round(e/1.401298464324817e-45))>>>0,t,r);else{var u=Math.floor(Math.log(e)/Math.LN2);n((o<<31|u+127<<23|8388607&Math.round(e*Math.pow(2,-u)*8388608))>>>0,t,r)}}function i(n,e,t){var r=n(e,t),o=2*(r>>31)+1,u=r>>>23&255,i=8388607&r;return 255===u?i?NaN:o*(1/0):0===u?1.401298464324817e-45*o*i:o*Math.pow(2,u-150)*(i+8388608)}n.writeFloatLE=u.bind(null,e),n.writeFloatBE=u.bind(null,t),n.readFloatLE=i.bind(null,r),n.readFloatBE=i.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=128===t[7];function o(n,r,o){e[0]=n,r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2],r[o+3]=t[3],r[o+4]=t[4],r[o+5]=t[5],r[o+6]=t[6],r[o+7]=t[7]}function u(n,r,o){e[0]=n,r[o]=t[7],r[o+1]=t[6],r[o+2]=t[5],r[o+3]=t[4],r[o+4]=t[3],r[o+5]=t[2],r[o+6]=t[1],r[o+7]=t[0]}function i(n,r){return t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],t[3]=n[r+3],t[4]=n[r+4],t[5]=n[r+5],t[6]=n[r+6],t[7]=n[r+7],e[0]}function a(n,r){return t[7]=n[r],t[6]=n[r+1],t[5]=n[r+2],t[4]=n[r+3],t[3]=n[r+4],t[2]=n[r+5],t[1]=n[r+6],t[0]=n[r+7],e[0]}n.writeDoubleLE=r?o:u,n.writeDoubleBE=r?u:o,n.readDoubleLE=r?i:a,n.readDoubleBE=r?a:i}():function(){function u(n,e,t,r,o,u){var i=r<0?1:0;if(i&&(r=-r),0===r)n(0,o,u+e),n(1/r>0?0:2147483648,o,u+t);else if(isNaN(r))n(0,o,u+e),n(2146959360,o,u+t);else if(r>1.7976931348623157e308)n(0,o,u+e),n((i<<31|2146435072)>>>0,o,u+t);else{var a;if(r<2.2250738585072014e-308)n((a=r/5e-324)>>>0,o,u+e),n((i<<31|a/4294967296)>>>0,o,u+t);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),n(4503599627370496*(a=r*Math.pow(2,-l))>>>0,o,u+e),n((i<<31|l+1023<<20|1048576*a&1048575)>>>0,o,u+t)}}}function i(n,e,t,r,o){var u=n(r,o+e),i=n(r,o+t),a=2*(i>>31)+1,l=i>>>20&2047,f=4294967296*(1048575&i)+u;return 2047===l?f?NaN:a*(1/0):0===l?5e-324*a*f:a*Math.pow(2,l-1075)*(f+4503599627370496)}n.writeDoubleLE=u.bind(null,e,0,4),n.writeDoubleBE=u.bind(null,t,4,0),n.readDoubleLE=i.bind(null,r,0,4),n.readDoubleBE=i.bind(null,o,4,0)}(),n}function e(n,e,t){e[t]=255&n,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function t(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=255&n}function r(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function o(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}module.exports=n(n);
},{}],416:[function(require,module,exports) {
"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire;
},{}],418:[function(require,module,exports) {
"use strict";var r=exports;r.length=function(r){for(var t=0,n=0,e=0;e<r.length;++e)(n=r.charCodeAt(e))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&r.charCodeAt(e+1))?(++e,t+=4):t+=3;return t},r.read=function(r,t,n){if(n-t<1)return"";for(var e,o=null,a=[],i=0;t<n;)(e=r[t++])<128?a[i++]=e:e>191&&e<224?a[i++]=(31&e)<<6|63&r[t++]:e>239&&e<365?(e=((7&e)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536,a[i++]=55296+(e>>10),a[i++]=56320+(1023&e)):a[i++]=(15&e)<<12|(63&r[t++])<<6|63&r[t++],i>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),i=0);return o?(i&&o.push(String.fromCharCode.apply(String,a.slice(0,i))),o.join("")):String.fromCharCode.apply(String,a.slice(0,i))},r.write=function(r,t,n){for(var e,o,a=n,i=0;i<r.length;++i)(e=r.charCodeAt(i))<128?t[n++]=e:e<2048?(t[n++]=e>>6|192,t[n++]=63&e|128):55296==(64512&e)&&56320==(64512&(o=r.charCodeAt(i+1)))?(e=65536+((1023&e)<<10)+(1023&o),++i,t[n++]=e>>18|240,t[n++]=e>>12&63|128,t[n++]=e>>6&63|128,t[n++]=63&e|128):(t[n++]=e>>12|224,t[n++]=e>>6&63|128,t[n++]=63&e|128);return n-a};
},{}],417:[function(require,module,exports) {
"use strict";function r(r,n,t){var u=t||8192,e=u>>>1,l=null,c=u;return function(t){if(t<1||t>e)return r(t);c+t>u&&(l=r(u),c=0);var i=n.call(l,c,c+=t);return 7&c&&(c=1+(7|c)),i}}module.exports=r;
},{}],410:[function(require,module,exports) {
"use strict";module.exports=i;var t=require("../util/minimal");function i(t,i){this.lo=t>>>0,this.hi=i>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var r=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(t){if(0===t)return o;var r=t<0;r&&(t=-t);var h=t>>>0,n=(t-h)/4294967296>>>0;return r&&(n=~n>>>0,h=~h>>>0,++h>4294967295&&(h=0,++n>4294967295&&(n=0))),new i(h,n)},i.from=function(r){if("number"==typeof r)return i.fromNumber(r);if(t.isString(r)){if(!t.Long)return i.fromNumber(parseInt(r,10));r=t.Long.fromString(r)}return r.low||r.high?new i(r.low>>>0,r.high>>>0):o},i.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var i=1+~this.lo>>>0,o=~this.hi>>>0;return i||(o=o+1>>>0),-(i+4294967296*o)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(i){return t.Long?new t.Long(0|this.lo,0|this.hi,Boolean(i)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(i)}};var h=String.prototype.charCodeAt;i.fromHash=function(t){return t===r?o:new i((h.call(t,0)|h.call(t,1)<<8|h.call(t,2)<<16|h.call(t,3)<<24)>>>0,(h.call(t,4)|h.call(t,5)<<8|h.call(t,6)<<16|h.call(t,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},i.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},i.prototype.length=function(){var t=this.lo,i=(this.lo>>>28|this.hi<<4)>>>0,o=this.hi>>>24;return 0===o?0===i?t<16384?t<128?1:2:t<2097152?3:4:i<16384?i<128?5:6:i<2097152?7:8:o<128?9:10};
},{"../util/minimal":406}],421:[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){for(var n,o=h(r),a=o[0],u=o[1],i=new e(c(r,a,u)),f=0,A=u>0?a-4:a,d=0;d<A;d+=4)n=t[r.charCodeAt(d)]<<18|t[r.charCodeAt(d+1)]<<12|t[r.charCodeAt(d+2)]<<6|t[r.charCodeAt(d+3)],i[f++]=n>>16&255,i[f++]=n>>8&255,i[f++]=255&n;return 2===u&&(n=t[r.charCodeAt(d)]<<2|t[r.charCodeAt(d+1)]>>4,i[f++]=255&n),1===u&&(n=t[r.charCodeAt(d)]<<10|t[r.charCodeAt(d+1)]<<4|t[r.charCodeAt(d+2)]>>2,i[f++]=n>>8&255,i[f++]=255&n),i}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],420:[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],419:[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],411:[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":421,"ieee754":420,"isarray":419,"buffer":411}],406:[function(require,module,exports) {
var global = arguments[3];
var Buffer = require("buffer").Buffer;
var r=arguments[3],e=require("buffer").Buffer,t=exports;function n(r,e,t){for(var n=Object.keys(e),o=0;o<n.length;++o)void 0!==r[n[o]]&&t||(r[n[o]]=e[n[o]]);return r}function o(r){function e(r,t){if(!(this instanceof e))return new e(r,t);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&n(this,t)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}t.asPromise=require("@protobufjs/aspromise"),t.base64=require("@protobufjs/base64"),t.EventEmitter=require("@protobufjs/eventemitter"),t.float=require("@protobufjs/float"),t.inquire=require("@protobufjs/inquire"),t.utf8=require("@protobufjs/utf8"),t.pool=require("@protobufjs/pool"),t.LongBits=require("./longbits"),t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isNode=Boolean(r.process&&r.process.versions&&r.process.versions.node),t.isInteger=Number.isInteger||function(r){return"number"==typeof r&&isFinite(r)&&Math.floor(r)===r},t.isString=function(r){return"string"==typeof r||r instanceof String},t.isObject=function(r){return r&&"object"==typeof r},t.isset=t.isSet=function(r,e){var t=r[e];return!(null==t||!r.hasOwnProperty(e))&&("object"!=typeof t||(Array.isArray(t)?t.length:Object.keys(t).length)>0)},t.Buffer=function(){try{var r=t.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(r){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(r){return"number"==typeof r?t.Buffer?t._Buffer_allocUnsafe(r):new t.Array(r):t.Buffer?t._Buffer_from(r):"undefined"==typeof Uint8Array?r:new Uint8Array(r)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=r.dcodeIO&&r.dcodeIO.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(r){return r?t.LongBits.from(r).toHash():t.LongBits.zeroHash},t.longFromHash=function(r,e){var n=t.LongBits.fromHash(r);return t.Long?t.Long.fromBits(n.lo,n.hi,e):n.toNumber(Boolean(e))},t.merge=n,t.lcFirst=function(r){return r.charAt(0).toLowerCase()+r.substring(1)},t.newError=o,t.ProtocolError=o("ProtocolError"),t.oneOfGetter=function(r){for(var e={},t=0;t<r.length;++t)e[r[t]]=1;return function(){for(var r=Object.keys(this),t=r.length-1;t>-1;--t)if(1===e[r[t]]&&void 0!==this[r[t]]&&null!==this[r[t]])return r[t]}},t.oneOfSetter=function(r){return function(e){for(var t=0;t<r.length;++t)r[t]!==e&&delete this[r[t]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var r=t.Buffer;r?(t._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,t){return new r(e,t)},t._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}):t._Buffer_from=t._Buffer_allocUnsafe=null};
},{"@protobufjs/aspromise":412,"@protobufjs/base64":415,"@protobufjs/eventemitter":414,"@protobufjs/float":413,"@protobufjs/inquire":416,"@protobufjs/utf8":418,"@protobufjs/pool":417,"./longbits":410,"buffer":411}],400:[function(require,module,exports) {
"use strict";module.exports=u;var t,i=require("./util/minimal"),n=i.LongBits,e=i.base64,o=i.utf8;function r(t,i,n){this.fn=t,this.len=i,this.next=void 0,this.val=n}function s(){}function h(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function u(){this.len=0,this.head=new r(s,0,0),this.tail=this.head,this.states=null}function l(t,i,n){i[n]=255&t}function p(t,i,n){for(;t>127;)i[n++]=127&t|128,t>>>=7;i[n]=t}function a(t,i){this.len=t,this.next=void 0,this.val=i}function f(t,i,n){for(;t.hi;)i[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)i[n++]=127&t.lo|128,t.lo=t.lo>>>7;i[n++]=t.lo}function c(t,i,n){i[n]=255&t,i[n+1]=t>>>8&255,i[n+2]=t>>>16&255,i[n+3]=t>>>24}u.create=i.Buffer?function(){return(u.create=function(){return new t})()}:function(){return new u},u.alloc=function(t){return new i.Array(t)},i.Array!==Array&&(u.alloc=i.pool(u.alloc,i.Array.prototype.subarray)),u.prototype._push=function(t,i,n){return this.tail=this.tail.next=new r(t,i,n),this.len+=i,this},a.prototype=Object.create(r.prototype),a.prototype.fn=p,u.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new a((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},u.prototype.int32=function(t){return t<0?this._push(f,10,n.fromNumber(t)):this.uint32(t)},u.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},u.prototype.uint64=function(t){var i=n.from(t);return this._push(f,i.length(),i)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(t){var i=n.from(t).zzEncode();return this._push(f,i.length(),i)},u.prototype.bool=function(t){return this._push(l,1,t?1:0)},u.prototype.fixed32=function(t){return this._push(c,4,t>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(t){var i=n.from(t);return this._push(c,4,i.lo)._push(c,4,i.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(t){return this._push(i.float.writeFloatLE,4,t)},u.prototype.double=function(t){return this._push(i.float.writeDoubleLE,8,t)};var y=i.Array.prototype.set?function(t,i,n){i.set(t,n)}:function(t,i,n){for(var e=0;e<t.length;++e)i[n+e]=t[e]};u.prototype.bytes=function(t){var n=t.length>>>0;if(!n)return this._push(l,1,0);if(i.isString(t)){var o=u.alloc(n=e.length(t));e.decode(t,o,0),t=o}return this.uint32(n)._push(y,n,t)},u.prototype.string=function(t){var i=o.length(t);return i?this.uint32(i)._push(o.write,i,t):this._push(l,1,0)},u.prototype.fork=function(){return this.states=new h(this),this.head=this.tail=new r(s,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new r(s,0,0),this.len=0),this},u.prototype.ldelim=function(){var t=this.head,i=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=i,this.len+=n),this},u.prototype.finish=function(){for(var t=this.head.next,i=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,i,n),n+=t.len,t=t.next;return i},u._configure=function(i){t=i};
},{"./util/minimal":406}],401:[function(require,module,exports) {

"use strict";module.exports=n;var t=require("./writer");(n.prototype=Object.create(t.prototype)).constructor=n;var e=require("./util/minimal"),r=e.Buffer;function n(){t.call(this)}n.alloc=function(t){return(n.alloc=e._Buffer_allocUnsafe)(t)};var i=r&&r.prototype instanceof Uint8Array&&"set"===r.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var n=0;n<t.length;)e[r++]=t[n++]};function o(t,r,n){t.length<40?e.utf8.write(t,r,n):r.utf8Write(t,n)}n.prototype.bytes=function(t){e.isString(t)&&(t=e._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(i,r,t),this},n.prototype.string=function(t){var e=r.byteLength(t);return this.uint32(e),e&&this._push(o,e,t),this};
},{"./writer":400,"./util/minimal":406}],402:[function(require,module,exports) {
"use strict";module.exports=h;var t,i=require("./util/minimal"),s=i.LongBits,r=i.utf8;function o(t,i){return RangeError("index out of range: "+t.pos+" + "+(i||1)+" > "+t.len)}function h(t){this.buf=t,this.pos=0,this.len=t.length}var n="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new h(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new h(t);throw Error("illegal buffer")};function e(){var t=new s(0,0),i=0;if(!(this.len-this.pos>4)){for(;i<3;++i){if(this.pos>=this.len)throw o(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*i)>>>0,t}for(;i<4;++i)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(i=0,this.len-this.pos>4){for(;i<5;++i)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return t}else for(;i<5;++i){if(this.pos>=this.len)throw o(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function u(t,i){return(t[i-4]|t[i-3]<<8|t[i-2]<<16|t[i-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw o(this,8);return new s(u(this.buf,this.pos+=4),u(this.buf,this.pos+=4))}h.create=i.Buffer?function(s){return(h.create=function(s){return i.Buffer.isBuffer(s)?new t(s):n(s)})(s)}:n,h.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,h.prototype.uint32=function(){var t=4294967295;return function(){if(t=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return t}}(),h.prototype.int32=function(){return 0|this.uint32()},h.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},h.prototype.bool=function(){return 0!==this.uint32()},h.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return u(this.buf,this.pos+=4)},h.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|u(this.buf,this.pos+=4)},h.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var t=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},h.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var t=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},h.prototype.bytes=function(){var t=this.uint32(),i=this.pos,s=this.pos+t;if(s>this.len)throw o(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(i,s):i===s?new this.buf.constructor(0):this._slice.call(this.buf,i,s)},h.prototype.string=function(){var t=this.bytes();return r.read(t,0,t.length)},h.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw o(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw o(this)}while(128&this.buf[this.pos++]);return this},h.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;;){if(4==(t=7&this.uint32()))break;this.skipType(t)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},h._configure=function(s){t=s;var r=i.Long?"toLong":"toNumber";i.merge(h.prototype,{int64:function(){return e.call(this)[r](!1)},uint64:function(){return e.call(this)[r](!0)},sint64:function(){return e.call(this).zzDecode()[r](!1)},fixed64:function(){return f.call(this)[r](!0)},sfixed64:function(){return f.call(this)[r](!1)}})};
},{"./util/minimal":406}],403:[function(require,module,exports) {
"use strict";module.exports=r;var t=require("./reader");(r.prototype=Object.create(t.prototype)).constructor=r;var e=require("./util/minimal");function r(e){t.call(this,e)}e.Buffer&&(r.prototype._slice=e.Buffer.prototype.slice),r.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len))};
},{"./reader":402,"./util/minimal":406}],408:[function(require,module,exports) {
"use strict";module.exports=t;var e=require("../util/minimal");function t(t,r,i){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(r),this.responseDelimited=Boolean(i)}(t.prototype=Object.create(e.EventEmitter.prototype)).constructor=t,t.prototype.rpcCall=function t(r,i,n,o,l){if(!o)throw TypeError("request must be specified");var u=this;if(!l)return e.asPromise(t,u,r,i,n,o);if(u.rpcImpl)try{return u.rpcImpl(r,i[u.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,t){if(e)return u.emit("error",e,r),l(e);if(null!==t){if(!(t instanceof n))try{t=n[u.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return u.emit("error",e,r),l(e)}return u.emit("data",t,r),l(null,t)}u.end(!0)})}catch(e){return u.emit("error",e,r),void setTimeout(function(){l(e)},0)}else setTimeout(function(){l(Error("already ended"))},0)},t.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};
},{"../util/minimal":406}],404:[function(require,module,exports) {
"use strict";var e=exports;e.Service=require("./rpc/service");
},{"./rpc/service":408}],405:[function(require,module,exports) {
"use strict";module.exports={};
},{}],398:[function(require,module,exports) {
"use strict";var r=exports;function e(){r.Reader._configure(r.BufferReader),r.util._configure()}r.build="minimal",r.Writer=require("./writer"),r.BufferWriter=require("./writer_buffer"),r.Reader=require("./reader"),r.BufferReader=require("./reader_buffer"),r.util=require("./util/minimal"),r.rpc=require("./rpc"),r.roots=require("./roots"),r.configure=e,r.Writer._configure(r.BufferWriter),e();
},{"./writer":400,"./writer_buffer":401,"./reader":402,"./reader_buffer":403,"./util/minimal":406,"./rpc":404,"./roots":405}],387:[function(require,module,exports) {
"use strict";module.exports=require("./src/index-minimal");
},{"./src/index-minimal":398}],231:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.tensorflow=void 0;var e=require("protobufjs/minimal"),t=o(e);function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}const n=t.Reader,r=t.util,s=t.roots.default||(t.roots.default={}),a=exports.tensorflow=s.tensorflow=(()=>{const e={};return e.Any=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.typeUrl="",e.prototype.value=r.newBuffer([]),e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.Any;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.typeUrl=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&a)}}return r},e}(),e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="DT_INVALID"]=0,t[e[1]="DT_FLOAT"]=1,t[e[2]="DT_DOUBLE"]=2,t[e[3]="DT_INT32"]=3,t[e[4]="DT_UINT8"]=4,t[e[5]="DT_INT16"]=5,t[e[6]="DT_INT8"]=6,t[e[7]="DT_STRING"]=7,t[e[8]="DT_COMPLEX64"]=8,t[e[9]="DT_INT64"]=9,t[e[10]="DT_BOOL"]=10,t[e[11]="DT_QINT8"]=11,t[e[12]="DT_QUINT8"]=12,t[e[13]="DT_QINT32"]=13,t[e[14]="DT_BFLOAT16"]=14,t[e[101]="DT_FLOAT_REF"]=101,t[e[102]="DT_DOUBLE_REF"]=102,t[e[103]="DT_INT32_REF"]=103,t[e[104]="DT_UINT8_REF"]=104,t[e[105]="DT_INT16_REF"]=105,t[e[106]="DT_INT8_REF"]=106,t[e[107]="DT_STRING_REF"]=107,t[e[108]="DT_COMPLEX64_REF"]=108,t[e[109]="DT_INT64_REF"]=109,t[e[110]="DT_BOOL_REF"]=110,t[e[111]="DT_QINT8_REF"]=111,t[e[112]="DT_QUINT8_REF"]=112,t[e[113]="DT_QINT32_REF"]=113,t[e[114]="DT_BFLOAT16_REF"]=114,t}(),e.TensorShape=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.dim=r.emptyArray,e.prototype.unknownRank=!1,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.TensorShape;e.pos<o;){var a=e.uint32();switch(a>>>3){case 2:r.dim&&r.dim.length||(r.dim=[]),r.dim.push(s.tensorflow.TensorShape.Dim.decode(e,e.uint32()));break;case 3:r.unknownRank=e.bool();break;default:e.skipType(7&a)}}return r},e.Dim=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.size=r.Long?r.Long.fromBits(0,0,!1):0,e.prototype.name="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.TensorShape.Dim;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.size=e.int64();break;case 2:r.name=e.string();break;default:e.skipType(7&a)}}return r},e}(),e}(),e.Tensor=function(){function e(e){if(this.floatVal=[],this.doubleVal=[],this.intVal=[],this.stringVal=[],this.scomplexVal=[],this.int64Val=[],this.boolVal=[],this.uint32Val=[],this.uint64Val=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.dtype=0,e.prototype.tensorShape=null,e.prototype.versionNumber=0,e.prototype.tensorContent=r.newBuffer([]),e.prototype.floatVal=r.emptyArray,e.prototype.doubleVal=r.emptyArray,e.prototype.intVal=r.emptyArray,e.prototype.stringVal=r.emptyArray,e.prototype.scomplexVal=r.emptyArray,e.prototype.int64Val=r.emptyArray,e.prototype.boolVal=r.emptyArray,e.prototype.uint32Val=r.emptyArray,e.prototype.uint64Val=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.Tensor;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.dtype=e.int32();break;case 2:r.tensorShape=s.tensorflow.TensorShape.decode(e,e.uint32());break;case 3:r.versionNumber=e.int32();break;case 4:r.tensorContent=e.bytes();break;case 5:if(r.floatVal&&r.floatVal.length||(r.floatVal=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)r.floatVal.push(e.float());else r.floatVal.push(e.float());break;case 6:if(r.doubleVal&&r.doubleVal.length||(r.doubleVal=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.doubleVal.push(e.double());else r.doubleVal.push(e.double());break;case 7:if(r.intVal&&r.intVal.length||(r.intVal=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.intVal.push(e.int32());else r.intVal.push(e.int32());break;case 8:r.stringVal&&r.stringVal.length||(r.stringVal=[]),r.stringVal.push(e.bytes());break;case 9:if(r.scomplexVal&&r.scomplexVal.length||(r.scomplexVal=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.scomplexVal.push(e.float());else r.scomplexVal.push(e.float());break;case 10:if(r.int64Val&&r.int64Val.length||(r.int64Val=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.int64Val.push(e.int64());else r.int64Val.push(e.int64());break;case 11:if(r.boolVal&&r.boolVal.length||(r.boolVal=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.boolVal.push(e.bool());else r.boolVal.push(e.bool());break;case 16:if(r.uint32Val&&r.uint32Val.length||(r.uint32Val=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.uint32Val.push(e.uint32());else r.uint32Val.push(e.uint32());break;case 17:if(r.uint64Val&&r.uint64Val.length||(r.uint64Val=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.uint64Val.push(e.uint64());else r.uint64Val.push(e.uint64());break;default:e.skipType(7&a)}}return r},e}(),e.AttrValue=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}let t;return e.prototype.list=null,e.prototype.s=r.newBuffer([]),e.prototype.i=r.Long?r.Long.fromBits(0,0,!1):0,e.prototype.f=0,e.prototype.b=!1,e.prototype.type=0,e.prototype.shape=null,e.prototype.tensor=null,e.prototype.placeholder="",e.prototype.func=null,Object.defineProperty(e.prototype,"value",{get:r.oneOfGetter(t=["list","s","i","f","b","type","shape","tensor","placeholder","func"]),set:r.oneOfSetter(t)}),e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.AttrValue;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.list=s.tensorflow.AttrValue.ListValue.decode(e,e.uint32());break;case 2:r.s=e.bytes();break;case 3:r.i=e.int64();break;case 4:r.f=e.float();break;case 5:r.b=e.bool();break;case 6:r.type=e.int32();break;case 7:r.shape=s.tensorflow.TensorShape.decode(e,e.uint32());break;case 8:r.tensor=s.tensorflow.Tensor.decode(e,e.uint32());break;case 9:r.placeholder=e.string();break;case 10:r.func=s.tensorflow.NameAttrList.decode(e,e.uint32());break;default:e.skipType(7&a)}}return r},e.ListValue=function(){function e(e){if(this.s=[],this.i=[],this.f=[],this.b=[],this.type=[],this.shape=[],this.tensor=[],this.func=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.s=r.emptyArray,e.prototype.i=r.emptyArray,e.prototype.f=r.emptyArray,e.prototype.b=r.emptyArray,e.prototype.type=r.emptyArray,e.prototype.shape=r.emptyArray,e.prototype.tensor=r.emptyArray,e.prototype.func=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.AttrValue.ListValue;e.pos<o;){var a=e.uint32();switch(a>>>3){case 2:r.s&&r.s.length||(r.s=[]),r.s.push(e.bytes());break;case 3:if(r.i&&r.i.length||(r.i=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)r.i.push(e.int64());else r.i.push(e.int64());break;case 4:if(r.f&&r.f.length||(r.f=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.f.push(e.float());else r.f.push(e.float());break;case 5:if(r.b&&r.b.length||(r.b=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.b.push(e.bool());else r.b.push(e.bool());break;case 6:if(r.type&&r.type.length||(r.type=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)r.type.push(e.int32());else r.type.push(e.int32());break;case 7:r.shape&&r.shape.length||(r.shape=[]),r.shape.push(s.tensorflow.TensorShape.decode(e,e.uint32()));break;case 8:r.tensor&&r.tensor.length||(r.tensor=[]),r.tensor.push(s.tensorflow.Tensor.decode(e,e.uint32()));break;case 9:r.func&&r.func.length||(r.func=[]),r.func.push(s.tensorflow.NameAttrList.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return r},e}(),e}(),e.NameAttrList=function(){function e(e){if(this.attr={},e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.name="",e.prototype.attr=r.emptyObject,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o,a=void 0===t?e.len:e.pos+t,i=new s.tensorflow.NameAttrList;e.pos<a;){var p=e.uint32();switch(p>>>3){case 1:i.name=e.string();break;case 2:e.skip().pos++,i.attr===r.emptyObject&&(i.attr={}),o=e.string(),e.pos++,i.attr[o]=s.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&p)}}return i},e}(),e.NodeDef=function(){function e(e){if(this.input=[],this.attr={},e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.name="",e.prototype.op="",e.prototype.input=r.emptyArray,e.prototype.device="",e.prototype.attr=r.emptyObject,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o,a=void 0===t?e.len:e.pos+t,i=new s.tensorflow.NodeDef;e.pos<a;){var p=e.uint32();switch(p>>>3){case 1:i.name=e.string();break;case 2:i.op=e.string();break;case 3:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 4:i.device=e.string();break;case 5:e.skip().pos++,i.attr===r.emptyObject&&(i.attr={}),o=e.string(),e.pos++,i.attr[o]=s.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&p)}}return i},e}(),e.VersionDef=function(){function e(e){if(this.badConsumers=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.producer=0,e.prototype.minConsumer=0,e.prototype.badConsumers=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.VersionDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.producer=e.int32();break;case 2:r.minConsumer=e.int32();break;case 3:if(r.badConsumers&&r.badConsumers.length||(r.badConsumers=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)r.badConsumers.push(e.int32());else r.badConsumers.push(e.int32());break;default:e.skipType(7&a)}}return r},e}(),e.GraphDef=function(){function e(e){if(this.node=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.node=r.emptyArray,e.prototype.versions=null,e.prototype.library=null,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.GraphDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.node&&r.node.length||(r.node=[]),r.node.push(s.tensorflow.NodeDef.decode(e,e.uint32()));break;case 4:r.versions=s.tensorflow.VersionDef.decode(e,e.uint32());break;case 2:r.library=s.tensorflow.FunctionDefLibrary.decode(e,e.uint32());break;default:e.skipType(7&a)}}return r},e}(),e.CollectionDef=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}let t;return e.prototype.nodeList=null,e.prototype.bytesList=null,e.prototype.int64List=null,e.prototype.floatList=null,e.prototype.anyList=null,Object.defineProperty(e.prototype,"kind",{get:r.oneOfGetter(t=["nodeList","bytesList","int64List","floatList","anyList"]),set:r.oneOfSetter(t)}),e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.CollectionDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.nodeList=s.tensorflow.CollectionDef.NodeList.decode(e,e.uint32());break;case 2:r.bytesList=s.tensorflow.CollectionDef.BytesList.decode(e,e.uint32());break;case 3:r.int64List=s.tensorflow.CollectionDef.Int64List.decode(e,e.uint32());break;case 4:r.floatList=s.tensorflow.CollectionDef.FloatList.decode(e,e.uint32());break;case 5:r.anyList=s.tensorflow.CollectionDef.AnyList.decode(e,e.uint32());break;default:e.skipType(7&a)}}return r},e.NodeList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.value=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.CollectionDef.NodeList;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(e.string());break;default:e.skipType(7&a)}}return r},e}(),e.BytesList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.value=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.CollectionDef.BytesList;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(e.bytes());break;default:e.skipType(7&a)}}return r},e}(),e.Int64List=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.value=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.CollectionDef.Int64List;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:if(r.value&&r.value.length||(r.value=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)r.value.push(e.int64());else r.value.push(e.int64());break;default:e.skipType(7&a)}}return r},e}(),e.FloatList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.value=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.CollectionDef.FloatList;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:if(r.value&&r.value.length||(r.value=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)r.value.push(e.float());else r.value.push(e.float());break;default:e.skipType(7&a)}}return r},e}(),e.AnyList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.value=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.CollectionDef.AnyList;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(s.tensorflow.Any.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return r},e}(),e}(),e.SaverDef=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.filenameTensorName="",e.prototype.saveTensorName="",e.prototype.restoreOpName="",e.prototype.maxToKeep=0,e.prototype.sharded=!1,e.prototype.keepCheckpointEveryNHours=0,e.prototype.version=0,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.SaverDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.filenameTensorName=e.string();break;case 2:r.saveTensorName=e.string();break;case 3:r.restoreOpName=e.string();break;case 4:r.maxToKeep=e.int32();break;case 5:r.sharded=e.bool();break;case 6:r.keepCheckpointEveryNHours=e.float();break;case 7:r.version=e.int32();break;default:e.skipType(7&a)}}return r},e.CheckpointFormatVersion=function(){const e={},t=Object.create(e);return t[e[0]="LEGACY"]=0,t[e[1]="V1"]=1,t[e[2]="V2"]=2,t}(),e}(),e.TensorInfo=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}let t;return e.prototype.name="",e.prototype.cooSparse=null,e.prototype.dtype=0,e.prototype.tensorShape=null,Object.defineProperty(e.prototype,"encoding",{get:r.oneOfGetter(t=["name","cooSparse"]),set:r.oneOfSetter(t)}),e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.TensorInfo;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.name=e.string();break;case 4:r.cooSparse=s.tensorflow.TensorInfo.CooSparse.decode(e,e.uint32());break;case 2:r.dtype=e.int32();break;case 3:r.tensorShape=s.tensorflow.TensorShape.decode(e,e.uint32());break;default:e.skipType(7&a)}}return r},e.CooSparse=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.valuesTensorName="",e.prototype.indicesTensorName="",e.prototype.denseShapeTensorName="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.TensorInfo.CooSparse;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.valuesTensorName=e.string();break;case 2:r.indicesTensorName=e.string();break;case 3:r.denseShapeTensorName=e.string();break;default:e.skipType(7&a)}}return r},e}(),e}(),e.SignatureDef=function(){function e(e){if(this.inputs={},this.outputs={},e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.inputs=r.emptyObject,e.prototype.outputs=r.emptyObject,e.prototype.methodName="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o,a=void 0===t?e.len:e.pos+t,i=new s.tensorflow.SignatureDef;e.pos<a;){var p=e.uint32();switch(p>>>3){case 1:e.skip().pos++,i.inputs===r.emptyObject&&(i.inputs={}),o=e.string(),e.pos++,i.inputs[o]=s.tensorflow.TensorInfo.decode(e,e.uint32());break;case 2:e.skip().pos++,i.outputs===r.emptyObject&&(i.outputs={}),o=e.string(),e.pos++,i.outputs[o]=s.tensorflow.TensorInfo.decode(e,e.uint32());break;case 3:i.methodName=e.string();break;default:e.skipType(7&p)}}return i},e}(),e.AssetFileDef=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.tensorInfo=null,e.prototype.filename="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.AssetFileDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.tensorInfo=s.tensorflow.TensorInfo.decode(e,e.uint32());break;case 2:r.filename=e.string();break;default:e.skipType(7&a)}}return r},e}(),e.OpDef=function(){function e(e){if(this.inputArg=[],this.outputArg=[],this.attr=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.name="",e.prototype.inputArg=r.emptyArray,e.prototype.outputArg=r.emptyArray,e.prototype.attr=r.emptyArray,e.prototype.deprecation=null,e.prototype.summary="",e.prototype.description="",e.prototype.isCommutative=!1,e.prototype.isAggregate=!1,e.prototype.isStateful=!1,e.prototype.allowsUninitializedInput=!1,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.OpDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.name=e.string();break;case 2:r.inputArg&&r.inputArg.length||(r.inputArg=[]),r.inputArg.push(s.tensorflow.OpDef.ArgDef.decode(e,e.uint32()));break;case 3:r.outputArg&&r.outputArg.length||(r.outputArg=[]),r.outputArg.push(s.tensorflow.OpDef.ArgDef.decode(e,e.uint32()));break;case 4:r.attr&&r.attr.length||(r.attr=[]),r.attr.push(s.tensorflow.OpDef.AttrDef.decode(e,e.uint32()));break;case 8:r.deprecation=s.tensorflow.OpDef.OpDeprecation.decode(e,e.uint32());break;case 5:r.summary=e.string();break;case 6:r.description=e.string();break;case 18:r.isCommutative=e.bool();break;case 16:r.isAggregate=e.bool();break;case 17:r.isStateful=e.bool();break;case 19:r.allowsUninitializedInput=e.bool();break;default:e.skipType(7&a)}}return r},e.ArgDef=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.name="",e.prototype.description="",e.prototype.type=0,e.prototype.typeAttr="",e.prototype.numberAttr="",e.prototype.typeListAttr="",e.prototype.isRef=!1,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.OpDef.ArgDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.name=e.string();break;case 2:r.description=e.string();break;case 3:r.type=e.int32();break;case 4:r.typeAttr=e.string();break;case 5:r.numberAttr=e.string();break;case 6:r.typeListAttr=e.string();break;case 16:r.isRef=e.bool();break;default:e.skipType(7&a)}}return r},e}(),e.AttrDef=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.name="",e.prototype.type="",e.prototype.defaultValue=null,e.prototype.description="",e.prototype.hasMinimum=!1,e.prototype.minimum=r.Long?r.Long.fromBits(0,0,!1):0,e.prototype.allowedValues=null,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.OpDef.AttrDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.name=e.string();break;case 2:r.type=e.string();break;case 3:r.defaultValue=s.tensorflow.AttrValue.decode(e,e.uint32());break;case 4:r.description=e.string();break;case 5:r.hasMinimum=e.bool();break;case 6:r.minimum=e.int64();break;case 7:r.allowedValues=s.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&a)}}return r},e}(),e.OpDeprecation=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.version=0,e.prototype.explanation="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.OpDef.OpDeprecation;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.version=e.int32();break;case 2:r.explanation=e.string();break;default:e.skipType(7&a)}}return r},e}(),e}(),e.OpList=function(){function e(e){if(this.op=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.op=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.OpList;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.op&&r.op.length||(r.op=[]),r.op.push(s.tensorflow.OpDef.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return r},e}(),e.MetaGraphDef=function(){function e(e){if(this.collectionDef={},this.signatureDef={},this.assetFileDef=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.metaInfoDef=null,e.prototype.graphDef=null,e.prototype.saverDef=null,e.prototype.collectionDef=r.emptyObject,e.prototype.signatureDef=r.emptyObject,e.prototype.assetFileDef=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o,a=void 0===t?e.len:e.pos+t,i=new s.tensorflow.MetaGraphDef;e.pos<a;){var p=e.uint32();switch(p>>>3){case 1:i.metaInfoDef=s.tensorflow.MetaGraphDef.MetaInfoDef.decode(e,e.uint32());break;case 2:i.graphDef=s.tensorflow.GraphDef.decode(e,e.uint32());break;case 3:i.saverDef=s.tensorflow.SaverDef.decode(e,e.uint32());break;case 4:e.skip().pos++,i.collectionDef===r.emptyObject&&(i.collectionDef={}),o=e.string(),e.pos++,i.collectionDef[o]=s.tensorflow.CollectionDef.decode(e,e.uint32());break;case 5:e.skip().pos++,i.signatureDef===r.emptyObject&&(i.signatureDef={}),o=e.string(),e.pos++,i.signatureDef[o]=s.tensorflow.SignatureDef.decode(e,e.uint32());break;case 6:i.assetFileDef&&i.assetFileDef.length||(i.assetFileDef=[]),i.assetFileDef.push(s.tensorflow.AssetFileDef.decode(e,e.uint32()));break;default:e.skipType(7&p)}}return i},e.MetaInfoDef=function(){function e(e){if(this.tags=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.metaGraphVersion="",e.prototype.strippedOpList=null,e.prototype.anyInfo=null,e.prototype.tags=r.emptyArray,e.prototype.tensorflowVersion="",e.prototype.tensorflowGitVersion="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.MetaGraphDef.MetaInfoDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.metaGraphVersion=e.string();break;case 2:r.strippedOpList=s.tensorflow.OpList.decode(e,e.uint32());break;case 3:r.anyInfo=s.tensorflow.Any.decode(e,e.uint32());break;case 4:r.tags&&r.tags.length||(r.tags=[]),r.tags.push(e.string());break;case 5:r.tensorflowVersion=e.string();break;case 6:r.tensorflowGitVersion=e.string();break;default:e.skipType(7&a)}}return r},e}(),e}(),e.SavedModel=function(){function e(e){if(this.metaGraphs=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.savedModelSchemaVersion=r.Long?r.Long.fromBits(0,0,!1):0,e.prototype.metaGraphs=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.SavedModel;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.savedModelSchemaVersion=e.int64();break;case 2:r.metaGraphs&&r.metaGraphs.length||(r.metaGraphs=[]),r.metaGraphs.push(s.tensorflow.MetaGraphDef.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return r},e}(),e.FunctionDefLibrary=function(){function e(e){if(this.function=[],this.gradient=[],e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.function=r.emptyArray,e.prototype.gradient=r.emptyArray,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.FunctionDefLibrary;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.function&&r.function.length||(r.function=[]),r.function.push(s.tensorflow.FunctionDef.decode(e,e.uint32()));break;case 2:r.gradient&&r.gradient.length||(r.gradient=[]),r.gradient.push(s.tensorflow.GradientDef.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return r},e}(),e.FunctionDef=function(){function e(e){if(this.attr={},this.nodeDef=[],this.ret={},e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.signature=null,e.prototype.attr=r.emptyObject,e.prototype.nodeDef=r.emptyArray,e.prototype.ret=r.emptyObject,e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o,a=void 0===t?e.len:e.pos+t,i=new s.tensorflow.FunctionDef;e.pos<a;){var p=e.uint32();switch(p>>>3){case 1:i.signature=s.tensorflow.OpDef.decode(e,e.uint32());break;case 5:e.skip().pos++,i.attr===r.emptyObject&&(i.attr={}),o=e.string(),e.pos++,i.attr[o]=s.tensorflow.AttrValue.decode(e,e.uint32());break;case 3:i.nodeDef&&i.nodeDef.length||(i.nodeDef=[]),i.nodeDef.push(s.tensorflow.NodeDef.decode(e,e.uint32()));break;case 4:e.skip().pos++,i.ret===r.emptyObject&&(i.ret={}),o=e.string(),e.pos++,i.ret[o]=e.string();break;default:e.skipType(7&p)}}return i},e}(),e.GradientDef=function(){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.functionName="",e.prototype.gradientFunc="",e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var o=void 0===t?e.len:e.pos+t,r=new s.tensorflow.GradientDef;e.pos<o;){var a=e.uint32();switch(a>>>3){case 1:r.functionName=e.string();break;case 2:r.gradientFunc=e.string();break;default:e.skipType(7&a)}}return r},e}(),e})();exports.default=s;
},{"protobufjs/minimal":387}],256:[function(require,module,exports) {
"use strict";function e(e,n,r,u){var i=n.params[e];if(i&&void 0!==i.inputIndex){if("tensor"===i.type)return t(n.inputNames[i.inputIndex],r,u);if("tensors"===i.type)return(0===i.inputIndex?0===i.inputParamLength?n.inputNames:n.inputNames.slice(i.inputIndex,-i.inputParamLength):n.inputNames.splice(i.inputIndex)).map(function(e){return t(e,r,u)});var s=Array.prototype.slice.call(t(n.inputNames.slice(i.inputIndex)[0],r,u).dataSync());return"number"===i.type?s[0]:s}return i&&i.value}function t(e,t,n){var i=u(e),s=i[0],a=i[1],p=n.currentContextIds.find(function(e){return!!t[r(s,e)]});return void 0!==p?t[r(s,p)][a]:void 0}function n(e,t){var n=u(e),i=n[0],s=n[1];return[r(i,t&&t.currentContextId),s]}function r(e,t){return t?e+"-"+t:e}function u(e){var t=e.lastIndexOf(":");return-1===t?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function i(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getParamValue=e,exports.getTensor=t,exports.getNodeNameAndIndex=n,exports.parseNodeName=u,exports.split=i;
},{}],296:[function(require,module,exports) {
module.exports=[{tfOpName:"Add",dlOpName:"add",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BiasAdd",dlOpName:"add",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",dlOpName:"sub",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",dlOpName:"div",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",dlOpName:"div",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",dlOpName:"mul",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",dlOpName:"maximum",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"}]},{tfOpName:"Minimum",dlOpName:"minimum",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"}]},{tfOpName:"Pow",dlOpName:"pow",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",dlOpName:"squaredDifference",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",dlOpName:"mod",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}];
},{}],297:[function(require,module,exports) {
module.exports=[{tfOpName:"Abs",dlOpName:"abs",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",dlOpName:"acos",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",dlOpName:"asin",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"atan",dlOpName:"atan",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",dlOpName:"ceil",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",dlOpName:"clipByValue",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"clip_value_min",dlParamName:"clipValueMin",type:"number"},{tfParamName:"clip_value_max",dlParamName:"clipValueMax",type:"number"}]},{tfOpName:"Cos",dlOpName:"cos",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",dlOpName:"cosh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",dlOpName:"elu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",dlOpName:"exp",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",dlOpName:"floor",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",dlOpName:"log",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",dlOpName:"neg",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",dlOpName:"relu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",dlOpName:"clipByValue",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{dlParamName:"clipValueMin",type:"number",defaultValue:0},{dlParamName:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",dlOpName:"selu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",dlOpName:"sigmoid",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",dlOpName:"sin",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",dlOpName:"sinh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",dlOpName:"sqrt",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",dlOpName:"rsqrt",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",dlOpName:"square",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",dlOpName:"tan",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",dlOpName:"tanh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",dlOpName:"sign",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",dlOpName:"round",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",dlOpName:"expm1",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",dlOpName:"log1p",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",dlOpName:"reciprocal",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",dlOpName:"reciprocal",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",dlOpName:"softplus",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",dlOpName:"asinh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",dlOpName:"acosh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",dlOpName:"atanh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",dlOpName:"erf",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}];
},{}],298:[function(require,module,exports) {
module.exports=[{tfOpName:"LoopCond",dlOpName:"loopCond",category:"control",params:[{tfInputIndex:0,dlParamName:"pred",type:"tensor"}]},{tfOpName:"Switch",dlOpName:"switch",category:"control",params:[{tfInputIndex:0,dlParamName:"data",type:"tensor"},{tfInputIndex:1,dlParamName:"pred",type:"tensor"}]},{tfOpName:"Merge",dlOpName:"merge",category:"control",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"}]},{tfOpName:"Enter",dlOpName:"enter",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"frame_name",dlParamName:"frameName",type:"string"},{tfParamName:"is_constant",dlParamName:"isConstant",type:"bool"}]},{tfOpName:"Exit",dlOpName:"exit",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",dlOpName:"nextIteration",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}];
},{}],299:[function(require,module,exports) {
module.exports=[{tfOpName:"AvgPool",dlOpName:"avgPool",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0},{tfParamName:"ksize",dlParamName:"kernelSize",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",dlOpName:"maxPool",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0},{tfParamName:"ksize",dlParamName:"kernelSize",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",dlOpName:"conv1d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"stride",dlParamName:"stride",type:"number"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NWC"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"dilation",dlParamName:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",dlOpName:"conv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"useCudnnOnGpu",dlParamName:"useCudnnOnGpu",type:"bool"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]},{tfOpName:"Conv2DBackpropInput",dlOpName:"conv2dTranspose",category:"convolution",params:[{tfInputIndex:2,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfInputIndex:0,dlParamName:"outputShape",type:"number[]"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",dlOpName:"depthwiseConv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"input",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",dlOpName:"depthwiseConv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"input",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]}];
},{}],300:[function(require,module,exports) {
module.exports=[{tfOpName:"Fill",dlOpName:"fill",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfInputIndex:1,dlParamName:"value",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LinSpace",dlOpName:"linspace",category:"creation",params:[{tfInputIndex:0,dlParamName:"start",type:"number"},{tfInputIndex:1,dlParamName:"stop",type:"number"},{tfInputIndex:2,dlParamName:"num",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",dlOpName:"oneHot",category:"creation",params:[{tfInputIndex:0,dlParamName:"indices",type:"tensor"},{tfInputIndex:1,dlParamName:"depth",type:"number"},{tfInputIndex:2,dlParamName:"onValue",type:"number",defaultValue:1},{tfInputIndex:3,dlParamName:"offValue",type:"number",defaultValue:0},{tfParamName:"axis",dlParamName:"axis",type:"number",notSupported:!0},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",dlOpName:"ones",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",dlOpName:"onesLike",category:"creation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",dlOpName:"randomUniform",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"minval",dlParamName:"minval",type:"number",defaultValue:0},{tfParamName:"maxval",dlParamName:"maxval",type:"number",defaultValue:1},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"seed",dlParamName:"seed",type:"number",defaultValue:0},{tfParamName:"seed2",dlParamName:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfParamName:"T",dlParamName:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",dlOpName:"range",category:"creation",params:[{tfInputIndex:0,dlParamName:"start",type:"number"},{tfInputIndex:1,dlParamName:"stop",type:"number"},{tfInputIndex:2,dlParamName:"step",type:"number",defaultValue:0},{tfParamName:"Tidx",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"truncatedNormal",dlOpName:"truncatedNormal",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"means",dlParamName:"mean",type:"number",defaultValue:0},{tfParamName:"stddev",dlParamName:"stdDev",type:"number",defaultValue:1},{tfParamName:"seed",dlParamName:"seed",type:"number"},{tfParamName:"seed2",dlParamName:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"T",dlParamName:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",dlOpName:"zeros",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",dlOpName:"zerosLike",category:"creation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]}];
},{}],301:[function(require,module,exports) {
module.exports=[{tfOpName:"PlaceholderWithDefault",dlOpName:"placeholder",category:"graph",params:[{tfInputIndex:0,dlParamName:"default",type:"tensor"}]},{tfOpName:"Placeholder",dlOpName:"placeholder",category:"graph"},{tfOpName:"Const",dlOpName:"const",category:"graph"},{tfOpName:"Identity",dlOpName:"identity",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Snapshot",dlOpName:"snapshot",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Shape",dlOpName:"shape",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Print",dlOpName:"print",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,tfInputParamLength:1,dlParamName:"data",type:"tensors"},{tfParamName:"message",dlParamName:"message",type:"string"},{tfParamName:"first_n",dlParamName:"firstN",type:"number",notSupprted:!0},{tfParamName:"summarize",dlParamName:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",dlOpName:"noop",category:"graph",params:[]},{tfOpName:"StopGradient",dlOpName:"stopGradient",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",dlOpName:"fakeQuantWithMinMaxVars",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"min",dlParamName:"min",type:"number"},{tfParamName:"max",dlParamName:"max",type:"number"}]}];
},{}],302:[function(require,module,exports) {
module.exports=[{tfOpName:"ResizeBilinear",dlOpName:"resizeBilinear",category:"image",params:[{tfInputIndex:0,dlParamName:"images",type:"tensor"},{tfInputIndex:1,dlParamName:"size",type:"number[]"},{tfParamName:"align_corners",dlParamName:"alignCorners",type:"bool"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",dlOpName:"resizeNearestNeighbor",category:"image",params:[{tfInputIndex:0,dlParamName:"images",type:"tensor"},{tfInputIndex:1,dlParamName:"size",type:"number[]"},{tfParamName:"align_corners",dlParamName:"alignCorners",type:"bool"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}];
},{}],303:[function(require,module,exports) {
module.exports=[{tfOpName:"Equal",dlOpName:"equal",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",dlOpName:"notEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",dlOpName:"greater",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",dlOpName:"greaterEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",dlOpName:"less",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",dlOpName:"lessEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",dlOpName:"logicalAnd",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",dlOpName:"logicalNot",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",dlOpName:"logicalOr",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",dlOpName:"where",category:"logical",params:[{tfInputIndex:0,dlParamName:"condition",type:"tensor"},{tfInputIndex:1,dlParamName:"a",type:"tensor"},{tfInputIndex:2,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}];
},{}],304:[function(require,module,exports) {
module.exports=[{tfOpName:"MatMul",dlOpName:"matMul",category:"matrices",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"transpose_a",dlParamName:"transposeA",type:"bool",defaultValue:!1},{tfParamName:"transpose_b",dlParamName:"transposeB",type:"bool",defaultValue:!1},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",dlOpName:"transpose",category:"matrices",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"perm",dlParamName:"perm",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}];
},{}],305:[function(require,module,exports) {
module.exports=[{tfOpName:"FusedBatchNorm",dlOpName:"batchNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"scale",type:"tensor"},{tfInputIndex:2,dlParamName:"offset",type:"tensor"},{tfInputIndex:3,dlParamName:"mean",type:"tensor"},{tfInputIndex:4,dlParamName:"variance",type:"tensor"},{tfParamName:"epsilon",dlParamName:"epsilon",type:"number",defaultValue:.001},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",dlOpName:"batchNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"scale",type:"tensor"},{tfInputIndex:2,dlParamName:"offset",type:"tensor"},{tfInputIndex:3,dlParamName:"mean",type:"tensor"},{tfInputIndex:4,dlParamName:"variance",type:"tensor"},{tfParamName:"epsilon",dlParamName:"epsilon",type:"number",defaultValue:.001},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",dlOpName:"localResponseNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"depth_radius",dlParamName:"radius",type:"number",defaultValue:5},{tfParamName:"bias",dlParamName:"bias",type:"number",defaultValue:1},{tfParamName:"alpha",dlParamName:"alpha",type:"number",defaultValue:1},{tfParamName:"beta",dlParamName:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",dlOpName:"softmax",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]}];
},{}],306:[function(require,module,exports) {
module.exports=[{tfOpName:"Max",dlOpName:"max",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Mean",dlOpName:"mean",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Min",dlOpName:"min",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Sum",dlOpName:"sum",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",dlOpName:"argMax",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"ArgMin",dlOpName:"argMin",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]}];
},{}],307:[function(require,module,exports) {
module.exports=[{tfOpName:"ConcatV2",dlOpName:"concat",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:1,dlParamName:"tensors",type:"tensors"},{tfInputIndex:-1,dlParamName:"axis",type:"number"}]},{tfOpName:"Concat",dlOpName:"concat",category:"slice_join",params:[{tfInputIndex:1,tfInputParamLength:1,dlParamName:"tensors",type:"tensors"},{tfInputIndex:0,dlParamName:"axis",type:"number"}]},{tfOpName:"GatherV2",dlOpName:"gather",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",dlOpName:"gather",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0},{tfParamName:"validate_indices",dlParamName:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",dlOpName:"reverse",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"ReverseV2",dlOpName:"reverse",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"Slice",dlOpName:"slice",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"begin",type:"number[]"},{tfInputIndex:2,dlParamName:"size",type:"number[]"}]},{tfOpName:"StridedSlice",dlOpName:"stridedSlice",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"begin",type:"number[]"},{tfInputIndex:2,dlParamName:"end",type:"number[]"},{tfInputIndex:3,dlParamName:"strides",type:"number[]"},{tfParamName:"begin_mask",dlParamName:"beginMask",type:"number",defaultValue:0},{tfParamName:"end_mask",dlParamName:"endMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",dlOpName:"stack",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"Tile",dlOpName:"tile",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"reps",type:"number[]"}]},{tfOpName:"Split",dlOpName:"split",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"axis",type:"number",defaultValue:0},{tfInputIndex:1,dlParamName:"x",type:"tensor"},{tfParamName:"num_split",dlParamName:"numOrSizeSplits",type:"number",defaultValue:1}]}];
},{}],308:[function(require,module,exports) {
module.exports=[{tfOpName:"Cast",dlOpName:"cast",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"SrcT",dlParamName:"sdtype",type:"dtype",notSupported:!0},{tfParamName:"DstT",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",dlOpName:"expandDims",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,tfParamNameDeprecated:"dim",dlParamName:"axis",type:"number"}]},{tfOpName:"Pad",dlOpName:"pad",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"padding",type:"number[]"},{tfParamName:"constant_value",dlParamName:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",dlOpName:"pad",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"padding",type:"number[]"},{tfInputIndex:2,dlParamName:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",dlOpName:"reshape",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"shape",type:"number[]"}]},{tfOpName:"Squeeze",dlOpName:"squeeze",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"axis",tfParamNameDeprecated:"squeeze_dims",dlParamName:"axis",type:"number[]"}]}];
},{}],232:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OperationMapper=void 0;var e=require("../data/compiled_api"),t=require("./executors/utils"),r=require("./op_list/arithmetic.json"),a=T(r),o=require("./op_list/basic_math.json"),n=T(o),i=require("./op_list/control.json"),u=T(i),p=require("./op_list/convolution.json"),s=T(p),m=require("./op_list/creation.json"),l=T(m),f=require("./op_list/graph.json"),c=T(f),d=require("./op_list/image.json"),h=T(d),P=require("./op_list/logical.json"),y=T(P),g=require("./op_list/matrices.json"),v=T(g),N=require("./op_list/normalization.json"),b=T(N),_=require("./op_list/reduction.json"),D=T(_),j=require("./op_list/slice_join.json"),w=T(j),q=require("./op_list/transformation.json"),O=T(q);function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var V=["Switch","Merge","Enter","Exit","NextIteration"],I=function(){function r(){var e=[a,n,u,s,l,y,h,c,v,b,D,w,O],t=[].concat.apply([],e.map(function(e){return e.default?e.default:e}));this.opMappers=t.reduce(function(e,t){return e[t.tfOpName]=t,e},{})}return Object.defineProperty(r,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),r.prototype.isControlFlow=function(e){return V.some(function(t){return t===e.op})},r.prototype.transformGraph=function(e){var r=this,a=e.node,o=!1,n=[],i=a.reduce(function(e,t){return e[t.name]=r.mapNode(t),r.isControlFlow(t)&&(o=!0),"Placeholder"===t.op&&n.push(e[t.name]),e},{}),u=[],p=[];return Object.keys(i).forEach(function(e){var r=i[e];r.inputNames.forEach(function(e){var a=(0,t.getNodeNameAndIndex)(e)[0];r.inputs.push(i[a]),i[a].children.push(r)}),0===r.inputs.length&&u.push(r)}),Object.keys(i).forEach(function(e){var t=i[e];0===t.children.length&&p.push(t)}),{nodes:i,inputs:u,outputs:p,placeholders:n,withControlFlow:o}},r.prototype.mapNode=function(e){var t=this,r=this.opMappers[e.op];if(void 0===r)throw new Error("Tensorflow Op is not supported: "+e.op);var a={name:e.name,op:r.dlOpName,category:r.category,inputNames:(e.input||[]).map(function(e){return e.startsWith("^")?e.substr(1):e}),inputs:[],children:[],params:{}};return r.params&&(a.params=r.params.reduce(function(r,a){var o=a.tfInputIndex,n=a.tfInputParamLength,i=a.type,u=void 0;if(void 0===o)switch(a.type){case"string":void 0===(u=t.getStringParam(e.attr,a.tfParamName,a.defaultValue))&&a.tfParamNameDeprecated&&(u=t.getStringParam(e.attr,a.tfParamNameDeprecated,a.defaultValue));break;case"number":void 0===(u=t.getNumberParam(e.attr,a.tfParamName,a.defaultValue))&&a.tfParamNameDeprecated&&(u=t.getNumberParam(e.attr,a.tfParamNameDeprecated,a.defaultValue));break;case"number[]":void 0===(u=t.getNumericArrayParam(e.attr,a.tfParamName,a.defaultValue))&&a.tfParamNameDeprecated&&(u=t.getNumericArrayParam(e.attr,a.tfParamNameDeprecated,a.defaultValue));break;case"bool":void 0===(u=t.getBoolParam(e.attr,a.tfParamName,a.defaultValue))&&a.tfParamNameDeprecated&&(u=t.getBoolParam(e.attr,a.tfParamNameDeprecated,a.defaultValue));break;case"shape":void 0===(u=t.getTensorShapeParam(e.attr,a.tfParamName,a.defaultValue))&&a.tfParamNameDeprecated&&(u=t.getTensorShapeParam(e.attr,a.tfParamNameDeprecated,a.defaultValue));break;case"dtype":void 0===(u=t.getDtypeParam(e.attr,a.tfParamName,a.defaultValue))&&a.tfParamNameDeprecated&&(u=t.getDtypeParam(e.attr,a.tfParamNameDeprecated,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+e.op)}return r[a.dlParamName]={value:u,inputIndex:o,type:i,inputParamLength:n},r},{})),a},r.prototype.getStringParam=function(e,t,r,a){void 0===a&&(a=!1);var o=e[t];if(void 0!==o){var n=String.fromCharCode.apply(null,o.s);return a?n:n.toLowerCase()}return r},r.prototype.getBoolParam=function(e,t,r){var a=e[t];return a?a.b:r},r.prototype.getNumberParam=function(e,t,r){var a=e[t],o=a?void 0!==a.f?a.f:a.i:r;return"number"==typeof o?o:o.toInt()},r.prototype.getDtypeParam=function(t,r,a){var o=t[r];if(o&&o.type)switch(o.type){case e.tensorflow.DataType.DT_FLOAT:return"float32";case e.tensorflow.DataType.DT_INT32:return"int32";case e.tensorflow.DataType.DT_BOOL:return"bool";default:return a}return a},r.prototype.getTensorShapeParam=function(e,t,r){var a=e[t];return a&&a.shape?a.shape.dim.map(function(e){return e.size}):r},r.prototype.getNumericArrayParam=function(e,t,r){var a=e[t];return a?(a.list.f&&a.list.f.length?a.list.f:a.list.i).map(function(e){return"number"==typeof e?e:e.toInt()}):r},r}();exports.OperationMapper=I;
},{"../data/compiled_api":231,"./executors/utils":256,"./op_list/arithmetic.json":296,"./op_list/basic_math.json":297,"./op_list/control.json":298,"./op_list/convolution.json":299,"./op_list/creation.json":300,"./op_list/graph.json":301,"./op_list/image.json":302,"./op_list/logical.json":303,"./op_list/matrices.json":304,"./op_list/normalization.json":305,"./op_list/reduction.json":306,"./op_list/slice_join.json":307,"./op_list/transformation.json":308}],282:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var u=exports.executeOp=function(e,t,u){switch(e.op){case"add":return[a.add((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"mod":return[a.mod((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"mul":return[a.mul((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"div":return[a.div((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"sub":return[a.sub((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"minimum":return[a.minimum((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"maximum":return[a.maximum((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"pow":return[a.pow((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];case"squaredDifference":return[a.squaredDifference((0,r.getParamValue)("a",e,t,u),(0,r.getParamValue)("b",e,t,u))];default:throw TypeError("Node type "+e.op+" is not implemented")}},m=exports.CATEGORY="arithmetic";
},{"@tensorflow/tfjs-core":49,"./utils":256}],283:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var u=exports.executeOp=function(e,t,u){switch(e.op){case"abs":return[a.abs((0,r.getParamValue)("x",e,t,u))];case"acos":return[a.acos((0,r.getParamValue)("x",e,t,u))];case"acosh":return[a.acosh((0,r.getParamValue)("x",e,t,u))];case"asin":return[a.asin((0,r.getParamValue)("x",e,t,u))];case"asinh":return[a.asinh((0,r.getParamValue)("x",e,t,u))];case"atan":return[a.atan((0,r.getParamValue)("x",e,t,u))];case"atanh":return[a.atanh((0,r.getParamValue)("x",e,t,u))];case"ceil":return[a.ceil((0,r.getParamValue)("x",e,t,u))];case"cos":return[a.cos((0,r.getParamValue)("x",e,t,u))];case"cosh":return[a.cosh((0,r.getParamValue)("x",e,t,u))];case"elu":return[a.elu((0,r.getParamValue)("x",e,t,u))];case"erf":return[a.erf((0,r.getParamValue)("x",e,t,u))];case"exp":return[a.exp((0,r.getParamValue)("x",e,t,u))];case"expm1":return[a.expm1((0,r.getParamValue)("x",e,t,u))];case"floor":return[a.floor((0,r.getParamValue)("x",e,t,u))];case"log":return[a.log((0,r.getParamValue)("x",e,t,u))];case"log1p":return[a.log1p((0,r.getParamValue)("x",e,t,u))];case"neg":return[a.neg((0,r.getParamValue)("x",e,t,u))];case"reciprocal":return[a.reciprocal((0,r.getParamValue)("x",e,t,u))];case"relu":return[a.relu((0,r.getParamValue)("x",e,t,u))];case"round":return[a.round((0,r.getParamValue)("x",e,t,u))];case"selu":return[a.selu((0,r.getParamValue)("x",e,t,u))];case"sigmoid":return[a.sigmoid((0,r.getParamValue)("x",e,t,u))];case"sin":return[a.sin((0,r.getParamValue)("x",e,t,u))];case"sign":return[a.sign((0,r.getParamValue)("x",e,t,u))];case"sinh":return[a.sinh((0,r.getParamValue)("x",e,t,u))];case"softplus":return[a.softplus((0,r.getParamValue)("x",e,t,u))];case"sqrt":return[a.sqrt((0,r.getParamValue)("x",e,t,u))];case"square":return[a.square((0,r.getParamValue)("x",e,t,u))];case"tanh":return[a.tanh((0,r.getParamValue)("x",e,t,u))];case"tan":return[a.tan((0,r.getParamValue)("x",e,t,u))];case"clipByValue":return[a.clipByValue((0,r.getParamValue)("x",e,t,u),(0,r.getParamValue)("clipValueMin",e,t,u),(0,r.getParamValue)("clipValueMax",e,t,u))];case"rsqrt":return[a.div(a.scalar(1,"float32"),a.sqrt((0,r.getTensor)(e.inputNames[0],t,u)))];default:throw TypeError("Node type "+e.op+" is not implemented")}},s=exports.CATEGORY="basic_math";
},{"@tensorflow/tfjs-core":49,"./utils":256}],284:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=void 0,exports.executeOp=n;var e=require("./utils"),t=function(e,t,r,n){return new(r||(r=Promise))(function(a,o){function u(e){try{c(n.next(e))}catch(e){o(e)}}function i(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(u,i)}c((n=n.apply(e,t||[])).next())})},r=function(e,t){var r,n,a,o,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(a=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[0,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){u.label=o[1];break}if(6===o[0]&&u.label<a[1]){u.label=a[1],a=o;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(o);break}a[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};function n(n,a,o){return t(this,void 0,void 0,function(){var t,u,i,c,s,l,f;return r(this,function(r){switch(r.label){case 0:switch(n.op){case"loopCond":return[3,1];case"switch":return[3,2];case"merge":return[3,4];case"enter":return[3,5];case"exit":return[3,6];case"nextIteration":return[3,7]}return[3,8];case 1:return[2,[(0,e.getParamValue)("pred",n,a,o)]];case 2:return t=(0,e.getParamValue)("pred",n,a,o),u=(0,e.getParamValue)("data",n,a,o),[4,t.data()];case 3:return[2,r.sent()[0]?[void 0,u]:[u,void 0]];case 4:return[2,(i=n.inputNames.find(function(t){return void 0!==(0,e.getTensor)(t,a,o)}))?[(0,e.getTensor)(i,a,o)]:void 0];case 5:return c=(0,e.getParamValue)("frameName",n,a,o),s=(0,e.getParamValue)("tensor",n,a,o),o.enterFrame(c),[2,[s]];case 6:return l=(0,e.getParamValue)("tensor",n,a,o),o.exitFrame(),[2,[l]];case 7:return f=(0,e.getParamValue)("tensor",n,a,o),o.nextIteration(),[2,[f]];case 8:throw TypeError("Node type "+n.op+" is not implemented")}})})}var a=exports.CATEGORY="control";
},{"./utils":256}],285:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var l=exports.executeOp=function(e,t,l){switch(e.op){case"conv1d":var u=(0,r.getParamValue)("stride",e,t,l),o=(0,r.getParamValue)("pad",e,t,l),s=(0,r.getParamValue)("dataFormat",e,t,l).toUpperCase(),m=(0,r.getParamValue)("dilation",e,t,l);return[a.conv1d((0,r.getParamValue)("x",e,t,l),(0,r.getParamValue)("filter",e,t,l),u,o,s,m)];case"conv2d":u=(0,r.getParamValue)("strides",e,t,l),o=(0,r.getParamValue)("pad",e,t,l),s=(0,r.getParamValue)("dataFormat",e,t,l).toUpperCase();var n=(0,r.getParamValue)("dilations",e,t,l);return[a.conv2d((0,r.getParamValue)("x",e,t,l),(0,r.getParamValue)("filter",e,t,l),[u[1],u[2]],o,s,[n[0],n[1]])];case"conv2dTranspose":var P=(0,r.getParamValue)("outputShape",e,t,l);u=(0,r.getParamValue)("strides",e,t,l),o=(0,r.getParamValue)("pad",e,t,l);return[a.conv2dTranspose((0,r.getParamValue)("x",e,t,l),(0,r.getParamValue)("filter",e,t,l),P,[u[1],u[2]],o)];case"depthwiseConv2d":u=(0,r.getParamValue)("strides",e,t,l),o=(0,r.getParamValue)("pad",e,t,l),n=(0,r.getParamValue)("dilations",e,t,l),s=(0,r.getParamValue)("dataFormat",e,t,l).toUpperCase();return[a.depthwiseConv2d((0,r.getParamValue)("input",e,t,l),(0,r.getParamValue)("filter",e,t,l),[u[1],u[2]],o,s,[n[0],n[1]])];case"avgPool":u=(0,r.getParamValue)("strides",e,t,l),o=(0,r.getParamValue)("pad",e,t,l);var d=(0,r.getParamValue)("kernelSize",e,t,l);return[a.avgPool((0,r.getParamValue)("x",e,t,l),[d[1],d[2]],[u[1],u[2]],o)];case"maxPool":u=(0,r.getParamValue)("strides",e,t,l),o=(0,r.getParamValue)("pad",e,t,l),d=(0,r.getParamValue)("kernelSize",e,t,l);return[a.maxPool((0,r.getParamValue)("x",e,t,l),[d[1],d[2]],[u[1],u[2]],o)];default:throw TypeError("Node type "+e.op+" is not implemented")}},u=exports.CATEGORY="convolution";
},{"@tensorflow/tfjs-core":49,"./utils":256}],286:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var u=exports.executeOp=function(e,t,u){switch(e.op){case"fill":var l=(0,r.getParamValue)("shape",e,t,u),s=(0,r.getParamValue)("value",e,t,u);return[a.fill(l,s)];case"linspace":var o=(0,r.getParamValue)("start",e,t,u),n=(0,r.getParamValue)("stop",e,t,u),m=(0,r.getParamValue)("num",e,t,u);return[a.linspace(o,n,m)];case"oneHot":var p=(0,r.getParamValue)("indices",e,t,u),g=(0,r.getParamValue)("depth",e,t,u),P=(0,r.getParamValue)("onValue",e,t,u),V=(0,r.getParamValue)("offValue",e,t,u);return[a.oneHot(p,g,P,V)];case"ones":return[a.ones((0,r.getParamValue)("shape",e,t,u),(0,r.getParamValue)("dtype",e,t,u))];case"onesLike":return[a.onesLike((0,r.getParamValue)("x",e,t,u))];case"randomUniform":return[a.randomUniform((0,r.getParamValue)("shape",e,t,u),(0,r.getParamValue)("minval",e,t,u),(0,r.getParamValue)("maxval",e,t,u),(0,r.getParamValue)("dtype",e,t,u))];case"range":o=(0,r.getParamValue)("start",e,t,u);var i=(0,r.getParamValue)("stop",e,t,u),c=(0,r.getParamValue)("step",e,t,u);return[a.range(o,i,c,(0,r.getParamValue)("dtype",e,t,u))];case"truncatedNormal":l=(0,r.getParamValue)("shape",e,t,u);var d=(0,r.getParamValue)("mean",e,t,u),f=(0,r.getParamValue)("stdDev",e,t,u),v=(0,r.getParamValue)("seed",e,t,u);return[a.truncatedNormal(l,d,f,(0,r.getParamValue)("dtype",e,t,u),v)];case"zeros":return[a.zeros((0,r.getParamValue)("shape",e,t,u),(0,r.getParamValue)("dtype",e,t,u))];case"zerosLike":return[a.zerosLike((0,r.getParamValue)("x",e,t,u))];default:throw TypeError("Node type "+e.op+" is not implemented")}},l=exports.CATEGORY="creation";
},{"@tensorflow/tfjs-core":49,"./utils":256}],287:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),r=t(e),a=require("./utils");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r.default=e,r}var o=exports.executeOp=function(e,t,o){switch(e.op){case"const":return t[e.name];case"placeholder":var s=(0,a.getParamValue)("default",e,t,o);return[(0,a.getTensor)(e.name,t,o)||s];case"identity":case"stopGradient":case"fakeQuantWithMinMaxVars":return[(0,a.getParamValue)("x",e,t,o)];case"snapshot":return[(0,a.getParamValue)("x",e,t,o).clone()];case"shape":return[r.tensor1d((0,a.getParamValue)("x",e,t,o).shape,"int32")];case"noop":return[];case"print":var n=(0,a.getParamValue)("x",e,t,o),u=(0,a.getParamValue)("data",e,t,o),l=(0,a.getParamValue)("message",e,t,o),c=(0,a.getParamValue)("summarize",e,t,o);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(var p=0;p<u.length;p++)console.log(Array.prototype.slice.call(u[0].dataSync()).slice(0,c));return[n];default:throw TypeError("Node type "+e.op+" is not implemented")}},s=exports.CATEGORY="graph";
},{"@tensorflow/tfjs-core":49,"./utils":256}],288:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),r=t(e),a=require("./utils");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r.default=e,r}var i=exports.executeOp=function(e,t,i){switch(e.op){case"resizeBilinear":var s=(0,a.getParamValue)("images",e,t,i),o=(0,a.getParamValue)("size",e,t,i),u=(0,a.getParamValue)("alignCorners",e,t,i);return[r.image.resizeBilinear(s,[o[0],o[1]],u)];case"resizeNearestNeighbor":s=(0,a.getParamValue)("images",e,t,i),o=(0,a.getParamValue)("size",e,t,i),u=(0,a.getParamValue)("alignCorners",e,t,i);return[r.image.resizeNearestNeighbor(s,[o[0],o[1]],u)];default:throw TypeError("Node type "+e.op+" is not implemented")}},s=exports.CATEGORY="image";
},{"@tensorflow/tfjs-core":49,"./utils":256}],289:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var l=exports.executeOp=function(e,t,l){switch(e.op){case"equal":return[a.equal((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"notEqual":return[a.notEqual((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"greater":return[a.greater((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"greaterEqual":return[a.greaterEqual((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"less":return[a.less((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"lessEqual":return[a.lessEqual((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"logicalAnd":return[a.logicalAnd((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"logicalNot":return[a.logicalNot((0,r.getParamValue)("a",e,t,l))];case"logicalOr":return[a.logicalOr((0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];case"where":return[a.where((0,r.getParamValue)("condition",e,t,l),(0,r.getParamValue)("a",e,t,l),(0,r.getParamValue)("b",e,t,l))];default:throw TypeError("Node type "+e.op+" is not implemented")}},u=exports.CATEGORY="logical";
},{"@tensorflow/tfjs-core":49,"./utils":256}],290:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),r=a(e),t=require("./utils");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}var o=exports.executeOp=function(e,a,o){switch(e.op){case"matMul":return[r.matMul((0,t.getParamValue)("a",e,a,o),(0,t.getParamValue)("b",e,a,o),(0,t.getParamValue)("transposeA",e,a,o),(0,t.getParamValue)("transposeB",e,a,o))];case"transpose":return[r.transpose((0,t.getParamValue)("x",e,a,o),(0,t.getParamValue)("perm",e,a,o))];default:throw TypeError("Node type "+e.op+" is not implemented")}},s=exports.CATEGORY="matrices";
},{"@tensorflow/tfjs-core":49,"./utils":256}],291:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var o=exports.executeOp=function(e,t,o){switch(e.op){case"batchNormalization":return[a.batchNormalization((0,r.getParamValue)("x",e,t,o),(0,r.getParamValue)("mean",e,t,o),(0,r.getParamValue)("variance",e,t,o),(0,r.getParamValue)("epsilon",e,t,o),(0,r.getParamValue)("scale",e,t,o),(0,r.getParamValue)("offset",e,t,o))];case"localResponseNormalization":return[a.localResponseNormalization((0,r.getParamValue)("x",e,t,o),(0,r.getParamValue)("radius",e,t,o),(0,r.getParamValue)("bias",e,t,o),(0,r.getParamValue)("alpha",e,t,o),(0,r.getParamValue)("beta",e,t,o))];case"softmax":return[a.softmax((0,r.getParamValue)("x",e,t,o))];default:throw TypeError("Node type "+e.op+" is not implemented")}},l=exports.CATEGORY="normalization";
},{"@tensorflow/tfjs-core":49,"./utils":256}],292:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var u=exports.executeOp=function(e,t,u){switch(e.op){case"max":var s=(0,r.getParamValue)("axis",e,t,u),m=(0,r.getParamValue)("keepDims",e,t,u);return[a.max((0,r.getParamValue)("x",e,t,u),s,m)];case"mean":s=(0,r.getParamValue)("axis",e,t,u),m=(0,r.getParamValue)("keepDims",e,t,u);return[a.mean((0,r.getParamValue)("x",e,t,u),s,m)];case"min":s=(0,r.getParamValue)("axis",e,t,u),m=(0,r.getParamValue)("keepDims",e,t,u);return[a.min((0,r.getParamValue)("x",e,t,u),s,m)];case"sum":s=(0,r.getParamValue)("axis",e,t,u),m=(0,r.getParamValue)("keepDims",e,t,u);return[a.sum((0,r.getParamValue)("x",e,t,u),s,m)];case"argMax":s=(0,r.getParamValue)("axis",e,t,u);return[a.argMax((0,r.getParamValue)("x",e,t,u),s)];case"argMin":s=(0,r.getParamValue)("axis",e,t,u);return[a.argMin((0,r.getParamValue)("x",e,t,u),s)];default:throw TypeError("Node type "+e.op+" is not implemented")}},s=exports.CATEGORY="reduction";
},{"@tensorflow/tfjs-core":49,"./utils":256}],293:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var s=exports.executeOp=function(e,t,s){switch(e.op){case"concat":var u=(0,r.getParamValue)("axis",e,t,s),l=(0,r.getParamValue)("tensors",e,t,s);return[a.concat(l,u)];case"gather":u=(0,r.getParamValue)("axis",e,t,s);var i=(0,r.getParamValue)("x",e,t,s),n=(0,r.getParamValue)("indices",e,t,s);return[a.gather(i,n,u)];case"reverse":u=(0,r.getParamValue)("axis",e,t,s),i=(0,r.getParamValue)("x",e,t,s);return[a.reverse(i,u)];case"slice":var o=(0,r.getParamValue)("begin",e,t,s),c=(0,r.getParamValue)("size",e,t,s);return[a.slice((0,r.getParamValue)("x",e,t,s),o,c)];case"stridedSlice":o=(0,r.getParamValue)("begin",e,t,s);var g=(0,r.getParamValue)("end",e,t,s),m=(0,r.getParamValue)("strides",e,t,s),p=(0,r.getParamValue)("beginMask",e,t,s),P=(0,r.getParamValue)("endMask",e,t,s);return[a.stridedSlice((0,r.getParamValue)("x",e,t,s),o,g,m,p,P)];case"stack":return a.tidy(function(){var u=(0,r.getParamValue)("axis",e,t,s),l=(0,r.getParamValue)("tensors",e,t,s),i=l[0].shape,n=l[0].squeeze().shape,o=l.map(function(e){var r=a.util.arraysEqual(e.shape,i);if(!r&&!a.util.arraysEqual(e.squeeze().shape,n))throw new Error("the input tensors shape does not match");return r?e:e.reshape(i)});return[a.stack(o,u)]});case"tile":var V=(0,r.getParamValue)("reps",e,t,s);return[a.tile((0,r.getParamValue)("x",e,t,s),V)];case"split":u=(0,r.getParamValue)("axis",e,t,s);var d=(0,r.getParamValue)("numOrSizeSplits",e,t,s);return a.split((0,r.getParamValue)("x",e,t,s),d,u);default:throw TypeError("Node type "+e.op+" is not implemented")}},u=exports.CATEGORY="slice_join";
},{"@tensorflow/tfjs-core":49,"./utils":256}],294:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CATEGORY=exports.executeOp=void 0;var e=require("@tensorflow/tfjs-core"),a=t(e),r=require("./utils");function t(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}var s=exports.executeOp=function(e,t,s){switch(e.op){case"cast":return[a.cast((0,r.getParamValue)("x",e,t,s),(0,r.getParamValue)("dtype",e,t,s))];case"expandDims":var u=e.params.axis.value;return[a.expandDims((0,r.getParamValue)("x",e,t,s),u)];case"squeeze":u=e.params.axis.value;return[a.squeeze((0,r.getParamValue)("x",e,t,s),u)];case"reshape":return[a.reshape((0,r.getParamValue)("x",e,t,s),(0,r.getParamValue)("shape",e,t,s))];case"pad":return[a.pad((0,r.getParamValue)("x",e,t,s),(0,r.split)((0,r.getParamValue)("padding",e,t,s),2),(0,r.getParamValue)("constantValue",e,t,s))];default:throw TypeError("Node type "+e.op+" is not implemented")}},u=exports.CATEGORY="transformation";
},{"@tensorflow/tfjs-core":49,"./utils":256}],254:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.executeOp=M;var e=require("./executors/arithmetic_executor"),r=z(e),t=require("./executors/basic_math_executor"),u=z(t),c=require("./executors/control_executor"),o=z(c),i=require("./executors/convolution_executor"),a=z(i),n=require("./executors/creation_executor"),s=z(n),x=require("./executors/graph_executor"),p=z(x),l=require("./executors/image_executor"),_=z(l),O=require("./executors/logical_executor"),m=z(O),q=require("./executors/matrices_executor"),f=z(q),d=require("./executors/normalization_executor"),h=z(d),g=require("./executors/reduction_executor"),v=z(g),y=require("./executors/slice_join_executor"),b=z(y),j=require("./executors/transformation_executor"),w=z(j);function z(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function M(e,t,c){switch(e.category){case"arithmetic":return r.executeOp(e,t,c);case"basic_math":return u.executeOp(e,t,c);case"control":return o.executeOp(e,t,c);case"convolution":return a.executeOp(e,t,c);case"creation":return s.executeOp(e,t,c);case"image":return _.executeOp(e,t,c);case"graph":return p.executeOp(e,t,c);case"logical":return m.executeOp(e,t,c);case"matrices":return f.executeOp(e,t,c);case"normalization":return h.executeOp(e,t,c);case"reduction":return v.executeOp(e,t,c);case"slice_join":return b.executeOp(e,t,c);case"transformation":return w.executeOp(e,t,c);default:throw TypeError("Node type "+e.op+" is not implemented")}}
},{"./executors/arithmetic_executor":282,"./executors/basic_math_executor":283,"./executors/control_executor":284,"./executors/convolution_executor":285,"./executors/creation_executor":286,"./executors/graph_executor":287,"./executors/image_executor":288,"./executors/logical_executor":289,"./executors/matrices_executor":290,"./executors/normalization_executor":291,"./executors/reduction_executor":292,"./executors/slice_join_executor":293,"./executors/transformation_executor":294}],255:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t){this.weightMap=t,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map(function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId}).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t}();exports.ExecutionContext=t;
},{}],233:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphExecutor=void 0;var e=require("@tensorflow/tfjs-core"),t=require("../operations/executors/utils"),n=require("../operations/operation_executor"),r=require("./execution_context"),o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,c)}s((r=r.apply(e,t||[])).next())})},u=function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},c=function(){function c(e){this.graph=e,this.compiledOrder=[],this._weightMap={},this.placeholders=e.placeholders.map(function(e){return e.name}),this.outputs=e.outputs.map(function(e){return e.name}),this.compile()}return Object.defineProperty(c.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map(function(t){return e[t].map(function(e){return e.id})});this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"inputNodes",{get:function(){return this.placeholders},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"outputNodes",{get:function(){return this.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isControlFlowModel",{get:function(){return this.graph.withControlFlow},enumerable:!0,configurable:!0}),c.prototype.compile=function(){if(!this.graph.withControlFlow)for(var e=this.graph.inputs.slice(),n={};e.length>0;){var r=e.pop();n[r.name]=!0,this.compiledOrder.push(r),r.children.forEach(function(r){!n[r.name]&&r.inputNames.every(function(e){var r=(0,t.getNodeNameAndIndex)(e)[0];return n[r]})&&e.push(r)})}},c.prototype.execute=function(t,i){var u=this;return this.checkInput(t),(0,e.tidy)(function(){var e=new r.ExecutionContext(u._weightMap),c=u.compiledOrder.reduce(function(t,r){return t[r.name]=(0,n.executeOp)(r,t,e),t},o({},u.weightMap,t));return u.findOutputs(c,e,i)})},c.prototype.executeAsync=function(e,t){return i(this,void 0,void 0,function(){var n,o,i,c,s,a,p=this;return u(this,function(u){switch(u.label){case 0:return n=new r.ExecutionContext(this._weightMap),[4,this.executeWithControlFlow(e,n)];case 1:return o=u.sent(),i=this.findOutputs(o,n,t),c=Object.keys(i).map(function(e){return i[e].id}),s=Object.keys(e).map(function(t){return e[t].map(function(e){return e.id})}),a=[].concat.apply([],s),Object.keys(o).forEach(function(e){o[e].forEach(function(e){e&&-1===c.indexOf(e.id)&&-1===a.indexOf(e.id)&&-1===p.weightIds.indexOf(e.id)&&e.dispose()})}),[2,i]}})})},c.prototype.executeWithControlFlow=function(e,r){return i(this,void 0,void 0,function(){var i,c,s,a,p,h,f,l;return u(this,function(u){switch(u.label){case 0:i=this.graph.inputs.map(function(e){return{node:e,contexts:r.currentContext}}),c=o({},this.weightMap,e),s={},u.label=1;case 1:return i.length>0?(a=i.pop(),r.currentContext=a.contexts,p=(0,n.executeOp)(a.node,c,r),h=(0,t.getNodeNameAndIndex)(a.node.name,r)[0],f=c,l=h,[4,p]):[3,3];case 2:return f[l]=u.sent(),a.node.children.forEach(function(e){var n=(0,t.getNodeNameAndIndex)(e.name,r)[0];s[n]||("merge"===e.op?e.inputNames.some(function(e){return!!(0,t.getTensor)(e,c,r)})&&(s[n]=!0,i.push({contexts:r.currentContext,node:e})):e.inputNames.every(function(e){return!!(0,t.getTensor)(e,c,r)})&&(s[n]=!0,i.push({contexts:r.currentContext,node:e})))}),[3,1];case 3:return[2,c]}})})},c.prototype.findOutputs=function(e,n,r){return!r||r instanceof Array||(r=[r]),(r||this.graph.outputs.map(function(e){return e.name})).reduce(function(r,o){return r[o]=(0,t.getTensor)(o,e,n),r},{})},c.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach(function(t){return e.weightMap[t].forEach(function(e){return e.dispose()})})},c.prototype.checkInput=function(e){var t=this,n=Object.keys(e),r=[],o=[];if(this.placeholders.forEach(function(e){-1===n.indexOf(e)&&r.push(e)}),n.forEach(function(e){-1===t.placeholders.indexOf(e)&&o.push(e)}),r.length>0)throw new Error("The dict provided in model.execute(dict) has the keys ["+n+"], but is missing the required keys: ["+r+"].");if(o.length>0)throw new Error("The dict provided in model.execute(dict) has unused keys: ["+o+"]. Please provide only the following keys: ["+this.placeholders+"].")},c}();exports.GraphExecutor=c;
},{"@tensorflow/tfjs-core":49,"../operations/executors/utils":256,"../operations/operation_executor":254,"./execution_context":255}],122:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FrozenModel=void 0,exports.loadFrozenModel=h;var e=require("@tensorflow/tfjs-core"),t=u(e),r=require("url"),n=u(r),o=require("../data/compiled_api"),i=require("../operations/operation_mapper"),s=require("./graph_executor");function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var a=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}a((n=n.apply(e,t||[])).next())})},c=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},p=function(){function e(e,t,r){this.modelUrl=e,this.weightManifestUrl=t,this.requestOption=r,this.version="n/a",this.pathPrefix=this.getPathPrefix()}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),e.prototype.getPathPrefix=function(){var e=n.parse(this.weightManifestUrl),t=e.pathname.split("/");return t.splice(-1),e.pathname=t.join("/"),n.format(e)+"/"},e.prototype.loadRemoteProtoFile=function(){return a(this,void 0,void 0,function(){var e,t,r,n,i;return c(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,fetch(this.modelUrl,this.requestOption)];case 1:return e=s.sent(),r=(t=o.tensorflow.GraphDef).decode,n=Uint8Array.bind,[4,e.arrayBuffer()];case 2:return[2,r.apply(t,[new(n.apply(Uint8Array,[void 0,s.sent()]))])];case 3:throw i=s.sent(),new Error(this.modelUrl+" not found. "+i);case 4:return[2]}})})},e.prototype.loadWeightManifest=function(){return a(this,void 0,void 0,function(){var e,t,r;return c(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch(this.weightManifestUrl,this.requestOption)];case 1:return e=n.sent(),t=this,[4,e.clone().json()];case 2:return t.weightManifest=n.sent(),[3,4];case 3:throw r=n.sent(),new Error(this.weightManifestUrl+" not found. "+r);case 4:return[2]}})})},e.prototype.load=function(){return a(this,void 0,void 0,function(){var e,r,n,o;return c(this,function(u){switch(u.label){case 0:return e=this.loadRemoteProtoFile(),r=this.loadWeightManifest(),[4,Promise.all([e,r])];case 1:return n=u.sent()[0],this.version=n.versions.producer+"."+n.versions.minConsumer,[4,t.io.loadWeights(this.weightManifest,this.pathPrefix,void 0,this.requestOption)];case 2:return o=u.sent(),this.executor=new s.GraphExecutor(i.OperationMapper.Instance.transformGraph(n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(o),[2,!0]}})})},e.prototype.predict=function(e,t){return this.execute(e,this.outputNodes)},e.prototype.constructTensorMap=function(e){var r=e instanceof t.Tensor?[e]:e;if(r.length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the frozen model has "+this.inputNodes.length+" placeholders, while there are "+r.length+" input tensors.");return this.inputNodes.reduce(function(e,t,n){return e[t]=r[n],e},{})},e.prototype.execute=function(e,r){if(r=r||this.outputNodes,(e instanceof t.Tensor||Array.isArray(e))&&(e=this.constructTensorMap(e)),this.executor.isControlFlowModel)throw new Error("The model contains control flow ops, please use executeAsync method");var n=this.executor.execute(this.convertTensorMapToTensorsMap(e),r),o=Object.keys(n);return Array.isArray(r)&&r.length>1?r.map(function(e){return n[e]}):n[o[0]]},e.prototype.executeAsync=function(e,r){return a(this,void 0,void 0,function(){var n,o;return c(this,function(i){switch(i.label){case 0:if(!this.executor.isControlFlowModel)throw new Error("The model does not contain control flow ops, please use execute method for better performance.");return r=r||this.outputNodes,(e instanceof t.Tensor||Array.isArray(e))&&(e=this.constructTensorMap(e)),[4,this.executor.executeAsync(this.convertTensorMapToTensorsMap(e),r)];case 1:return n=i.sent(),o=Object.keys(n),[2,Array.isArray(r)&&r.length>1?r.map(function(e){return n[e]}):n[o[0]]]}})})},e.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce(function(t,r){return t[r]=[e[r]],t},{})},e.prototype.dispose=function(){this.executor.dispose()},e}();function h(e,t,r){return a(this,void 0,void 0,function(){var n;return c(this,function(o){switch(o.label){case 0:return[4,(n=new p(e,t,r)).load()];case 1:return o.sent(),[2,n]}})})}exports.FrozenModel=p;
},{"@tensorflow/tfjs-core":49,"url":234,"../data/compiled_api":231,"../operations/operation_mapper":232,"./graph_executor":233}],121:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="0.4.1";exports.version=e;
},{}],47:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./executor/frozen_model");Object.defineProperty(exports,"FrozenModel",{enumerable:!0,get:function(){return e.FrozenModel}}),Object.defineProperty(exports,"loadFrozenModel",{enumerable:!0,get:function(){return e.loadFrozenModel}});var r=require("./version");Object.defineProperty(exports,"version_converter",{enumerable:!0,get:function(){return r.version}});
},{"./executor/frozen_model":122,"./version":121}],24:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.version=void 0;var e=require("@tensorflow/tfjs-core");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("@tensorflow/tfjs-layers");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("@tensorflow/tfjs-converter");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var o=require("./version"),n=exports.version={"tfjs-core":e.version_core,"tfjs-layers":r.version_layers,"tfjs-converter":t.version_converter,tfjs:o.version};
},{"@tensorflow/tfjs-core":49,"@tensorflow/tfjs-layers":48,"@tensorflow/tfjs-converter":47,"./version":99}],35:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.partNames=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],t=exports.NUM_KEYPOINTS=e.length,r=exports.partIds=e.reduce(function(e,t,r){return e[t]=r,e},{}),l=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]],i=exports.poseChain=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]],h=exports.connectedPartIndices=l.map(function(e){var t=e[0],l=e[1];return[r[t],r[l]]});
},{}],36:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAdjacentKeyPoints=a,exports.getBoundingBox=f,exports.getBoundingBoxPoints=l,exports.toTensorBuffer=p,exports.toTensorBuffers3D=x,exports.scalePose=m,exports.scalePoses=y,exports.getValidResolution=h;var n=require("@tensorflow/tfjs"),e=r(n),t=require("./keypoints");function r(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}var o=function(n,e,t,r){return new(t||(t=Promise))(function(o,i){function u(n){try{c(r.next(n))}catch(n){i(n)}}function a(n){try{c(r.throw(n))}catch(n){i(n)}}function c(n){n.done?o(n.value):new t(function(e){e(n.value)}).then(u,a)}c((r=r.apply(n,e||[])).next())})},i=function(n,e){var t,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;u;)try{if(t=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(n,u)}catch(n){i=[6,n],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};function u(n,e,t){return n<t||e<t}function a(n,e){return t.connectedPartIndices.reduce(function(t,r){var o=r[0],i=r[1];return u(n[o].score,n[i].score,e)?t:(t.push([n[o],n[i]]),t)},[])}var c=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;function f(n){return n.reduce(function(n,e){var t=n.maxX,r=n.maxY,o=n.minX,i=n.minY,u=e.position,a=u.x,c=u.y;return{maxX:Math.max(t,a),maxY:Math.max(r,c),minX:Math.min(o,a),minY:Math.min(i,c)}},{maxX:c,maxY:c,minX:s,minY:s})}function l(n){var e=f(n),t=e.minX,r=e.minY,o=e.maxX,i=e.maxY;return[{x:t,y:r},{x:o,y:r},{x:o,y:i},{x:t,y:i}]}function p(n,t){return void 0===t&&(t="float32"),o(this,void 0,void 0,function(){var r;return i(this,function(o){switch(o.label){case 0:return[4,n.data()];case 1:return r=o.sent(),[2,new e.TensorBuffer(n.shape,t,r)]}})})}function x(n){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,Promise.all(n.map(function(n){return p(n,"float32")}))]})})}function m(n,e,t){return{score:n.score,keypoints:n.keypoints.map(function(n){var r=n.score,o=n.part,i=n.position;return{score:r,part:o,position:{x:i.x*e,y:i.y*t}}})}}function y(n,e,t){return 1===t&&1===e?n:n.map(function(n){return m(n,t,e)})}function h(n,e,t){var r=e*n-1;return r-r%t+1}
},{"@tensorflow/tfjs":24,"./keypoints":35}],193:[function(require,module,exports) {
"use strict";function e(e){return Math.floor(e/2)}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return-1===this.numberOfElements},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(t){for(;t>0&&this.less(e(t),t);)this.exchange(t,e(t)),t=e(t)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},t.prototype.exchange=function(e,t){var i=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=i},t}();exports.MaxHeap=t;
},{}],79:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildPartWithScoreQueue=a;var e=require("./maxHeap");function r(e,r,a,t,o,u){for(var n=u.shape,i=n[0],f=n[1],p=!0,h=Math.max(a-o,0),s=Math.min(a+o+1,i),c=h;c<s;++c){for(var v=Math.max(t-o,0),m=Math.min(t+o+1,f),x=v;x<m;++x)if(u.get(c,x,e)>r){p=!1;break}if(!p)break}return p}function a(a,t,o){for(var u=o.shape,n=u[0],i=u[1],f=u[2],p=new e.MaxHeap(n*i*f,function(e){return e.score}),h=0;h<n;++h)for(var s=0;s<i;++s)for(var c=0;c<f;++c){var v=o.get(h,s,c);v<a||r(c,v,h,s,t,o)&&p.enqueue({score:v,part:{heatmapY:h,heatmapX:s,id:c}})}return p}
},{"./maxHeap":193}],81:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOffsetPoint=r,exports.getImageCoords=t,exports.fillArray=n,exports.clamp=o,exports.squaredDistance=a,exports.addVectors=u,exports.clampVector=s;var e=require("../keypoints");function r(r,t,n,o){return{y:o.get(r,t,n),x:o.get(r,t,n+e.NUM_KEYPOINTS)}}function t(e,t,n){var o=r(e.heatmapY,e.heatmapX,e.id,n),a=o.y,u=o.x;return{x:e.heatmapX*t+u,y:e.heatmapY*t+a}}function n(e,r){for(var t=new Array(r),n=0;n<r;n++)t[n]=e;return t}function o(e,r,t){return e<r?r:e>t?t:e}function a(e,r,t,n){var o=t-e,a=n-r;return o*o+a*a}function u(e,r){return{x:e.x+r.x,y:e.y+r.y}}function s(e,r,t){return{y:o(e.y,r,t),x:o(e.x,r,t)}}
},{"../keypoints":35}],80:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodePose=p;var r=require("../keypoints"),e=require("./util"),t=r.poseChain.map(function(e){var t=e[0],o=e[1];return[r.partIds[t],r.partIds[o]]}),o=t.map(function(r){return r[1]}),n=t.map(function(r){return r[0]});function a(r,e,t){var o=t.shape[2]/2;return{y:t.get(e.y,e.x,r),x:t.get(e.y,e.x,o+r)}}function s(r,t,o,n){return{y:(0,e.clamp)(Math.round(r.y/t),0,o-1),x:(0,e.clamp)(Math.round(r.x/t),0,n-1)}}function i(t,o,n,i,p,u,c){var d=i.shape,y=d[0],x=d[1],f=a(t,s(o.position,u,y,x),c),m=s((0,e.addVectors)(o.position,f),u,y,x),v=(0,e.getOffsetPoint)(m.y,m.x,n,p),g=i.get(m.y,m.x,n);return{position:(0,e.addVectors)({x:m.x*u,y:m.y*u},{x:v.x,y:v.y}),part:r.partNames[n],score:g}}function p(t,a,s,p,u,c){var d=a.shape[2],y=o.length,x=new Array(d),f=t.part,m=t.score,v=(0,e.getImageCoords)(f,p,s);x[f.id]={score:m,part:r.partNames[f.id],position:v};for(var g=y-1;g>=0;--g){var h=o[g],l=n[g];x[h]&&!x[l]&&(x[l]=i(g,x[h],l,a,s,p,c))}for(g=0;g<y;++g){h=n[g],l=o[g];x[h]&&!x[l]&&(x[l]=i(g,x[h],l,a,s,p,u))}return x}
},{"../keypoints":35,"./util":81}],37:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeMultiplePoses=s;var e=require("../util"),t=require("./buildPartWithScoreQueue"),r=require("./decodePose"),n=require("./util"),o=function(e,t,r,n){return new(r||(r=Promise))(function(o,u){function i(e){try{a(n.next(e))}catch(e){u(e)}}function c(e){try{a(n.throw(e))}catch(e){u(e)}}function a(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,c)}a((n=n.apply(e,t||[])).next())})},u=function(e,t){var r,n,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&u[0]?"return":u[0]?"throw":"next"])&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[0,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};function i(e,t,r,o){var u=r.x,i=r.y;return e.some(function(e){var r=e.keypoints[o].position;return(0,n.squaredDistance)(i,u,r.y,r.x)<=t})}function c(e,t,r){return r.reduce(function(r,n,o){var u=n.position,c=n.score;return i(e,t,u,o)||(r+=c),r},0)/r.length}var a=1;function s(s,l,f,p,d,h,y,b){return void 0===y&&(y=.5),void 0===b&&(b=20),o(this,void 0,void 0,function(){var o,v,w,x,g,P,k,m,q,S,D,M;return u(this,function(u){switch(u.label){case 0:return o=[],[4,(0,e.toTensorBuffers3D)([s,l,f,p])];case 1:for(v=u.sent(),w=v[0],x=v[1],g=v[2],P=v[3],k=(0,t.buildPartWithScoreQueue)(y,a,w),m=b*b;o.length<h&&!k.empty();)q=k.dequeue(),S=(0,n.getImageCoords)(q.part,d,x),i(o,m,S,q.part.id)||(D=(0,r.decodePose)(q,w,x,d,g,P),M=c(o,m,D),o.push({keypoints:D,score:M}));return[2,o]}})})}
},{"../util":36,"./buildPartWithScoreQueue":79,"./decodePose":80,"./util":81}],55:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CheckpointLoader=void 0;var e=require("@tensorflow/tfjs"),n="manifest.json",t=function(){function t(e){this.urlPath=e,"/"!==this.urlPath.charAt(this.urlPath.length-1)&&(this.urlPath+="/")}return t.prototype.loadManifest=function(){var e=this;return new Promise(function(t,o){var r=new XMLHttpRequest;r.open("GET",e.urlPath+n),r.onload=function(){e.checkpointManifest=JSON.parse(r.responseText),t()},r.onerror=function(t){throw new Error(n+" not found at "+e.urlPath+". "+t)},r.send()})},t.prototype.getCheckpointManifest=function(){var e=this;return null==this.checkpointManifest?new Promise(function(n,t){e.loadManifest().then(function(){n(e.checkpointManifest)})}):new Promise(function(n,t){n(e.checkpointManifest)})},t.prototype.getAllVariables=function(){var e=this;return null!=this.variables?new Promise(function(n,t){n(e.variables)}):new Promise(function(n,t){e.getCheckpointManifest().then(function(t){for(var o=Object.keys(e.checkpointManifest),r=[],i=0;i<o.length;i++)r.push(e.getVariable(o[i]));Promise.all(r).then(function(t){e.variables={};for(var r=0;r<t.length;r++)e.variables[o[r]]=t[r];n(e.variables)})})})},t.prototype.getVariable=function(n){var t=this;if(!(n in this.checkpointManifest))throw new Error("Cannot load non-existant variable "+n);var o=function(o,r){var i=new XMLHttpRequest;i.responseType="arraybuffer";var a=t.checkpointManifest[n].filename;i.open("GET",t.urlPath+a),i.onload=function(){if(404===i.status)throw new Error("Not found variable "+n);var r=new Float32Array(i.response),a=e.Tensor.make(t.checkpointManifest[n].shape,{values:r});o(a)},i.onerror=function(e){throw new Error("Could not fetch variable "+n+": "+e)},i.send()};return null==this.checkpointManifest?new Promise(function(e,n){t.loadManifest().then(function(){new Promise(o).then(e)})}):new Promise(o)},t}();exports.CheckpointLoader=t;
},{"@tensorflow/tfjs":24}],53:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MobileNet=exports.mobileNetArchitectures=void 0,exports.assertValidOutputStride=i,exports.assertValidResolution=p,exports.assertValidScaleFactor=l;var e=require("@tensorflow/tfjs"),t=a(e);function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}var r=[["conv2d",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",2],["separableConv",1]],o=[["conv2d",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1]],s=[["conv2d",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",2],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1],["separableConv",1]],n=[8,16,32];function i(e){t.util.assert("number"==typeof e,"outputStride is not a number"),t.util.assert(n.indexOf(e)>=0,"outputStride of "+e+" is invalid. It must be either 8, 16, or 32")}function p(e,a){t.util.assert("number"==typeof e,"resolution is not a number"),t.util.assert((e-1)%a==0,"resolution of "+e+" is invalid for output stride "+a+".")}function l(e){t.util.assert("number"==typeof e,"imageScaleFactor is not a number"),t.util.assert(e>=.2&&e<=1,"imageScaleFactor must be between 0.2 and 1.0")}var v=exports.mobileNetArchitectures={100:r,75:o,50:s};function u(e,t){var a=1,r=1;return e.map(function(e,o){var s,n,i=e[0],p=e[1];return a===t?(s=1,n=r,r*=p):(s=p,n=1,a*=p),{blockId:o,convType:i,stride:s,rate:n,outputStride:a}})}var b=function(){function e(e,a){this.PREPROCESS_DIVISOR=t.scalar(127.5),this.ONE=t.scalar(1),this.variables=e,this.convolutionDefinitions=a}return e.prototype.predict=function(e,a){var r=this,o=t.cast(e,"float32").div(this.PREPROCESS_DIVISOR).sub(this.ONE);return u(this.convolutionDefinitions,a).reduce(function(e,t){var a=t.blockId,o=t.stride,s=t.convType,n=t.rate;if("conv2d"===s)return r.conv(e,o,a);if("separableConv"===s)return r.separableConv(e,o,a,n);throw Error("Unknown conv type of "+s)},o)},e.prototype.convToOutput=function(e,t){return e.conv2d(this.weights(t),1,"same").add(this.biases(t))},e.prototype.conv=function(e,t,a){return e.conv2d(this.weights("Conv2d_"+String(a)),t,"same").add(this.biases("Conv2d_"+String(a))).clipByValue(0,6)},e.prototype.separableConv=function(e,t,a,r){void 0===r&&(r=1);var o="Conv2d_"+String(a)+"_depthwise",s="Conv2d_"+String(a)+"_pointwise";return e.depthwiseConv2D(this.depthwiseWeights(o),t,"same","NHWC",r).add(this.biases(o)).clipByValue(0,6).conv2d(this.weights(s),[1,1],"same").add(this.biases(s)).clipByValue(0,6)},e.prototype.weights=function(e){return this.variables["MobilenetV1/"+e+"/weights"]},e.prototype.biases=function(e){return this.variables["MobilenetV1/"+e+"/biases"]},e.prototype.depthwiseWeights=function(e){return this.variables["MobilenetV1/"+e+"/depthwise_weights"]},e.prototype.dispose=function(){for(var e in this.variables)this.variables[e].dispose()},e}();exports.MobileNet=b;
},{"@tensorflow/tfjs":24}],34:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkpoints=void 0;var e=require("./mobilenet"),t="https://storage.googleapis.com/tfjs-models/weights/posenet/",r=exports.checkpoints={1.01:{url:t+"mobilenet_v1_101/",architecture:e.mobileNetArchitectures[100]},1:{url:t+"mobilenet_v1_100/",architecture:e.mobileNetArchitectures[100]},.75:{url:t+"mobilenet_v1_075/",architecture:e.mobileNetArchitectures[75]},.5:{url:t+"mobilenet_v1_050/",architecture:e.mobileNetArchitectures[50]}};
},{"./mobilenet":53}],82:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.argmax2d=a;var r=require("@tensorflow/tfjs"),e=t(r);function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function n(r,t){return e.tidy(function(){var n=r.div(e.scalar(t,"int32"));return r.sub(n.mul(e.scalar(t,"int32")))})}function a(r){var t=r.shape,a=t[0],i=t[1],u=t[2];return e.tidy(function(){var t=r.reshape([a*i,u]).argMax(0),o=t.div(e.scalar(i,"int32")).expandDims(1),s=n(t,i).expandDims(1);return e.concat([o,s],1)})}
},{"@tensorflow/tfjs":24}],83:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPointsConfidence=o,exports.getOffsetVectors=s,exports.getOffsetPoints=f;var e=require("@tensorflow/tfjs"),t=n(e),r=require("../keypoints");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e,t){for(var r=t.shape[0],n=new Float32Array(r),o=0;o<r;o++){var u=t.get(o,0),s=t.get(o,1);n[o]=e.get(u,s,o)}return n}function u(e,t,n,o){return{y:o.get(e,t,n),x:o.get(e,t,n+r.NUM_KEYPOINTS)}}function s(e,n){for(var o=[],s=0;s<r.NUM_KEYPOINTS;s++){var f=u(e.get(s,0).valueOf(),e.get(s,1).valueOf(),s,n),a=f.x,i=f.y;o.push(i),o.push(a)}return t.tensor2d(o,[r.NUM_KEYPOINTS,2])}function f(e,r,n){return t.tidy(function(){var o=s(e,n);return e.toTensor().mul(t.scalar(r,"int32")).toFloat().add(o)})}
},{"@tensorflow/tfjs":24,"../keypoints":35}],38:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeSinglePose=u;var e=require("../keypoints"),t=require("../util"),r=require("./argmax2d"),n=require("./util"),o=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(u,a)}s((n=n.apply(e,t||[])).next())})},i=function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};function u(u,a,s){return o(this,void 0,void 0,function(){var o,c,l,f,p,h,y,d,b,v;return i(this,function(i){switch(i.label){case 0:return o=0,c=(0,r.argmax2d)(u),[4,Promise.all([(0,t.toTensorBuffer)(u),(0,t.toTensorBuffer)(a),(0,t.toTensorBuffer)(c,"int32")])];case 1:return l=i.sent(),f=l[0],p=l[1],h=l[2],y=(0,n.getOffsetPoints)(h,s,p),[4,(0,t.toTensorBuffer)(y)];case 2:return d=i.sent(),b=Array.from((0,n.getPointsConfidence)(f,h)),v=b.map(function(t,r){return o+=t,{position:{y:d.get(r,0),x:d.get(r,1)},part:e.partNames[r],score:t}}),c.dispose(),y.dispose(),[2,{keypoints:v,score:o/v.length}]}})})}
},{"../keypoints":35,"../util":36,"./argmax2d":82,"./util":83}],33:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PoseNet=void 0,exports.load=f;var e=require("@tensorflow/tfjs"),t=l(e),o=require("./checkpoint_loader"),i=require("./checkpoints"),r=require("./mobilenet"),n=require("./multiPose/decodeMultiplePoses"),s=require("./singlePose/decodeSinglePose"),u=require("./util");function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}var a=function(e,t,o,i){return new(o||(o=Promise))(function(r,n){function s(e){try{l(i.next(e))}catch(e){n(e)}}function u(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){e.done?r(e.value):new o(function(t){t(e.value)}).then(s,u)}l((i=i.apply(e,t||[])).next())})},c=function(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function u(n){return function(u){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,u])}}};function d(e,o,i,r){var n=t.fromPixels(e);return r?n.reverse(1).resizeBilinear([o,i]):n.resizeBilinear([o,i])}var p=function(){function e(e){this.mobileNet=e}return e.prototype.predictForSinglePose=function(e,o){var i=this;return void 0===o&&(o=16),(0,r.assertValidOutputStride)(o),t.tidy(function(){var t=i.mobileNet.predict(e,o),r=i.mobileNet.convToOutput(t,"heatmap_2"),n=i.mobileNet.convToOutput(t,"offset_2");return{heatmapScores:r.sigmoid(),offsets:n}})},e.prototype.predictForMultiPose=function(e,o){var i=this;return void 0===o&&(o=16),t.tidy(function(){var t=i.mobileNet.predict(e,o),r=i.mobileNet.convToOutput(t,"heatmap_2"),n=i.mobileNet.convToOutput(t,"offset_2"),s=i.mobileNet.convToOutput(t,"displacement_fwd_2"),u=i.mobileNet.convToOutput(t,"displacement_bwd_2");return{heatmapScores:r.sigmoid(),offsets:n,displacementFwd:s,displacementBwd:u}})},e.prototype.estimateSinglePose=function(e,o,i,n){return void 0===o&&(o=.5),void 0===i&&(i=!1),void 0===n&&(n=16),a(this,void 0,void 0,function(){var l,a,p,f,h,v,b,m,w=this;return c(this,function(c){switch(c.label){case 0:return(0,r.assertValidOutputStride)(n),(0,r.assertValidScaleFactor)(o),l=(0,u.getValidResolution)(o,e.height,n),a=(0,u.getValidResolution)(o,e.width,n),p=t.tidy(function(){var t=d(e,l,a,i);return w.predictForSinglePose(t,n)}),f=p.heatmapScores,h=p.offsets,[4,(0,s.decodeSinglePose)(f,h,n)];case 1:return v=c.sent(),f.dispose(),h.dispose(),b=e.height/l,m=e.width/a,[2,(0,u.scalePose)(v,b,m)]}})})},e.prototype.estimateMultiplePoses=function(e,o,i,s,l,p,f){return void 0===o&&(o=.5),void 0===i&&(i=!1),void 0===s&&(s=16),void 0===l&&(l=5),void 0===p&&(p=.5),void 0===f&&(f=20),a(this,void 0,void 0,function(){var a,h,v,b,m,w,y,g,P,S,N=this;return c(this,function(c){switch(c.label){case 0:return(0,r.assertValidOutputStride)(s),(0,r.assertValidScaleFactor)(o),a=(0,u.getValidResolution)(o,e.height,s),h=(0,u.getValidResolution)(o,e.width,s),v=t.tidy(function(){var t=d(e,a,h,i);return N.predictForMultiPose(t,s)}),b=v.heatmapScores,m=v.offsets,w=v.displacementFwd,y=v.displacementBwd,[4,(0,n.decodeMultiplePoses)(b,m,w,y,s,l,p,f)];case 1:return g=c.sent(),b.dispose(),m.dispose(),w.dispose(),y.dispose(),P=e.height/a,S=e.width/h,[2,(0,u.scalePoses)(g,P,S)]}})})},e.prototype.dispose=function(){this.mobileNet.dispose()},e}();function f(e){return void 0===e&&(e=1.01),a(this,void 0,void 0,function(){var n,s,u,l;return c(this,function(a){switch(a.label){case 0:if(null==t)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");return n=Object.keys(i.checkpoints),t.util.assert("number"==typeof e,"got multiplier type of "+typeof e+" when it should be a number."),t.util.assert(n.indexOf(e.toString())>=0,"invalid multiplier value of "+e+".  No checkpoint exists for that multiplier. Must be one of "+n.join(",")+"."),s=i.checkpoints[e],[4,new o.CheckpointLoader(s.url).getAllVariables()];case 1:return u=a.sent(),l=new r.MobileNet(u,s.architecture),[2,new p(l)]}})})}exports.PoseNet=p;
},{"@tensorflow/tfjs":24,"./checkpoint_loader":55,"./checkpoints":34,"./mobilenet":53,"./multiPose/decodeMultiplePoses":37,"./singlePose/decodeSinglePose":38,"./util":36}],15:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PoseNet=exports.load=exports.decodeSinglePose=exports.decodeMultiplePoses=exports.getBoundingBoxPoints=exports.getBoundingBox=exports.getAdjacentKeyPoints=exports.poseChain=exports.partNames=exports.partIds=exports.checkpoints=void 0;var e=require("./checkpoints");Object.defineProperty(exports,"checkpoints",{enumerable:!0,get:function(){return e.checkpoints}});var t=require("./keypoints");Object.defineProperty(exports,"partIds",{enumerable:!0,get:function(){return t.partIds}}),Object.defineProperty(exports,"partNames",{enumerable:!0,get:function(){return t.partNames}}),Object.defineProperty(exports,"poseChain",{enumerable:!0,get:function(){return t.poseChain}});var o=require("./util");Object.defineProperty(exports,"getAdjacentKeyPoints",{enumerable:!0,get:function(){return o.getAdjacentKeyPoints}}),Object.defineProperty(exports,"getBoundingBox",{enumerable:!0,get:function(){return o.getBoundingBox}}),Object.defineProperty(exports,"getBoundingBoxPoints",{enumerable:!0,get:function(){return o.getBoundingBoxPoints}});var r=require("./multiPose/decodeMultiplePoses"),n=require("./posenet"),s=require("./singlePose/decodeSinglePose");exports.decodeMultiplePoses=r.decodeMultiplePoses,exports.decodeSinglePose=s.decodeSinglePose,exports.load=n.load,exports.PoseNet=n.PoseNet;
},{"./multiPose/decodeMultiplePoses":37,"./posenet":33,"./singlePose/decodeSinglePose":38,"./checkpoints":34,"./keypoints":35,"./util":36}],14:[function(require,module,exports) {
var define;
var e;!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof e&&e.amd?e(n):t.Stats=n()}(this,function(){var e=function(){function t(e){return i.appendChild(e.dom),e}function n(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";l=e}var l=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(e){e.preventDefault(),n(++l%i.children.length)},!1);var a=(performance||Date).now(),o=a,r=0,f=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:i,addPanel:t,showPanel:n,begin:function(){a=(performance||Date).now()},end:function(){r++;var e=(performance||Date).now();if(c.update(e-a,200),e>o+1e3&&(f.update(1e3*r/(e-o),100),o=e,r=0,d)){var t=performance.memory;d.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:i,setMode:n}};return e.Panel=function(e,t,n){var l=1/0,i=0,a=Math.round,o=a(window.devicePixelRatio||1),r=80*o,f=48*o,c=3*o,d=2*o,p=3*o,u=15*o,s=74*o,m=30*o,h=document.createElement("canvas");h.width=r,h.height=f,h.style.cssText="width:80px;height:48px";var v=h.getContext("2d");return v.font="bold "+9*o+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,r,f),v.fillStyle=t,v.fillText(e,c,d),v.fillRect(p,u,s,m),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(p,u,s,m),{dom:h,update:function(f,y){l=Math.min(l,f),i=Math.max(i,f),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,r,u),v.fillStyle=t,v.fillText(a(f)+" "+e+" ("+a(l)+"-"+a(i)+")",c,d),v.drawImage(h,p+o,u,s-o,m,p,u,s-o,m),v.fillRect(p+s-o,u,o,m),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(p+s-o,u,o,a((1-f/y)*m))}}},e});
},{}],10:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawPoint=f,exports.drawSegment=l,exports.drawSkeleton=c,exports.drawKeypoints=u,exports.drawBoundingBox=d,exports.renderToCanvas=p,exports.renderImageToCanvas=g,exports.drawHeatMapValues=x,exports.drawOffsetVectors=w;var t=require("@tensorflow/tfjs"),e=r(t),n=require("@tensorflow-models/posenet"),o=r(n);function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}const a="white",i=2;function s({y:t,x:e}){return[t,e]}function f(t,e,n,o,r){t.beginPath(),t.arc(n,e,o,0,2*Math.PI),t.fillStyle=r,t.fill()}function l([t,e],[n,o],r,a,s){s.beginPath(),s.moveTo(e*a,t*a),s.lineTo(o*a,n*a),s.lineWidth=i,s.strokeStyle=r,s.stroke()}function c(t,e,n,r=1){o.getAdjacentKeyPoints(t,e).forEach(t=>{l(s(t[0].position),s(t[1].position),a,r,n)})}function u(t,e,n,o=1){for(let r=0;r<t.length;r++){const i=t[r];if(i.score<e)continue;const{y:s,x:l}=i.position;f(n,s*o,l*o,3,a)}}function d(t,e){const n=o.getBoundingBox(t);e.rect(n.minX,n.minY,n.maxX-n.minX,n.maxY-n.minY),e.stroke()}async function p(t,e){const[n,o]=t.shape,r=new ImageData(o,n),a=await t.data();for(let t=0;t<n*o;++t){const e=4*t,n=3*t;r.data[e+0]=a[n+0],r.data[e+1]=a[n+1],r.data[e+2]=a[n+2],r.data[e+3]=255}e.putImageData(r,0,0)}function g(t,e,n){n.width=e[0],n.height=e[1],n.getContext("2d").drawImage(t,0,0)}function x(t,n,o){h(o.getContext("2d"),t.mul(e.scalar(n,"int32")),5,a)}function h(t,e,n,o){const r=e.buffer().values;for(let e=0;e<r.length;e+=2){const a=r[e],i=r[e+1];0!==i&&0!==a&&(t.beginPath(),t.arc(i,a,n,0,2*Math.PI),t.fillStyle=o,t.fill())}}function w(t,e,n,r=1,i){const s=o.singlePose.getOffsetPoints(t,n,e),f=t.buffer().values,c=s.buffer().values;for(let t=0;t<f.length;t+=2){l([f[t]*n,f[t+1]*n],[c[t],c[t+1]],a,r,i)}}
},{"@tensorflow/tfjs":24,"@tensorflow-models/posenet":15}],25:[function(require,module,exports) {
"use strict";function t(){}Object.defineProperty(exports,"__esModule",{value:!0}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),Object.assign(t.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var r=this._listeners[t];if(void 0!==r){var n=r.indexOf(e);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var r=e.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,t)}}}});var e="93",r={LEFT:0,MIDDLE:1,RIGHT:2},n=0,i=1,o=2,a=3,s=0,c=1,h=0,l=1,u=2,p=0,d=1,f=2,m=1,g=2,v=0,y=1,x=2,b=0,_=1,w=2,M=3,E=4,T=5,S=100,A=101,R=102,L=103,P=104,C=200,O=201,I=202,N=203,D=204,U=205,B=206,F=207,z=208,G=209,H=210,V=0,k=1,j=2,W=3,X=4,q=5,Y=6,Z=7,J=0,Q=1,K=2,$=0,tt=1,et=2,rt=3,nt=4,it=300,ot=301,at=302,st=303,ct=304,ht=305,lt=306,ut=307,pt=1e3,dt=1001,ft=1002,mt=1003,gt=1004,vt=1005,yt=1006,xt=1007,bt=1008,_t=1009,wt=1010,Mt=1011,Et=1012,Tt=1013,St=1014,At=1015,Rt=1016,Lt=1017,Pt=1018,Ct=1019,Ot=1020,It=1021,Nt=1022,Dt=1023,Ut=1024,Bt=1025,Ft=Dt,zt=1026,Gt=1027,Ht=33776,Vt=33777,kt=33778,jt=33779,Wt=35840,Xt=35841,qt=35842,Yt=35843,Zt=36196,Jt=37808,Qt=37809,Kt=37810,$t=37811,te=37812,ee=37813,re=37814,ne=37815,ie=37816,oe=37817,ae=37818,se=37819,ce=37820,he=37821,le=2200,ue=2201,pe=2202,de=2300,fe=2301,me=2302,ge=2400,ve=2401,ye=2402,xe=0,be=1,_e=2,we=3e3,Me=3001,Ee=3007,Te=3002,Se=3003,Ae=3004,Re=3005,Le=3006,Pe=3200,Ce=3201,Oe={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&r]+t[r>>8&255]+"-"+t[r>>16&15|64]+t[r>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]).toUpperCase()}}(),clamp:function(t,e,r){return Math.max(e,Math.min(r,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},lerp:function(t,e,r){return(1-r)*t+r*e},smoothstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*(3-2*t)},smootherstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Oe.DEG2RAD},radToDeg:function(t){return t*Oe.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Ie(t,e){this.x=t||0,this.y=e||0}function Ne(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function De(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==n?n:1}function Ue(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}function Be(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ie.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Ie.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,r=this.y,n=t.elements;return this.x=n[0]*e+n[3]*r+n[6],this.y=n[1]*e+n[4]*r+n[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new Ie,e=new Ie;return function(r,n){return t.set(r,r),e.set(n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y;return e*e+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var r=Math.cos(e),n=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*r-o*n+t.x,this.y=i*n+o*r+t.y,this}}),Object.assign(Ne.prototype,{isMatrix4:!0,set:function(t,e,r,n,i,o,a,s,c,h,l,u,p,d,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=h,g[10]=l,g[14]=u,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ne).fromArray(this.elements)},copy:function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this},copyPosition:function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this},extractBasis:function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},extractRotation:function(){var t=new Ue;return function(e){var r=this.elements,n=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=0,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,r=t.x,n=t.y,i=t.z,o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),c=Math.sin(n),h=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){var u=o*h,p=o*l,d=a*h,f=a*l;e[0]=s*h,e[4]=-s*l,e[8]=c,e[1]=p+d*c,e[5]=u-f*c,e[9]=-a*s,e[2]=f-u*c,e[6]=d+p*c,e[10]=o*s}else if("YXZ"===t.order){var m=s*h,g=s*l,v=c*h,y=c*l;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*c,e[1]=o*l,e[5]=o*h,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*h,g=s*l,v=c*h,y=c*l;e[0]=m-y*a,e[4]=-o*l,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*h,e[9]=y-m*a,e[2]=-o*c,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){u=o*h,p=o*l,d=a*h,f=a*l;e[0]=s*h,e[4]=d*c-p,e[8]=u*c+f,e[1]=s*l,e[5]=f*c+u,e[9]=p*c-d,e[2]=-c,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var x=o*s,b=o*c,_=a*s,w=a*c;e[0]=s*h,e[4]=w-x*l,e[8]=_*l+b,e[1]=l,e[5]=o*h,e[9]=-a*h,e[2]=-c*h,e[6]=b*l+_,e[10]=x-w*l}else if("XZY"===t.order){x=o*s,b=o*c,_=a*s,w=a*c;e[0]=s*h,e[4]=-l,e[8]=c*h,e[1]=x*l+w,e[5]=o*h,e[9]=b*l-_,e[2]=_*l-b,e[6]=a*h,e[10]=w*l+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(){var t=new Ue(0,0,0),e=new Ue(1,1,1);return function(r){return this.compose(t,r,e)}}(),lookAt:function(){var t=new Ue,e=new Ue,r=new Ue;return function(n,i,o){var a=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),t.crossVectors(o,r),0===t.lengthSq()&&(1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),t.crossVectors(o,r)),t.normalize(),e.crossVectors(r,t),a[0]=t.x,a[4]=e.x,a[8]=r.x,a[1]=t.y,a[5]=e.y,a[9]=r.y,a[2]=t.z,a[6]=e.z,a[10]=r.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],a=r[4],s=r[8],c=r[12],h=r[1],l=r[5],u=r[9],p=r[13],d=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],x=r[11],b=r[15],_=n[0],w=n[4],M=n[8],E=n[12],T=n[1],S=n[5],A=n[9],R=n[13],L=n[2],P=n[6],C=n[10],O=n[14],I=n[3],N=n[7],D=n[11],U=n[15];return i[0]=o*_+a*T+s*L+c*I,i[4]=o*w+a*S+s*P+c*N,i[8]=o*M+a*A+s*C+c*D,i[12]=o*E+a*R+s*O+c*U,i[1]=h*_+l*T+u*L+p*I,i[5]=h*w+l*S+u*P+p*N,i[9]=h*M+l*A+u*C+p*D,i[13]=h*E+l*R+u*O+p*U,i[2]=d*_+f*T+m*L+g*I,i[6]=d*w+f*S+m*P+g*N,i[10]=d*M+f*A+m*C+g*D,i[14]=d*E+f*R+m*O+g*U,i[3]=v*_+y*T+x*L+b*I,i[7]=v*w+y*S+x*P+b*N,i[11]=v*M+y*A+x*C+b*D,i[15]=v*E+y*R+x*O+b*U,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new Ue;return function(e){for(var r=0,n=e.count;r<n;r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix4(this),e.setXYZ(r,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],o=t[1],a=t[5],s=t[9],c=t[13],h=t[2],l=t[6],u=t[10],p=t[14];return t[3]*(+i*s*l-n*c*l-i*a*u+r*c*u+n*a*p-r*s*p)+t[7]*(+e*s*p-e*c*u+i*o*u-n*o*p+n*c*h-i*s*h)+t[11]*(+e*c*l-e*a*p-i*o*l+r*o*p+i*a*h-r*c*h)+t[15]*(-n*a*h-e*s*l+e*a*u+n*o*l-r*o*u+r*s*h)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var r=this.elements,n=t.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],h=n[5],l=n[6],u=n[7],p=n[8],d=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],b=d*y*u-v*f*u+v*l*m-h*y*m-d*l*x+h*f*x,_=g*f*u-p*y*u-g*l*m+c*y*m+p*l*x-c*f*x,w=p*v*u-g*d*u+g*h*m-c*v*m-p*h*x+c*d*x,M=g*d*l-p*v*l-g*h*f+c*v*f+p*h*y-c*d*y,E=i*b+o*_+a*w+s*M;if(0===E){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(T);return console.warn(T),this.identity()}var S=1/E;return r[0]=b*S,r[1]=(v*f*s-d*y*s-v*a*m+o*y*m+d*a*x-o*f*x)*S,r[2]=(h*y*s-v*l*s+v*a*u-o*y*u-h*a*x+o*l*x)*S,r[3]=(d*l*s-h*f*s-d*a*u+o*f*u+h*a*m-o*l*m)*S,r[4]=_*S,r[5]=(p*y*s-g*f*s+g*a*m-i*y*m-p*a*x+i*f*x)*S,r[6]=(g*l*s-c*y*s-g*a*u+i*y*u+c*a*x-i*l*x)*S,r[7]=(c*f*s-p*l*s+p*a*u-i*f*u-c*a*m+i*l*m)*S,r[8]=w*S,r[9]=(g*d*s-p*v*s-g*o*m+i*v*m+p*o*x-i*d*x)*S,r[10]=(c*v*s-g*h*s+g*o*u-i*v*u-c*o*x+i*h*x)*S,r[11]=(p*h*s-c*d*s-p*o*u+i*d*u+c*o*m-i*h*m)*S,r[12]=M*S,r[13]=(p*v*a-g*d*a+g*o*f-i*v*f-p*o*y+i*d*y)*S,r[14]=(g*h*a-c*v*a-g*o*l+i*v*l+c*o*y-i*h*y)*S,r[15]=(c*d*a-p*h*a+p*o*l-i*d*l-c*o*f+i*h*f)*S,this},scale:function(t){var e=this.elements,r=t.x,n=t.y,i=t.z;return e[0]*=r,e[4]*=n,e[8]*=i,e[1]*=r,e[5]*=n,e[9]*=i,e[2]*=r,e[6]*=n,e[10]*=i,e[3]*=r,e[7]*=n,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,o=t.x,a=t.y,s=t.z,c=i*o,h=i*a;return this.set(c*o+r,c*a-n*s,c*s+n*a,0,c*a+n*s,h*a+r,h*s-n*o,0,c*s-n*a,h*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,r){var n=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,c=i+i,h=o+o,l=a+a,u=i*c,p=i*h,d=i*l,f=o*h,m=o*l,g=a*l,v=s*c,y=s*h,x=s*l,b=r.x,_=r.y,w=r.z;return n[0]=(1-(f+g))*b,n[1]=(p+x)*b,n[2]=(d-y)*b,n[3]=0,n[4]=(p-x)*_,n[5]=(1-(u+g))*_,n[6]=(m+v)*_,n[7]=0,n[8]=(d+y)*w,n[9]=(m-v)*w,n[10]=(1-(u+f))*w,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},decompose:function(){var t=new Ue,e=new Ne;return function(r,n,i){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),c=t.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],e.copy(this);var h=1/a,l=1/s,u=1/c;return e.elements[0]*=h,e.elements[1]*=h,e.elements[2]*=h,e.elements[4]*=l,e.elements[5]*=l,e.elements[6]*=l,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,n.setFromRotationMatrix(e),i.x=a,i.y=s,i.z=c,this}}(),makePerspective:function(t,e,r,n,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),c=2*i/(r-n),h=(e+t)/(e-t),l=(r+n)/(r-n),u=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,r,n,i,o){var a=this.elements,s=1/(e-t),c=1/(r-n),h=1/(o-i),l=(e+t)*s,u=(r+n)*c,p=(o+i)*h;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,r=t.elements,n=0;n<16;n++)if(e[n]!==r[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<16;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}),Object.assign(De,{slerp:function(t,e,r,n){return r.copy(t).slerp(e,n)},slerpFlat:function(t,e,r,n,i,o,a){var s=r[n+0],c=r[n+1],h=r[n+2],l=r[n+3],u=i[o+0],p=i[o+1],d=i[o+2],f=i[o+3];if(l!==f||s!==u||c!==p||h!==d){var m=1-a,g=s*u+c*p+h*d+l*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),b=Math.atan2(x,g*v);m=Math.sin(m*b)/x,a=Math.sin(a*b)/x}var _=a*v;if(s=s*m+u*_,c=c*m+p*_,h=h*m+d*_,l=l*m+f*_,m===1-a){var w=1/Math.sqrt(s*s+c*c+h*h+l*l);s*=w,c*=w,h*=w,l*=w}}t[e]=s,t[e+1]=c,t[e+2]=h,t[e+3]=l}}),Object.defineProperties(De.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(De.prototype,{set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=t._x,n=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,c=a(r/2),h=a(n/2),l=a(i/2),u=s(r/2),p=s(n/2),d=s(i/2);return"XYZ"===o?(this._x=u*h*l+c*p*d,this._y=c*p*l-u*h*d,this._z=c*h*d+u*p*l,this._w=c*h*l-u*p*d):"YXZ"===o?(this._x=u*h*l+c*p*d,this._y=c*p*l-u*h*d,this._z=c*h*d-u*p*l,this._w=c*h*l+u*p*d):"ZXY"===o?(this._x=u*h*l-c*p*d,this._y=c*p*l+u*h*d,this._z=c*h*d+u*p*l,this._w=c*h*l-u*p*d):"ZYX"===o?(this._x=u*h*l-c*p*d,this._y=c*p*l+u*h*d,this._z=c*h*d-u*p*l,this._w=c*h*l+u*p*d):"YZX"===o?(this._x=u*h*l+c*p*d,this._y=c*p*l+u*h*d,this._z=c*h*d-u*p*l,this._w=c*h*l-u*p*d):"XZY"===o&&(this._x=u*h*l-c*p*d,this._y=c*p*l-u*h*d,this._z=c*h*d+u*p*l,this._w=c*h*l+u*p*d),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var r=e/2,n=Math.sin(r);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,r=t.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],c=r[9],h=r[2],l=r[6],u=r[10],p=n+s+u;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(l-c)*e,this._y=(o-h)*e,this._z=(a-i)*e):n>s&&n>u?(e=2*Math.sqrt(1+n-s-u),this._w=(l-c)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+h)/e):s>u?(e=2*Math.sqrt(1+s-n-u),this._w=(o-h)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(c+l)/e):(e=2*Math.sqrt(1+u-n-s),this._w=(a-i)/e,this._x=(o+h)/e,this._y=(c+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new Ue;return function(r,n){return void 0===e&&(e=new Ue),(t=r.dot(n)+1)<1e-6?(t=0,Math.abs(r.x)>Math.abs(r.z)?e.set(-r.y,r.x,0):e.set(0,-r.z,r.y)):e.crossVectors(r,n),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var r=t._x,n=t._y,i=t._z,o=t._w,a=e._x,s=e._y,c=e._z,h=e._w;return this._x=r*h+o*a+n*c-i*s,this._y=n*h+o*s+i*a-r*c,this._z=i*h+o*c+r*s-n*a,this._w=o*h-r*a-n*s-i*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*t._w+r*t._x+n*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var c=Math.atan2(s,a),h=Math.sin((1-e)*c)/s,l=Math.sin(e*c)/s;return this._w=o*h+this._w*l,this._x=r*h+this._x*l,this._y=n*h+this._y*l,this._z=i*h+this._z*l,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Ue.prototype,{isVector3:!0,set:function(t,e,r){return this.x=t,this.y=e,this.z=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new De;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new De;return function(e,r){return this.applyQuaternion(t.setFromAxisAngle(e,r))}}(),applyMatrix3:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6]*n,this.y=i[1]*e+i[4]*r+i[7]*n,this.z=i[2]*e+i[5]*r+i[8]*n,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements,o=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*e+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*e+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(t){var e=this.x,r=this.y,n=this.z,i=t.x,o=t.y,a=t.z,s=t.w,c=s*e+o*n-a*r,h=s*r+a*e-i*n,l=s*n+i*r-o*e,u=-i*e-o*r-a*n;return this.x=c*s+u*-i+h*-a-l*-o,this.y=h*s+u*-o+l*-i-c*-a,this.z=l*s+u*-a+c*-o-h*-i,this},project:function(){var t=new Ne;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new Ne;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n,this.y=i[1]*e+i[5]*r+i[9]*n,this.z=i[2]*e+i[6]*r+i[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new Ue,e=new Ue;return function(r,n){return t.set(r,r,r),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var r=t.x,n=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new Ue;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new Ue;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Oe.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return e*e+r*r+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=n,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(Be.prototype,{isMatrix3:!0,set:function(t,e,r,n,i,o,a,s,c){var h=this.elements;return h[0]=t,h[1]=n,h[2]=a,h[3]=e,h[4]=i,h[5]=s,h[6]=r,h[7]=o,h[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new Ue;return function(e){for(var r=0,n=e.count;r<n;r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix3(this),e.setXYZ(r,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],a=r[3],s=r[6],c=r[1],h=r[4],l=r[7],u=r[2],p=r[5],d=r[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],x=n[7],b=n[2],_=n[5],w=n[8];return i[0]=o*f+a*v+s*b,i[3]=o*m+a*y+s*_,i[6]=o*g+a*x+s*w,i[1]=c*f+h*v+l*b,i[4]=c*m+h*y+l*_,i[7]=c*g+h*x+l*w,i[2]=u*f+p*v+d*b,i[5]=u*m+p*y+d*_,i[8]=u*g+p*x+d*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],c=t[7],h=t[8];return e*o*h-e*a*c-r*i*h+r*a*s+n*i*c-n*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=t.elements,n=this.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],h=r[5],l=r[6],u=r[7],p=r[8],d=p*c-h*u,f=h*l-p*s,m=u*s-c*l,g=i*d+o*f+a*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=d*y,n[1]=(a*u-p*o)*y,n[2]=(h*o-a*c)*y,n[3]=f*y,n[4]=(p*i-a*l)*y,n[5]=(a*s-h*i)*y,n[6]=m*y,n[7]=(o*l-u*i)*y,n[8]=(c*i-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,r,n,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(r*s,r*c,-r*(s*o+c*a)+o+t,-n*c,n*s,-n*(-c*o+s*a)+a+e,0,0,1)},scale:function(t,e){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this},rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements,i=n[0],o=n[3],a=n[6],s=n[1],c=n[4],h=n[7];return n[0]=e*i+r*s,n[3]=e*o+r*c,n[6]=e*a+r*h,n[1]=-r*i+e*s,n[4]=-r*o+e*c,n[7]=-r*a+e*h,this},translate:function(t,e){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this},equals:function(t){for(var e=this.elements,r=t.elements,n=0;n<9;n++)if(e[n]!==r[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<9;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}});var Fe=0;function ze(t,e,r,n,i,o,a,s,c,h){Object.defineProperty(this,"id",{value:Fe++}),this.uuid=Oe.generateUUID(),this.name="",this.image=void 0!==t?t:ze.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:ze.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:dt,this.wrapT=void 0!==n?n:dt,this.magFilter=void 0!==i?i:yt,this.minFilter=void 0!==o?o:bt,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Dt,this.type=void 0!==s?s:_t,this.offset=new Ie(0,0),this.repeat=new Ie(1,1),this.center=new Ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Be,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:we,this.version=0,this.onUpdate=null}function Ge(t,e,r,n){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==n?n:1}function He(t,e,r){this.width=t,this.height=e,this.scissor=new Ge(0,0,t,e),this.scissorTest=!1,this.viewport=new Ge(0,0,t,e),void 0===(r=r||{}).minFilter&&(r.minFilter=yt),this.texture=new ze(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.generateMipmaps=void 0===r.generateMipmaps||r.generateMipmaps,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function Ve(t,e,r){He.call(this,t,e,r),this.activeCubeFace=0,this.activeMipMapLevel=0}function ke(t,e,r,n,i,o,a,s,c,h,l,u){ze.call(this,null,o,a,s,c,h,n,i,l,u),this.image={data:t,width:e,height:r},this.magFilter=void 0!==c?c:mt,this.minFilter=void 0!==h?h:mt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function je(t,e){this.min=void 0!==t?t:new Ue(1/0,1/0,1/0),this.max=void 0!==e?e:new Ue(-1/0,-1/0,-1/0)}function We(t,e){this.center=void 0!==t?t:new Ue,this.radius=void 0!==e?e:0}function Xe(t,e){this.normal=void 0!==t?t:new Ue(1,0,0),this.constant=void 0!==e?e:0}function qe(t,e,r,n,i,o){this.planes=[void 0!==t?t:new Xe,void 0!==e?e:new Xe,void 0!==r?r:new Xe,void 0!==n?n:new Xe,void 0!==i?i:new Xe,void 0!==o?o:new Xe]}ze.DEFAULT_IMAGE=void 0,ze.DEFAULT_MAPPING=it,ze.prototype=Object.assign(Object.create(t.prototype),{constructor:ze,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Oe.generateUUID()),e||void 0!==t.images[n.uuid]||(t.images[n.uuid]={uuid:n.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var r=e.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(n)}),r.image=n.uuid}return e||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===it){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case pt:t.x=t.x-Math.floor(t.x);break;case dt:t.x=t.x<0?0:1;break;case ft:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case pt:t.y=t.y-Math.floor(t.y);break;case dt:t.y=t.y<0?0:1;break;case ft:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(ze.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ge.prototype,{isVector4:!0,set:function(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*e+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*e+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*e+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,r,n,i,o=t.elements,a=o[0],s=o[4],c=o[8],h=o[1],l=o[5],u=o[9],p=o[2],d=o[6],f=o[10];if(Math.abs(s-h)<.01&&Math.abs(c-p)<.01&&Math.abs(u-d)<.01){if(Math.abs(s+h)<.1&&Math.abs(c+p)<.1&&Math.abs(u+d)<.1&&Math.abs(a+l+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(l+1)/2,v=(f+1)/2,y=(s+h)/4,x=(c+p)/4,b=(u+d)/4;return m>g&&m>v?m<.01?(r=0,n=.707106781,i=.707106781):(n=y/(r=Math.sqrt(m)),i=x/r):g>v?g<.01?(r=.707106781,n=0,i=.707106781):(r=y/(n=Math.sqrt(g)),i=b/n):v<.01?(r=.707106781,n=.707106781,i=0):(r=x/(i=Math.sqrt(v)),n=b/i),this.set(r,n,i,e),this}var _=Math.sqrt((d-u)*(d-u)+(c-p)*(c-p)+(h-s)*(h-s));return Math.abs(_)<.001&&(_=1),this.x=(d-u)/_,this.y=(c-p)/_,this.z=(h-s)/_,this.w=Math.acos((a+l+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(r,n){return void 0===t&&(t=new Ge,e=new Ge),t.set(r,r,r,r),e.set(n,n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),He.prototype=Object.assign(Object.create(t.prototype),{constructor:He,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ve.prototype=Object.create(He.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isWebGLRenderTargetCube=!0,ke.prototype=Object.create(ze.prototype),ke.prototype.constructor=ke,ke.prototype.isDataTexture=!0,Object.assign(je.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=t.length;s<c;s+=3){var h=t[s],l=t[s+1],u=t[s+2];h<e&&(e=h),l<r&&(r=l),u<n&&(n=u),h>i&&(i=h),l>o&&(o=l),u>a&&(a=u)}return this.min.set(e,r,n),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=t.count;s<c;s++){var h=t.getX(s),l=t.getY(s),u=t.getZ(s);h<e&&(e=h),l<r&&(r=l),u<n&&(n=u),h>i&&(i=h),l>o&&(o=l),u>a&&(a=u)}return this.min.set(e,r,n),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Ue;return function(e,r){var n=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Ue),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Ue),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,r,n=new Ue;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(e=0,r=a.length;e<r;e++)n.copy(a[e]),n.applyMatrix4(i.matrixWorld),t.expandByPoint(n)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(e=0,r=s.count;e<r;e++)n.fromBufferAttribute(s,e).applyMatrix4(i.matrixWorld),t.expandByPoint(n)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Ue),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new Ue;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=t.constant&&r>=t.constant},intersectsTriangle:function(){var t=new Ue,e=new Ue,r=new Ue,n=new Ue,i=new Ue,o=new Ue,a=new Ue,s=new Ue,c=new Ue,h=new Ue;function l(n){var i,o;for(i=0,o=n.length-3;i<=o;i+=3){a.fromArray(n,i);var s=c.x*Math.abs(a.x)+c.y*Math.abs(a.y)+c.z*Math.abs(a.z),h=t.dot(a),l=e.dot(a),u=r.dot(a);if(Math.max(-Math.max(h,l,u),Math.min(h,l,u))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),t.subVectors(a.a,s),e.subVectors(a.b,s),r.subVectors(a.c,s),n.subVectors(e,t),i.subVectors(r,e),o.subVectors(t,r);var u=[0,-n.z,n.y,0,-i.z,i.y,0,-o.z,o.y,n.z,0,-n.x,i.z,0,-i.x,o.z,0,-o.x,-n.y,n.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!l(u)&&(!!l(u=[1,0,0,0,1,0,0,0,1])&&(h.crossVectors(n,i),l(u=[h.x,h.y,h.z])))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Ue),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Ue;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new Ue;return function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new We),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){if(this.isEmpty())return this;var e=t.elements,r=e[0]*this.min.x,n=e[1]*this.min.x,i=e[2]*this.min.x,o=e[0]*this.max.x,a=e[1]*this.max.x,s=e[2]*this.max.x,c=e[4]*this.min.y,h=e[5]*this.min.y,l=e[6]*this.min.y,u=e[4]*this.max.y,p=e[5]*this.max.y,d=e[6]*this.max.y,f=e[8]*this.min.z,m=e[9]*this.min.z,g=e[10]*this.min.z,v=e[8]*this.max.z,y=e[9]*this.max.z,x=e[10]*this.max.z;return this.min.x=Math.min(r,o)+Math.min(c,u)+Math.min(f,v)+e[12],this.min.y=Math.min(n,a)+Math.min(h,p)+Math.min(m,y)+e[13],this.min.z=Math.min(i,s)+Math.min(l,d)+Math.min(g,x)+e[14],this.max.x=Math.max(r,o)+Math.max(c,u)+Math.max(f,v)+e[12],this.max.y=Math.max(n,a)+Math.max(h,p)+Math.max(m,y)+e[13],this.max.z=Math.max(i,s)+Math.max(l,d)+Math.max(g,x)+e[14],this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(We.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new je;return function(e,r){var n=this.center;void 0!==r?n.copy(r):t.setFromPoints(e).getCenter(n);for(var i=0,o=0,a=e.length;o<a;o++)i=Math.max(i,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var r=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Ue),e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new je),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(Xe.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new Ue,e=new Ue;return function(r,n,i){var o=t.subVectors(i,n).cross(e.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Ue),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new Ue;return function(e,r){void 0===r&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new Ue);var n=e.delta(t),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?r.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:r.copy(n).multiplyScalar(o).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return e<0&&r>0||r<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Ue),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new Ue,e=new Be;return function(r,n){var i=n||e.getNormalMatrix(r),o=this.coplanarPoint(t).applyMatrix4(r),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(qe.prototype,{set:function(t,e,r,n,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,r=0;r<6;r++)e[r].copy(t.planes[r]);return this},setFromMatrix:function(t){var e=this.planes,r=t.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],c=r[5],h=r[6],l=r[7],u=r[8],p=r[9],d=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return e[0].setComponents(a-n,l-s,f-u,y-m).normalize(),e[1].setComponents(a+n,l+s,f+u,y+m).normalize(),e[2].setComponents(a+i,l+c,f+p,y+g).normalize(),e[3].setComponents(a-i,l-c,f-p,y-g).normalize(),e[4].setComponents(a-o,l-h,f-d,y-v).normalize(),e[5].setComponents(a+o,l+h,f+d,y+v).normalize(),this},intersectsObject:function(){var t=new We;return function(e){var r=e.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new We;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,r=t.center,n=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(r)<n)return!1}return!0},intersectsBox:function(){var t=new Ue,e=new Ue;return function(r){for(var n=this.planes,i=0;i<6;i++){var o=n[i];t.x=o.normal.x>0?r.min.x:r.max.x,e.x=o.normal.x>0?r.max.x:r.min.x,t.y=o.normal.y>0?r.min.y:r.max.y,e.y=o.normal.y>0?r.max.y:r.min.y,t.z=o.normal.z>0?r.min.z:r.max.z,e.z=o.normal.z>0?r.max.z:r.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}});var Ye="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",Ze="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",Je="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",Qe="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",Ke="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",$e="\nvec3 transformed = vec3( position );\n",tr="\nvec3 objectNormal = vec3( normal );\n",er="float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",rr="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",nr="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",ir="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",or="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",ar="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",sr="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",cr="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",hr="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",lr="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",ur="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",pr="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",dr="vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",fr="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",mr="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",gr="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",vr="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",yr="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",xr="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",br="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",_r="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",wr="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",Mr="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",Er="\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",Tr="#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",Sr="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",Ar="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",Rr="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",Lr="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",Pr="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Cr="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",Or="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",Ir="#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",Nr="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",Dr="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",Ur="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",Br="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",Fr="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",zr="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",Gr="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",Hr="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Vr="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",kr="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",jr="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",Wr="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",Xr="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",qr="#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",Yr="#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",Zr="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",Jr="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",Qr="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",Kr="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",$r="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",tn="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",en="#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",rn="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy *= normalScale;\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",nn="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",on="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",an="vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",sn="#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",cn="#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",hn="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",ln="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",un="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",pn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",dn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",fn="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",mn="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",gn="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",vn="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",yn="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",xn="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",bn="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",_n="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",wn="#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",Mn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",En="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",Tn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",Sn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",An="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",Rn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",Ln="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",Pn="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",Cn="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",On="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",In="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",Nn="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",Dn="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",Un="uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",Bn="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",Fn="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",zn="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",Gn="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Hn="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",Vn="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",kn="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",jn="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Wn="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Xn="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",qn="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Yn="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",Zn="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",Jn="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Qn="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",Kn="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",$n="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",ti={alphamap_fragment:Ye,alphamap_pars_fragment:Ze,alphatest_fragment:Je,aomap_fragment:Qe,aomap_pars_fragment:Ke,begin_vertex:$e,beginnormal_vertex:tr,bsdfs:er,bumpmap_pars_fragment:rr,clipping_planes_fragment:nr,clipping_planes_pars_fragment:ir,clipping_planes_pars_vertex:or,clipping_planes_vertex:ar,color_fragment:sr,color_pars_fragment:cr,color_pars_vertex:hr,color_vertex:lr,common:ur,cube_uv_reflection_fragment:pr,defaultnormal_vertex:dr,displacementmap_pars_vertex:fr,displacementmap_vertex:mr,emissivemap_fragment:gr,emissivemap_pars_fragment:vr,encodings_fragment:yr,encodings_pars_fragment:xr,envmap_fragment:br,envmap_pars_fragment:_r,envmap_pars_vertex:wr,envmap_vertex:Mr,fog_vertex:Er,fog_pars_vertex:Tr,fog_fragment:Sr,fog_pars_fragment:Ar,gradientmap_pars_fragment:Rr,lightmap_fragment:Lr,lightmap_pars_fragment:Pr,lights_lambert_vertex:Cr,lights_pars_begin:Or,lights_pars_maps:Ir,lights_phong_fragment:Nr,lights_phong_pars_fragment:Dr,lights_physical_fragment:Ur,lights_physical_pars_fragment:Br,lights_fragment_begin:Fr,lights_fragment_maps:zr,lights_fragment_end:Gr,logdepthbuf_fragment:Hr,logdepthbuf_pars_fragment:Vr,logdepthbuf_pars_vertex:kr,logdepthbuf_vertex:jr,map_fragment:Wr,map_pars_fragment:Xr,map_particle_fragment:qr,map_particle_pars_fragment:Yr,metalnessmap_fragment:Zr,metalnessmap_pars_fragment:Jr,morphnormal_vertex:Qr,morphtarget_pars_vertex:Kr,morphtarget_vertex:$r,normal_fragment_begin:tn,normal_fragment_maps:en,normalmap_pars_fragment:rn,packing:nn,premultiplied_alpha_fragment:on,project_vertex:an,dithering_fragment:sn,dithering_pars_fragment:cn,roughnessmap_fragment:hn,roughnessmap_pars_fragment:ln,shadowmap_pars_fragment:un,shadowmap_pars_vertex:pn,shadowmap_vertex:dn,shadowmask_pars_fragment:fn,skinbase_vertex:mn,skinning_pars_vertex:gn,skinning_vertex:vn,skinnormal_vertex:yn,specularmap_fragment:xn,specularmap_pars_fragment:bn,tonemapping_fragment:_n,tonemapping_pars_fragment:wn,uv_pars_fragment:Mn,uv_pars_vertex:En,uv_vertex:Tn,uv2_pars_fragment:Sn,uv2_pars_vertex:An,uv2_vertex:Rn,worldpos_vertex:Ln,cube_frag:Pn,cube_vert:Cn,depth_frag:On,depth_vert:In,distanceRGBA_frag:Nn,distanceRGBA_vert:Dn,equirect_frag:Un,equirect_vert:Bn,linedashed_frag:Fn,linedashed_vert:zn,meshbasic_frag:Gn,meshbasic_vert:Hn,meshlambert_frag:Vn,meshlambert_vert:kn,meshphong_frag:jn,meshphong_vert:Wn,meshphysical_frag:Xn,meshphysical_vert:qn,normal_frag:Yn,normal_vert:Zn,points_frag:Jn,points_vert:Qn,shadow_frag:Kn,shadow_vert:$n},ei={merge:function(t){for(var e={},r=0;r<t.length;r++){var n=this.clone(t[r]);for(var i in n)e[i]=n[i]}return e},clone:function(t){var e={};for(var r in t)for(var n in e[r]={},t[r]){var i=t[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[r][n]=i.clone():Array.isArray(i)?e[r][n]=i.slice():e[r][n]=i}return e}},ri={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ni(t,e,r){return void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}Object.assign(ni.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,r){return this.r=t,this.g=e,this.b=r,this},setHSL:function(){function t(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}return function(e,r,n){if(e=Oe.euclideanModulo(e,1),r=Oe.clamp(r,0,1),n=Oe.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,o=2*n-i;this.r=t(o,i,e+1/3),this.g=t(o,i,e),this.b=t(o,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(a,s,c)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(t)){var h,l=(h=r[1]).length;if(3===l)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}t&&t.length>0&&(void 0!==(h=ri[t])?this.setHex(h):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var r=e>0?1/e:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,r,n=this.r,i=this.g,o=this.b,a=Math.max(n,i,o),s=Math.min(n,i,o),c=(s+a)/2;if(s===a)e=0,r=0;else{var h=a-s;switch(r=c<=.5?h/(a+s):h/(2-a-s),a){case n:e=(i-o)/h+(i<o?6:0);break;case i:e=(o-n)/h+2;break;case o:e=(n-i)/h+4}e/=6}return t.h=e,t.s=r,t.l=c,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var t={};return function(e,r,n){return this.getHSL(t),t.h+=e,t.s+=r,t.l+=n,this.setHSL(t.h,t.s,t.l),this}}(),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var ii={common:{diffuse:{value:new ni(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Be},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ni(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ni(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Be}}},oi={basic:{uniforms:ei.merge([ii.common,ii.specularmap,ii.envmap,ii.aomap,ii.lightmap,ii.fog]),vertexShader:ti.meshbasic_vert,fragmentShader:ti.meshbasic_frag},lambert:{uniforms:ei.merge([ii.common,ii.specularmap,ii.envmap,ii.aomap,ii.lightmap,ii.emissivemap,ii.fog,ii.lights,{emissive:{value:new ni(0)}}]),vertexShader:ti.meshlambert_vert,fragmentShader:ti.meshlambert_frag},phong:{uniforms:ei.merge([ii.common,ii.specularmap,ii.envmap,ii.aomap,ii.lightmap,ii.emissivemap,ii.bumpmap,ii.normalmap,ii.displacementmap,ii.gradientmap,ii.fog,ii.lights,{emissive:{value:new ni(0)},specular:{value:new ni(1118481)},shininess:{value:30}}]),vertexShader:ti.meshphong_vert,fragmentShader:ti.meshphong_frag},standard:{uniforms:ei.merge([ii.common,ii.envmap,ii.aomap,ii.lightmap,ii.emissivemap,ii.bumpmap,ii.normalmap,ii.displacementmap,ii.roughnessmap,ii.metalnessmap,ii.fog,ii.lights,{emissive:{value:new ni(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ti.meshphysical_vert,fragmentShader:ti.meshphysical_frag},points:{uniforms:ei.merge([ii.points,ii.fog]),vertexShader:ti.points_vert,fragmentShader:ti.points_frag},dashed:{uniforms:ei.merge([ii.common,ii.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ti.linedashed_vert,fragmentShader:ti.linedashed_frag},depth:{uniforms:ei.merge([ii.common,ii.displacementmap]),vertexShader:ti.depth_vert,fragmentShader:ti.depth_frag},normal:{uniforms:ei.merge([ii.common,ii.bumpmap,ii.normalmap,ii.displacementmap,{opacity:{value:1}}]),vertexShader:ti.normal_vert,fragmentShader:ti.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ti.cube_vert,fragmentShader:ti.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ti.equirect_vert,fragmentShader:ti.equirect_frag},distanceRGBA:{uniforms:ei.merge([ii.common,ii.displacementmap,{referencePosition:{value:new Ue},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ti.distanceRGBA_vert,fragmentShader:ti.distanceRGBA_frag},shadow:{uniforms:ei.merge([ii.lights,ii.fog,{color:{value:new ni(0)},opacity:{value:1}}]),vertexShader:ti.shadow_vert,fragmentShader:ti.shadow_frag}};function ai(){var t=null,e=!1,r=null;function n(i,o){!1!==e&&(r(i,o),t.requestAnimationFrame(n))}return{start:function(){!0!==e&&null!==r&&(t.requestAnimationFrame(n),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){r=t},setContext:function(e){t=e}}}function si(t){var e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);var n=e.get(r);n&&(t.deleteBuffer(n.buffer),e.delete(r))},update:function(r,n){r.isInterleavedBufferAttribute&&(r=r.data);var i=e.get(r);void 0===i?e.set(r,function(e,r){var n=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(r,o),t.bufferData(r,n,i),e.onUploadCallback();var a=t.FLOAT;return n instanceof Float32Array?a=t.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=t.UNSIGNED_SHORT:n instanceof Int16Array?a=t.SHORT:n instanceof Uint32Array?a=t.UNSIGNED_INT:n instanceof Int32Array?a=t.INT:n instanceof Int8Array?a=t.BYTE:n instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}(r,n)):i.version<r.version&&(function(e,r,n){var i=r.array,o=r.updateRange;t.bindBuffer(n,e),!1===r.dynamic?t.bufferData(n,i,t.STATIC_DRAW):-1===o.count?t.bufferSubData(n,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,r,n),i.version=r.version)}}}function ci(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._order=n||ci.DefaultOrder}function hi(){this.mask=1}oi.physical={uniforms:ei.merge([oi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:ti.meshphysical_vert,fragmentShader:ti.meshphysical_frag},ci.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ci.DefaultOrder="XYZ",Object.defineProperties(ci.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(ci.prototype,{isEuler:!0,set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,r){var n=Oe.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],c=i[1],h=i[5],l=i[9],u=i[2],p=i[6],d=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-u,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===e?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(p,d),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,h))):"YZX"===e?(this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,h),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new Ne;return function(e,r,n){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,r,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new De;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Ue(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(hi.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var li=0;function ui(){Object.defineProperty(this,"id",{value:li++}),this.uuid=Oe.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ui.DefaultUp.clone();var t=new Ue,e=new ci,r=new De,n=new Ue(1,1,1);e.onChange(function(){r.setFromEuler(e,!1)}),r.onChange(function(){e.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new Ne},normalMatrix:{value:new Be}}),this.matrix=new Ne,this.matrixWorld=new Ne,this.matrixAutoUpdate=ui.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hi,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function pi(){ui.call(this),this.type="Camera",this.matrixWorldInverse=new Ne,this.projectionMatrix=new Ne}function di(t,e,r,n,i,o){pi.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function fi(t,e,r,n,i,o){this.a=t,this.b=e,this.c=r,this.normal=n&&n.isVector3?n:new Ue,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new ni,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}ui.DefaultUp=new Ue(0,1,0),ui.DefaultMatrixAutoUpdate=!0,ui.prototype=Object.assign(Object.create(t.prototype),{constructor:ui,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new De;return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new De;return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new Ue(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new Ue(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new Ue(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new Ue;return function(e,r){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(r)),this}}(),translateX:function(){var t=new Ue(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new Ue(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new Ue(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new Ne;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new Ne,e=new Ue;return function(r,n,i){r.isVector3?e.copy(r):e.set(r,n,i),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var r=this.children.indexOf(t);return-1!==r&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Ue),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new Ue,e=new Ue;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new De),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,r,e),r}}(),getWorldScale:function(){var t=new Ue,e=new De;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new Ue),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,r),r}}(),getWorldDirection:function(){var t=new De;return function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Ue),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||"string"==typeof t,r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function i(e,r){return void 0===e[r.uuid]&&(e[r.uuid]=r.toJSON(t)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),void 0!==this.geometry){n.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var h=a[s];i(t.shapes,h)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(i(t.materials,this.material[s]));n.material=l}else n.material=i(t.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(t).object)}if(e){var u=m(t.geometries),p=m(t.materials),d=m(t.textures),f=m(t.images);a=m(t.shapes);u.length>0&&(r.geometries=u),p.length>0&&(r.materials=p),d.length>0&&(r.textures=d),f.length>0&&(r.images=f),a.length>0&&(r.shapes=a)}return r.object=n,r;function m(t){var e=[];for(var r in t){var n=t[r];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var r=0;r<t.children.length;r++){var n=t.children[r];this.add(n.clone())}return this}}),pi.prototype=Object.assign(Object.create(ui.prototype),{constructor:pi,isCamera:!0,copy:function(t,e){return ui.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new De;return function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Ue),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){ui.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),di.prototype=Object.assign(Object.create(pi.prototype),{constructor:di,isOrthographicCamera:!0,copy:function(t,e){return pi.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,r,n,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-t,o=r+t,a=n+e,s=n-e;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),h=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;o=(i+=l*(this.view.offsetX/c))+l*(this.view.width/c),s=(a-=u*(this.view.offsetY/h))-u*(this.view.height/h)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far)},toJSON:function(t){var e=ui.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(fi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,r=t.vertexNormals.length;e<r;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,r=t.vertexColors.length;e<r;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var mi=0;function gi(){Object.defineProperty(this,"id",{value:mi+=2}),this.uuid=Oe.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function vi(t,e,r){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function yi(t,e,r){vi.call(this,new Int8Array(t),e,r)}function xi(t,e,r){vi.call(this,new Uint8Array(t),e,r)}function bi(t,e,r){vi.call(this,new Uint8ClampedArray(t),e,r)}function _i(t,e,r){vi.call(this,new Int16Array(t),e,r)}function wi(t,e,r){vi.call(this,new Uint16Array(t),e,r)}function Mi(t,e,r){vi.call(this,new Int32Array(t),e,r)}function Ei(t,e,r){vi.call(this,new Uint32Array(t),e,r)}function Ti(t,e,r){vi.call(this,new Float32Array(t),e,r)}function Si(t,e,r){vi.call(this,new Float64Array(t),e,r)}function Ai(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ri(t){if(0===t.length)return-1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]>e&&(e=t[r]);return e}gi.prototype=Object.assign(Object.create(t.prototype),{constructor:gi,isGeometry:!0,applyMatrix:function(t){for(var e=(new Be).getNormalMatrix(t),r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(t)}for(r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new Ne;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ne;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ne;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ne;return function(e,r,n){return t.makeTranslation(e,r,n),this.applyMatrix(t),this}}(),scale:function(){var t=new Ne;return function(e,r,n){return t.makeScale(e,r,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new ui;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var e=this,r=null!==t.index?t.index.array:void 0,n=t.attributes,i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var h=[],l=[],u=[],p=0,d=0;p<i.length;p+=3,d+=2)e.vertices.push(new Ue(i[p],i[p+1],i[p+2])),void 0!==o&&h.push(new Ue(o[p],o[p+1],o[p+2])),void 0!==a&&e.colors.push(new ni(a[p],a[p+1],a[p+2])),void 0!==s&&l.push(new Ie(s[d],s[d+1])),void 0!==c&&u.push(new Ie(c[d],c[d+1]));function f(t,r,n,i){var p=new fi(t,r,n,void 0!==o?[h[t].clone(),h[r].clone(),h[n].clone()]:[],void 0!==a?[e.colors[t].clone(),e.colors[r].clone(),e.colors[n].clone()]:[],i);e.faces.push(p),void 0!==s&&e.faceVertexUvs[0].push([l[t].clone(),l[r].clone(),l[n].clone()]),void 0!==c&&e.faceVertexUvs[1].push([u[t].clone(),u[r].clone(),u[n].clone()])}var m=t.groups;if(m.length>0)for(p=0;p<m.length;p++)for(var g=m[p],v=g.start,y=(d=v,v+g.count);d<y;d+=3)void 0!==r?f(r[d],r[d+1],r[d+2],g.materialIndex):f(d,d+1,d+2,g.materialIndex);else if(void 0!==r)for(p=0;p<r.length;p+=3)f(r[p],r[p+1],r[p+2]);else for(p=0;p<i.length/3;p+=3)f(p,p+1,p+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new Ue;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,r=0===e?1:1/e,n=new Ne;return n.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new Ue,e=new Ue,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,r,n,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,r=this.vertices.length;e<r;e++)a[e]=new Ue;if(t){var s,c,h,l=new Ue,u=new Ue;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s=this.vertices[o.a],c=this.vertices[o.b],h=this.vertices[o.c],l.subVectors(h,c),u.subVectors(s,c),l.cross(u),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,r=this.vertices.length;e<r;e++)a[e].normalize();for(n=0,i=this.faces.length;n<i;n++){var p=(o=this.faces[n]).vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,r;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var n=(r=this.faces[t]).vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new gi;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)c=new Ue,h={a:new Ue,b:new Ue,c:new Ue},a.push(c),s.push(h)}var c,h,l=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],c=l.faceNormals[r],h=l.vertexNormals[r],c.copy(i.normal),h.a.copy(i.vertexNormals[0]),h.b.copy(i.vertexNormals[1]),h.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new je),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new We),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,r){if(t&&t.isGeometry){var n,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,h=this.faceVertexUvs[0],l=t.faceVertexUvs[0],u=this.colors,p=t.colors;void 0===r&&(r=0),void 0!==e&&(n=(new Be).getNormalMatrix(e));for(var d=0,f=a.length;d<f;d++){var m=a[d].clone();void 0!==e&&m.applyMatrix4(e),o.push(m)}for(d=0,f=p.length;d<f;d++)u.push(p[d].clone());for(d=0,f=c.length;d<f;d++){var g,v,y,x=c[d],b=x.vertexNormals,_=x.vertexColors;(g=new fi(x.a+i,x.b+i,x.c+i)).normal.copy(x.normal),void 0!==n&&g.normal.applyMatrix3(n).normalize();for(var w=0,M=b.length;w<M;w++)v=b[w].clone(),void 0!==n&&v.applyMatrix3(n).normalize(),g.vertexNormals.push(v);g.color.copy(x.color);for(w=0,M=_.length;w<M;w++)y=_[w],g.vertexColors.push(y.clone());g.materialIndex=x.materialIndex+r,s.push(g)}for(d=0,f=l.length;d<f;d++){var E=l[d],T=[];if(void 0!==E){for(w=0,M=E.length;w<M;w++)T.push(E[w].clone());h.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,r,n,i,o,a,s,c={},h=[],l=[],u=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)t=this.vertices[r],void 0===c[e=Math.round(t.x*u)+"_"+Math.round(t.y*u)+"_"+Math.round(t.z*u)]?(c[e]=r,h.push(this.vertices[r]),l[r]=h.length-1):l[r]=l[c[e]];var p=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){p.push(r);break}}for(r=p.length-1;r>=0;r--){var f=p[r];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-h.length;return this.vertices=h,m},setFromPoints:function(t){this.vertices=[];for(var e=0,r=t.length;e<r;e++){var n=t[e];this.vertices.push(new Ue(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,r=0;r<e;r++)t[r]._id=r;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(n=[]),a&&a.length===e&&(i=[]);for(r=0;r<e;r++){var s=t[r]._id;n&&n.push(o[s]),i&&i.push(a[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}for(var n=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];n.push(o.x,o.y,o.z)}var a=[],s=[],c={},h=[],l={},u=[],p={};for(i=0;i<this.faces.length;i++){var d=this.faces[i],f=void 0!==this.faceVertexUvs[0][i],m=d.normal.length()>0,g=d.vertexNormals.length>0,v=1!==d.color.r||1!==d.color.g||1!==d.color.b,y=d.vertexColors.length>0,x=0;if(x=M(x,0,0),x=M(x,1,!0),x=M(x,2,!1),x=M(x,3,f),x=M(x,4,m),x=M(x,5,g),x=M(x,6,v),x=M(x,7,y),a.push(x),a.push(d.a,d.b,d.c),a.push(d.materialIndex),f){var b=this.faceVertexUvs[0][i];a.push(S(b[0]),S(b[1]),S(b[2]))}if(m&&a.push(E(d.normal)),g){var _=d.vertexNormals;a.push(E(_[0]),E(_[1]),E(_[2]))}if(v&&a.push(T(d.color)),y){var w=d.vertexColors;a.push(T(w[0]),T(w[1]),T(w[2]))}}function M(t,e,r){return r?t|1<<e:t&~(1<<e)}function E(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=s.length/3,s.push(t.x,t.y,t.z),c[e])}function T(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]?l[e]:(l[e]=h.length,h.push(t.getHex()),l[e])}function S(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=u.length/2,u.push(t.x,t.y),p[e])}return t.data={},t.data.vertices=n,t.data.normals=s,h.length>0&&(t.data.colors=h),u.length>0&&(t.data.uvs=[u]),t.data.faces=a,t},clone:function(){return(new gi).copy(this)},copy:function(t){var e,r,n,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,r=s.length;e<r;e++)this.vertices.push(s[e].clone());var c=t.colors;for(e=0,r=c.length;e<r;e++)this.colors.push(c[e].clone());var h=t.faces;for(e=0,r=h.length;e<r;e++)this.faces.push(h[e].clone());for(e=0,r=t.faceVertexUvs.length;e<r;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),n=0,i=l.length;n<i;n++){var u=l[n],p=[];for(o=0,a=u.length;o<a;o++){var d=u[o];p.push(d.clone())}this.faceVertexUvs[e].push(p)}}var f=t.morphTargets;for(e=0,r=f.length;e<r;e++){var m={};if(m.name=f[e].name,void 0!==f[e].vertices)for(m.vertices=[],n=0,i=f[e].vertices.length;n<i;n++)m.vertices.push(f[e].vertices[n].clone());if(void 0!==f[e].normals)for(m.normals=[],n=0,i=f[e].normals.length;n<i;n++)m.normals.push(f[e].normals[n].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,r=g.length;e<r;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],n=0,i=g[e].vertexNormals.length;n<i;n++){var y=g[e].vertexNormals[n],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),v.vertexNormals.push(x)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],n=0,i=g[e].faceNormals.length;n<i;n++)v.faceNormals.push(g[e].faceNormals[n].clone());this.morphNormals.push(v)}var b=t.skinWeights;for(e=0,r=b.length;e<r;e++)this.skinWeights.push(b[e].clone());var _=t.skinIndices;for(e=0,r=_.length;e<r;e++)this.skinIndices.push(_[e].clone());var w=t.lineDistances;for(e=0,r=w.length;e<r;e++)this.lineDistances.push(w[e]);var M=t.boundingBox;null!==M&&(this.boundingBox=M.clone());var E=t.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(vi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(vi.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.itemSize:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new ni),e[r++]=o.r,e[r++]=o.g,e[r++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new Ie),e[r++]=o.x,e[r++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new Ue),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Ge),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z,e[r++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),yi.prototype=Object.create(vi.prototype),yi.prototype.constructor=yi,xi.prototype=Object.create(vi.prototype),xi.prototype.constructor=xi,bi.prototype=Object.create(vi.prototype),bi.prototype.constructor=bi,_i.prototype=Object.create(vi.prototype),_i.prototype.constructor=_i,wi.prototype=Object.create(vi.prototype),wi.prototype.constructor=wi,Mi.prototype=Object.create(vi.prototype),Mi.prototype.constructor=Mi,Ei.prototype=Object.create(vi.prototype),Ei.prototype.constructor=Ei,Ti.prototype=Object.create(vi.prototype),Ti.prototype.constructor=Ti,Si.prototype=Object.create(vi.prototype),Si.prototype.constructor=Si,Object.assign(Ai.prototype,{computeGroups:function(t){for(var e,r=[],n=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,r.push(e)),e={start:3*o,materialIndex:n})}void 0!==e&&(e.count=3*o-e.start,r.push(e)),this.groups=r},fromGeometry:function(t){var e,r=t.faces,n=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var h=0;h<c;h++)e[h]=[];this.morphTargets.position=e}var l,u=t.morphNormals,p=u.length;if(p>0){l=[];for(h=0;h<p;h++)l[h]=[];this.morphTargets.normal=l}var d=t.skinIndices,f=t.skinWeights,m=d.length===n.length,g=f.length===n.length;0===r.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(h=0;h<r.length;h++){var v=r[h];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var x=v.normal;this.normals.push(x,x,x)}var b,_=v.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(b=i[0][h])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",h),this.uvs.push(new Ie,new Ie,new Ie));if(!0===a)void 0!==(b=i[1][h])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",h),this.uvs2.push(new Ie,new Ie,new Ie));for(var M=0;M<c;M++){var E=s[M].vertices;e[M].push(E[v.a],E[v.b],E[v.c])}for(M=0;M<p;M++){var T=u[M].vertexNormals[h];l[M].push(T.a,T.b,T.c)}m&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Li=1;function Pi(){Object.defineProperty(this,"id",{value:Li+=2}),this.uuid=Oe.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Ci(t,e,r,n,i,o){gi.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Oi(t,e,r,n,i,o)),this.mergeVertices()}function Oi(t,e,r,n,i,o){Pi.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};var a=this;t=t||1,e=e||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],c=[],h=[],l=[],u=0,p=0;function d(t,e,r,n,i,o,d,f,m,g,v){var y,x,b=o/m,_=d/g,w=o/2,M=d/2,E=f/2,T=m+1,S=g+1,A=0,R=0,L=new Ue;for(x=0;x<S;x++){var P=x*_-M;for(y=0;y<T;y++){var C=y*b-w;L[t]=C*n,L[e]=P*i,L[r]=E,c.push(L.x,L.y,L.z),L[t]=0,L[e]=0,L[r]=f>0?1:-1,h.push(L.x,L.y,L.z),l.push(y/m),l.push(1-x/g),A+=1}}for(x=0;x<g;x++)for(y=0;y<m;y++){var O=u+y+T*x,I=u+y+T*(x+1),N=u+(y+1)+T*(x+1),D=u+(y+1)+T*x;s.push(O,I,D),s.push(I,N,D),R+=6}a.addGroup(p,R,v),p+=R,u+=A}d("z","y","x",-1,-1,r,e,t,o,i,0),d("z","y","x",1,-1,r,e,-t,o,i,1),d("x","z","y",1,1,t,r,e,n,o,2),d("x","z","y",1,-1,t,r,-e,n,o,3),d("x","y","z",1,-1,t,e,r,n,i,4),d("x","y","z",-1,-1,t,e,-r,n,i,5),this.setIndex(s),this.addAttribute("position",new Ti(c,3)),this.addAttribute("normal",new Ti(h,3)),this.addAttribute("uv",new Ti(l,2))}function Ii(t,e,r,n){gi.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Ni(t,e,r,n)),this.mergeVertices()}function Ni(t,e,r,n){Pi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,c=Math.floor(r)||1,h=Math.floor(n)||1,l=c+1,u=h+1,p=t/c,d=e/h,f=[],m=[],g=[],v=[];for(o=0;o<u;o++){var y=o*d-s;for(i=0;i<l;i++){var x=i*p-a;m.push(x,-y,0),g.push(0,0,1),v.push(i/c),v.push(1-o/h)}}for(o=0;o<h;o++)for(i=0;i<c;i++){var b=i+l*o,_=i+l*(o+1),w=i+1+l*(o+1),M=i+1+l*o;f.push(b,_,M),f.push(_,w,M)}this.setIndex(f),this.addAttribute("position",new Ti(m,3)),this.addAttribute("normal",new Ti(g,3)),this.addAttribute("uv",new Ti(v,2))}Pi.prototype=Object.assign(Object.create(t.prototype),{constructor:Pi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Ri(t)>65535?Ei:wi)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new vi(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new Be).getNormalMatrix(t).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new Ne;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ne;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ne;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ne;return function(e,r,n){return t.makeTranslation(e,r,n),this.applyMatrix(t),this}}(),scale:function(){var t=new Ne;return function(e,r,n){return t.makeScale(e,r,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new ui;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new Ue;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var r=new Ti(3*e.vertices.length,3),n=new Ti(3*e.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new Ti(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Ti(e,3)),this},updateFromObject:function(t){var e,r=t.geometry;if(t.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(r.vertices),e.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(r.normals),e.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(r.colors),e.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(r.uvs),e.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(r.lineDistances),e.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Ai).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new vi(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var r=new Float32Array(3*t.normals.length);this.addAttribute("normal",new vi(r,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new vi(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new vi(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new vi(o,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var s=[],c=t.morphTargets[a],h=0,l=c.length;h<l;h++){var u=c[h],p=new Ti(3*u.length,3);s.push(p.copyVector3sArray(u))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var d=new Ti(4*t.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var f=new Ti(4*t.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new je);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new je,e=new Ue;return function(){null===this.boundingSphere&&(this.boundingSphere=new We);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;t.setFromBufferAttribute(r),t.getCenter(n);for(var i=0,o=0,a=r.count;o<a;o++)e.x=r.getX(o),e.y=r.getY(o),e.z=r.getZ(o),i=Math.max(i,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,r=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new vi(new Float32Array(n.length),3));else for(var i=e.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var s,c,h,l=e.normal.array,u=new Ue,p=new Ue,d=new Ue,f=new Ue,m=new Ue;if(t){var g=t.array;0===r.length&&this.addGroup(0,g.length);for(var v=0,y=r.length;v<y;++v){var x=r[v],b=x.start;for(o=b,a=b+x.count;o<a;o+=3)s=3*g[o+0],c=3*g[o+1],h=3*g[o+2],u.fromArray(n,s),p.fromArray(n,c),d.fromArray(n,h),f.subVectors(d,p),m.subVectors(u,p),f.cross(m),l[s]+=f.x,l[s+1]+=f.y,l[s+2]+=f.z,l[c]+=f.x,l[c+1]+=f.y,l[c+2]+=f.z,l[h]+=f.x,l[h+1]+=f.y,l[h+2]+=f.z}}else for(o=0,a=n.length;o<a;o+=9)u.fromArray(n,o),p.fromArray(n,o+3),d.fromArray(n,o+6),f.subVectors(d,p),m.subVectors(u,p),f.cross(m),l[o]=f.x,l[o+1]=f.y,l[o+2]=f.z,l[o+3]=f.x,l[o+4]=f.y,l[o+5]=f.z,l[o+6]=f.x,l[o+7]=f.y,l[o+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(void 0!==t.attributes[n])for(var i=r[n].array,o=t.attributes[n],a=o.array,s=0,c=o.itemSize*e;s<a.length;s++,c++)i[c]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new Ue;return function(){for(var e=this.attributes.normal,r=0,n=e.count;r<n;r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.normalize(),e.setXYZ(r,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Pi,e=this.index.array,r=this.attributes;for(var n in r){for(var i=r[n],o=i.array,a=i.itemSize,s=new o.constructor(e.length*a),c=0,h=0,l=0,u=e.length;l<u;l++){c=e[l]*a;for(var p=0;p<a;p++)s[h++]=o[c++]}t.addAttribute(n,new vi(s,a))}var d=this.groups;for(l=0,u=d.length;l<u;l++){var f=d[l];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:i}}var o=this.attributes;for(var r in o){var a=o[r];i=Array.prototype.slice.call(a.array);t.data.attributes[r]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(t.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),t},clone:function(){return(new Pi).copy(this)},copy:function(t){var e,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.addAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var c=[],h=s[e];for(r=0,n=h.length;r<n;r++)c.push(h[r].clone());this.morphAttributes[e]=c}var l=t.groups;for(r=0,n=l.length;r<n;r++){var u=l[r];this.addGroup(u.start,u.count,u.materialIndex)}var p=t.boundingBox;null!==p&&(this.boundingBox=p.clone());var d=t.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ci.prototype=Object.create(gi.prototype),Ci.prototype.constructor=Ci,Oi.prototype=Object.create(Pi.prototype),Oi.prototype.constructor=Oi,Ii.prototype=Object.create(gi.prototype),Ii.prototype.constructor=Ii,Ni.prototype=Object.create(Pi.prototype),Ni.prototype.constructor=Ni;var Di=0;function Ui(){Object.defineProperty(this,"id",{value:Di++}),this.uuid=Oe.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=_,this.side=p,this.flatShading=!1,this.vertexColors=v,this.opacity=1,this.transparent=!1,this.blendSrc=D,this.blendDst=U,this.blendEquation=S,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=W,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Bi(t){Ui.call(this),this.type="MeshBasicMaterial",this.color=new ni(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function Fi(t){Ui.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function zi(t,e){this.origin=void 0!==t?t:new Ue,this.direction=void 0!==e?e:new Ue}function Gi(t,e){this.start=void 0!==t?t:new Ue,this.end=void 0!==e?e:new Ue}function Hi(t,e,r){this.a=void 0!==t?t:new Ue,this.b=void 0!==e?e:new Ue,this.c=void 0!==r?r:new Ue}function Vi(t,e){ui.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Pi,this.material=void 0!==e?e:new Bi({color:16777215*Math.random()}),this.drawMode=xe,this.updateMorphTargets()}function ki(t,e,r,n){var i,o,a,s=new ni(0),c=0;function h(t,r){e.buffers.color.setClear(t.r,t.g,t.b,r,n)}return{getClearColor:function(){return s},setClearColor:function(t,e){s.set(t),h(s,c=void 0!==e?e:1)},getClearAlpha:function(){return c},setClearAlpha:function(t){h(s,c=t)},render:function(e,n,l,u){var p=n.background;null===p?h(s,c):p&&p.isColor&&(h(p,1),u=!0),(t.autoClear||u)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&p.isCubeTexture?(void 0===a&&((a=new Vi(new Oi(1,1,1),new Fi({uniforms:oi.cube.uniforms,vertexShader:oi.cube.vertexShader,fragmentShader:oi.cube.fragmentShader,side:d,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},r.update(a)),a.material.uniforms.tCube.value=p,e.push(a,a.geometry,a.material,0,null)):p&&p.isTexture&&(void 0===i&&(i=new di(-1,1,1,-1,0,1),o=new Vi(new Ni(2,2),new Bi({depthTest:!1,depthWrite:!1,fog:!1})),r.update(o)),o.material.map=p,t.renderBufferDirect(i,null,o.geometry,o.material,o,null))}}}function ji(t,e,r){var n;this.setMode=function(t){n=t},this.render=function(e,i){t.drawArrays(n,e,i),r.update(i,n)},this.renderInstances=function(t,i,o){var a=e.get("ANGLE_instanced_arrays");null!==a?(a.drawArraysInstancedANGLE(n,i,o,t.maxInstancedCount),r.update(o,n,t.maxInstancedCount)):console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function Wi(t,e,r){var n;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o=void 0!==r.precision?r.precision:"highp",a=i(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===r.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_TEXTURE_SIZE),u=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),d=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=h>0,v=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==n)return n;var r=e.get("EXT_texture_filter_anisotropic");return n=null!==r?t.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:s,maxTextures:c,maxVertexTextures:h,maxTextureSize:l,maxCubemapSize:u,maxAttributes:p,maxVertexUniforms:d,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}function Xi(){var t=this,e=null,r=0,n=!1,i=!1,o=new Xe,a=new Be,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function h(e,r,n,i){var c=null!==e?e.length:0,h=null;if(0!==c){if(h=s.value,!0!==i||null===h){var l=n+4*c,u=r.matrixWorldInverse;a.getNormalMatrix(u),(null===h||h.length<l)&&(h=new Float32Array(l));for(var p=0,d=n;p!==c;++p,d+=4)o.copy(e[p]).applyMatrix4(u,a),o.normal.toArray(h,d),h[d+3]=o.constant}s.value=h,s.needsUpdate=!0}return t.numPlanes=c,h}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==r||n;return n=i,e=h(t,o,0),r=t.length,a},this.beginShadows=function(){i=!0,h(null)},this.endShadows=function(){i=!1,c()},this.setState=function(t,o,a,l,u,p){if(!n||null===t||0===t.length||i&&!a)i?h(null):c();else{var d=i?0:r,f=4*d,m=u.clippingState||null;s.value=m,m=h(t,l,f,p);for(var g=0;g!==f;++g)m[g]=e[g];u.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=d}}}function qi(t){var e={};return{get:function(r){if(void 0!==e[r])return e[r];var n;switch(r){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(r)}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),e[r]=n,n}}}function Yi(t,e,r){var n={},i={};function o(t){var a=t.target,s=n[a.id];for(var c in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[c]);a.removeEventListener("dispose",o),delete n[a.id];var h=i[a.id];h&&(e.remove(h),delete i[a.id]),(h=i[s.id])&&(e.remove(h),delete i[s.id]),r.memory.geometries--}return{get:function(t,e){var i=n[e.id];return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Pi).setFromObject(t)),i=e._bufferGeometry),n[e.id]=i,r.memory.geometries++,i)},update:function(r){var n=r.index,i=r.attributes;for(var o in null!==n&&e.update(n,t.ELEMENT_ARRAY_BUFFER),i)e.update(i[o],t.ARRAY_BUFFER);var a=r.morphAttributes;for(var o in a)for(var s=a[o],c=0,h=s.length;c<h;c++)e.update(s[c],t.ARRAY_BUFFER)},getWireframeAttribute:function(r){var n=i[r.id];if(n)return n;var o,a=[],s=r.index,c=r.attributes;if(null!==s)for(var h=0,l=(o=s.array).length;h<l;h+=3){var u=o[h+0],p=o[h+1],d=o[h+2];a.push(u,p,p,d,d,u)}else for(h=0,l=(o=c.position.array).length/3-1;h<l;h+=3)u=h+0,p=h+1,d=h+2,a.push(u,p,p,d,d,u);return n=new(Ri(a)>65535?Ei:wi)(a,1),e.update(n,t.ELEMENT_ARRAY_BUFFER),i[r.id]=n,n}}}function Zi(t,e,r){var n,i,o;this.setMode=function(t){n=t},this.setIndex=function(t){i=t.type,o=t.bytesPerElement},this.render=function(e,a){t.drawElements(n,a,i,e*o),r.update(a,n)},this.renderInstances=function(t,a,s){var c=e.get("ANGLE_instanced_arrays");null!==c?(c.drawElementsInstancedANGLE(n,s,i,a*o,t.maxInstancedCount),r.update(s,n,t.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function Ji(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(r,n,i){switch(i=i||1,e.calls++,n){case t.TRIANGLES:e.triangles+=i*(r/3);break;case t.TRIANGLE_STRIP:case t.TRIANGLE_FAN:e.triangles+=i*(r-2);break;case t.LINES:e.lines+=i*(r/2);break;case t.LINE_STRIP:e.lines+=i*(r-1);break;case t.LINE_LOOP:e.lines+=i*r;break;case t.POINTS:e.points+=i*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Qi(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Ki(t){var e={},r=new Float32Array(8);return{update:function(n,i,o,a){var s=n.morphTargetInfluences,c=s.length,h=e[i.id];if(void 0===h){h=[];for(var l=0;l<c;l++)h[l]=[l,0];e[i.id]=h}var u=o.morphTargets&&i.morphAttributes.position,p=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++)0!==(d=h[l])[1]&&(u&&i.removeAttribute("morphTarget"+l),p&&i.removeAttribute("morphNormal"+l));for(l=0;l<c;l++)(d=h[l])[0]=l,d[1]=s[l];for(h.sort(Qi),l=0;l<8;l++){var d;if(d=h[l]){var f=d[0],m=d[1];if(m){u&&i.addAttribute("morphTarget"+l,u[f]),p&&i.addAttribute("morphNormal"+l,p[f]),r[l]=m;continue}}r[l]=0}a.getUniforms().setValue(t,"morphTargetInfluences",r)}}}function $i(t,e){var r={};return{update:function(n){var i=e.render.frame,o=n.geometry,a=t.get(n,o);return r[a.id]!==i&&(o.isGeometry&&a.updateFromObject(n),t.update(a),r[a.id]=i),a},dispose:function(){r={}}}}function to(t,e,r,n,i,o,a,s,c,h){t=void 0!==t?t:[],e=void 0!==e?e:ot,ze.call(this,t,e,r,n,i,o,a,s,c,h),this.flipY=!1}Ui.prototype=Object.assign(Object.create(t.prototype),{constructor:Ui,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var r=t[e];if(void 0!==r)if("shading"!==e){var n=this[e];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[e]="overdraw"===e?Number(r):r:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===m;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){var e=[];for(var r in t){var n=t[r];delete n.metadata,e.push(n)}return e}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==p&&(r.side=this.side),this.vertexColors!==v&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),e){var i=n(t.textures),o=n(t.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,r=null;if(null!==e){var n=e.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=e[i].clone()}return this.clippingPlanes=r,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Bi.prototype=Object.create(Ui.prototype),Bi.prototype.constructor=Bi,Bi.prototype.isMeshBasicMaterial=!0,Bi.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Fi.prototype=Object.create(Ui.prototype),Fi.prototype.constructor=Fi,Fi.prototype.isShaderMaterial=!0,Fi.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ei.clone(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Fi.prototype.toJSON=function(t){var e=Ui.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(zi.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Ue),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new Ue;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Ue),e.subVectors(t,this.origin);var r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new Ue;return function(e){var r=t.subVectors(e,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(r).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new Ue,e=new Ue,r=new Ue;return function(n,i,o,a){t.copy(n).add(i).multiplyScalar(.5),e.copy(i).sub(n).normalize(),r.copy(this.origin).sub(t);var s,c,h,l,u=.5*n.distanceTo(i),p=-this.direction.dot(e),d=r.dot(this.direction),f=-r.dot(e),m=r.lengthSq(),g=Math.abs(1-p*p);if(g>0)if(c=p*d-f,l=u*g,(s=p*f-d)>=0)if(c>=-l)if(c<=l){var v=1/g;h=(s*=v)*(s+p*(c*=v)+2*d)+c*(p*s+c+2*f)+m}else c=u,h=-(s=Math.max(0,-(p*c+d)))*s+c*(c+2*f)+m;else c=-u,h=-(s=Math.max(0,-(p*c+d)))*s+c*(c+2*f)+m;else c<=-l?h=-(s=Math.max(0,-(-p*u+d)))*s+(c=s>0?-u:Math.min(Math.max(-u,-f),u))*(c+2*f)+m:c<=l?(s=0,h=(c=Math.min(Math.max(-u,-f),u))*(c+2*f)+m):h=-(s=Math.max(0,-(p*u+d)))*s+(c=s>0?u:Math.min(Math.max(-u,-f),u))*(c+2*f)+m;else c=p>0?-u:u,h=-(s=Math.max(0,-(p*c+d)))*s+c*(c+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(c).add(t),h}}(),intersectSphere:function(){var t=new Ue;return function(e,r){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),i=t.dot(t)-n*n,o=e.radius*e.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,c=n+a;return s<0&&c<0?null:s<0?this.at(c,r):this.at(s,r)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null},intersectPlane:function(t,e){var r=this.distanceToPlane(t);return null===r?null:this.at(r,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var r,n,i,o,a,s,c=1/this.direction.x,h=1/this.direction.y,l=1/this.direction.z,u=this.origin;return c>=0?(r=(t.min.x-u.x)*c,n=(t.max.x-u.x)*c):(r=(t.max.x-u.x)*c,n=(t.min.x-u.x)*c),h>=0?(i=(t.min.y-u.y)*h,o=(t.max.y-u.y)*h):(i=(t.max.y-u.y)*h,o=(t.min.y-u.y)*h),r>o||i>n?null:((i>r||r!=r)&&(r=i),(o<n||n!=n)&&(n=o),l>=0?(a=(t.min.z-u.z)*l,s=(t.max.z-u.z)*l):(a=(t.max.z-u.z)*l,s=(t.min.z-u.z)*l),r>s||a>n?null:((a>r||r!=r)&&(r=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,e)))},intersectsBox:function(){var t=new Ue;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new Ue,e=new Ue,r=new Ue,n=new Ue;return function(i,o,a,s,c){e.subVectors(o,i),r.subVectors(a,i),n.crossVectors(e,r);var h,l=this.direction.dot(n);if(l>0){if(s)return null;h=1}else{if(!(l<0))return null;h=-1,l=-l}t.subVectors(this.origin,i);var u=h*this.direction.dot(r.crossVectors(t,r));if(u<0)return null;var p=h*this.direction.dot(e.cross(t));if(p<0)return null;if(u+p>l)return null;var d=-h*t.dot(n);return d<0?null:this.at(d/l,c)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(Gi.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Ue),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Ue),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Ue),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new Ue,e=new Ue;return function(r,n){t.subVectors(r,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),o=e.dot(t)/i;return n&&(o=Oe.clamp(o,0,1)),o}}(),closestPointToPoint:function(t,e,r){var n=this.closestPointToPointParameter(t,e);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new Ue),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(Hi,{getNormal:function(){var t=new Ue;return function(e,r,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Ue),i.subVectors(n,r),t.subVectors(e,r),i.cross(t);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var t=new Ue,e=new Ue,r=new Ue;return function(n,i,o,a,s){t.subVectors(a,i),e.subVectors(o,i),r.subVectors(n,i);var c=t.dot(t),h=t.dot(e),l=t.dot(r),u=e.dot(e),p=e.dot(r),d=c*u-h*h;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Ue),0===d)return s.set(-2,-1,-1);var f=1/d,m=(u*l-h*p)*f,g=(c*p-h*l)*f;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var t=new Ue;return function(e,r,n,i){return Hi.getBarycoord(e,r,n,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}()}),Object.assign(Hi.prototype,{set:function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},setFromPointsAndIndices:function(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new Ue,e=new Ue;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Ue),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Hi.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ue),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Hi.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Hi.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new Xe,e=[new Gi,new Gi,new Gi],r=new Ue,n=new Ue;return function(i,o){void 0===o&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new Ue);var a=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,r),!0===this.containsPoint(r))o.copy(r);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var s=0;s<e.length;s++){e[s].closestPointToPoint(r,!0,n);var c=r.distanceToSquared(n);c<a&&(a=c,o.copy(n))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Vi.prototype=Object.assign(Object.create(ui.prototype),{constructor:Vi,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return ui.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)r=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)r=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}},raycast:function(){var t=new Ne,e=new zi,r=new We,n=new Ue,i=new Ue,o=new Ue,a=new Ue,s=new Ue,c=new Ue,h=new Ie,l=new Ie,u=new Ie,p=new Ue,m=new Ue,g=new Ue;function v(t,e,r,n,i,o,a){return Hi.getBarycoord(t,e,r,n,p),i.multiplyScalar(p.x),o.multiplyScalar(p.y),a.multiplyScalar(p.z),i.add(o).add(a),i.clone()}function y(t,e,r,n,i,o,a,s){if(null===(e.side===d?n.intersectTriangle(a,o,i,!0,s):n.intersectTriangle(i,o,a,e.side!==f,s)))return null;g.copy(s),g.applyMatrix4(t.matrixWorld);var c=r.ray.origin.distanceTo(g);return c<r.near||c>r.far?null:{distance:c,point:g.clone(),object:t}}function x(t,e,r,a,s,c,p,d){n.fromBufferAttribute(a,c),i.fromBufferAttribute(a,p),o.fromBufferAttribute(a,d);var f=y(t,t.material,e,r,n,i,o,m);if(f){s&&(h.fromBufferAttribute(s,c),l.fromBufferAttribute(s,p),u.fromBufferAttribute(s,d),f.uv=v(m,n,i,o,h,l,u));var g=new fi(c,p,d);Hi.getNormal(n,i,o,g.normal),f.face=g}return f}return function(p,d){var f,g=this.geometry,b=this.material,_=this.matrixWorld;if(void 0!==b&&(null===g.boundingSphere&&g.computeBoundingSphere(),r.copy(g.boundingSphere),r.applyMatrix4(_),!1!==p.ray.intersectsSphere(r)&&(t.getInverse(_),e.copy(p.ray).applyMatrix4(t),null===g.boundingBox||!1!==e.intersectsBox(g.boundingBox))))if(g.isBufferGeometry){var w,M,E,T,S,A=g.index,R=g.attributes.position,L=g.attributes.uv;if(null!==A)for(T=0,S=A.count;T<S;T+=3)w=A.getX(T),M=A.getX(T+1),E=A.getX(T+2),(f=x(this,p,e,R,L,w,M,E))&&(f.faceIndex=Math.floor(T/3),d.push(f));else if(void 0!==R)for(T=0,S=R.count;T<S;T+=3)(f=x(this,p,e,R,L,w=T,M=T+1,E=T+2))&&(f.faceIndex=Math.floor(T/3),d.push(f))}else if(g.isGeometry){var P,C,O,I,N=Array.isArray(b),D=g.vertices,U=g.faces,B=g.faceVertexUvs[0];B.length>0&&(I=B);for(var F=0,z=U.length;F<z;F++){var G=U[F],H=N?b[G.materialIndex]:b;if(void 0!==H){if(P=D[G.a],C=D[G.b],O=D[G.c],!0===H.morphTargets){var V=g.morphTargets,k=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var j=0,W=V.length;j<W;j++){var X=k[j];if(0!==X){var q=V[j].vertices;n.addScaledVector(a.subVectors(q[G.a],P),X),i.addScaledVector(s.subVectors(q[G.b],C),X),o.addScaledVector(c.subVectors(q[G.c],O),X)}}n.add(P),i.add(C),o.add(O),P=n,C=i,O=o}if(f=y(this,H,p,e,P,C,O,m)){if(I&&I[F]){var Y=I[F];h.copy(Y[0]),l.copy(Y[1]),u.copy(Y[2]),f.uv=v(m,P,C,O,h,l,u)}f.face=G,f.faceIndex=F,d.push(f)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),to.prototype=Object.create(ze.prototype),to.prototype.constructor=to,to.prototype.isCubeTexture=!0,Object.defineProperty(to.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var eo=new ze,ro=new to;function no(){this.seq=[],this.map={}}var io=[],oo=[],ao=new Float32Array(16),so=new Float32Array(9),co=new Float32Array(4);function ho(t,e,r){var n=t[0];if(n<=0||n>0)return t;var i=e*r,o=io[i];if(void 0===o&&(o=new Float32Array(i),io[i]=o),0!==e){n.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=r,t[a].toArray(o,s)}return o}function lo(t,e){if(t.length!==e.length)return!1;for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function uo(t,e){for(var r=0,n=e.length;r<n;r++)t[r]=e[r]}function po(t,e){var r=oo[e];void 0===r&&(r=new Int32Array(e),oo[e]=r);for(var n=0;n!==e;++n)r[n]=t.allocTextureUnit();return r}function fo(t,e){var r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function mo(t,e){var r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function go(t,e){var r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(lo(r,e))return;t.uniform2fv(this.addr,e),uo(r,e)}}function vo(t,e){var r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(void 0!==e.r)r[0]===e.r&&r[1]===e.g&&r[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(lo(r,e))return;t.uniform3fv(this.addr,e),uo(r,e)}}function yo(t,e){var r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(lo(r,e))return;t.uniform4fv(this.addr,e),uo(r,e)}}function xo(t,e){var r=this.cache,n=e.elements;if(void 0===n){if(lo(r,e))return;t.uniformMatrix2fv(this.addr,!1,e),uo(r,e)}else{if(lo(r,n))return;co.set(n),t.uniformMatrix2fv(this.addr,!1,co),uo(r,n)}}function bo(t,e){var r=this.cache,n=e.elements;if(void 0===n){if(lo(r,e))return;t.uniformMatrix3fv(this.addr,!1,e),uo(r,e)}else{if(lo(r,n))return;so.set(n),t.uniformMatrix3fv(this.addr,!1,so),uo(r,n)}}function _o(t,e){var r=this.cache,n=e.elements;if(void 0===n){if(lo(r,e))return;t.uniformMatrix4fv(this.addr,!1,e),uo(r,e)}else{if(lo(r,n))return;ao.set(n),t.uniformMatrix4fv(this.addr,!1,ao),uo(r,n)}}function wo(t,e,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(e||eo,i)}function Mo(t,e,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(e||ro,i)}function Eo(t,e){var r=this.cache;lo(r,e)||(t.uniform2iv(this.addr,e),uo(r,e))}function To(t,e){var r=this.cache;lo(r,e)||(t.uniform3iv(this.addr,e),uo(r,e))}function So(t,e){var r=this.cache;lo(r,e)||(t.uniform4iv(this.addr,e),uo(r,e))}function Ao(t){switch(t){case 5126:return fo;case 35664:return go;case 35665:return vo;case 35666:return yo;case 35674:return xo;case 35675:return bo;case 35676:return _o;case 35678:case 36198:return wo;case 35680:return Mo;case 5124:case 35670:return mo;case 35667:case 35671:return Eo;case 35668:case 35672:return To;case 35669:case 35673:return So}}function Ro(t,e){var r=this.cache;lo(r,e)||(t.uniform1fv(this.addr,e),uo(r,e))}function Lo(t,e){var r=this.cache;lo(r,e)||(t.uniform1iv(this.addr,e),uo(r,e))}function Po(t,e){var r=this.cache,n=ho(e,this.size,2);lo(r,n)||(t.uniform2fv(this.addr,n),this.updateCache(n))}function Co(t,e){var r=this.cache,n=ho(e,this.size,3);lo(r,n)||(t.uniform3fv(this.addr,n),this.updateCache(n))}function Oo(t,e){var r=this.cache,n=ho(e,this.size,4);lo(r,n)||(t.uniform4fv(this.addr,n),this.updateCache(n))}function Io(t,e){var r=this.cache,n=ho(e,this.size,4);lo(r,n)||(t.uniformMatrix2fv(this.addr,!1,n),this.updateCache(n))}function No(t,e){var r=this.cache,n=ho(e,this.size,9);lo(r,n)||(t.uniformMatrix3fv(this.addr,!1,n),this.updateCache(n))}function Do(t,e){var r=this.cache,n=ho(e,this.size,16);lo(r,n)||(t.uniformMatrix4fv(this.addr,!1,n),this.updateCache(n))}function Uo(t,e,r){var n=this.cache,i=e.length,o=po(r,i);!1===lo(n,o)&&(t.uniform1iv(this.addr,o),uo(n,o));for(var a=0;a!==i;++a)r.setTexture2D(e[a]||eo,o[a])}function Bo(t,e,r){var n=this.cache,i=e.length,o=po(r,i);!1===lo(n,o)&&(t.uniform1iv(this.addr,o),uo(n,o));for(var a=0;a!==i;++a)r.setTextureCube(e[a]||ro,o[a])}function Fo(t){switch(t){case 5126:return Ro;case 35664:return Po;case 35665:return Co;case 35666:return Oo;case 35674:return Io;case 35675:return No;case 35676:return Do;case 35678:return Uo;case 35680:return Bo;case 5124:case 35670:return Lo;case 35667:case 35671:return Eo;case 35668:case 35672:return To;case 35669:case 35673:return So}}function zo(t,e,r){this.id=t,this.addr=r,this.cache=[],this.setValue=Ao(e.type)}function Go(t,e,r){this.id=t,this.addr=r,this.cache=[],this.size=e.size,this.setValue=Fo(e.type)}function Ho(t){this.id=t,no.call(this)}Go.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),uo(e,t)},Ho.prototype.setValue=function(t,e){for(var r=this.seq,n=0,i=r.length;n!==i;++n){var o=r[n];o.setValue(t,e[o.id])}};var Vo=/([\w\d_]+)(\])?(\[|\.)?/g;function ko(t,e){t.seq.push(e),t.map[e.id]=e}function jo(t,e,r){var n=t.name,i=n.length;for(Vo.lastIndex=0;;){var o=Vo.exec(n),a=Vo.lastIndex,s=o[1],c="]"===o[2],h=o[3];if(c&&(s|=0),void 0===h||"["===h&&a+2===i){ko(r,void 0===h?new zo(s,t,e):new Go(s,t,e));break}var l=r.map[s];void 0===l&&ko(r,l=new Ho(s)),r=l}}function Wo(t,e,r){no.call(this),this.renderer=r;for(var n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=t.getActiveUniform(e,i);jo(o,t.getUniformLocation(e,o.name),this)}}function Xo(t){for(var e=t.split("\n"),r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join("\n")}function qo(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),!1===t.getShaderParameter(n,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(n),Xo(r)),n}Wo.prototype.setValue=function(t,e,r){var n=this.map[e];void 0!==n&&n.setValue(t,r,this.renderer)},Wo.prototype.setOptional=function(t,e,r){var n=e[r];void 0!==n&&this.setValue(t,r,n)},Wo.upload=function(t,e,r,n){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,n)}},Wo.seqWithValue=function(t,e){for(var r=[],n=0,i=t.length;n!==i;++n){var o=t[n];o.id in e&&r.push(o)}return r};var Yo=0;function Zo(t){switch(t){case we:return["Linear","( value )"];case Me:return["sRGB","( value )"];case Te:return["RGBE","( value )"];case Ae:return["RGBM","( value, 7.0 )"];case Re:return["RGBM","( value, 16.0 )"];case Le:return["RGBD","( value, 256.0 )"];case Ee:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Jo(t,e){var r=Zo(e);return"vec4 "+t+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function Qo(t,e){var r=Zo(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Ko(t,e){var r;switch(e){case tt:r="Linear";break;case et:r="Reinhard";break;case rt:r="Uncharted2";break;case nt:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function $o(t,e,r){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ra).join("\n")}function ta(t){var e=[];for(var r in t){var n=t[r];!1!==n&&e.push("#define "+r+" "+n)}return e.join("\n")}function ea(t,e){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=t.getActiveAttrib(e,i).name;r[o]=t.getAttribLocation(e,o)}return r}function ra(t){return""!==t}function na(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function ia(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function oa(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var r=ti[e];if(void 0===r)throw new Error("Can not resolve #include <"+e+">");return oa(r)})}function aa(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,r,n){for(var i="",o=parseInt(e);o<parseInt(r);o++)i+=n.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function sa(t,e,r,n,i,o){var a=t.context,s=n.defines,c=i.vertexShader,h=i.fragmentShader,p="SHADOWMAP_TYPE_BASIC";o.shadowMapType===l?p="SHADOWMAP_TYPE_PCF":o.shadowMapType===u&&(p="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(n.envMap.mapping){case ot:case at:d="ENVMAP_TYPE_CUBE";break;case lt:case ut:d="ENVMAP_TYPE_CUBE_UV";break;case st:case ct:d="ENVMAP_TYPE_EQUIREC";break;case ht:d="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case at:case ct:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case J:m="ENVMAP_BLENDING_MULTIPLY";break;case Q:m="ENVMAP_BLENDING_MIX";break;case K:m="ENVMAP_BLENDING_ADD"}}var g,v,y=t.gammaFactor>0?t.gammaFactor:1,x=$o(n.extensions,o,e),b=ta(s),_=a.createProgram();n.isRawShaderMaterial?((g=[b].filter(ra).join("\n")).length>0&&(g+="\n"),(v=[x,b].filter(ra).join("\n")).length>0&&(v+="\n")):(g=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+p:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ra).join("\n"),v=[x,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+y,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.envMap?"#define "+f:"",o.envMap?"#define "+m:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+p:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==$?"#define TONE_MAPPING":"",o.toneMapping!==$?ti.tonemapping_pars_fragment:"",o.toneMapping!==$?Ko("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?ti.encodings_pars_fragment:"",o.mapEncoding?Jo("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?Jo("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Jo("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?Qo("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ra).join("\n")),c=ia(c=na(c=oa(c),o),o),h=ia(h=na(h=oa(h),o),o);var w=g+(c=aa(c)),M=v+(h=aa(h)),E=qo(a,a.VERTEX_SHADER,w),T=qo(a,a.FRAGMENT_SHADER,M);a.attachShader(_,E),a.attachShader(_,T),void 0!==n.index0AttributeName?a.bindAttribLocation(_,0,n.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(_,0,"position"),a.linkProgram(_);var S,A,R=a.getProgramInfoLog(_).trim(),L=a.getShaderInfoLog(E).trim(),P=a.getShaderInfoLog(T).trim(),C=!0,O=!0;return!1===a.getProgramParameter(_,a.LINK_STATUS)?(C=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(_,a.VALIDATE_STATUS),"gl.getProgramInfoLog",R,L,P)):""!==R?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",R):""!==L&&""!==P||(O=!1),O&&(this.diagnostics={runnable:C,material:n,programLog:R,vertexShader:{log:L,prefix:g},fragmentShader:{log:P,prefix:v}}),a.deleteShader(E),a.deleteShader(T),this.getUniforms=function(){return void 0===S&&(S=new Wo(a,_,t)),S},this.getAttributes=function(){return void 0===A&&(A=ea(a,_)),A},this.destroy=function(){a.deleteProgram(_),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=Yo++,this.code=r,this.usedTimes=1,this.program=_,this.vertexShader=E,this.fragmentShader=T,this}function ca(t,e,r){var n=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(t,e){var r;return t?t.isTexture?r=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=t.texture.encoding):r=we,r===we&&e&&(r=Ee),r}this.getParameters=function(e,n,o,s,c,h,l){var u=i[e.type],p=l.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms,i=Math.floor((n-20)/4),o=Math.min(i,e.length);return o<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+o+"."),0):o}(l):0,m=r.precision;null!==e.precision&&(m=r.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",m,"instead.");var g=t.getRenderTarget();return{shaderID:u,precision:m,supportsVertexTextures:r.vertexTextures,outputEncoding:a(g?g.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:a(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:a(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===lt||e.envMap.mapping===ut),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:a(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:r.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:c,numClipIntersection:h,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&o.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===f,flipSided:e.side===d,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)n.push(i),n.push(e.defines[i]);for(var a=0;a<o.length;a++)n.push(r[o[a]]);return n.push(e.onBeforeCompile.toString()),n.push(t.gammaOutput),n.join()},this.acquireProgram=function(r,i,o,a){for(var s,c=0,h=n.length;c<h;c++){var l=n[c];if(l.code===a){++(s=l).usedTimes;break}}return void 0===s&&(s=new sa(t,e,a,r,i,o),n.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=n.indexOf(t);n[e]=n[n.length-1],n.pop(),t.destroy()}},this.programs=n}function ha(){var t=new WeakMap;return{get:function(e){var r=t.get(e);return void 0===r&&(r={},t.set(e,r)),r},remove:function(e){t.delete(e)},update:function(e,r,n){t.get(e)[r]=n},dispose:function(){t=new WeakMap}}}function la(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ua(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function pa(){var t=[],e=0,r=[],n=[];return{opaque:r,transparent:n,init:function(){e=0,r.length=0,n.length=0},push:function(i,o,a,s,c){var h=t[e];void 0===h?(h={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:c},t[e]=h):(h.id=i.id,h.object=i,h.geometry=o,h.material=a,h.program=a.program,h.renderOrder=i.renderOrder,h.z=s,h.group=c),(!0===a.transparent?n:r).push(h),e++},sort:function(){r.length>1&&r.sort(la),n.length>1&&n.sort(ua)}}}function da(){var t={};return{get:function(e,r){var n=e.id+","+r.id,i=t[n];return void 0===i&&(i=new pa,t[n]=i),i},dispose:function(){t={}}}}function fa(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var r;switch(e.type){case"DirectionalLight":r={direction:new Ue,color:new ni,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"SpotLight":r={position:new Ue,direction:new Ue,color:new ni,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"PointLight":r={position:new Ue,color:new ni,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ie,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new Ue,skyColor:new ni,groundColor:new ni};break;case"RectAreaLight":r={color:new ni,position:new Ue,halfWidth:new Ue,halfHeight:new Ue}}return t[e.id]=r,r}}}var ma=0;function ga(){var t=new fa,e={id:ma++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new Ue,n=new Ne,i=new Ne;return{setup:function(o,a,s){for(var c=0,h=0,l=0,u=0,p=0,d=0,f=0,m=0,g=s.matrixWorldInverse,v=0,y=o.length;v<y;v++){var x=o[v],b=x.color,_=x.intensity,w=x.distance,M=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)c+=b.r*_,h+=b.g*_,l+=b.b*_;else if(x.isDirectionalLight){if((T=t.get(x)).color.copy(x.color).multiplyScalar(x.intensity),T.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(g),T.shadow=x.castShadow,x.castShadow){var E=x.shadow;T.shadowBias=E.bias,T.shadowRadius=E.radius,T.shadowMapSize=E.mapSize}e.directionalShadowMap[u]=M,e.directionalShadowMatrix[u]=x.shadow.matrix,e.directional[u]=T,u++}else if(x.isSpotLight)(T=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),T.position.applyMatrix4(g),T.color.copy(b).multiplyScalar(_),T.distance=w,T.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(g),T.coneCos=Math.cos(x.angle),T.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),T.decay=0===x.distance?0:x.decay,T.shadow=x.castShadow,x.castShadow&&(E=x.shadow,T.shadowBias=E.bias,T.shadowRadius=E.radius,T.shadowMapSize=E.mapSize),e.spotShadowMap[d]=M,e.spotShadowMatrix[d]=x.shadow.matrix,e.spot[d]=T,d++;else if(x.isRectAreaLight)(T=t.get(x)).color.copy(b).multiplyScalar(_),T.position.setFromMatrixPosition(x.matrixWorld),T.position.applyMatrix4(g),i.identity(),n.copy(x.matrixWorld),n.premultiply(g),i.extractRotation(n),T.halfWidth.set(.5*x.width,0,0),T.halfHeight.set(0,.5*x.height,0),T.halfWidth.applyMatrix4(i),T.halfHeight.applyMatrix4(i),e.rectArea[f]=T,f++;else if(x.isPointLight)(T=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),T.position.applyMatrix4(g),T.color.copy(x.color).multiplyScalar(x.intensity),T.distance=x.distance,T.decay=0===x.distance?0:x.decay,T.shadow=x.castShadow,x.castShadow&&(E=x.shadow,T.shadowBias=E.bias,T.shadowRadius=E.radius,T.shadowMapSize=E.mapSize,T.shadowCameraNear=E.camera.near,T.shadowCameraFar=E.camera.far),e.pointShadowMap[p]=M,e.pointShadowMatrix[p]=x.shadow.matrix,e.point[p]=T,p++;else if(x.isHemisphereLight){var T;(T=t.get(x)).direction.setFromMatrixPosition(x.matrixWorld),T.direction.transformDirection(g),T.direction.normalize(),T.skyColor.copy(x.color).multiplyScalar(_),T.groundColor.copy(x.groundColor).multiplyScalar(_),e.hemi[m]=T,m++}}e.ambient[0]=c,e.ambient[1]=h,e.ambient[2]=l,e.directional.length=u,e.spot.length=d,e.rectArea.length=f,e.point.length=p,e.hemi.length=m,e.hash=e.id+","+u+","+p+","+d+","+f+","+m+","+a.length},state:e}}function va(){var t=new ga,e=[],r=[],n=[];return{init:function(){e.length=0,r.length=0,n.length=0},state:{lightsArray:e,shadowsArray:r,spritesArray:n,lights:t},setupLights:function(n){t.setup(e,r,n)},pushLight:function(t){e.push(t)},pushShadow:function(t){r.push(t)},pushSprite:function(t){n.push(t)}}}function ya(){var t={};return{get:function(e,r){var n=e.id+","+r.id,i=t[n];return void 0===i&&(i=new va,t[n]=i),i},dispose:function(){t={}}}}function xa(t){Ui.call(this),this.type="MeshDepthMaterial",this.depthPacking=Pe,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function ba(t){Ui.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Ue,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function _a(t,e,r){for(var n=new qe,i=new Ne,o=new Ie,a=new Ie(r,r),s=new Ue,c=new Ue,h=1,u=2,m=1+(h|u),g=new Array(m),v=new Array(m),y={},x={0:d,1:p,2:f},b=[new Ue(1,0,0),new Ue(-1,0,0),new Ue(0,0,1),new Ue(0,0,-1),new Ue(0,1,0),new Ue(0,-1,0)],_=[new Ue(0,1,0),new Ue(0,1,0),new Ue(0,1,0),new Ue(0,1,0),new Ue(0,0,1),new Ue(0,0,-1)],w=[new Ge,new Ge,new Ge,new Ge,new Ge,new Ge],M=0;M!==m;++M){var E=0!=(M&h),T=0!=(M&u),S=new xa({depthPacking:Ce,morphTargets:E,skinning:T});g[M]=S;var A=new ba({morphTargets:E,skinning:T});v[M]=A}var R=this;function L(e,r,n,i,o,a){var s=e.geometry,c=null,l=g,p=e.customDepthMaterial;if(n&&(l=v,p=e.customDistanceMaterial),p)c=p;else{var d=!1;r.morphTargets&&(s&&s.isBufferGeometry?d=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(d=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var f=e.isSkinnedMesh&&r.skinning,m=0;d&&(m|=h),f&&(m|=u),c=l[m]}if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var b=c.uuid,_=r.uuid,w=y[b];void 0===w&&(w={},y[b]=w);var M=w[_];void 0===M&&(M=c.clone(),w[_]=M),c=M}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=null!=r.shadowSide?r.shadowSide:x[r.side],c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,n&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=o,c.farDistance=a),c}function P(r,i,o,a){if(!1!==r.visible){if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var s=e.update(r),h=r.material;if(Array.isArray(h))for(var l=s.groups,u=0,p=l.length;u<p;u++){var d=l[u],f=h[d.materialIndex];if(f&&f.visible){var m=L(r,f,a,c,o.near,o.far);t.renderBufferDirect(o,null,s,m,r,d)}}else if(h.visible){m=L(r,h,a,c,o.near,o.far);t.renderBufferDirect(o,null,s,m,r,null)}}for(var g=r.children,v=0,y=g.length;v<y;v++)P(g[v],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=l,this.render=function(e,r,h){if(!1!==R.enabled&&(!1!==R.autoUpdate||!1!==R.needsUpdate)&&0!==e.length){var l,u=t.context,p=t.state;p.disable(u.BLEND),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var d=0,f=e.length;d<f;d++){var m=e[d],g=m.shadow,v=m&&m.isPointLight;if(void 0!==g){var y=g.camera;if(o.copy(g.mapSize),o.min(a),v){var x=o.x,M=o.y;w[0].set(2*x,M,x,M),w[1].set(0,M,x,M),w[2].set(3*x,M,x,M),w[3].set(x,M,x,M),w[4].set(3*x,0,x,M),w[5].set(x,0,x,M),o.x*=4,o.y*=2}if(null===g.map){var E={minFilter:mt,magFilter:mt,format:Dt};g.map=new He(o.x,o.y,E),g.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}g.isSpotLightShadow&&g.update(m);var T=g.map,S=g.matrix;c.setFromMatrixPosition(m.matrixWorld),y.position.copy(c),v?(l=6,S.makeTranslation(-c.x,-c.y,-c.z)):(l=1,s.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(s),y.updateMatrixWorld(),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(y.projectionMatrix),S.multiply(y.matrixWorldInverse)),t.setRenderTarget(T),t.clear();for(var A=0;A<l;A++){if(v){s.copy(y.position),s.add(b[A]),y.up.copy(_[A]),y.lookAt(s),y.updateMatrixWorld();var L=w[A];p.viewport(L)}i.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),n.setFromMatrix(i),P(r,h,y,v)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}R.needsUpdate=!1}}}function wa(t,e,r,n,i,o,a,s,c){ze.call(this,t,e,r,n,i,o,a,s,c),this.needsUpdate=!0}function Ma(t,e,r,n,i){var o,a,s,c,h,l,u=new Ue,p=new De,d=new Ue;function f(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);o=e.createBuffer(),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW),s=function(){var t=e.createProgram(),r=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(r),e.compileShader(n),e.attachShader(t,r),e.attachShader(t,n),e.linkProgram(t),t}(),c={position:e.getAttribLocation(s,"position"),uv:e.getAttribLocation(s,"uv")},h={uvOffset:e.getUniformLocation(s,"uvOffset"),uvScale:e.getUniformLocation(s,"uvScale"),rotation:e.getUniformLocation(s,"rotation"),center:e.getUniformLocation(s,"center"),scale:e.getUniformLocation(s,"scale"),color:e.getUniformLocation(s,"color"),map:e.getUniformLocation(s,"map"),opacity:e.getUniformLocation(s,"opacity"),modelViewMatrix:e.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(s,"projectionMatrix"),fogType:e.getUniformLocation(s,"fogType"),fogDensity:e.getUniformLocation(s,"fogDensity"),fogNear:e.getUniformLocation(s,"fogNear"),fogFar:e.getUniformLocation(s,"fogFar"),fogColor:e.getUniformLocation(s,"fogColor"),fogDepth:e.getUniformLocation(s,"fogDepth"),alphaTest:e.getUniformLocation(s,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var u=n.getContext("2d");u.fillStyle="white",u.fillRect(0,0,8,8),l=new wa(n)}function m(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(i,g,v){if(0!==i.length){void 0===s&&f(),r.useProgram(s),r.initAttributes(),r.enableAttribute(c.position),r.enableAttribute(c.uv),r.disableUnusedAttributes(),r.disable(e.CULL_FACE),r.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(c.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(c.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.uniformMatrix4fv(h.projectionMatrix,!1,v.projectionMatrix.elements),r.activeTexture(e.TEXTURE0),e.uniform1i(h.map,0);var y=0,x=0,b=g.fog;b?(e.uniform3f(h.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(e.uniform1f(h.fogNear,b.near),e.uniform1f(h.fogFar,b.far),e.uniform1i(h.fogType,1),y=1,x=1):b.isFogExp2&&(e.uniform1f(h.fogDensity,b.density),e.uniform1i(h.fogType,2),y=2,x=2)):(e.uniform1i(h.fogType,0),y=0,x=0);for(var _=0,w=i.length;_<w;_++){(T=i[_]).modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,T.matrixWorld),T.z=-T.modelViewMatrix.elements[14]}i.sort(m);var M=[],E=[];for(_=0,w=i.length;_<w;_++){var T,S=(T=i[_]).material;if(!1!==S.visible){T.onBeforeRender(t,g,v,void 0,S,void 0),e.uniform1f(h.alphaTest,S.alphaTest),e.uniformMatrix4fv(h.modelViewMatrix,!1,T.modelViewMatrix.elements),T.matrixWorld.decompose(u,p,d),M[0]=d.x,M[1]=d.y,E[0]=T.center.x-.5,E[1]=T.center.y-.5;var A=0;g.fog&&S.fog&&(A=x),y!==A&&(e.uniform1i(h.fogType,A),y=A),null!==S.map?(e.uniform2f(h.uvOffset,S.map.offset.x,S.map.offset.y),e.uniform2f(h.uvScale,S.map.repeat.x,S.map.repeat.y)):(e.uniform2f(h.uvOffset,0,0),e.uniform2f(h.uvScale,1,1)),e.uniform1f(h.opacity,S.opacity),e.uniform3f(h.color,S.color.r,S.color.g,S.color.b),e.uniform1f(h.rotation,S.rotation),e.uniform2fv(h.center,E),e.uniform2fv(h.scale,M),r.setBlending(S.blending,S.blendEquation,S.blendSrc,S.blendDst,S.blendEquationAlpha,S.blendSrcAlpha,S.blendDstAlpha,S.premultipliedAlpha),r.buffers.depth.setTest(S.depthTest),r.buffers.depth.setMask(S.depthWrite),r.buffers.color.setMask(S.colorWrite),n.setTexture2D(S.map||l,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),T.onAfterRender(t,g,v,void 0,S,void 0)}}r.enable(e.CULL_FACE),r.reset()}}}function Ea(t,e,r){var a=new function(){var e=!1,r=new Ge,n=null,i=new Ge(0,0,0,0);return{setMask:function(r){n===r||e||(t.colorMask(r,r,r,r),n=r)},setLocked:function(t){e=t},setClear:function(e,n,o,a,s){!0===s&&(e*=a,n*=a,o*=a),r.set(e,n,o,a),!1===i.equals(r)&&(t.clearColor(e,n,o,a),i.copy(r))},reset:function(){e=!1,n=null,i.set(-1,0,0,0)}}},s=new function(){var e=!1,r=null,n=null,i=null;return{setTest:function(e){e?rt(t.DEPTH_TEST):nt(t.DEPTH_TEST)},setMask:function(n){r===n||e||(t.depthMask(n),r=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case V:t.depthFunc(t.NEVER);break;case k:t.depthFunc(t.ALWAYS);break;case j:t.depthFunc(t.LESS);break;case W:t.depthFunc(t.LEQUAL);break;case X:t.depthFunc(t.EQUAL);break;case q:t.depthFunc(t.GEQUAL);break;case Y:t.depthFunc(t.GREATER);break;case Z:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);n=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,r=null,n=null,i=null}}},c=new function(){var e=!1,r=null,n=null,i=null,o=null,a=null,s=null,c=null,h=null;return{setTest:function(e){e?rt(t.STENCIL_TEST):nt(t.STENCIL_TEST)},setMask:function(n){r===n||e||(t.stencilMask(n),r=n)},setFunc:function(e,r,a){n===e&&i===r&&o===a||(t.stencilFunc(e,r,a),n=e,i=r,o=a)},setOp:function(e,r,n){a===e&&s===r&&c===n||(t.stencilOp(e,r,n),a=e,s=r,c=n)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,r=null,n=null,i=null,o=null,a=null,s=null,c=null,h=null}}},h=t.getParameter(t.MAX_VERTEX_ATTRIBS),l=new Uint8Array(h),u=new Uint8Array(h),p=new Uint8Array(h),m={},g=null,v=null,y=null,x=null,S=null,A=null,R=null,L=null,P=null,C=!1,O=null,I=null,N=null,D=null,U=null,B=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),F=!1,z=0,G=t.getParameter(t.VERSION);-1!==G.indexOf("WebGL")?(z=parseFloat(/^WebGL\ ([0-9])/.exec(G)[1]),F=z>=1):-1!==G.indexOf("OpenGL ES")&&(z=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(G)[1]),F=z>=2);var H=null,J={},Q=new Ge,K=new Ge;function $(e,r,n){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<n;a++)t.texImage2D(r+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}var tt={};function et(r,n){(l[r]=1,0===u[r]&&(t.enableVertexAttribArray(r),u[r]=1),p[r]!==n)&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,n),p[r]=n)}function rt(e){!0!==m[e]&&(t.enable(e),m[e]=!0)}function nt(e){!1!==m[e]&&(t.disable(e),m[e]=!1)}function it(e,n,i,o,a,s,c,h){if(e!==b?rt(t.BLEND):nt(t.BLEND),e!==T){if(e!==y||h!==C)switch(e){case w:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case M:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case E:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}x=null,S=null,A=null,R=null,L=null,P=null}else a=a||n,s=s||i,c=c||o,n===x&&a===R||(t.blendEquationSeparate(r.convert(n),r.convert(a)),x=n,R=a),i===S&&o===A&&s===L&&c===P||(t.blendFuncSeparate(r.convert(i),r.convert(o),r.convert(s),r.convert(c)),S=i,A=o,L=s,P=c);y=e,C=h}function ot(e){O!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),O=e)}function at(e){e!==n?(rt(t.CULL_FACE),e!==I&&(e===i?t.cullFace(t.BACK):e===o?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):nt(t.CULL_FACE),I=e}function st(e,r,n){e?(rt(t.POLYGON_OFFSET_FILL),D===r&&U===n||(t.polygonOffset(r,n),D=r,U=n)):nt(t.POLYGON_OFFSET_FILL)}function ct(e){void 0===e&&(e=t.TEXTURE0+B-1),H!==e&&(t.activeTexture(e),H=e)}return tt[t.TEXTURE_2D]=$(t.TEXTURE_2D,t.TEXTURE_2D,1),tt[t.TEXTURE_CUBE_MAP]=$(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),a.setClear(0,0,0,1),s.setClear(1),c.setClear(0),rt(t.DEPTH_TEST),s.setFunc(W),ot(!1),at(i),rt(t.CULL_FACE),rt(t.BLEND),it(_),{buffers:{color:a,depth:s,stencil:c},initAttributes:function(){for(var t=0,e=l.length;t<e;t++)l[t]=0},enableAttribute:function(t){et(t,0)},enableAttributeAndDivisor:et,disableUnusedAttributes:function(){for(var e=0,r=u.length;e!==r;++e)u[e]!==l[e]&&(t.disableVertexAttribArray(e),u[e]=0)},enable:rt,disable:nt,getCompressedTextureFormats:function(){if(null===g&&(g=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var r=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)g.push(r[n]);return g},useProgram:function(e){return v!==e&&(t.useProgram(e),v=e,!0)},setBlending:it,setMaterial:function(e,r){e.side===f?nt(t.CULL_FACE):rt(t.CULL_FACE);var n=e.side===d;r&&(n=!n),ot(n),!0===e.transparent?it(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):it(b),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),a.setMask(e.colorWrite),st(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:ot,setCullFace:at,setLineWidth:function(e){e!==N&&(F&&t.lineWidth(e),N=e)},setPolygonOffset:st,setScissorTest:function(e){e?rt(t.SCISSOR_TEST):nt(t.SCISSOR_TEST)},activeTexture:ct,bindTexture:function(e,r){null===H&&ct();var n=J[H];void 0===n&&(n={type:void 0,texture:void 0},J[H]=n),n.type===e&&n.texture===r||(t.bindTexture(e,r||tt[e]),n.type=e,n.texture=r)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===Q.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),Q.copy(e))},viewport:function(e){!1===K.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),K.copy(e))},reset:function(){for(var e=0;e<u.length;e++)1===u[e]&&(t.disableVertexAttribArray(e),u[e]=0);m={},g=null,H=null,J={},v=null,y=null,O=null,I=null,a.reset(),s.reset(),c.reset()}}}function Ta(t,e,r,n,i,o,a){var s,c="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,h={};function l(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var r=e/Math.max(t.width,t.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(t.width*r),n.height=Math.floor(t.height*r),n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function u(t){return Oe.isPowerOfTwo(t.width)&&Oe.isPowerOfTwo(t.height)}function p(t,e){return t.generateMipmaps&&e&&t.minFilter!==mt&&t.minFilter!==yt}function d(e,r,i,o){t.generateMipmap(e),n.get(r).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function f(e){return e===mt||e===gt||e===vt?t.NEAREST:t.LINEAR}function m(e){var r=e.target;r.removeEventListener("dispose",m),function(e){var r=n.get(e);if(e.image&&r.__image__webglTextureCube)t.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;t.deleteTexture(r.__webglTexture)}n.remove(e)}(r),r.isVideoTexture&&delete h[r.id],a.memory.textures--}function g(e){var r=e.target;r.removeEventListener("dispose",g),function(e){var r=n.get(e),i=n.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[o]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(e.texture),n.remove(e)}(r),a.memory.textures--}function v(e,f){var g=n.get(e);if(e.isVideoTexture&&function(t){var e=t.id,r=a.render.frame;h[e]!==r&&(h[e]=r,t.update())}(e),e.version>0&&g.__version!==e.version){var v=e.image;if(void 0===v)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==v.complete)return void function(e,n,h){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",m),e.__webglTexture=t.createTexture(),a.memory.textures++);r.activeTexture(t.TEXTURE0+h),r.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,n.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,n.unpackAlignment);var f=l(n.image,i.maxTextureSize);(function(t){return t.wrapS!==dt||t.wrapT!==dt||t.minFilter!==mt&&t.minFilter!==yt})(n)&&!1===u(f)&&(f=function(t){return t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap?(void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=Oe.floorPowerOfTwo(t.width),s.height=Oe.floorPowerOfTwo(t.height),s.getContext("2d").drawImage(t,0,0,s.width,s.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+s.width+"x"+s.height,t),s):t}(f));var g=u(f),v=o.convert(n.format),x=o.convert(n.type);y(t.TEXTURE_2D,n,g);var b,_=n.mipmaps;if(n.isDepthTexture){var w=t.DEPTH_COMPONENT;if(n.type===At){if(!c)throw new Error("Float Depth Texture only supported in WebGL2.0");w=t.DEPTH_COMPONENT32F}else c&&(w=t.DEPTH_COMPONENT16);n.format===zt&&w===t.DEPTH_COMPONENT&&n.type!==Et&&n.type!==St&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Et,x=o.convert(n.type)),n.format===Gt&&(w=t.DEPTH_STENCIL,n.type!==Ot&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Ot,x=o.convert(n.type))),r.texImage2D(t.TEXTURE_2D,0,w,f.width,f.height,0,v,x,null)}else if(n.isDataTexture)if(_.length>0&&g){for(var M=0,E=_.length;M<E;M++)b=_[M],r.texImage2D(t.TEXTURE_2D,M,v,b.width,b.height,0,v,x,b.data);n.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else r.texImage2D(t.TEXTURE_2D,0,v,f.width,f.height,0,v,x,f.data),e.__maxMipLevel=0;else if(n.isCompressedTexture){for(var M=0,E=_.length;M<E;M++)b=_[M],n.format!==Dt&&n.format!==Nt?r.getCompressedTextureFormats().indexOf(v)>-1?r.compressedTexImage2D(t.TEXTURE_2D,M,v,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(t.TEXTURE_2D,M,v,b.width,b.height,0,v,x,b.data);e.__maxMipLevel=_.length-1}else if(_.length>0&&g){for(var M=0,E=_.length;M<E;M++)b=_[M],r.texImage2D(t.TEXTURE_2D,M,v,v,x,b);n.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else r.texImage2D(t.TEXTURE_2D,0,v,v,x,f),e.__maxMipLevel=0;p(n,g)&&d(t.TEXTURE_2D,n,f.width,f.height);e.__version=n.version,n.onUpdate&&n.onUpdate(n)}(g,e,f);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}r.activeTexture(t.TEXTURE0+f),r.bindTexture(t.TEXTURE_2D,g.__webglTexture)}function y(r,a,s){var c;if(s?(t.texParameteri(r,t.TEXTURE_WRAP_S,o.convert(a.wrapS)),t.texParameteri(r,t.TEXTURE_WRAP_T,o.convert(a.wrapT)),t.texParameteri(r,t.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),t.texParameteri(r,t.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(t.texParameteri(r,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(r,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.wrapS===dt&&a.wrapT===dt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(r,t.TEXTURE_MAG_FILTER,f(a.magFilter)),t.texParameteri(r,t.TEXTURE_MIN_FILTER,f(a.minFilter)),a.minFilter!==mt&&a.minFilter!==yt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),c=e.get("EXT_texture_filter_anisotropic")){if(a.type===At&&null===e.get("OES_texture_float_linear"))return;if(a.type===Rt&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(t.texParameterf(r,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function x(e,i,a,s){var c=o.convert(i.texture.format),h=o.convert(i.texture.type);r.texImage2D(s,0,c,i.width,i.height,0,c,h,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,n.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function b(e,r){t.bindRenderbuffer(t.RENDERBUFFER,e),r.depthBuffer&&!r.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r.width,r.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):r.depthBuffer&&r.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,r.width,r.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,r.width,r.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function _(e){var r=n.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),v(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===zt)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(r.depthTexture.format!==Gt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}(r.__webglFramebuffer,e)}else if(i){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=t.createRenderbuffer(),b(r.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),b(r.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}this.setTexture2D=v,this.setTextureCube=function(e,s){var c=n.get(e);if(6===e.image.length)if(e.version>0&&c.__version!==e.version){c.__image__webglTextureCube||(e.addEventListener("dispose",m),c.__image__webglTextureCube=t.createTexture(),a.memory.textures++),r.activeTexture(t.TEXTURE0+s),r.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var h=e&&e.isCompressedTexture,f=e.image[0]&&e.image[0].isDataTexture,g=[],v=0;v<6;v++)g[v]=h||f?f?e.image[v].image:e.image[v]:l(e.image[v],i.maxCubemapSize);var x=g[0],b=u(x),_=o.convert(e.format),w=o.convert(e.type);for(y(t.TEXTURE_CUBE_MAP,e,b),v=0;v<6;v++)if(h)for(var M,E=g[v].mipmaps,T=0,S=E.length;T<S;T++)M=E[T],e.format!==Dt&&e.format!==Nt?r.getCompressedTextureFormats().indexOf(_)>-1?r.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,T,_,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,T,_,M.width,M.height,0,_,w,M.data);else f?r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,_,g[v].width,g[v].height,0,_,w,g[v].data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,_,_,w,g[v]);c.__maxMipLevel=h?E.length-1:0,p(e,b)&&d(t.TEXTURE_CUBE_MAP,e,x.width,x.height),c.__version=e.version,e.onUpdate&&e.onUpdate(e)}else r.activeTexture(t.TEXTURE0+s),r.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){r.activeTexture(t.TEXTURE0+i),r.bindTexture(t.TEXTURE_CUBE_MAP,n.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=n.get(e),o=n.get(e.texture);e.addEventListener("dispose",g),o.__webglTexture=t.createTexture(),a.memory.textures++;var s=!0===e.isWebGLRenderTargetCube,c=u(e);if(s){i.__webglFramebuffer=[];for(var h=0;h<6;h++)i.__webglFramebuffer[h]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){for(r.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),y(t.TEXTURE_CUBE_MAP,e.texture,c),h=0;h<6;h++)x(i.__webglFramebuffer[h],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+h);p(e.texture,c)&&d(t.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),r.bindTexture(t.TEXTURE_CUBE_MAP,null)}else r.bindTexture(t.TEXTURE_2D,o.__webglTexture),y(t.TEXTURE_2D,e.texture,c),x(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),p(e.texture,c)&&d(t.TEXTURE_2D,e.texture,e.width,e.height),r.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&_(e)},this.updateRenderTargetMipmap=function(e){var i=e.texture;if(p(i,u(e))){var o=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=n.get(i).__webglTexture;r.bindTexture(o,a),d(o,i,e.width,e.height),r.bindTexture(o,null)}}}function Sa(t,e){return{convert:function(r){var n;if(r===pt)return t.REPEAT;if(r===dt)return t.CLAMP_TO_EDGE;if(r===ft)return t.MIRRORED_REPEAT;if(r===mt)return t.NEAREST;if(r===gt)return t.NEAREST_MIPMAP_NEAREST;if(r===vt)return t.NEAREST_MIPMAP_LINEAR;if(r===yt)return t.LINEAR;if(r===xt)return t.LINEAR_MIPMAP_NEAREST;if(r===bt)return t.LINEAR_MIPMAP_LINEAR;if(r===_t)return t.UNSIGNED_BYTE;if(r===Lt)return t.UNSIGNED_SHORT_4_4_4_4;if(r===Pt)return t.UNSIGNED_SHORT_5_5_5_1;if(r===Ct)return t.UNSIGNED_SHORT_5_6_5;if(r===wt)return t.BYTE;if(r===Mt)return t.SHORT;if(r===Et)return t.UNSIGNED_SHORT;if(r===Tt)return t.INT;if(r===St)return t.UNSIGNED_INT;if(r===At)return t.FLOAT;if(r===Rt&&null!==(n=e.get("OES_texture_half_float")))return n.HALF_FLOAT_OES;if(r===It)return t.ALPHA;if(r===Nt)return t.RGB;if(r===Dt)return t.RGBA;if(r===Ut)return t.LUMINANCE;if(r===Bt)return t.LUMINANCE_ALPHA;if(r===zt)return t.DEPTH_COMPONENT;if(r===Gt)return t.DEPTH_STENCIL;if(r===S)return t.FUNC_ADD;if(r===A)return t.FUNC_SUBTRACT;if(r===R)return t.FUNC_REVERSE_SUBTRACT;if(r===C)return t.ZERO;if(r===O)return t.ONE;if(r===I)return t.SRC_COLOR;if(r===N)return t.ONE_MINUS_SRC_COLOR;if(r===D)return t.SRC_ALPHA;if(r===U)return t.ONE_MINUS_SRC_ALPHA;if(r===B)return t.DST_ALPHA;if(r===F)return t.ONE_MINUS_DST_ALPHA;if(r===z)return t.DST_COLOR;if(r===G)return t.ONE_MINUS_DST_COLOR;if(r===H)return t.SRC_ALPHA_SATURATE;if((r===Ht||r===Vt||r===kt||r===jt)&&null!==(n=e.get("WEBGL_compressed_texture_s3tc"))){if(r===Ht)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Vt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===kt)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===jt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((r===Wt||r===Xt||r===qt||r===Yt)&&null!==(n=e.get("WEBGL_compressed_texture_pvrtc"))){if(r===Wt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Xt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===qt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Yt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===Zt&&null!==(n=e.get("WEBGL_compressed_texture_etc1")))return n.COMPRESSED_RGB_ETC1_WEBGL;if((r===Jt||r===Qt||r===Kt||r===$t||r===te||r===ee||r===re||r===ne||r===ie||r===oe||r===ae||r===se||r===ce||r===he)&&null!==(n=e.get("WEBGL_compressed_texture_astc")))return r;if((r===L||r===P)&&null!==(n=e.get("EXT_blend_minmax"))){if(r===L)return n.MIN_EXT;if(r===P)return n.MAX_EXT}return r===Ot&&null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:0}}}function Aa(t,e,r,n){pi.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Ra(t){Aa.call(this),this.cameras=t||[]}function La(t){var e=this,r=null,n=null,i=null,o=new Ne,a=new Ne;"undefined"!=typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",g,!1));var s=new Ne,c=new De,h=new Ue,l=new Aa;l.bounds=new Ge(0,0,.5,1),l.layers.enable(1);var u=new Aa;u.bounds=new Ge(.5,0,.5,1),u.layers.enable(2);var p,d,f=new Ra([l,u]);function m(){return null!==r&&!0===r.isPresenting}function g(){if(m()){var n=r.getEyeParameters("left"),i=n.renderWidth,o=n.renderHeight;d=t.getPixelRatio(),p=t.getSize(),t.setDrawingBufferSize(2*i,o,1),v.start()}else e.enabled&&(t.setDrawingBufferSize(p.width,p.height,d),v.stop())}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t),v.setContext(t)},this.setPoseTarget=function(t){void 0!==t&&(i=t)},this.getCamera=function(t){if(null===r)return t;r.depthNear=t.near,r.depthFar=t.far,r.getFrameData(n);var p=r.stageParameters;p?o.fromArray(p.sittingToStandingTransform):o.makeTranslation(0,e.userHeight,0);var d=n.pose,m=null!==i?i:t;if(m.matrix.copy(o),m.matrix.decompose(m.position,m.quaternion,m.scale),null!==d.orientation&&(c.fromArray(d.orientation),m.quaternion.multiply(c)),null!==d.position&&(c.setFromRotationMatrix(o),h.fromArray(d.position),h.applyQuaternion(c),m.position.add(h)),m.updateMatrixWorld(),!1===r.isPresenting)return t;l.near=t.near,u.near=t.near,l.far=t.far,u.far=t.far,f.matrixWorld.copy(t.matrixWorld),f.matrixWorldInverse.copy(t.matrixWorldInverse),l.matrixWorldInverse.fromArray(n.leftViewMatrix),u.matrixWorldInverse.fromArray(n.rightViewMatrix),a.getInverse(o),l.matrixWorldInverse.multiply(a),u.matrixWorldInverse.multiply(a);var g=m.parent;null!==g&&(s.getInverse(g.matrixWorld),l.matrixWorldInverse.multiply(s),u.matrixWorldInverse.multiply(s)),l.matrixWorld.getInverse(l.matrixWorldInverse),u.matrixWorld.getInverse(u.matrixWorldInverse),l.projectionMatrix.fromArray(n.leftProjectionMatrix),u.projectionMatrix.fromArray(n.rightProjectionMatrix),f.projectionMatrix.copy(l.projectionMatrix);var v=r.getLayers();if(v.length){var y=v[0];null!==y.leftBounds&&4===y.leftBounds.length&&l.bounds.fromArray(y.leftBounds),null!==y.rightBounds&&4===y.rightBounds.length&&u.bounds.fromArray(y.rightBounds)}return f},this.getStandingMatrix=function(){return o},this.isPresenting=m;var v=new ai;this.setAnimationLoop=function(t){v.setAnimationLoop(t)},this.submitFrame=function(){m()&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",g)}}function Pa(t){var e=t.context,r=null,n=null,i=null,o=null;function a(){return null!==n&&null!==i}var s=new Aa;s.layers.enable(1),s.viewport=new Ge;var c=new Aa;c.layers.enable(2),c.viewport=new Ge;var h=new Ra([s,c]);function l(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}h.layers.enable(1),h.layers.enable(2),this.enabled=!1,this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t),e.setCompatibleXRDevice(t)},this.setSession=function(r,o){null!==(n=r)&&(n.addEventListener("end",function(){t.setFramebuffer(null),p.stop()}),n.baseLayer=new XRWebGLLayer(n,e),n.requestFrameOfReference(o.frameOfReferenceType).then(function(e){i=e,t.setFramebuffer(n.baseLayer.framebuffer),p.setContext(n),p.start()}))},this.getCamera=function(t){if(a()){var e=t.parent,r=h.cameras;l(h,e);for(var n=0;n<r.length;n++)l(r[n],e);t.matrixWorld.copy(h.matrixWorld);for(var i=t.children,o=(n=0,i.length);n<o;n++)i[n].updateMatrixWorld(!0);return h}return t},this.isPresenting=a;var u=null;var p=new ai;p.setAnimationLoop(function(t,e){o=e.getDevicePose(i);for(var r=n.baseLayer,a=e.views,s=0;s<a.length;s++){var c=a[s],l=r.getViewport(c),p=o.getViewMatrix(c),d=h.cameras[s];d.matrix.fromArray(p).getInverse(d.matrix),d.projectionMatrix.fromArray(c.projectionMatrix),d.viewport.set(l.x,l.y,l.width,l.height),0===s&&(h.matrix.copy(d.matrix),h.projectionMatrix.copy(d.projectionMatrix))}u&&u()}),this.setAnimationLoop=function(t){u=t},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new THREE.Matrix4},this.submitFrame=function(){}}function Ca(t){console.log("THREE.WebGLRenderer",e);var r=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,o=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,c=void 0===t.premultipliedAlpha||t.premultipliedAlpha,h=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=void 0!==t.powerPreference?t.powerPreference:"default",u=null,p=null;this.domElement=r,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=tt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,m,g,y,x,b,_,w,M,E,T,S,A,R,L,P,C,O,I,N=this,D=!1,U=null,B=null,F=null,z=-1,G="",H=null,V=null,k=new Ge,j=new Ge,W=null,X=0,q=r.width,Y=r.height,Z=1,J=new Ge(0,0,q,Y),Q=new Ge(0,0,q,Y),K=!1,$=new qe,et=new Xi,rt=!1,nt=!1,it=new Ne,ot=new Ue;function at(){return null===B?Z:1}try{var st={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:l};if(r.addEventListener("webglcontextlost",ut,!1),r.addEventListener("webglcontextrestored",pt,!1),null===(f=n||r.getContext("webgl",st)||r.getContext("experimental-webgl",st)))throw null!==r.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}function ct(){(m=new qi(f)).get("WEBGL_depth_texture"),m.get("OES_texture_float"),m.get("OES_texture_float_linear"),m.get("OES_texture_half_float"),m.get("OES_texture_half_float_linear"),m.get("OES_standard_derivatives"),m.get("OES_element_index_uint"),m.get("ANGLE_instanced_arrays"),I=new Sa(f,m),g=new Wi(f,m,t),(y=new Ea(f,m,I)).scissor(j.copy(Q).multiplyScalar(Z)),y.viewport(k.copy(J).multiplyScalar(Z)),x=new Ji(f),b=new ha,_=new Ta(f,m,y,b,g,I,x),w=new si(f),M=new Yi(f,w,x),E=new $i(M,x),L=new Ki(f),T=new ca(N,m,g),S=new da,A=new ya,R=new ki(N,y,E,c),P=new ji(f,m,x),C=new Zi(f,m,x),O=new Ma(N,f,y,_,g),x.programs=T.programs,N.context=f,N.capabilities=g,N.extensions=m,N.properties=b,N.renderLists=S,N.state=y,N.info=x}ct();var ht="xr"in navigator?new Pa(N):new La(N);this.vr=ht;var lt=new _a(N,E,g.maxTextureSize);function ut(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function pt(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1,ct()}function dt(t){var e=t.target;e.removeEventListener("dispose",dt),function(t){ft(t),b.remove(t)}(e)}function ft(t){var e=b.get(t).program;t.program=void 0,void 0!==e&&T.releaseProgram(e)}this.shadowMap=lt,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var t=m.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=m.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Z},this.setPixelRatio=function(t){void 0!==t&&(Z=t,this.setSize(q,Y,!1))},this.getSize=function(){return{width:q,height:Y}},this.setSize=function(t,e,n){ht.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(q=t,Y=e,r.width=t*Z,r.height=e*Z,!1!==n&&(r.style.width=t+"px",r.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:q*Z,height:Y*Z}},this.setDrawingBufferSize=function(t,e,n){q=t,Y=e,Z=n,r.width=t*n,r.height=e*n,this.setViewport(0,0,t,e)},this.getCurrentViewport=function(){return k},this.setViewport=function(t,e,r,n){J.set(t,Y-e-n,r,n),y.viewport(k.copy(J).multiplyScalar(Z))},this.setScissor=function(t,e,r,n){Q.set(t,Y-e-n,r,n),y.scissor(j.copy(Q).multiplyScalar(Z))},this.setScissorTest=function(t){y.setScissorTest(K=t)},this.getClearColor=function(){return R.getClearColor()},this.setClearColor=function(){R.setClearColor.apply(R,arguments)},this.getClearAlpha=function(){return R.getClearAlpha()},this.setClearAlpha=function(){R.setClearAlpha.apply(R,arguments)},this.clear=function(t,e,r){var n=0;(void 0===t||t)&&(n|=f.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=f.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=f.STENCIL_BUFFER_BIT),f.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,r,n){this.setRenderTarget(t),this.clear(e,r,n)},this.dispose=function(){r.removeEventListener("webglcontextlost",ut,!1),r.removeEventListener("webglcontextrestored",pt,!1),S.dispose(),A.dispose(),b.dispose(),E.dispose(),ht.dispose(),vt.stop()},this.renderBufferImmediate=function(t,e,r){y.initAttributes();var n=b.get(t);t.hasPositions&&!n.position&&(n.position=f.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),t.hasColors&&!n.color&&(n.color=f.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(f.bindBuffer(f.ARRAY_BUFFER,n.position),f.bufferData(f.ARRAY_BUFFER,t.positionArray,f.DYNAMIC_DRAW),y.enableAttribute(i.position),f.vertexAttribPointer(i.position,3,f.FLOAT,!1,0,0)),t.hasNormals){if(f.bindBuffer(f.ARRAY_BUFFER,n.normal),!r.isMeshPhongMaterial&&!r.isMeshStandardMaterial&&!r.isMeshNormalMaterial&&!0===r.flatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,c=(s[o+0]+s[o+3]+s[o+6])/3,h=(s[o+1]+s[o+4]+s[o+7])/3,l=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=c,s[o+1]=h,s[o+2]=l,s[o+3]=c,s[o+4]=h,s[o+5]=l,s[o+6]=c,s[o+7]=h,s[o+8]=l}f.bufferData(f.ARRAY_BUFFER,t.normalArray,f.DYNAMIC_DRAW),y.enableAttribute(i.normal),f.vertexAttribPointer(i.normal,3,f.FLOAT,!1,0,0)}t.hasUvs&&r.map&&(f.bindBuffer(f.ARRAY_BUFFER,n.uv),f.bufferData(f.ARRAY_BUFFER,t.uvArray,f.DYNAMIC_DRAW),y.enableAttribute(i.uv),f.vertexAttribPointer(i.uv,2,f.FLOAT,!1,0,0)),t.hasColors&&r.vertexColors!==v&&(f.bindBuffer(f.ARRAY_BUFFER,n.color),f.bufferData(f.ARRAY_BUFFER,t.colorArray,f.DYNAMIC_DRAW),y.enableAttribute(i.color),f.vertexAttribPointer(i.color,3,f.FLOAT,!1,0,0)),y.disableUnusedAttributes(),f.drawArrays(f.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,r,n,i,o){var a=i.isMesh&&i.matrixWorld.determinant()<0;y.setMaterial(n,a);var s=wt(t,e,n,i),c=r.id+"_"+s.id+"_"+(!0===n.wireframe),h=!1;c!==G&&(G=c,h=!0),i.morphTargetInfluences&&(L.update(i,r,n,s),h=!0);var l,u=r.index,p=r.attributes.position,d=1;!0===n.wireframe&&(u=M.getWireframeAttribute(r),d=2);var g=P;null!==u&&(l=w.get(u),(g=C).setIndex(l)),h&&(!function(t,e,r){if(r&&r.isInstancedBufferGeometry&&null===m.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");y.initAttributes();var n=r.attributes,i=e.getAttributes(),o=t.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var c=n[a];if(void 0!==c){var h=c.normalized,l=c.itemSize,u=w.get(c);if(void 0===u)continue;var p=u.buffer,d=u.type,g=u.bytesPerElement;if(c.isInterleavedBufferAttribute){var v=c.data,x=v.stride,b=c.offset;v&&v.isInstancedInterleavedBuffer?(y.enableAttributeAndDivisor(s,v.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=v.meshPerAttribute*v.count)):y.enableAttribute(s),f.bindBuffer(f.ARRAY_BUFFER,p),f.vertexAttribPointer(s,l,d,h,x*g,b*g)}else c.isInstancedBufferAttribute?(y.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=c.meshPerAttribute*c.count)):y.enableAttribute(s),f.bindBuffer(f.ARRAY_BUFFER,p),f.vertexAttribPointer(s,l,d,h,0,0)}else if(void 0!==o){var _=o[a];if(void 0!==_)switch(_.length){case 2:f.vertexAttrib2fv(s,_);break;case 3:f.vertexAttrib3fv(s,_);break;case 4:f.vertexAttrib4fv(s,_);break;default:f.vertexAttrib1fv(s,_)}}}}y.disableUnusedAttributes()}(n,s,r),null!==u&&f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l.buffer));var v=1/0;null!==u?v=u.count:void 0!==p&&(v=p.count);var x=r.drawRange.start*d,b=r.drawRange.count*d,_=null!==o?o.start*d:0,E=null!==o?o.count*d:1/0,T=Math.max(x,_),S=Math.min(v,x+b,_+E)-1,A=Math.max(0,S-T+1);if(0!==A){if(i.isMesh)if(!0===n.wireframe)y.setLineWidth(n.wireframeLinewidth*at()),g.setMode(f.LINES);else switch(i.drawMode){case xe:g.setMode(f.TRIANGLES);break;case be:g.setMode(f.TRIANGLE_STRIP);break;case _e:g.setMode(f.TRIANGLE_FAN)}else if(i.isLine){var R=n.linewidth;void 0===R&&(R=1),y.setLineWidth(R*at()),i.isLineSegments?g.setMode(f.LINES):i.isLineLoop?g.setMode(f.LINE_LOOP):g.setMode(f.LINE_STRIP)}else i.isPoints&&g.setMode(f.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&g.renderInstances(r,T,A):g.render(T,A)}},this.compile=function(t,e){(p=A.get(t,e)).init(),t.traverse(function(t){t.isLight&&(p.pushLight(t),t.castShadow&&p.pushShadow(t))}),p.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)bt(e.material[r],t.fog,e);else bt(e.material,t.fog,e)})};var mt=null;var gt,vt=new ai;function yt(t,e,r,n){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,c=a.geometry,h=void 0===n?a.material:n,l=a.group;if(r.isArrayCamera){V=r;for(var u=r.cameras,p=0,d=u.length;p<d;p++){var f=u[p];if(s.layers.test(f.layers)){if("viewport"in f)y.viewport(k.copy(f.viewport));else{var m=f.bounds,g=m.x*q,v=m.y*Y,x=m.z*q,b=m.w*Y;y.viewport(k.set(g,v,x,b).multiplyScalar(Z))}xt(s,e,f,c,h,l)}}}else V=null,xt(s,e,r,c,h,l)}}function xt(t,e,r,n,i,o){if(t.onBeforeRender(N,e,r,n,i,o),p=A.get(e,V||r),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=t.isMesh&&t.matrixWorld.determinant()<0;y.setMaterial(i,a);var s=wt(r,e.fog,i,t);G="",function(t,e,r){t.render(function(t){N.renderBufferImmediate(t,e,r)})}(t,s,i)}else N.renderBufferDirect(r,e.fog,n,i,t,o);t.onAfterRender(N,e,r,n,i,o),p=A.get(e,V||r)}function bt(t,e,r){var n=b.get(t),i=p.state.lights,o=p.state.shadowsArray,a=T.getParameters(t,i.state,o,e,et.numPlanes,et.numIntersection,r),s=T.getProgramCode(t,a),c=n.program,h=!0;if(void 0===c)t.addEventListener("dispose",dt);else if(c.code!==s)ft(t);else if(n.lightsHash!==i.state.hash)b.update(t,"lightsHash",i.state.hash),h=!1;else{if(void 0!==a.shaderID)return;h=!1}if(h){if(a.shaderID){var l=oi[a.shaderID];n.shader={name:t.type,uniforms:ei.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(n.shader,N),c=T.acquireProgram(t,n.shader,a,s),n.program=c,t.program=c}var u=c.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<N.maxMorphTargets;d++)u["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(d=0;d<N.maxMorphNormals;d++)u["morphNormal"+d]>=0&&t.numSupportedMorphNormals++}var f=n.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=et.numPlanes,n.numIntersection=et.numIntersection,f.clippingPlanes=et.uniform),n.fog=e,n.lightsHash=i.state.hash,t.lights&&(f.ambientLightColor.value=i.state.ambient,f.directionalLights.value=i.state.directional,f.spotLights.value=i.state.spot,f.rectAreaLights.value=i.state.rectArea,f.pointLights.value=i.state.point,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=n.program.getUniforms(),g=Wo.seqWithValue(m.seq,f);n.uniformsList=g}function wt(t,e,r,n){X=0;var i=b.get(r),o=p.state.lights;if(rt&&(nt||t!==H)){var a=t===H&&r.id===z;et.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,t,i,a)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==e?r.needsUpdate=!0:r.lights&&i.lightsHash!==o.state.hash?r.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===et.numPlanes&&i.numIntersection===et.numIntersection||(r.needsUpdate=!0)),r.needsUpdate&&(bt(r,e,n),r.needsUpdate=!1);var s,c,h=!1,l=!1,u=!1,m=i.program,v=m.getUniforms(),x=i.shader.uniforms;if(y.useProgram(m.program)&&(h=!0,l=!0,u=!0),r.id!==z&&(z=r.id,l=!0),h||t!==H){if(v.setValue(f,"projectionMatrix",t.projectionMatrix),g.logarithmicDepthBuffer&&v.setValue(f,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),H!==(V||t)&&(H=V||t,l=!0,u=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var _=v.map.cameraPosition;void 0!==_&&_.setValue(f,ot.setFromMatrixPosition(t.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&v.setValue(f,"viewMatrix",t.matrixWorldInverse)}if(r.skinning){v.setOptional(f,n,"bindMatrix"),v.setOptional(f,n,"bindMatrixInverse");var w=n.skeleton;if(w){var M=w.bones;if(g.floatVertexTextures){if(void 0===w.boneTexture){var E=Math.sqrt(4*M.length);E=Oe.ceilPowerOfTwo(E),E=Math.max(E,4);var T=new Float32Array(E*E*4);T.set(w.boneMatrices);var S=new ke(T,E,E,Dt,At);S.needsUpdate=!0,w.boneMatrices=T,w.boneTexture=S,w.boneTextureSize=E}v.setValue(f,"boneTexture",w.boneTexture),v.setValue(f,"boneTextureSize",w.boneTextureSize)}else v.setOptional(f,w,"boneMatrices")}}return l&&(v.setValue(f,"toneMappingExposure",N.toneMappingExposure),v.setValue(f,"toneMappingWhitePoint",N.toneMappingWhitePoint),r.lights&&(c=u,(s=x).ambientLightColor.needsUpdate=c,s.directionalLights.needsUpdate=c,s.pointLights.needsUpdate=c,s.spotLights.needsUpdate=c,s.rectAreaLights.needsUpdate=c,s.hemisphereLights.needsUpdate=c),e&&r.fog&&function(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(x,e),r.isMeshBasicMaterial?Mt(x,r):r.isMeshLambertMaterial?(Mt(x,r),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(x,r)):r.isMeshPhongMaterial?(Mt(x,r),r.isMeshToonMaterial?function(t,e){Et(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(x,r):Et(x,r)):r.isMeshStandardMaterial?(Mt(x,r),r.isMeshPhysicalMaterial?function(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,Tt(t,e)}(x,r):Tt(x,r)):r.isMeshDepthMaterial?(Mt(x,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(x,r)):r.isMeshDistanceMaterial?(Mt(x,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(x,r)):r.isMeshNormalMaterial?(Mt(x,r),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===d&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===d&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(x,r)):r.isLineBasicMaterial?(function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}(x,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(x,r)):r.isPointsMaterial?function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Z,t.scale.value=.5*Y,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}(x,r):r.isShadowMaterial&&(x.color.value=r.color,x.opacity.value=r.opacity),void 0!==x.ltc_1&&(x.ltc_1.value=ii.LTC_1),void 0!==x.ltc_2&&(x.ltc_2.value=ii.LTC_2),Wo.upload(f,i.uniformsList,x,N)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Wo.upload(f,i.uniformsList,x,N),r.uniformsNeedUpdate=!1),v.setValue(f,"modelViewMatrix",n.modelViewMatrix),v.setValue(f,"normalMatrix",n.normalMatrix),v.setValue(f,"modelMatrix",n.matrixWorld),m}function Mt(t,e){var r;t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=b.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}function Et(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===d&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===d&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Tt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===d&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===d&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}vt.setAnimationLoop(function(){ht.isPresenting()||mt&&mt()}),vt.setContext(window),this.setAnimationLoop=function(t){mt=t,ht.setAnimationLoop(t),vt.start()},this.render=function(t,e,r,n){if(e&&e.isCamera){if(!D){G="",z=-1,H=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ht.enabled&&(e=ht.getCamera(e)),(p=A.get(t,e)).init(),t.onBeforeRender(N,t,e,r),it.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),$.setFromMatrix(it),nt=this.localClippingEnabled,rt=et.init(this.clippingPlanes,nt,e),(u=S.get(t,e)).init(),function t(e,r,n){if(!1===e.visible)return;var i=e.layers.test(r.layers);if(i)if(e.isLight)p.pushLight(e),e.castShadow&&p.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!$.intersectsSprite(e)||p.pushSprite(e);else if(e.isImmediateRenderObject)n&&ot.setFromMatrixPosition(e.matrixWorld).applyMatrix4(it),u.push(e,null,e.material,ot.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||$.intersectsObject(e))){n&&ot.setFromMatrixPosition(e.matrixWorld).applyMatrix4(it);var o=E.update(e),a=e.material;if(Array.isArray(a))for(var s=o.groups,c=0,h=s.length;c<h;c++){var l=s[c],d=a[l.materialIndex];d&&d.visible&&u.push(e,o,d,ot.z,l)}else a.visible&&u.push(e,o,a,ot.z,null)}var f=e.children;for(var c=0,h=f.length;c<h;c++)t(f[c],r,n)}(t,e,N.sortObjects),!0===N.sortObjects&&u.sort(),rt&&et.beginShadows();var i=p.state.shadowsArray;lt.render(i,t,e),p.setupLights(e),rt&&et.endShadows(),this.info.autoReset&&this.info.reset(),void 0===r&&(r=null),this.setRenderTarget(r),R.render(u,t,e,n);var o=u.opaque,a=u.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&yt(o,t,e,s),a.length&&yt(a,t,e,s)}else o.length&&yt(o,t,e),a.length&&yt(a,t,e);var c=p.state.spritesArray;O.render(c,t,e),r&&_.updateRenderTargetMipmap(r),y.buffers.depth.setTest(!0),y.buffers.depth.setMask(!0),y.buffers.color.setMask(!0),y.setPolygonOffset(!1),t.onAfterRender(N,t,e),ht.enabled&&ht.submitFrame(),u=null,p=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var t=X;return t>=g.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+g.maxTextures),X+=1,t},this.setTexture2D=(gt=!1,function(t,e){t&&t.isWebGLRenderTarget&&(gt||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),gt=!0),t=t.texture),_.setTexture2D(t,e)}),this.setTexture=function(){var t=!1;return function(e,r){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),_.setTexture2D(e,r)}}(),this.setTextureCube=function(){var t=!1;return function(e,r){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?_.setTextureCube(e,r):_.setTextureCubeDynamic(e,r)}}(),this.setFramebuffer=function(t){U=t},this.getRenderTarget=function(){return B},this.setRenderTarget=function(t){B=t,t&&void 0===b.get(t).__webglFramebuffer&&_.setupRenderTarget(t);var e=U,r=!1;if(t){var n=b.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=n[t.activeCubeFace],r=!0):e=n,k.copy(t.viewport),j.copy(t.scissor),W=t.scissorTest}else k.copy(J).multiplyScalar(Z),j.copy(Q).multiplyScalar(Z),W=K;if(F!==e&&(f.bindFramebuffer(f.FRAMEBUFFER,e),F=e),y.viewport(k),y.scissor(j),y.setScissorTest(W),r){var i=b.get(t.texture);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,r,n,i,o){if(t&&t.isWebGLRenderTarget){var a=b.get(t).__webglFramebuffer;if(a){var s=!1;a!==F&&(f.bindFramebuffer(f.FRAMEBUFFER,a),s=!0);try{var c=t.texture,h=c.format,l=c.type;if(h!==Dt&&I.convert(h)!==f.getParameter(f.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===_t||I.convert(l)===f.getParameter(f.IMPLEMENTATION_COLOR_READ_TYPE)||l===At&&(m.get("OES_texture_float")||m.get("WEBGL_color_buffer_float"))||l===Rt&&m.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");f.checkFramebufferStatus(f.FRAMEBUFFER)===f.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&r>=0&&r<=t.height-i&&f.readPixels(e,r,n,i,I.convert(h),I.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&f.bindFramebuffer(f.FRAMEBUFFER,F)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,r){var n=e.image.width,i=e.image.height,o=I.convert(e.format);this.setTexture2D(e,0),f.copyTexImage2D(f.TEXTURE_2D,r||0,o,t.x,t.y,n,i,0)},this.copyTextureToTexture=function(t,e,r,n){var i=e.image.width,o=e.image.height,a=I.convert(r.format),s=I.convert(r.type);this.setTexture2D(r,0),e.isDataTexture?f.texSubImage2D(f.TEXTURE_2D,n||0,t.x,t.y,i,o,a,s,e.image.data):f.texSubImage2D(f.TEXTURE_2D,n||0,t.x,t.y,a,s,e.image)}}function Oa(t,e){this.name="",this.color=new ni(t),this.density=void 0!==e?e:25e-5}function Ia(t,e,r){this.name="",this.color=new ni(t),this.near=void 0!==e?e:1,this.far=void 0!==r?r:1e3}function Na(){ui.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Da(t){Ui.call(this),this.type="SpriteMaterial",this.color=new ni(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Ua(t){ui.call(this),this.type="Sprite",this.material=void 0!==t?t:new Da,this.center=new Ie(.5,.5)}function Ba(){ui.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Fa(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Ne)}}function za(){ui.call(this),this.type="Bone"}function Ga(t,e){Vi.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ne,this.bindMatrixInverse=new Ne;var r=new Fa(this.initBones());this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}function Ha(t){Ui.call(this),this.type="LineBasicMaterial",this.color=new ni(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function Va(t,e,r){if(1===r)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new ka(t,e);ui.call(this),this.type="Line",this.geometry=void 0!==t?t:new Pi,this.material=void 0!==e?e:new Ha({color:16777215*Math.random()})}function ka(t,e){Va.call(this,t,e),this.type="LineSegments"}function ja(t,e){Va.call(this,t,e),this.type="LineLoop"}function Wa(t){Ui.call(this),this.type="PointsMaterial",this.color=new ni(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function Xa(t,e){ui.call(this),this.type="Points",this.geometry=void 0!==t?t:new Pi,this.material=void 0!==e?e:new Wa({color:16777215*Math.random()})}function qa(){ui.call(this),this.type="Group"}function Ya(t,e,r,n,i,o,a,s,c){ze.call(this,t,e,r,n,i,o,a,s,c),this.generateMipmaps=!1}function Za(t,e,r,n,i,o,a,s,c,h,l,u){ze.call(this,null,o,a,s,c,h,n,i,l,u),this.image={width:e,height:r},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Ja(t,e,r,n,i,o,a,s,c,h){if((h=void 0!==h?h:zt)!==zt&&h!==Gt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&h===zt&&(r=Et),void 0===r&&h===Gt&&(r=Ot),ze.call(this,null,n,i,o,a,s,h,r,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:mt,this.minFilter=void 0!==s?s:mt,this.flipY=!1,this.generateMipmaps=!1}function Qa(t){Pi.call(this),this.type="WireframeGeometry";var e,r,n,i,o,a,s,c,h,l,u=[],p=[0,0],d={},f=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,n=m.length;e<n;e++){var g=m[e];for(r=0;r<3;r++)s=g[f[r]],c=g[f[(r+1)%3]],p[0]=Math.min(s,c),p[1]=Math.max(s,c),void 0===d[h=p[0]+","+p[1]]&&(d[h]={index1:p[0],index2:p[1]})}for(h in d)a=d[h],l=t.vertices[a.index1],u.push(l.x,l.y,l.z),l=t.vertices[a.index2],u.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var v,y,x,b,_,w,M;if(l=new Ue,null!==t.index){for(v=t.attributes.position,y=t.index,0===(x=t.groups).length&&(x=[{start:0,count:y.count,materialIndex:0}]),i=0,o=x.length;i<o;++i)for(e=_=(b=x[i]).start,n=_+b.count;e<n;e+=3)for(r=0;r<3;r++)s=y.getX(e+r),c=y.getX(e+(r+1)%3),p[0]=Math.min(s,c),p[1]=Math.max(s,c),void 0===d[h=p[0]+","+p[1]]&&(d[h]={index1:p[0],index2:p[1]});for(h in d)a=d[h],l.fromBufferAttribute(v,a.index1),u.push(l.x,l.y,l.z),l.fromBufferAttribute(v,a.index2),u.push(l.x,l.y,l.z)}else for(e=0,n=(v=t.attributes.position).count/3;e<n;e++)for(r=0;r<3;r++)w=3*e+r,l.fromBufferAttribute(v,w),u.push(l.x,l.y,l.z),M=3*e+(r+1)%3,l.fromBufferAttribute(v,M),u.push(l.x,l.y,l.z)}this.addAttribute("position",new Ti(u,3))}function Ka(t,e,r){gi.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:r},this.fromBufferGeometry(new $a(t,e,r)),this.mergeVertices()}function $a(t,e,r){Pi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:r};var n,i,o=[],a=[],s=[],c=[],h=new Ue,l=new Ue,u=new Ue,p=new Ue,d=new Ue;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=e+1;for(n=0;n<=r;n++){var m=n/r;for(i=0;i<=e;i++){var g=i/e;t(g,m,l),a.push(l.x,l.y,l.z),g-1e-5>=0?(t(g-1e-5,m,u),p.subVectors(l,u)):(t(g+1e-5,m,u),p.subVectors(u,l)),m-1e-5>=0?(t(g,m-1e-5,u),d.subVectors(l,u)):(t(g,m+1e-5,u),d.subVectors(u,l)),h.crossVectors(p,d).normalize(),s.push(h.x,h.y,h.z),c.push(g,m)}}for(n=0;n<r;n++)for(i=0;i<e;i++){var v=n*f+i,y=n*f+i+1,x=(n+1)*f+i+1,b=(n+1)*f+i;o.push(v,y,b),o.push(y,x,b)}this.setIndex(o),this.addAttribute("position",new Ti(a,3)),this.addAttribute("normal",new Ti(s,3)),this.addAttribute("uv",new Ti(c,2))}function ts(t,e,r,n){gi.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n},this.fromBufferGeometry(new es(t,e,r,n)),this.mergeVertices()}function es(t,e,r,n){Pi.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n},r=r||1;var i=[],o=[];function a(t,e,r,n){var i,o,a=Math.pow(2,n),c=[];for(i=0;i<=a;i++){c[i]=[];var h=t.clone().lerp(r,i/a),l=e.clone().lerp(r,i/a),u=a-i;for(o=0;o<=u;o++)c[i][o]=0===o&&i===a?h:h.clone().lerp(l,o/u)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var p=Math.floor(o/2);o%2==0?(s(c[i][p+1]),s(c[i+1][p]),s(c[i][p])):(s(c[i][p+1]),s(c[i+1][p+1]),s(c[i+1][p]))}}function s(t){i.push(t.x,t.y,t.z)}function c(e,r){var n=3*e;r.x=t[n+0],r.y=t[n+1],r.z=t[n+2]}function h(t,e,r,n){n<0&&1===t.x&&(o[e]=t.x-1),0===r.x&&0===r.z&&(o[e]=n/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}!function(t){for(var r=new Ue,n=new Ue,i=new Ue,o=0;o<e.length;o+=3)c(e[o+0],r),c(e[o+1],n),c(e[o+2],i),a(r,n,i,t)}(n=n||0),function(t){for(var e=new Ue,r=0;r<i.length;r+=3)e.x=i[r+0],e.y=i[r+1],e.z=i[r+2],e.normalize().multiplyScalar(t),i[r+0]=e.x,i[r+1]=e.y,i[r+2]=e.z}(r),function(){for(var t=new Ue,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var r=l(t)/2/Math.PI+.5,n=(a=t,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(r,1-n)}var a;(function(){for(var t=new Ue,e=new Ue,r=new Ue,n=new Ue,a=new Ie,s=new Ie,c=new Ie,u=0,p=0;u<i.length;u+=9,p+=6){t.set(i[u+0],i[u+1],i[u+2]),e.set(i[u+3],i[u+4],i[u+5]),r.set(i[u+6],i[u+7],i[u+8]),a.set(o[p+0],o[p+1]),s.set(o[p+2],o[p+3]),c.set(o[p+4],o[p+5]),n.copy(t).add(e).add(r).divideScalar(3);var d=l(n);h(a,p+0,t,d),h(s,p+2,e,d),h(c,p+4,r,d)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],r=o[t+2],n=o[t+4],i=Math.max(e,r,n),a=Math.min(e,r,n);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),r<.2&&(o[t+2]+=1),n<.2&&(o[t+4]+=1))}}()}(),this.addAttribute("position",new Ti(i,3)),this.addAttribute("normal",new Ti(i.slice(),3)),this.addAttribute("uv",new Ti(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function rs(t,e){gi.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ns(t,e)),this.mergeVertices()}function ns(t,e){es.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function is(t,e){gi.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new os(t,e)),this.mergeVertices()}function os(t,e){es.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function as(t,e){gi.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ss(t,e)),this.mergeVertices()}function ss(t,e){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];es.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function cs(t,e){gi.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new hs(t,e)),this.mergeVertices()}function hs(t,e){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];es.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ls(t,e,r,n,i,o){gi.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:n,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new us(t,e,r,n,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function us(t,e,r,n,i){Pi.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:n,closed:i},e=e||64,r=r||1,n=n||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,c=new Ue,h=new Ue,l=new Ie,u=new Ue,p=[],d=[],f=[],m=[];function g(i){u=t.getPointAt(i/e,u);var a=o.normals[i],l=o.binormals[i];for(s=0;s<=n;s++){var f=s/n*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);h.x=g*a.x+m*l.x,h.y=g*a.y+m*l.y,h.z=g*a.z+m*l.z,h.normalize(),d.push(h.x,h.y,h.z),c.x=u.x+r*h.x,c.y=u.y+r*h.y,c.z=u.z+r*h.z,p.push(c.x,c.y,c.z)}}!function(){for(a=0;a<e;a++)g(a);g(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=n;s++)l.x=a/e,l.y=s/n,f.push(l.x,l.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=n;a++){var t=(n+1)*(s-1)+(a-1),r=(n+1)*s+(a-1),i=(n+1)*s+a,o=(n+1)*(s-1)+a;m.push(t,r,o),m.push(r,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new Ti(p,3)),this.addAttribute("normal",new Ti(d,3)),this.addAttribute("uv",new Ti(f,2))}function ps(t,e,r,n,i,o,a){gi.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ds(t,e,r,n,i,o)),this.mergeVertices()}function ds(t,e,r,n,i,o){Pi.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:o},t=t||1,e=e||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,o=o||3;var a,s,c=[],h=[],l=[],u=[],p=new Ue,d=new Ue,f=new Ue,m=new Ue,g=new Ue,v=new Ue,y=new Ue;for(a=0;a<=r;++a){var x=a/r*i*Math.PI*2;for(A(x,i,o,t,f),A(x+.01,i,o,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=n;++s){var b=s/n*Math.PI*2,_=-e*Math.cos(b),w=e*Math.sin(b);p.x=f.x+(_*y.x+w*g.x),p.y=f.y+(_*y.y+w*g.y),p.z=f.z+(_*y.z+w*g.z),h.push(p.x,p.y,p.z),d.subVectors(p,f).normalize(),l.push(d.x,d.y,d.z),u.push(a/r),u.push(s/n)}}for(s=1;s<=r;s++)for(a=1;a<=n;a++){var M=(n+1)*(s-1)+(a-1),E=(n+1)*s+(a-1),T=(n+1)*s+a,S=(n+1)*(s-1)+a;c.push(M,E,S),c.push(E,T,S)}function A(t,e,r,n,i){var o=Math.cos(t),a=Math.sin(t),s=r/e*t,c=Math.cos(s);i.x=n*(2+c)*.5*o,i.y=n*(2+c)*a*.5,i.z=n*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new Ti(h,3)),this.addAttribute("normal",new Ti(l,3)),this.addAttribute("uv",new Ti(u,2))}function fs(t,e,r,n,i){gi.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new ms(t,e,r,n,i)),this.mergeVertices()}function ms(t,e,r,n,i){Pi.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},t=t||1,e=e||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var o,a,s=[],c=[],h=[],l=[],u=new Ue,p=new Ue,d=new Ue;for(o=0;o<=r;o++)for(a=0;a<=n;a++){var f=a/n*i,m=o/r*Math.PI*2;p.x=(t+e*Math.cos(m))*Math.cos(f),p.y=(t+e*Math.cos(m))*Math.sin(f),p.z=e*Math.sin(m),c.push(p.x,p.y,p.z),u.x=t*Math.cos(f),u.y=t*Math.sin(f),d.subVectors(p,u).normalize(),h.push(d.x,d.y,d.z),l.push(a/n),l.push(o/r)}for(o=1;o<=r;o++)for(a=1;a<=n;a++){var g=(n+1)*o+a-1,v=(n+1)*(o-1)+a-1,y=(n+1)*(o-1)+a,x=(n+1)*o+a;s.push(g,v,x),s.push(v,y,x)}this.setIndex(s),this.addAttribute("position",new Ti(c,3)),this.addAttribute("normal",new Ti(h,3)),this.addAttribute("uv",new Ti(l,2))}xa.prototype=Object.create(Ui.prototype),xa.prototype.constructor=xa,xa.prototype.isMeshDepthMaterial=!0,xa.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},ba.prototype=Object.create(Ui.prototype),ba.prototype.constructor=ba,ba.prototype.isMeshDistanceMaterial=!0,ba.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},wa.prototype=Object.create(ze.prototype),wa.prototype.constructor=wa,wa.prototype.isCanvasTexture=!0,Aa.prototype=Object.assign(Object.create(pi.prototype),{constructor:Aa,isPerspectiveCamera:!0,copy:function(t,e){return pi.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Oe.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Oe.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Oe.RAD2DEG*Math.atan(Math.tan(.5*Oe.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,r,n,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Oe.DEG2RAD*this.fov)/this.zoom,r=2*e,n=this.aspect*r,i=-.5*n,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*n/a,e-=o.offsetY*r/s,n*=o.width/a,r*=o.height/s}var c=this.filmOffset;0!==c&&(i+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,e,e-r,t,this.far)},toJSON:function(t){var e=ui.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Ra.prototype=Object.assign(Object.create(Aa.prototype),{constructor:Ra,isArrayCamera:!0}),Oa.prototype.isFogExp2=!0,Oa.prototype.clone=function(){return new Oa(this.color,this.density)},Oa.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Ia.prototype.isFog=!0,Ia.prototype.clone=function(){return new Ia(this.color,this.near,this.far)},Ia.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Na.prototype=Object.assign(Object.create(ui.prototype),{constructor:Na,copy:function(t,e){return ui.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=ui.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),Da.prototype=Object.create(Ui.prototype),Da.prototype.constructor=Da,Da.prototype.isSpriteMaterial=!0,Da.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Ua.prototype=Object.assign(Object.create(ui.prototype),{constructor:Ua,isSprite:!0,raycast:function(){var t=new Ue,e=new Ue,r=new Ue;return function(n,i){e.setFromMatrixPosition(this.matrixWorld),n.ray.closestPointToPoint(e,t),r.setFromMatrixScale(this.matrixWorld);var o=r.x*r.y/4;if(!(e.distanceToSquared(t)>o)){var a=n.ray.origin.distanceTo(t);a<n.near||a>n.far||i.push({distance:a,point:t.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return ui.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),Ba.prototype=Object.assign(Object.create(ui.prototype),{constructor:Ba,copy:function(t){ui.prototype.copy.call(this,t,!1);for(var e=t.levels,r=0,n=e.length;r<n;r++){var i=e[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var r=this.levels,n=0;n<r.length&&!(e<r[n].distance);n++);r.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,r=1,n=e.length;r<n&&!(t<e[r].distance);r++);return e[r-1].object},raycast:function(){var t=new Ue;return function(e,r){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,r)}}(),update:function(){var t=new Ue,e=new Ue;return function(r){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(r.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);n[0].object.visible=!0;for(var o=1,a=n.length;o<a&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;o<a;o++)n[o].object.visible=!1}}}(),toJSON:function(t){var e=ui.prototype.toJSON.call(this,t);e.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var o=r[n];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Object.assign(Fa.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var r=new Ne;this.bones[t]&&r.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(r)}},pose:function(){var t,e,r;for(e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new Ne,e=new Ne;return function(){for(var r=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=r.length;a<s;a++){var c=r[a]?r[a].matrixWorld:e;t.multiplyMatrices(c,n[a]),t.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Fa(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,r=this.bones.length;e<r;e++){var n=this.bones[e];if(n.name===t)return n}}}),za.prototype=Object.assign(Object.create(ui.prototype),{constructor:za,isBone:!0}),Ga.prototype=Object.assign(Object.create(Vi.prototype),{constructor:Ga,isSkinnedMesh:!0,initBones:function(){var t,e,r,n,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(r=0,n=this.geometry.bones.length;r<n;r++)e=this.geometry.bones[r],t=new za,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(r=0,n=this.geometry.bones.length;r<n;r++)-1!==(e=this.geometry.bones[r]).parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[r]):this.add(i[r])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var r=this.geometry.skinWeights[e];(t=1/r.manhattanLength())!==1/0?r.multiplyScalar(t):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new Ge,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)n.x=i.getX(e),n.y=i.getY(e),n.z=i.getZ(e),n.w=i.getW(e),(t=1/n.manhattanLength())!==1/0?n.multiplyScalar(t):n.set(1,0,0,0),i.setXYZW(e,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){Vi.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ha.prototype=Object.create(Ui.prototype),Ha.prototype.constructor=Ha,Ha.prototype.isLineBasicMaterial=!0,Ha.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},Va.prototype=Object.assign(Object.create(ui.prototype),{constructor:Va,isLine:!0,computeLineDistances:function(){var t=new Ue,e=new Ue;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[0],o=1,a=n.count;o<a;o++)t.fromBufferAttribute(n,o-1),e.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=t.distanceTo(e);r.addAttribute("lineDistance",new Ti(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;(i=r.lineDistances)[0]=0;for(o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var t=new Ne,e=new zi,r=new We;return function(n,i){var o=n.linePrecision,a=o*o,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(c),!1!==n.ray.intersectsSphere(r)){t.getInverse(c),e.copy(n.ray).applyMatrix4(t);var h=new Ue,l=new Ue,u=new Ue,p=new Ue,d=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var f=s.index,m=s.attributes.position.array;if(null!==f)for(var g=f.array,v=0,y=g.length-1;v<y;v+=d){var x=g[v],b=g[v+1];if(h.fromArray(m,3*x),l.fromArray(m,3*b),!(e.distanceSqToSegment(h,l,p,u)>a))p.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(p))<n.near||M>n.far||i.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(v=0,y=m.length/3-1;v<y;v+=d){if(h.fromArray(m,3*v),l.fromArray(m,3*v+3),!(e.distanceSqToSegment(h,l,p,u)>a))p.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(p))<n.near||M>n.far||i.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else if(s.isGeometry){var _=s.vertices,w=_.length;for(v=0;v<w-1;v+=d){var M;if(!(e.distanceSqToSegment(_[v],_[v+1],p,u)>a))p.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(p))<n.near||M>n.far||i.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ka.prototype=Object.assign(Object.create(Va.prototype),{constructor:ka,isLineSegments:!0,computeLineDistances:function(){var t=new Ue,e=new Ue;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[],o=0,a=n.count;o<a;o+=2)t.fromBufferAttribute(n,o),e.fromBufferAttribute(n,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);r.addAttribute("lineDistance",new Ti(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;for(i=r.lineDistances,o=0,a=s.length;o<a;o+=2)t.copy(s[o]),e.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e)}return this}}()}),ja.prototype=Object.assign(Object.create(Va.prototype),{constructor:ja,isLineLoop:!0}),Wa.prototype=Object.create(Ui.prototype),Wa.prototype.constructor=Wa,Wa.prototype.isPointsMaterial=!0,Wa.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},Xa.prototype=Object.assign(Object.create(ui.prototype),{constructor:Xa,isPoints:!0,raycast:function(){var t=new Ne,e=new zi,r=new We;return function(n,i){var o=this,a=this.geometry,s=this.matrixWorld,c=n.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(s),r.radius+=c,!1!==n.ray.intersectsSphere(r)){t.getInverse(s),e.copy(n.ray).applyMatrix4(t);var h=c/((this.scale.x+this.scale.y+this.scale.z)/3),l=h*h,u=new Ue,p=new Ue;if(a.isBufferGeometry){var d=a.index,f=a.attributes.position.array;if(null!==d)for(var m=d.array,g=0,v=m.length;g<v;g++){var y=m[g];u.fromArray(f,3*y),_(u,y)}else{g=0;for(var x=f.length/3;g<x;g++)u.fromArray(f,3*g),_(u,g)}}else{var b=a.vertices;for(g=0,x=b.length;g<x;g++)_(b[g],g)}}function _(t,r){var a=e.distanceSqToPoint(t);if(a<l){e.closestPointToPoint(t,p),p.applyMatrix4(s);var c=n.ray.origin.distanceTo(p);if(c<n.near||c>n.far)return;i.push({distance:c,distanceToRay:Math.sqrt(a),point:p.clone(),index:r,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),qa.prototype=Object.assign(Object.create(ui.prototype),{constructor:qa,isGroup:!0}),Ya.prototype=Object.assign(Object.create(ze.prototype),{constructor:Ya,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Za.prototype=Object.create(ze.prototype),Za.prototype.constructor=Za,Za.prototype.isCompressedTexture=!0,Ja.prototype=Object.create(ze.prototype),Ja.prototype.constructor=Ja,Ja.prototype.isDepthTexture=!0,Qa.prototype=Object.create(Pi.prototype),Qa.prototype.constructor=Qa,Ka.prototype=Object.create(gi.prototype),Ka.prototype.constructor=Ka,$a.prototype=Object.create(Pi.prototype),$a.prototype.constructor=$a,ts.prototype=Object.create(gi.prototype),ts.prototype.constructor=ts,es.prototype=Object.create(Pi.prototype),es.prototype.constructor=es,rs.prototype=Object.create(gi.prototype),rs.prototype.constructor=rs,ns.prototype=Object.create(es.prototype),ns.prototype.constructor=ns,is.prototype=Object.create(gi.prototype),is.prototype.constructor=is,os.prototype=Object.create(es.prototype),os.prototype.constructor=os,as.prototype=Object.create(gi.prototype),as.prototype.constructor=as,ss.prototype=Object.create(es.prototype),ss.prototype.constructor=ss,cs.prototype=Object.create(gi.prototype),cs.prototype.constructor=cs,hs.prototype=Object.create(es.prototype),hs.prototype.constructor=hs,ls.prototype=Object.create(gi.prototype),ls.prototype.constructor=ls,us.prototype=Object.create(Pi.prototype),us.prototype.constructor=us,ps.prototype=Object.create(gi.prototype),ps.prototype.constructor=ps,ds.prototype=Object.create(Pi.prototype),ds.prototype.constructor=ds,fs.prototype=Object.create(gi.prototype),fs.prototype.constructor=fs,ms.prototype=Object.create(Pi.prototype),ms.prototype.constructor=ms;var gs={triangulate:function(t,e,r){r=r||2;var n,i,o,a,s,c,h,l=e&&e.length,u=l?e[0]*r:t.length,p=vs(t,0,u,r,!0),d=[];if(!p)return d;if(l&&(p=Es(t,e,p,r)),t.length>80*r){n=o=t[0],i=a=t[1];for(var f=r;f<u;f+=r)(s=t[f])<n&&(n=s),(c=t[f+1])<i&&(i=c),s>o&&(o=s),c>a&&(a=c);h=0!==(h=Math.max(o-n,a-i))?1/h:0}return xs(p,d,r,n,i,h),d}};function vs(t,e,r,n,i){var o,a;if(i===js(t,e,r,n)>0)for(o=e;o<r;o+=n)a=Hs(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=Hs(o,t[o],t[o+1],a);return a&&Ds(a,a.next)&&(Vs(a),a=a.next),a}function ys(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Ds(n,n.next)&&0!==Ns(n.prev,n,n.next))n=n.next;else{if(Vs(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function xs(t,e,r,n,i,o,a){if(t){!a&&o&&Rs(t,n,i,o);for(var s,c,h=t;t.prev!==t.next;)if(s=t.prev,c=t.next,o?_s(t,n,i,o):bs(t))e.push(s.i/r),e.push(t.i/r),e.push(c.i/r),Vs(t),t=c.next,h=c.next;else if((t=c)===h){a?1===a?xs(t=ws(t,e,r),e,r,n,i,o,2):2===a&&Ms(t,e,r,n,i,o):xs(ys(t),e,r,n,i,o,1);break}}}function bs(t){var e=t.prev,r=t,n=t.next;if(Ns(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Os(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Ns(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function _s(t,e,r,n){var i=t.prev,o=t,a=t.next;if(Ns(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,h=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,u=Ps(s,c,e,r,n),p=Ps(h,l,e,r,n),d=t.nextZ;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&Os(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Ns(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&Os(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Ns(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function ws(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!Ds(i,o)&&Us(i,n,n.next,o)&&Fs(i,o)&&Fs(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),Vs(n),Vs(n.next),n=t=o),n=n.next}while(n!==t);return n}function Ms(t,e,r,n,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Is(a,s)){var c=Gs(a,s);return a=ys(a,a.next),c=ys(c,c.next),xs(a,e,r,n,i,o),void xs(c,e,r,n,i,o)}s=s.next}a=a.next}while(a!==t)}function Es(t,e,r,n){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=vs(t,e[i]*n,i<o-1?e[i+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),s.push(Cs(a));for(s.sort(Ts),i=0;i<s.length;i++)Ss(s[i],r),r=ys(r,r.next);return r}function Ts(t,e){return t.x-e.x}function Ss(t,e){if(e=As(t,e)){var r=Gs(e,t);ys(r,r.next)}}function As(t,e){var r,n=e,i=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===a)return r.prev;var c,h=r,l=r.x,u=r.y,p=1/0;for(n=r.next;n!==h;)i>=n.x&&n.x>=l&&i!==n.x&&Os(o<u?i:a,o,l,u,o<u?a:i,o,n.x,n.y)&&((c=Math.abs(o-n.y)/(i-n.x))<p||c===p&&n.x>r.x)&&Fs(n,t)&&(r=n,p=c),n=n.next;return r}function Rs(t,e,r,n){var i=t;do{null===i.z&&(i.z=Ps(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Ls(i)}function Ls(t){var e,r,n,i,o,a,s,c,h=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<h&&(s++,n=n.nextZ);e++);for(c=h;s>0||c>0&&n;)0!==s&&(0===c||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,c--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,h*=2}while(a>1);return t}function Ps(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Cs(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function Os(t,e,r,n,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function Is(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Bs(t,e)&&Fs(t,e)&&Fs(e,t)&&zs(t,e)}function Ns(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Ds(t,e){return t.x===e.x&&t.y===e.y}function Us(t,e,r,n){return!!(Ds(t,e)&&Ds(r,n)||Ds(t,n)&&Ds(r,e))||Ns(t,e,r)>0!=Ns(t,e,n)>0&&Ns(r,n,t)>0!=Ns(r,n,e)>0}function Bs(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Us(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Fs(t,e){return Ns(t.prev,t,t.next)<0?Ns(t,e,t.next)>=0&&Ns(t,t.prev,e)>=0:Ns(t,e,t.prev)<0||Ns(t,t.next,e)<0}function zs(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}function Gs(t,e){var r=new ks(t.i,t.x,t.y),n=new ks(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Hs(t,e,r,n){var i=new ks(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Vs(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ks(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function js(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}var Ws={area:function(t){for(var e=t.length,r=0,n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},isClockWise:function(t){return Ws.area(t)<0},triangulateShape:function(t,e){var r=[],n=[],i=[];Xs(t),qs(r,t);var o=t.length;e.forEach(Xs);for(var a=0;a<e.length;a++)n.push(o),o+=e[a].length,qs(r,e[a]);var s=gs.triangulate(r,n);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function Xs(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function qs(t,e){for(var r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}function Ys(t,e){gi.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Zs(t,e)),this.mergeVertices()}function Zs(t,e){Pi.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var r=this,n=[],i=[],o=0,a=t.length;o<a;o++){s(t[o])}function s(t){var o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,c=void 0!==e.depth?e.depth:100,h=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,u=void 0!==e.bevelSize?e.bevelSize:l-2,p=void 0!==e.bevelSegments?e.bevelSegments:3,d=e.extrudePath,f=void 0!==e.UVGenerator?e.UVGenerator:Js;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=e.amount);var m,g,v,y,x,b,_,w,M=!1;d&&(m=d.getSpacedPoints(s),M=!0,h=!1,g=d.computeFrenetFrames(s,!1),v=new Ue,y=new Ue,x=new Ue),h||(p=0,l=0,u=0);var E=t.extractPoints(a),T=E.shape,S=E.holes;if(!Ws.isClockWise(T))for(T=T.reverse(),_=0,w=S.length;_<w;_++)b=S[_],Ws.isClockWise(b)&&(S[_]=b.reverse());var A=Ws.triangulateShape(T,S),R=T;for(_=0,w=S.length;_<w;_++)b=S[_],T=T.concat(b);function L(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t)}var P,C,O,I,N,D,U=T.length,B=A.length;function F(t,e,r){var n,i,o,a=t.x-e.x,s=t.y-e.y,c=r.x-t.x,h=r.y-t.y,l=a*a+s*s,u=a*h-s*c;if(Math.abs(u)>Number.EPSILON){var p=Math.sqrt(l),d=Math.sqrt(c*c+h*h),f=e.x-s/p,m=e.y+a/p,g=((r.x-h/d-f)*h-(r.y+c/d-m)*c)/(a*h-s*c),v=(n=f+a*g-t.x)*n+(i=m+s*g-t.y)*i;if(v<=2)return new Ie(n,i);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?c>Number.EPSILON&&(y=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(h)&&(y=!0),y?(n=-s,i=a,o=Math.sqrt(l)):(n=a,i=s,o=Math.sqrt(l/2))}return new Ie(n/o,i/o)}for(var z=[],G=0,H=R.length,V=H-1,k=G+1;G<H;G++,V++,k++)V===H&&(V=0),k===H&&(k=0),z[G]=F(R[G],R[V],R[k]);var j,W,X=[],q=z.concat();for(_=0,w=S.length;_<w;_++){for(b=S[_],j=[],G=0,V=(H=b.length)-1,k=G+1;G<H;G++,V++,k++)V===H&&(V=0),k===H&&(k=0),j[G]=F(b[G],b[V],b[k]);X.push(j),q=q.concat(j)}for(P=0;P<p;P++){for(O=P/p,I=l*Math.cos(O*Math.PI/2),C=u*Math.sin(O*Math.PI/2),G=0,H=R.length;G<H;G++)Z((N=L(R[G],z[G],C)).x,N.y,-I);for(_=0,w=S.length;_<w;_++)for(b=S[_],j=X[_],G=0,H=b.length;G<H;G++)Z((N=L(b[G],j[G],C)).x,N.y,-I)}for(C=u,G=0;G<U;G++)N=h?L(T[G],q[G],C):T[G],M?(y.copy(g.normals[0]).multiplyScalar(N.x),v.copy(g.binormals[0]).multiplyScalar(N.y),x.copy(m[0]).add(y).add(v),Z(x.x,x.y,x.z)):Z(N.x,N.y,0);for(W=1;W<=s;W++)for(G=0;G<U;G++)N=h?L(T[G],q[G],C):T[G],M?(y.copy(g.normals[W]).multiplyScalar(N.x),v.copy(g.binormals[W]).multiplyScalar(N.y),x.copy(m[W]).add(y).add(v),Z(x.x,x.y,x.z)):Z(N.x,N.y,c/s*W);for(P=p-1;P>=0;P--){for(O=P/p,I=l*Math.cos(O*Math.PI/2),C=u*Math.sin(O*Math.PI/2),G=0,H=R.length;G<H;G++)Z((N=L(R[G],z[G],C)).x,N.y,c+I);for(_=0,w=S.length;_<w;_++)for(b=S[_],j=X[_],G=0,H=b.length;G<H;G++)N=L(b[G],j[G],C),M?Z(N.x,N.y+m[s-1].y,m[s-1].x+I):Z(N.x,N.y,c+I)}function Y(t,e){var r,n;for(G=t.length;--G>=0;){r=G,(n=G-1)<0&&(n=t.length-1);var i=0,o=s+2*p;for(i=0;i<o;i++){var a=U*i,c=U*(i+1);Q(e+r+a,e+n+a,e+n+c,e+r+c)}}}function Z(t,e,r){o.push(t),o.push(e),o.push(r)}function J(t,e,i){K(t),K(e),K(i);var o=n.length/3,a=f.generateTopUV(r,n,o-3,o-2,o-1);$(a[0]),$(a[1]),$(a[2])}function Q(t,e,i,o){K(t),K(e),K(o),K(e),K(i),K(o);var a=n.length/3,s=f.generateSideWallUV(r,n,a-6,a-3,a-2,a-1);$(s[0]),$(s[1]),$(s[3]),$(s[1]),$(s[2]),$(s[3])}function K(t){n.push(o[3*t+0]),n.push(o[3*t+1]),n.push(o[3*t+2])}function $(t){i.push(t.x),i.push(t.y)}!function(){var t=n.length/3;if(h){var e=0,i=U*e;for(G=0;G<B;G++)J((D=A[G])[2]+i,D[1]+i,D[0]+i);for(i=U*(e=s+2*p),G=0;G<B;G++)J((D=A[G])[0]+i,D[1]+i,D[2]+i)}else{for(G=0;G<B;G++)J((D=A[G])[2],D[1],D[0]);for(G=0;G<B;G++)J((D=A[G])[0]+U*s,D[1]+U*s,D[2]+U*s)}r.addGroup(t,n.length/3-t,0)}(),function(){var t=n.length/3,e=0;for(Y(R,e),e+=R.length,_=0,w=S.length;_<w;_++)Y(b=S[_],e),e+=b.length;r.addGroup(t,n.length/3-t,1)}()}this.addAttribute("position",new Ti(n,3)),this.addAttribute("uv",new Ti(i,2)),this.computeVertexNormals()}Ys.prototype=Object.create(gi.prototype),Ys.prototype.constructor=Ys,Ys.prototype.toJSON=function(){var t=gi.prototype.toJSON.call(this);return Qs(this.parameters.shapes,this.parameters.options,t)},Zs.prototype=Object.create(Pi.prototype),Zs.prototype.constructor=Zs,Zs.prototype.toJSON=function(){var t=Pi.prototype.toJSON.call(this);return Qs(this.parameters.shapes,this.parameters.options,t)};var Js={generateTopUV:function(t,e,r,n,i){var o=e[3*r],a=e[3*r+1],s=e[3*n],c=e[3*n+1],h=e[3*i],l=e[3*i+1];return[new Ie(o,a),new Ie(s,c),new Ie(h,l)]},generateSideWallUV:function(t,e,r,n,i,o){var a=e[3*r],s=e[3*r+1],c=e[3*r+2],h=e[3*n],l=e[3*n+1],u=e[3*n+2],p=e[3*i],d=e[3*i+1],f=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-l)<.01?[new Ie(a,1-c),new Ie(h,1-u),new Ie(p,1-f),new Ie(m,1-v)]:[new Ie(s,1-c),new Ie(l,1-u),new Ie(d,1-f),new Ie(g,1-v)]}};function Qs(t,e,r){if(r.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++){var o=t[n];r.shapes.push(o.uuid)}else r.shapes.push(t.uuid);return void 0!==e.extrudePath&&(r.options.extrudePath=e.extrudePath.toJSON()),r}function Ks(t,e){gi.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new $s(t,e)),this.mergeVertices()}function $s(t,e){var r=(e=e||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new gi;var n=r.generateShapes(t,e.size,e.curveSegments);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Zs.call(this,n,e),this.type="TextBufferGeometry"}function tc(t,e,r,n,i,o,a){gi.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new ec(t,e,r,n,i,o,a)),this.mergeVertices()}function ec(t,e,r,n,i,o,a){Pi.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var s,c,h=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),l=0,u=[],p=new Ue,d=new Ue,f=[],m=[],g=[],v=[];for(c=0;c<=r;c++){var y=[],x=c/r;for(s=0;s<=e;s++){var b=s/e;p.x=-t*Math.cos(n+b*i)*Math.sin(o+x*a),p.y=t*Math.cos(o+x*a),p.z=t*Math.sin(n+b*i)*Math.sin(o+x*a),m.push(p.x,p.y,p.z),d.set(p.x,p.y,p.z).normalize(),g.push(d.x,d.y,d.z),v.push(b,1-x),y.push(l++)}u.push(y)}for(c=0;c<r;c++)for(s=0;s<e;s++){var _=u[c][s+1],w=u[c][s],M=u[c+1][s],E=u[c+1][s+1];(0!==c||o>0)&&f.push(_,w,E),(c!==r-1||h<Math.PI)&&f.push(w,M,E)}this.setIndex(f),this.addAttribute("position",new Ti(m,3)),this.addAttribute("normal",new Ti(g,3)),this.addAttribute("uv",new Ti(v,2))}function rc(t,e,r,n,i,o){gi.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new nc(t,e,r,n,i,o)),this.mergeVertices()}function nc(t,e,r,n,i,o){Pi.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var a,s,c,h=[],l=[],u=[],p=[],d=t,f=(e-t)/(n=void 0!==n?Math.max(1,n):1),m=new Ue,g=new Ie;for(s=0;s<=n;s++){for(c=0;c<=r;c++)a=i+c/r*o,m.x=d*Math.cos(a),m.y=d*Math.sin(a),l.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,p.push(g.x,g.y);d+=f}for(s=0;s<n;s++){var v=s*(r+1);for(c=0;c<r;c++){var y=a=c+v,x=a+r+1,b=a+r+2,_=a+1;h.push(y,x,_),h.push(x,b,_)}}this.setIndex(h),this.addAttribute("position",new Ti(l,3)),this.addAttribute("normal",new Ti(u,3)),this.addAttribute("uv",new Ti(p,2))}function ic(t,e,r,n){gi.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},this.fromBufferGeometry(new oc(t,e,r,n)),this.mergeVertices()}function oc(t,e,r,n){Pi.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},e=Math.floor(e)||12,r=r||0,n=n||2*Math.PI,n=Oe.clamp(n,0,2*Math.PI);var i,o,a,s=[],c=[],h=[],l=1/e,u=new Ue,p=new Ie;for(o=0;o<=e;o++){var d=r+o*l*n,f=Math.sin(d),m=Math.cos(d);for(a=0;a<=t.length-1;a++)u.x=t[a].x*f,u.y=t[a].y,u.z=t[a].x*m,c.push(u.x,u.y,u.z),p.x=o/e,p.y=a/(t.length-1),h.push(p.x,p.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var g=i=a+o*t.length,v=i+t.length,y=i+t.length+1,x=i+1;s.push(g,v,x),s.push(v,y,x)}if(this.setIndex(s),this.addAttribute("position",new Ti(c,3)),this.addAttribute("uv",new Ti(h,2)),this.computeVertexNormals(),n===2*Math.PI){var b=this.attributes.normal.array,_=new Ue,w=new Ue,M=new Ue;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)_.x=b[a+0],_.y=b[a+1],_.z=b[a+2],w.x=b[i+a+0],w.y=b[i+a+1],w.z=b[i+a+2],M.addVectors(_,w).normalize(),b[a+0]=b[i+a+0]=M.x,b[a+1]=b[i+a+1]=M.y,b[a+2]=b[i+a+2]=M.z}}function ac(t,e){gi.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new sc(t,e)),this.mergeVertices()}function sc(t,e){Pi.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],n=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))h(t);else for(var c=0;c<t.length;c++)h(t[c]),this.addGroup(a,s,c),a+=s,s=0;function h(t){var a,c,h,l=n.length/3,u=t.extractPoints(e),p=u.shape,d=u.holes;if(!1===Ws.isClockWise(p))for(p=p.reverse(),a=0,c=d.length;a<c;a++)h=d[a],!0===Ws.isClockWise(h)&&(d[a]=h.reverse());var f=Ws.triangulateShape(p,d);for(a=0,c=d.length;a<c;a++)h=d[a],p=p.concat(h);for(a=0,c=p.length;a<c;a++){var m=p[a];n.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,c=f.length;a<c;a++){var g=f[a],v=g[0]+l,y=g[1]+l,x=g[2]+l;r.push(v,y,x),s+=3}}this.setIndex(r),this.addAttribute("position",new Ti(n,3)),this.addAttribute("normal",new Ti(i,3)),this.addAttribute("uv",new Ti(o,2))}function cc(t,e){if(e.shapes=[],Array.isArray(t))for(var r=0,n=t.length;r<n;r++){var i=t[r];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function hc(t,e){Pi.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var r,n,i,o,a=[],s=Math.cos(Oe.DEG2RAD*e),c=[0,0],h={},l=["a","b","c"];t.isBufferGeometry?(o=new gi).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var u=o.vertices,p=o.faces,d=0,f=p.length;d<f;d++)for(var m=p[d],g=0;g<3;g++)r=m[l[g]],n=m[l[(g+1)%3]],c[0]=Math.min(r,n),c[1]=Math.max(r,n),void 0===h[i=c[0]+","+c[1]]?h[i]={index1:c[0],index2:c[1],face1:d,face2:void 0}:h[i].face2=d;for(i in h){var v=h[i];if(void 0===v.face2||p[v.face1].normal.dot(p[v.face2].normal)<=s){var y=u[v.index1];a.push(y.x,y.y,y.z),y=u[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new Ti(a,3))}function lc(t,e,r,n,i,o,a,s){gi.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new uc(t,e,r,n,i,o,a,s)),this.mergeVertices()}function uc(t,e,r,n,i,o,a,s){Pi.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var h=[],l=[],u=[],p=[],d=0,f=[],m=r/2,g=0;function v(r){var i,o,f,v=new Ie,y=new Ue,x=0,b=!0===r?t:e,_=!0===r?1:-1;for(o=d,i=1;i<=n;i++)l.push(0,m*_,0),u.push(0,_,0),p.push(.5,.5),d++;for(f=d,i=0;i<=n;i++){var w=i/n*s+a,M=Math.cos(w),E=Math.sin(w);y.x=b*E,y.y=m*_,y.z=b*M,l.push(y.x,y.y,y.z),u.push(0,_,0),v.x=.5*M+.5,v.y=.5*E*_+.5,p.push(v.x,v.y),d++}for(i=0;i<n;i++){var T=o+i,S=f+i;!0===r?h.push(S,S+1,T):h.push(S+1,S,T),x+=3}c.addGroup(g,x,!0===r?1:2),g+=x}!function(){var o,v,y=new Ue,x=new Ue,b=0,_=(e-t)/r;for(v=0;v<=i;v++){var w=[],M=v/i,E=M*(e-t)+t;for(o=0;o<=n;o++){var T=o/n,S=T*s+a,A=Math.sin(S),R=Math.cos(S);x.x=E*A,x.y=-M*r+m,x.z=E*R,l.push(x.x,x.y,x.z),y.set(A,_,R).normalize(),u.push(y.x,y.y,y.z),p.push(T,1-M),w.push(d++)}f.push(w)}for(o=0;o<n;o++)for(v=0;v<i;v++){var L=f[v][o],P=f[v+1][o],C=f[v+1][o+1],O=f[v][o+1];h.push(L,P,O),h.push(P,C,O),b+=6}c.addGroup(g,b,0),g+=b}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(h),this.addAttribute("position",new Ti(l,3)),this.addAttribute("normal",new Ti(u,3)),this.addAttribute("uv",new Ti(p,2))}function pc(t,e,r,n,i,o,a){lc.call(this,0,t,e,r,n,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function dc(t,e,r,n,i,o,a){uc.call(this,0,t,e,r,n,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function fc(t,e,r,n){gi.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new mc(t,e,r,n)),this.mergeVertices()}function mc(t,e,r,n){Pi.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,o,a=[],s=[],c=[],h=[],l=new Ue,u=new Ie;for(s.push(0,0,0),c.push(0,0,1),h.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var p=r+o/e*n;l.x=t*Math.cos(p),l.y=t*Math.sin(p),s.push(l.x,l.y,l.z),c.push(0,0,1),u.x=(s[i]/t+1)/2,u.y=(s[i+1]/t+1)/2,h.push(u.x,u.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new Ti(s,3)),this.addAttribute("normal",new Ti(c,3)),this.addAttribute("uv",new Ti(h,2))}Ks.prototype=Object.create(gi.prototype),Ks.prototype.constructor=Ks,$s.prototype=Object.create(Zs.prototype),$s.prototype.constructor=$s,tc.prototype=Object.create(gi.prototype),tc.prototype.constructor=tc,ec.prototype=Object.create(Pi.prototype),ec.prototype.constructor=ec,rc.prototype=Object.create(gi.prototype),rc.prototype.constructor=rc,nc.prototype=Object.create(Pi.prototype),nc.prototype.constructor=nc,ic.prototype=Object.create(gi.prototype),ic.prototype.constructor=ic,oc.prototype=Object.create(Pi.prototype),oc.prototype.constructor=oc,ac.prototype=Object.create(gi.prototype),ac.prototype.constructor=ac,ac.prototype.toJSON=function(){var t=gi.prototype.toJSON.call(this);return cc(this.parameters.shapes,t)},sc.prototype=Object.create(Pi.prototype),sc.prototype.constructor=sc,sc.prototype.toJSON=function(){var t=Pi.prototype.toJSON.call(this);return cc(this.parameters.shapes,t)},hc.prototype=Object.create(Pi.prototype),hc.prototype.constructor=hc,lc.prototype=Object.create(gi.prototype),lc.prototype.constructor=lc,uc.prototype=Object.create(Pi.prototype),uc.prototype.constructor=uc,pc.prototype=Object.create(lc.prototype),pc.prototype.constructor=pc,dc.prototype=Object.create(uc.prototype),dc.prototype.constructor=dc,fc.prototype=Object.create(gi.prototype),fc.prototype.constructor=fc,mc.prototype=Object.create(Pi.prototype),mc.prototype.constructor=mc;var gc=Object.freeze({WireframeGeometry:Qa,ParametricGeometry:Ka,ParametricBufferGeometry:$a,TetrahedronGeometry:rs,TetrahedronBufferGeometry:ns,OctahedronGeometry:is,OctahedronBufferGeometry:os,IcosahedronGeometry:as,IcosahedronBufferGeometry:ss,DodecahedronGeometry:cs,DodecahedronBufferGeometry:hs,PolyhedronGeometry:ts,PolyhedronBufferGeometry:es,TubeGeometry:ls,TubeBufferGeometry:us,TorusKnotGeometry:ps,TorusKnotBufferGeometry:ds,TorusGeometry:fs,TorusBufferGeometry:ms,TextGeometry:Ks,TextBufferGeometry:$s,SphereGeometry:tc,SphereBufferGeometry:ec,RingGeometry:rc,RingBufferGeometry:nc,PlaneGeometry:Ii,PlaneBufferGeometry:Ni,LatheGeometry:ic,LatheBufferGeometry:oc,ShapeGeometry:ac,ShapeBufferGeometry:sc,ExtrudeGeometry:Ys,ExtrudeBufferGeometry:Zs,EdgesGeometry:hc,ConeGeometry:pc,ConeBufferGeometry:dc,CylinderGeometry:lc,CylinderBufferGeometry:uc,CircleGeometry:fc,CircleBufferGeometry:mc,BoxGeometry:Ci,BoxBufferGeometry:Oi});function vc(t){Ui.call(this),this.type="ShadowMaterial",this.color=new ni(0),this.transparent=!0,this.setValues(t)}function yc(t){Fi.call(this,t),this.type="RawShaderMaterial"}function xc(t){Ui.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ni(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ni(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function bc(t){xc.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function _c(t){Ui.call(this),this.type="MeshPhongMaterial",this.color=new ni(16777215),this.specular=new ni(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ni(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function wc(t){_c.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Mc(t){Ui.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ec(t){Ui.call(this),this.type="MeshLambertMaterial",this.color=new ni(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ni(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Tc(t){Ha.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}vc.prototype=Object.create(Ui.prototype),vc.prototype.constructor=vc,vc.prototype.isShadowMaterial=!0,vc.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this},yc.prototype=Object.create(Fi.prototype),yc.prototype.constructor=yc,yc.prototype.isRawShaderMaterial=!0,xc.prototype=Object.create(Ui.prototype),xc.prototype.constructor=xc,xc.prototype.isMeshStandardMaterial=!0,xc.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},bc.prototype=Object.create(xc.prototype),bc.prototype.constructor=bc,bc.prototype.isMeshPhysicalMaterial=!0,bc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},_c.prototype=Object.create(Ui.prototype),_c.prototype.constructor=_c,_c.prototype.isMeshPhongMaterial=!0,_c.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},wc.prototype=Object.create(_c.prototype),wc.prototype.constructor=wc,wc.prototype.isMeshToonMaterial=!0,wc.prototype.copy=function(t){return _c.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},Mc.prototype=Object.create(Ui.prototype),Mc.prototype.constructor=Mc,Mc.prototype.isMeshNormalMaterial=!0,Mc.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ec.prototype=Object.create(Ui.prototype),Ec.prototype.constructor=Ec,Ec.prototype.isMeshLambertMaterial=!0,Ec.prototype.copy=function(t){return Ui.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Tc.prototype=Object.create(Ha.prototype),Tc.prototype.constructor=Tc,Tc.prototype.isLineDashedMaterial=!0,Tc.prototype.copy=function(t){return Ha.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Sc=Object.freeze({ShadowMaterial:vc,SpriteMaterial:Da,RawShaderMaterial:yc,ShaderMaterial:Fi,PointsMaterial:Wa,MeshPhysicalMaterial:bc,MeshStandardMaterial:xc,MeshPhongMaterial:_c,MeshToonMaterial:wc,MeshNormalMaterial:Mc,MeshLambertMaterial:Ec,MeshDepthMaterial:xa,MeshDistanceMaterial:ba,MeshBasicMaterial:Bi,LineDashedMaterial:Tc,LineBasicMaterial:Ha,Material:Ui}),Ac={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Rc(t,e,r){var n=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){a++,!1===i&&void 0!==n.onStart&&n.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}var Lc=new Rc,Pc={};function Cc(t){this.manager=void 0!==t?t:Lc}function Oc(t){this.manager=void 0!==t?t:Lc,this._parser=null}function Ic(t){this.manager=void 0!==t?t:Lc,this._parser=null}function Nc(t){this.manager=void 0!==t?t:Lc}function Dc(t){this.manager=void 0!==t?t:Lc}function Uc(t){this.manager=void 0!==t?t:Lc}function Bc(){this.type="Curve",this.arcLengthDivisions=200}function Fc(t,e,r,n,i,o,a,s){Bc.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function zc(t,e,r,n,i,o){Fc.call(this,t,e,r,r,n,i,o),this.type="ArcCurve"}function Gc(){var t=0,e=0,r=0,n=0;function i(i,o,a,s){t=i,e=a,r=-3*i+3*o-2*a-s,n=2*i-2*o+a+s}return{initCatmullRom:function(t,e,r,n,o){i(e,r,o*(r-t),o*(n-e))},initNonuniformCatmullRom:function(t,e,r,n,o,a,s){var c=(e-t)/o-(r-t)/(o+a)+(r-e)/a,h=(r-e)/a-(n-e)/(a+s)+(n-r)/s;i(e,r,c*=a,h*=a)},calc:function(i){var o=i*i;return t+e*i+r*o+n*(o*i)}}}Object.assign(Cc.prototype,{load:function(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Ac.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0===Pc[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],h=a[3];h=window.decodeURIComponent(h),c&&(h=window.atob(h));try{var l,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var p=new Uint8Array(h.length),d=0;d<h.length;d++)p[d]=h.charCodeAt(d);l="blob"===u?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var f=new DOMParser;l=f.parseFromString(h,s);break;case"json":l=JSON.parse(h);break;default:l=h}window.setTimeout(function(){e&&e(l),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){n&&n(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{Pc[t]=[],Pc[t].push({onLoad:e,onProgress:r,onError:n});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",function(e){var r=this.response;Ac.add(t,r);var n=Pc[t];if(delete Pc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,a=n.length;o<a;o++){(s=n[o]).onLoad&&s.onLoad(r)}i.manager.itemEnd(t)}else{for(o=0,a=n.length;o<a;o++){var s;(s=n[o]).onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}},!1),m.addEventListener("progress",function(e){for(var r=Pc[t],n=0,i=r.length;n<i;n++){var o=r[n];o.onProgress&&o.onProgress(e)}},!1),m.addEventListener("error",function(e){var r=Pc[t];delete Pc[t];for(var n=0,o=r.length;n<o;n++){var a=r[n];a.onError&&a.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(t),m}Pc[t].push({onLoad:e,onProgress:r,onError:n})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(Oc.prototype,{load:function(t,e,r,n){var i=this,o=[],a=new Za;a.image=o;var s=new Cc(this.manager);function c(c){s.load(t[c],function(t){var r=i._parser(t,!0);o[c]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(h+=1)&&(1===r.mipmapCount&&(a.minFilter=yt),a.format=r.format,a.needsUpdate=!0,e&&e(a))},r,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var h=0,l=0,u=t.length;l<u;++l)c(l);else s.load(t,function(t){var r=i._parser(t,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var c=0;c<r.mipmapCount;c++)o[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+c]),o[s].format=r.format,o[s].width=r.width,o[s].height=r.height}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=yt),a.format=r.format,a.needsUpdate=!0,e&&e(a)},r,n);return a},setPath:function(t){return this.path=t,this}}),Object.assign(Ic.prototype,{load:function(t,e,r,n){var i=this,o=new ke,a=new Cc(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var r=i._parser(t);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:dt,o.wrapT=void 0!==r.wrapT?r.wrapT:dt,o.magFilter=void 0!==r.magFilter?r.magFilter:yt,o.minFilter=void 0!==r.minFilter?r.minFilter:bt,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=yt),o.needsUpdate=!0,e&&e(o,r))},r,n),o}}),Object.assign(Nc.prototype,{crossOrigin:"Anonymous",load:function(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Ac.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),Ac.add(t,this),e&&e(this),i.manager.itemEnd(t)}function c(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),n&&n(e),i.manager.itemEnd(t),i.manager.itemError(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Dc.prototype,{crossOrigin:"Anonymous",load:function(t,e,r,n){var i=new to,o=new Nc(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(r){o.load(t[r],function(t){i.images[r]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))},void 0,n)}for(var c=0;c<t.length;++c)s(c);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Uc.prototype,{crossOrigin:"Anonymous",load:function(t,e,r,n){var i=new ze,o=new Nc(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(r){i.image=r;var n=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=n?Nt:Dt,i.needsUpdate=!0,void 0!==e&&e(i)},r,n),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Bc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var r=this.getUtoTmapping(t);return this.getPoint(r,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=t;r++)o+=(e=this.getPoint(r/t)).distanceTo(i),n.push(o),i=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var r,n=this.getLengths(),i=0,o=n.length;r=e||t*n[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=n[i=Math.floor(s+(c-s)/2)]-r)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(n[i=c]===r)return i/(o-1);var h=n[i];return(i+(r-h)/(n[i+1]-h))/(o-1)},getTangent:function(t){var e=t-1e-4,r=t+1e-4;e<0&&(e=0),r>1&&(r=1);var n=this.getPoint(e);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var r,n,i,o=new Ue,a=[],s=[],c=[],h=new Ue,l=new Ne;for(r=0;r<=t;r++)n=r/t,a[r]=this.getTangentAt(n),a[r].normalize();s[0]=new Ue,c[0]=new Ue;var u=Number.MAX_VALUE,p=Math.abs(a[0].x),d=Math.abs(a[0].y),f=Math.abs(a[0].z);for(p<=u&&(u=p,o.set(1,0,0)),d<=u&&(u=d,o.set(0,1,0)),f<=u&&o.set(0,0,1),h.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],h),c[0].crossVectors(a[0],s[0]),r=1;r<=t;r++)s[r]=s[r-1].clone(),c[r]=c[r-1].clone(),h.crossVectors(a[r-1],a[r]),h.length()>Number.EPSILON&&(h.normalize(),i=Math.acos(Oe.clamp(a[r-1].dot(a[r]),-1,1)),s[r].applyMatrix4(l.makeRotationAxis(h,i))),c[r].crossVectors(a[r],s[r]);if(!0===e)for(i=Math.acos(Oe.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(h.crossVectors(s[0],s[t]))>0&&(i=-i),r=1;r<=t;r++)s[r].applyMatrix4(l.makeRotationAxis(a[r],i*r)),c[r].crossVectors(a[r],s[r]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Fc.prototype=Object.create(Bc.prototype),Fc.prototype.constructor=Fc,Fc.prototype.isEllipseCurve=!0,Fc.prototype.getPoint=function(t,e){for(var r=e||new Ie,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=o?0:n),!0!==this.aClockwise||o||(i===n?i=-n:i-=n);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var h=Math.cos(this.aRotation),l=Math.sin(this.aRotation),u=s-this.aX,p=c-this.aY;s=u*h-p*l+this.aX,c=u*l+p*h+this.aY}return r.set(s,c)},Fc.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Fc.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Fc.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},zc.prototype=Object.create(Fc.prototype),zc.prototype.constructor=zc,zc.prototype.isArcCurve=!0;var Hc=new Ue,Vc=new Gc,kc=new Gc,jc=new Gc;function Wc(t,e,r,n){Bc.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=r||"centripetal",this.tension=n||.5}function Xc(t,e,r,n,i){var o=.5*(n-e),a=.5*(i-r),s=t*t;return(2*r-2*n+o+a)*(t*s)+(-3*r+3*n-2*o-a)*s+o*t+r}function qc(t,e){var r=1-t;return r*r*e}function Yc(t,e){return 2*(1-t)*t*e}function Zc(t,e){return t*t*e}function Jc(t,e,r,n){return qc(t,e)+Yc(t,r)+Zc(t,n)}function Qc(t,e){var r=1-t;return r*r*r*e}function Kc(t,e){var r=1-t;return 3*r*r*t*e}function $c(t,e){return 3*(1-t)*t*t*e}function th(t,e){return t*t*t*e}function eh(t,e,r,n,i){return Qc(t,e)+Kc(t,r)+$c(t,n)+th(t,i)}function rh(t,e,r,n){Bc.call(this),this.type="CubicBezierCurve",this.v0=t||new Ie,this.v1=e||new Ie,this.v2=r||new Ie,this.v3=n||new Ie}function nh(t,e,r,n){Bc.call(this),this.type="CubicBezierCurve3",this.v0=t||new Ue,this.v1=e||new Ue,this.v2=r||new Ue,this.v3=n||new Ue}function ih(t,e){Bc.call(this),this.type="LineCurve",this.v1=t||new Ie,this.v2=e||new Ie}function oh(t,e){Bc.call(this),this.type="LineCurve3",this.v1=t||new Ue,this.v2=e||new Ue}function ah(t,e,r){Bc.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Ie,this.v1=e||new Ie,this.v2=r||new Ie}function sh(t,e,r){Bc.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Ue,this.v1=e||new Ue,this.v2=r||new Ue}function ch(t){Bc.call(this),this.type="SplineCurve",this.points=t||[]}Wc.prototype=Object.create(Bc.prototype),Wc.prototype.constructor=Wc,Wc.prototype.isCatmullRomCurve3=!0,Wc.prototype.getPoint=function(t,e){var r,n,i,o,a=e||new Ue,s=this.points,c=s.length,h=(c-(this.closed?0:1))*t,l=Math.floor(h),u=h-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/c)+1)*c:0===u&&l===c-1&&(l=c-2,u=1),this.closed||l>0?r=s[(l-1)%c]:(Hc.subVectors(s[0],s[1]).add(s[0]),r=Hc),n=s[l%c],i=s[(l+1)%c],this.closed||l+2<c?o=s[(l+2)%c]:(Hc.subVectors(s[c-1],s[c-2]).add(s[c-1]),o=Hc),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,d=Math.pow(r.distanceToSquared(n),p),f=Math.pow(n.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(o),p);f<1e-4&&(f=1),d<1e-4&&(d=f),m<1e-4&&(m=f),Vc.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,d,f,m),kc.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,d,f,m),jc.initNonuniformCatmullRom(r.z,n.z,i.z,o.z,d,f,m)}else"catmullrom"===this.curveType&&(Vc.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),kc.initCatmullRom(r.y,n.y,i.y,o.y,this.tension),jc.initCatmullRom(r.z,n.z,i.z,o.z,this.tension));return a.set(Vc.calc(u),kc.calc(u),jc.calc(u)),a},Wc.prototype.copy=function(t){Bc.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Wc.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++){var n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Wc.prototype.fromJSON=function(t){Bc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Ue).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},rh.prototype=Object.create(Bc.prototype),rh.prototype.constructor=rh,rh.prototype.isCubicBezierCurve=!0,rh.prototype.getPoint=function(t,e){var r=e||new Ie,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(eh(t,n.x,i.x,o.x,a.x),eh(t,n.y,i.y,o.y,a.y)),r},rh.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},rh.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},rh.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},nh.prototype=Object.create(Bc.prototype),nh.prototype.constructor=nh,nh.prototype.isCubicBezierCurve3=!0,nh.prototype.getPoint=function(t,e){var r=e||new Ue,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(eh(t,n.x,i.x,o.x,a.x),eh(t,n.y,i.y,o.y,a.y),eh(t,n.z,i.z,o.z,a.z)),r},nh.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},nh.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},nh.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ih.prototype=Object.create(Bc.prototype),ih.prototype.constructor=ih,ih.prototype.isLineCurve=!0,ih.prototype.getPoint=function(t,e){var r=e||new Ie;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},ih.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ih.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},ih.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ih.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ih.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},oh.prototype=Object.create(Bc.prototype),oh.prototype.constructor=oh,oh.prototype.isLineCurve3=!0,oh.prototype.getPoint=function(t,e){var r=e||new Ue;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},oh.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},oh.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},oh.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},oh.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ah.prototype=Object.create(Bc.prototype),ah.prototype.constructor=ah,ah.prototype.isQuadraticBezierCurve=!0,ah.prototype.getPoint=function(t,e){var r=e||new Ie,n=this.v0,i=this.v1,o=this.v2;return r.set(Jc(t,n.x,i.x,o.x),Jc(t,n.y,i.y,o.y)),r},ah.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ah.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ah.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},sh.prototype=Object.create(Bc.prototype),sh.prototype.constructor=sh,sh.prototype.isQuadraticBezierCurve3=!0,sh.prototype.getPoint=function(t,e){var r=e||new Ue,n=this.v0,i=this.v1,o=this.v2;return r.set(Jc(t,n.x,i.x,o.x),Jc(t,n.y,i.y,o.y),Jc(t,n.z,i.z,o.z)),r},sh.prototype.copy=function(t){return Bc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},sh.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},sh.prototype.fromJSON=function(t){return Bc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ch.prototype=Object.create(Bc.prototype),ch.prototype.constructor=ch,ch.prototype.isSplineCurve=!0,ch.prototype.getPoint=function(t,e){var r=e||new Ie,n=this.points,i=(n.length-1)*t,o=Math.floor(i),a=i-o,s=n[0===o?o:o-1],c=n[o],h=n[o>n.length-2?n.length-1:o+1],l=n[o>n.length-3?n.length-1:o+2];return r.set(Xc(a,s.x,c.x,h.x,l.x),Xc(a,s.y,c.y,h.y,l.y)),r},ch.prototype.copy=function(t){Bc.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push(n.clone())}return this},ch.prototype.toJSON=function(){var t=Bc.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++){var n=this.points[e];t.points.push(n.toArray())}return t},ch.prototype.fromJSON=function(t){Bc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Ie).fromArray(n))}return this};var hh=Object.freeze({ArcCurve:zc,CatmullRomCurve3:Wc,CubicBezierCurve:rh,CubicBezierCurve3:nh,EllipseCurve:Fc,LineCurve:ih,LineCurve3:oh,QuadraticBezierCurve:ah,QuadraticBezierCurve3:sh,SplineCurve:ch});function lh(){Bc.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function uh(t){lh.call(this),this.type="Path",this.currentPoint=new Ie,t&&this.setFromPoints(t)}function ph(t){uh.call(this,t),this.uuid=Oe.generateUUID(),this.type="Shape",this.holes=[]}function dh(t,e){ui.call(this),this.type="Light",this.color=new ni(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function fh(t,e,r){dh.call(this,t,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ui.DefaultUp),this.updateMatrix(),this.groundColor=new ni(e)}function mh(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Ie(512,512),this.map=null,this.matrix=new Ne}function gh(){mh.call(this,new Aa(50,1,.5,500))}function vh(t,e,r,n,i,o){dh.call(this,t,e),this.type="SpotLight",this.position.copy(ui.DefaultUp),this.updateMatrix(),this.target=new ui,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new gh}function yh(t,e,r,n){dh.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new mh(new Aa(90,1,.5,500))}function xh(){mh.call(this,new di(-5,5,5,-5,.5,500))}function bh(t,e){dh.call(this,t,e),this.type="DirectionalLight",this.position.copy(ui.DefaultUp),this.updateMatrix(),this.target=new ui,this.shadow=new xh}function _h(t,e){dh.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function wh(t,e,r,n){dh.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function Mh(t,e,r,n){Nh.call(this,t,e,r,n)}function Eh(t,e,r){Nh.call(this,t,e,r)}function Th(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r}function Sh(t,e,r,n){Th.call(this,t,e,r,n)}function Ah(t,e,r,n){Nh.call(this,t,e,r,n)}function Rh(t,e,r,n){Nh.call(this,t,e,r,n)}function Lh(t,e,r,n){Nh.call(this,t,e,r,n)}function Ph(t,e,r,n){Th.call(this,t,e,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ch(t,e,r,n){Th.call(this,t,e,r,n)}function Oh(t,e,r,n){Th.call(this,t,e,r,n)}lh.prototype=Object.assign(Object.create(Bc.prototype),{constructor:lh,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ih(e,t))},getPoint:function(t){for(var e=t*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=e){var i=r[n]-e,o=this.curves[n],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],a=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),c=0;c<s.length;c++){var h=s[c];e&&e.equals(h)||(r.push(h),e=h)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Bc.prototype.copy.call(this,t),this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Bc.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,r=this.curves.length;e<r;e++){var n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){Bc.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push((new hh[n.type]).fromJSON(n))}return this}}),uh.prototype=Object.assign(Object.create(lh.prototype),{constructor:uh,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var r=new ih(this.currentPoint.clone(),new Ie(t,e));this.curves.push(r),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,r,n){var i=new ah(this.currentPoint.clone(),new Ie(t,e),new Ie(r,n));this.curves.push(i),this.currentPoint.set(r,n)},bezierCurveTo:function(t,e,r,n,i,o){var a=new rh(this.currentPoint.clone(),new Ie(t,e),new Ie(r,n),new Ie(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(t){var e=new ch([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,r,n,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,r,n,i,o)},absarc:function(t,e,r,n,i,o){this.absellipse(t,e,r,r,n,i,o)},ellipse:function(t,e,r,n,i,o,a,s){var c=this.currentPoint.x,h=this.currentPoint.y;this.absellipse(t+c,e+h,r,n,i,o,a,s)},absellipse:function(t,e,r,n,i,o,a,s){var c=new Fc(t,e,r,n,i,o,a,s);if(this.curves.length>0){var h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)},copy:function(t){return lh.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=lh.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return lh.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ph.prototype=Object.assign(Object.create(uh.prototype),{constructor:ph,getPointsHoles:function(t){for(var e=[],r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){uh.prototype.copy.call(this,t),this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){var t=uh.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,r=this.holes.length;e<r;e++){var n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){uh.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push((new uh).fromJSON(n))}return this}}),dh.prototype=Object.assign(Object.create(ui.prototype),{constructor:dh,isLight:!0,copy:function(t){return ui.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=ui.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),fh.prototype=Object.assign(Object.create(dh.prototype),{constructor:fh,isHemisphereLight:!0,copy:function(t){return dh.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(mh.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),gh.prototype=Object.assign(Object.create(mh.prototype),{constructor:gh,isSpotLightShadow:!0,update:function(t){var e=this.camera,r=2*Oe.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;r===e.fov&&n===e.aspect&&i===e.far||(e.fov=r,e.aspect=n,e.far=i,e.updateProjectionMatrix())}}),vh.prototype=Object.assign(Object.create(dh.prototype),{constructor:vh,isSpotLight:!0,copy:function(t){return dh.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),yh.prototype=Object.assign(Object.create(dh.prototype),{constructor:yh,isPointLight:!0,copy:function(t){return dh.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),xh.prototype=Object.assign(Object.create(mh.prototype),{constructor:xh}),bh.prototype=Object.assign(Object.create(dh.prototype),{constructor:bh,isDirectionalLight:!0,copy:function(t){return dh.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),_h.prototype=Object.assign(Object.create(dh.prototype),{constructor:_h,isAmbientLight:!0}),wh.prototype=Object.assign(Object.create(dh.prototype),{constructor:wh,isRectAreaLight:!0,copy:function(t){return dh.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=dh.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Mh.prototype=Object.assign(Object.create(Nh.prototype),{constructor:Mh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:de,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Eh.prototype=Object.assign(Object.create(Nh.prototype),{constructor:Eh,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:de,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Th.prototype,{evaluate:function(t){var e=this.parameterPositions,r=this._cachedIndex,n=e[r],i=e[r-1];t:{e:{var o;r:{n:if(!(t<n)){for(var a=r+2;;){if(void 0===n){if(t<i)break n;return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,t,i)}if(r===a)break;if(i=n,t<(n=e[++r]))break e}o=e.length;break r}if(t>=i)break t;var s=e[1];t<s&&(r=2,i=s);for(a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===a)break;if(n=i,t>=(i=e[--r-1]))break e}o=r,r=0}for(;r<o;){var c=r+o>>>1;t<e[c]?o=c:r=c+1}if(n=e[r],void 0===(i=e[r-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,i,t)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=t*n,o=0;o!==n;++o)e[o]=r[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Th.prototype,{beforeStart_:Th.prototype.copySampleValue_,afterEnd_:Th.prototype.copySampleValue_}),Sh.prototype=Object.assign(Object.create(Th.prototype),{constructor:Sh,interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=(r-e)/(n-e),h=s+a;s!==h;s+=4)De.slerpFlat(i,0,o,s-a,o,s,c);return i}}),Ah.prototype=Object.assign(Object.create(Nh.prototype),{constructor:Ah,ValueTypeName:"quaternion",DefaultInterpolation:fe,InterpolantFactoryMethodLinear:function(t){return new Sh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Rh.prototype=Object.assign(Object.create(Nh.prototype),{constructor:Rh,ValueTypeName:"color"}),Lh.prototype=Object.assign(Object.create(Nh.prototype),{constructor:Lh,ValueTypeName:"number"}),Ph.prototype=Object.assign(Object.create(Th.prototype),{constructor:Ph,DefaultSettings_:{endingStart:ge,endingEnd:ge},intervalChanged_:function(t,e,r){var n=this.parameterPositions,i=t-2,o=t+1,a=n[i],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case ve:i=t,a=2*e-r;break;case ye:a=e+n[i=n.length-2]-n[i+1];break;default:i=t,a=r}if(void 0===s)switch(this.getSettings_().endingEnd){case ve:o=t,s=2*r-e;break;case ye:o=1,s=r+n[1]-n[0];break;default:o=t-1,s=e}var c=.5*(r-e),h=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(s-r),this._offsetPrev=i*h,this._offsetNext=o*h},interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,h=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,p=this._weightNext,d=(r-e)/(n-e),f=d*d,m=f*d,g=-u*m+2*u*f-u*d,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,x=p*m-p*f,b=0;b!==a;++b)i[b]=g*o[h+b]+v*o[c+b]+y*o[s+b]+x*o[l+b];return i}}),Ch.prototype=Object.assign(Object.create(Th.prototype),{constructor:Ch,interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,h=(r-e)/(n-e),l=1-h,u=0;u!==a;++u)i[u]=o[c+u]*l+o[s+u]*h;return i}}),Oh.prototype=Object.assign(Object.create(Th.prototype),{constructor:Oh,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Ih={arraySlice:function(t,e,r){return Ih.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)},convertArray:function(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,r=new Array(e),n=0;n!==e;++n)r[n]=n;return r.sort(function(e,r){return t[e]-t[r]}),r},sortedArray:function(t,e,r){for(var n=t.length,i=new t.constructor(n),o=0,a=0;a!==n;++o)for(var s=r[o]*e,c=0;c!==e;++c)i[a++]=t[s+c];return i},flattenJSON:function(t,e,r,n){for(var i=1,o=t[0];void 0!==o&&void 0===o[n];)o=t[i++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(e.push(o.time),r.push.apply(r,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(e.push(o.time),a.toArray(r,r.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(e.push(o.time),r.push(a)),o=t[i++]}while(void 0!==o)}}};function Nh(t,e,r,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ih.convertArray(e,this.TimeBufferType),this.values=Ih.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function Dh(t,e,r,n){Nh.call(this,t,e,r,n)}function Uh(t,e,r){this.name=t,this.tracks=r,this.duration=void 0!==e?e:-1,this.uuid=Oe.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Bh(t){this.manager=void 0!==t?t:Lc,this.textures={}}function Fh(t){this.manager=void 0!==t?t:Lc}Object.assign(Nh,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=Nh._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var r=[],n=[];Ih.flattenJSON(t.keys,r,n,"value"),t.times=r,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,r=t.constructor;if(void 0!==r.toJSON)e=r.toJSON(t);else{e={name:t.name,times:Ih.convertArray(t.times,Array),values:Ih.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Lh;case"vector":case"vector2":case"vector3":case"vector4":return Dh;case"color":return Rh;case"quaternion":return Ah;case"bool":case"boolean":return Eh;case"string":return Mh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(Nh.prototype,{constructor:Nh,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:fe,InterpolantFactoryMethodDiscrete:function(t){return new Oh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Ch(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Ph(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case de:e=this.InterpolantFactoryMethodDiscrete;break;case fe:e=this.InterpolantFactoryMethodLinear;break;case me:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",r)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return de;case this.InterpolantFactoryMethodLinear:return fe;case this.InterpolantFactoryMethodSmooth:return me}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]*=t;return this},trim:function(t,e){for(var r=this.times,n=r.length,i=0,o=n-1;i!==n&&r[i]<t;)++i;for(;-1!==o&&r[o]>e;)--o;if(++o,0!==i||o!==n){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Ih.arraySlice(r,i,o),this.values=Ih.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=r[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==n&&Ih.isTypedArray(n)){a=0;for(var c=n.length;a!==c;++a){var h=n[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,r=this.getValueSize(),n=this.getInterpolation()===me,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,c=t[a];if(c!==t[a+1]&&(1!==a||c!==c[0]))if(n)s=!0;else for(var h=a*r,l=h-r,u=h+r,p=0;p!==r;++p){var d=e[h+p];if(d!==e[l+p]||d!==e[u+p]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var f=a*r,m=i*r;for(p=0;p!==r;++p)e[m+p]=e[f+p]}++i}}if(o>0){t[i]=t[o];for(f=o*r,m=i*r,p=0;p!==r;++p)e[m+p]=e[f+p];++i}return i!==t.length&&(this.times=Ih.arraySlice(t,0,i),this.values=Ih.arraySlice(e,0,i*r)),this}}),Dh.prototype=Object.assign(Object.create(Nh.prototype),{constructor:Dh,ValueTypeName:"vector"}),Object.assign(Uh,{parse:function(t){for(var e=[],r=t.tracks,n=1/(t.fps||1),i=0,o=r.length;i!==o;++i)e.push(Nh.parse(r[i]).scale(n));return new Uh(t.name,t.duration,e)},toJSON:function(t){for(var e=[],r=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,o=r.length;i!==o;++i)e.push(Nh.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(t,e,r,n){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var h=Ih.getKeyframeOrder(s);s=Ih.sortedArray(s,1,h),c=Ih.sortedArray(c,1,h),n||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new Lh(".morphTargetInfluences["+e[a].name+"]",s,c).scale(1/r))}return new Uh(t,-1,o)},findByName:function(t,e){var r=t;if(!Array.isArray(t)){var n=t;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===e)return r[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],c=s.name.match(i);if(c&&c.length>1){var h=n[u=c[1]];h||(n[u]=h=[]),h.push(s)}}var l=[];for(var u in n)l.push(Uh.CreateFromMorphTargetSequence(u,n[u],e,r));return l},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(t,e,r,n,i){if(0!==r.length){var o=[],a=[];Ih.flattenJSON(r,o,a,n),0!==o.length&&i.push(new t(e,o,a))}},n=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var h=s[c].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var l={},u=0;u<h.length;u++)if(h[u].morphTargets)for(var p=0;p<h[u].morphTargets.length;p++)l[h[u].morphTargets[p]]=-1;for(var d in l){var f=[],m=[];for(p=0;p!==h[u].morphTargets.length;++p){var g=h[u];f.push(g.time),m.push(g.morphTarget===d?1:0)}n.push(new Lh(".morphTargetInfluence["+d+"]",f,m))}o=l.length*(a||1)}else{var v=".bones["+e[c].name+"]";r(Dh,v+".position",h,"pos",n),r(Ah,v+".quaternion",h,"rot",n),r(Dh,v+".scale",h,"scl",n)}}return 0===n.length?null:new Uh(i,o,n)}}),Object.assign(Uh.prototype,{resetDuration:function(){for(var t=0,e=0,r=this.tracks.length;e!==r;++e){var n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(Bh.prototype,{load:function(t,e,r,n){var i=this;new Cc(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},r,n)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function r(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var n=new Sc[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(n.uniforms=t.uniforms),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=r(t.map)),void 0!==t.alphaMap&&(n.alphaMap=r(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=r(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=r(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new Ie).fromArray(i)}return void 0!==t.displacementMap&&(n.displacementMap=r(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=r(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=r(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=r(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=r(t.specularMap)),void 0!==t.envMap&&(n.envMap=r(t.envMap)),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=r(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=r(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=r(t.gradientMap)),n}}),Object.assign(Fh.prototype,{load:function(t,e,r,n){var i=this;new Cc(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},r,n)},parse:function(t){var e=new Pi,r=t.data.index;if(void 0!==r){var n=new zh[r.type](r.array);e.setIndex(new vi(n,1))}var i=t.data.attributes;for(var o in i){var a=i[o];n=new zh[a.type](a.array);e.addAttribute(o,new vi(n,a.itemSize,a.normalized))}var s=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==s)for(var c=0,h=s.length;c!==h;++c){var l=s[c];e.addGroup(l.start,l.count,l.materialIndex)}var u=t.data.boundingSphere;if(void 0!==u){var p=new Ue;void 0!==u.center&&p.fromArray(u.center),e.boundingSphere=new We(p,u.radius)}return e}});var zh={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Gh(){}Gh.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,r=0,n=e.length;r<n;r+=2){var i=e[r],o=e[r+1];if(i.test(t))return o}return null}},Object.assign(Gh.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,r){for(var n=[],i=0;i<t.length;++i)n[i]=this.createMaterial(t[i],e,r);return n},createMaterial:function(){var t={NoBlending:b,NormalBlending:_,AdditiveBlending:w,SubtractiveBlending:M,MultiplyBlending:E,CustomBlending:T},e=new ni,r=new Uc,n=new Bh;return function(i,o,a){var s={};function c(t,e,n,i,c){var h,l=o+t,u=Gh.Handlers.get(l);null!==u?h=u.load(l):(r.setCrossOrigin(a),h=r.load(l)),void 0!==e&&(h.repeat.fromArray(e),1!==e[0]&&(h.wrapS=pt),1!==e[1]&&(h.wrapT=pt)),void 0!==n&&h.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(h.wrapS=pt),"mirror"===i[0]&&(h.wrapS=ft),"repeat"===i[1]&&(h.wrapT=pt),"mirror"===i[1]&&(h.wrapT=ft)),void 0!==c&&(h.anisotropy=c);var p=Oe.generateUUID();return s[p]=h,p}var h={uuid:Oe.generateUUID(),type:"MeshLambertMaterial"};for(var l in i){var u=i[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":h.name=u;break;case"blending":h.blending=t[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":h.color=e.fromArray(u).getHex();break;case"colorSpecular":h.specular=e.fromArray(u).getHex();break;case"colorEmissive":h.emissive=e.fromArray(u).getHex();break;case"specularCoef":h.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(h.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(h.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(h.type="MeshStandardMaterial");break;case"mapDiffuse":h.map=c(u,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":h.emissiveMap=c(u,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":h.lightMap=c(u,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":h.aoMap=c(u,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":h.bumpMap=c(u,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":h.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":h.normalMap=c(u,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":h.normalScale=u;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":h.specularMap=c(u,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":h.metalnessMap=c(u,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":h.roughnessMap=c(u,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":h.alphaMap=c(u,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":h.side=d;break;case"doubleSided":h.side=f;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),h.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":h[l]=u;break;case"vertexColors":!0===u&&(h.vertexColors=x),"face"===u&&(h.vertexColors=y);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,u)}}return"MeshBasicMaterial"===h.type&&delete h.emissive,"MeshPhongMaterial"!==h.type&&delete h.specular,h.opacity<1&&(h.transparent=!0),n.setTextures(s),n.parse(h)}}()});var Hh={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",r=0,n=t.length;r<n;r++)e+=String.fromCharCode(t[r]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function Vh(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Lc,this.withCredentials=!1}function kh(t){this.manager=void 0!==t?t:Lc,this.texturePath=""}Object.assign(Vh.prototype,{load:function(t,e,r,n){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Hh.extractUrlBase(t),a=new Cc(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(r){var n=JSON.parse(r),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.")}var c=i.parse(n,o);e(c.geometry,c.materials)},r,n)},setTexturePath:function(t){this.texturePath=t},parse:function(){return function(t,e){void 0!==t.data&&(t=t.data),void 0!==t.scale?t.scale=1/t.scale:t.scale=1;var r=new gi;return function(t,e){function r(t,e){return t&1<<e}var n,i,o,a,s,c,h,l,u,p,d,f,m,g,v,y,x,b,_,w,M,E,T,S,A,R=t.faces,L=t.vertices,P=t.normals,C=t.colors,O=t.scale,I=0;if(void 0!==t.uvs){for(n=0;n<t.uvs.length;n++)t.uvs[n].length&&I++;for(n=0;n<I;n++)e.faceVertexUvs[n]=[]}for(a=0,s=L.length;a<s;)(b=new Ue).x=L[a++]*O,b.y=L[a++]*O,b.z=L[a++]*O,e.vertices.push(b);for(a=0,s=R.length;a<s;)if(d=r(p=R[a++],0),f=r(p,1),m=r(p,3),g=r(p,4),v=r(p,5),y=r(p,6),x=r(p,7),d){if((w=new fi).a=R[a],w.b=R[a+1],w.c=R[a+3],(M=new fi).a=R[a+1],M.b=R[a+2],M.c=R[a+3],a+=4,f&&(u=R[a++],w.materialIndex=u,M.materialIndex=u),o=e.faces.length,m)for(n=0;n<I;n++)for(S=t.uvs[n],e.faceVertexUvs[n][o]=[],e.faceVertexUvs[n][o+1]=[],i=0;i<4;i++)A=new Ie(S[2*(l=R[a++])],S[2*l+1]),2!==i&&e.faceVertexUvs[n][o].push(A),0!==i&&e.faceVertexUvs[n][o+1].push(A);if(g&&(h=3*R[a++],w.normal.set(P[h++],P[h++],P[h]),M.normal.copy(w.normal)),v)for(n=0;n<4;n++)h=3*R[a++],T=new Ue(P[h++],P[h++],P[h]),2!==n&&w.vertexNormals.push(T),0!==n&&M.vertexNormals.push(T);if(y&&(E=C[c=R[a++]],w.color.setHex(E),M.color.setHex(E)),x)for(n=0;n<4;n++)E=C[c=R[a++]],2!==n&&w.vertexColors.push(new ni(E)),0!==n&&M.vertexColors.push(new ni(E));e.faces.push(w),e.faces.push(M)}else{if((_=new fi).a=R[a++],_.b=R[a++],_.c=R[a++],f&&(u=R[a++],_.materialIndex=u),o=e.faces.length,m)for(n=0;n<I;n++)for(S=t.uvs[n],e.faceVertexUvs[n][o]=[],i=0;i<3;i++)A=new Ie(S[2*(l=R[a++])],S[2*l+1]),e.faceVertexUvs[n][o].push(A);if(g&&(h=3*R[a++],_.normal.set(P[h++],P[h++],P[h])),v)for(n=0;n<3;n++)h=3*R[a++],T=new Ue(P[h++],P[h++],P[h]),_.vertexNormals.push(T);if(y&&(c=R[a++],_.color.setHex(C[c])),x)for(n=0;n<3;n++)c=R[a++],_.vertexColors.push(new ni(C[c]));e.faces.push(_)}}(t,r),function(t,e){var r=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,i=t.skinWeights.length;n<i;n+=r){var o=t.skinWeights[n],a=r>1?t.skinWeights[n+1]:0,s=r>2?t.skinWeights[n+2]:0,c=r>3?t.skinWeights[n+3]:0;e.skinWeights.push(new Ge(o,a,s,c))}if(t.skinIndices)for(n=0,i=t.skinIndices.length;n<i;n+=r){var h=t.skinIndices[n],l=r>1?t.skinIndices[n+1]:0,u=r>2?t.skinIndices[n+2]:0,p=r>3?t.skinIndices[n+3]:0;e.skinIndices.push(new Ge(h,l,u,p))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}(t,r),function(t,e){var r=t.scale;if(void 0!==t.morphTargets)for(var n=0,i=t.morphTargets.length;n<i;n++){e.morphTargets[n]={},e.morphTargets[n].name=t.morphTargets[n].name,e.morphTargets[n].vertices=[];for(var o=e.morphTargets[n].vertices,a=t.morphTargets[n].vertices,s=0,c=a.length;s<c;s+=3){var h=new Ue;h.x=a[s]*r,h.y=a[s+1]*r,h.z=a[s+2]*r,o.push(h)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var l=e.faces,u=t.morphColors[0].colors;for(n=0,i=l.length;n<i;n++)l[n].color.fromArray(u,3*n)}}(t,r),function(t,e){var r=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var i=0;i<n.length;i++){var o=Uh.parseAnimation(n[i],e.bones);o&&r.push(o)}if(e.morphTargets){var a=Uh.CreateClipsFromMorphTargetSequences(e.morphTargets,10);r=r.concat(a)}r.length>0&&(e.animations=r)}(t,r),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:r}:{geometry:r,materials:Gh.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}()}),Object.assign(kh.prototype,{load:function(t,e,r,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new Cc(i.manager).load(t,function(r){var o=null;try{o=JSON.parse(r)}catch(e){return void 0!==n&&n(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.")},r,n)},setTexturePath:function(t){return this.texturePath=t,this},setCrossOrigin:function(t){return this.crossOrigin=t,this},parse:function(t,e){var r=this.parseShape(t.shapes),n=this.parseGeometries(t.geometries,r),i=this.parseImages(t.images,function(){void 0!==e&&e(s)}),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,n,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var r=0,n=t.length;r<n;r++){var i=(new ph).fromJSON(t[r]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var r={};if(void 0!==t)for(var n=new Vh,i=new Fh,o=0,a=t.length;o<a;o++){var s,c=t[o];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new gc[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new gc[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new gc[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new gc[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new gc[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new gc[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new gc[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new gc[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new gc[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new gc[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new gc[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new gc[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var h=[],l=0,u=c.shapes.length;l<u;l++){var p=e[c.shapes[l]];h.push(p)}s=new gc[c.type](h,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(h=[],l=0,u=c.shapes.length;l<u;l++){p=e[c.shapes[l]];h.push(p)}var d=c.options.extrudePath;void 0!==d&&(c.options.extrudePath=(new hh[d.type]).fromJSON(d)),s=new gc[c.type](h,c.options);break;case"BufferGeometry":s=i.parse(c);break;case"Geometry":s=n.parse(c,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),!0===s.isBufferGeometry&&void 0!==c.userData&&(s.userData=c.userData),r[c.uuid]=s}return r},parseMaterials:function(t,e){var r={};if(void 0!==t){var n=new Bh;n.setTextures(e);for(var i=0,o=t.length;i<o;i++){var a=t[i];if("MultiMaterial"===a.type){for(var s=[],c=0;c<a.materials.length;c++)s.push(n.parse(a.materials[c]));r[a.uuid]=s}else r[a.uuid]=n.parse(a)}}return r},parseAnimations:function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r],i=Uh.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),e.push(i)}return e},parseImages:function(t,e){var r=this,n={};function i(t){return r.manager.itemStart(t),o.load(t,function(){r.manager.itemEnd(t)},void 0,function(){r.manager.itemEnd(t),r.manager.itemError(t)})}if(void 0!==t&&t.length>0){var o=new Nc(new Rc(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var c=t[a],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:r.texturePath+c.url;n[c.uuid]=i(h)}}return n},parseTextures:function(t,e){function r(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=t[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new ze(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=r(a.mapping,Wh)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=r(a.wrap[0],Xh),s.wrapT=r(a.wrap[1],Xh)),void 0!==a.format&&(s.format=a.format),void 0!==a.minFilter&&(s.minFilter=r(a.minFilter,qh)),void 0!==a.magFilter&&(s.magFilter=r(a.magFilter,qh)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),n[a.uuid]=s}return n},parseObject:function(t,e,r){var n;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];void 0===r[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(r[o])}return e}return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r[t]}}switch(t.type){case"Scene":n=new Na,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new ni(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new Ia(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new Oa(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new Aa(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new di(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"AmbientLight":n=new _h(t.color,t.intensity);break;case"DirectionalLight":n=new bh(t.color,t.intensity);break;case"PointLight":n=new yh(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new wh(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new vh(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new fh(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(t.geometry),s=o(t.material);n=a.bones&&a.bones.length>0?new Ga(a,s):new Vi(a,s);break;case"LOD":n=new Ba;break;case"Line":n=new Va(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":n=new ja(i(t.geometry),o(t.material));break;case"LineSegments":n=new ka(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":n=new Xa(i(t.geometry),o(t.material));break;case"Sprite":n=new Ua(o(t.material));break;case"Group":n=new qa;break;default:n=new ui}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(n.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(n.matrixAutoUpdate=t.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.frustumCulled&&(n.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(n.renderOrder=t.renderOrder),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var c=t.children,h=0;h<c.length;h++)n.add(this.parseObject(c[h],e,r));if("LOD"===t.type)for(var l=t.levels,u=0;u<l.length;u++){var p=l[u],d=n.getObjectByProperty("uuid",p.object);void 0!==d&&n.addLevel(d,p.distance)}return n}});var jh,Wh={UVMapping:it,CubeReflectionMapping:ot,CubeRefractionMapping:at,EquirectangularReflectionMapping:st,EquirectangularRefractionMapping:ct,SphericalReflectionMapping:ht,CubeUVReflectionMapping:lt,CubeUVRefractionMapping:ut},Xh={RepeatWrapping:pt,ClampToEdgeWrapping:dt,MirroredRepeatWrapping:ft},qh={NearestFilter:mt,NearestMipMapNearestFilter:gt,NearestMipMapLinearFilter:vt,LinearFilter:yt,LinearMipMapNearestFilter:xt,LinearMipMapLinearFilter:bt};function Yh(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Lc,this.options=void 0}function Zh(){this.type="ShapePath",this.color=new ni,this.subPaths=[],this.currentPath=null}function Jh(t){this.type="Font",this.data=t}function Qh(t,e,r,n){for(var i=Array.from?Array.from(t):String(t).split(""),o=e/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,s=[],c=0,h=0,l=0;l<i.length;l++){var u=i[l];if("\n"===u)c=0,h-=a;else{var p=Kh(u,r,o,c,h,n);c+=p.offsetX,s.push(p.path)}}return s}function Kh(t,e,r,n,i,o){var a=o.glyphs[t]||o.glyphs["?"];if(a){var s,c,h,l,u,p,d,f,m=new Zh;if(a.o)for(var g=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,y=g.length;v<y;){switch(g[v++]){case"m":s=g[v++]*r+n,c=g[v++]*r+i,m.moveTo(s,c);break;case"l":s=g[v++]*r+n,c=g[v++]*r+i,m.lineTo(s,c);break;case"q":h=g[v++]*r+n,l=g[v++]*r+i,u=g[v++]*r+n,p=g[v++]*r+i,m.quadraticCurveTo(u,p,h,l);break;case"b":h=g[v++]*r+n,l=g[v++]*r+i,u=g[v++]*r+n,p=g[v++]*r+i,d=g[v++]*r+n,f=g[v++]*r+i,m.bezierCurveTo(u,p,d,f,h,l)}}return{offsetX:a.ha*r,path:m}}}function $h(t){this.manager=void 0!==t?t:Lc}Yh.prototype={constructor:Yh,setOptions:function(t){return this.options=t,this},load:function(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Ac.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(r){Ac.add(t,r),e&&e(r),i.manager.itemEnd(t)}).catch(function(e){n&&n(e),i.manager.itemEnd(t),i.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Zh.prototype,{moveTo:function(t,e){this.currentPath=new uh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,r,n){this.currentPath.quadraticCurveTo(t,e,r,n)},bezierCurveTo:function(t,e,r,n,i,o){this.currentPath.bezierCurveTo(t,e,r,n,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function r(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],o=new ph;o.curves=i.curves,e.push(o)}return e}function n(t,e){for(var r=e.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=e[i],s=e[o],c=s.x-a.x,h=s.y-a.y;if(Math.abs(h)>Number.EPSILON){if(h<0&&(a=e[o],c=-c,s=e[i],h=-h),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=h*(t.x-a.x)-c*(t.y-a.y);if(0===l)return!0;if(l<0)continue;n=!n}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return n}var i=Ws.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return r(o);var a,s,c,h=[];if(1===o.length)return s=o[0],(c=new ph).curves=s.curves,h.push(c),h;var l=!i(o[0].getPoints());l=t?!l:l;var u,p,d=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=i(u=(s=o[v]).getPoints()),(a=t?!a:a)?(!l&&f[g]&&g++,f[g]={s:new ph,p:u},f[g].s.curves=s.curves,l&&g++,m[g]=[]):m[g].push({h:s,p:u[0]});if(!f[0])return r(o);if(f.length>1){for(var x=!1,b=[],_=0,w=f.length;_<w;_++)d[_]=[];for(_=0,w=f.length;_<w;_++)for(var M=m[_],E=0;E<M.length;E++){for(var T=M[E],S=!0,A=0;A<f.length;A++)n(T.p,f[A].p)&&(_!==A&&b.push({froms:_,tos:A,hole:E}),S?(S=!1,d[A].push(T)):x=!0);S&&d[_].push(T)}b.length>0&&(x||(m=d))}v=0;for(var R=f.length;v<R;v++){c=f[v].s,h.push(c);for(var L=0,P=(p=m[v]).length;L<P;L++)c.holes.push(p[L].h)}return h}}),Object.assign(Jh.prototype,{isFont:!0,generateShapes:function(t,e,r){void 0===e&&(e=100),void 0===r&&(r=4);for(var n=[],i=Qh(t,e,r,this.data),o=0,a=i.length;o<a;o++)Array.prototype.push.apply(n,i[o].toShapes());return n}}),Object.assign($h.prototype,{load:function(t,e,r,n){var i=this,o=new Cc(this.manager);o.setPath(this.path),o.load(t,function(t){var r;try{r=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(t.substring(65,t.length-2))}var n=i.parse(r);e&&e(n)},r,n)},parse:function(t){return new Jh(t)},setPath:function(t){return this.path=t,this}});var tl={getContext:function(){return void 0===jh&&(jh=new(window.AudioContext||window.webkitAudioContext)),jh},setContext:function(t){jh=t}};function el(t){this.manager=void 0!==t?t:Lc}function rl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Aa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Aa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function nl(t,e,r){ui.call(this),this.type="CubeCamera";var n=new Aa(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new Ue(1,0,0)),this.add(n);var i=new Aa(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new Ue(-1,0,0)),this.add(i);var o=new Aa(90,1,t,e);o.up.set(0,0,1),o.lookAt(new Ue(0,1,0)),this.add(o);var a=new Aa(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new Ue(0,-1,0)),this.add(a);var s=new Aa(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new Ue(0,0,1)),this.add(s);var c=new Aa(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new Ue(0,0,-1)),this.add(c);var h={format:Nt,magFilter:yt,minFilter:yt};this.renderTarget=new Ve(r,r,h),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,t.render(e,n,r),r.activeCubeFace=1,t.render(e,i,r),r.activeCubeFace=2,t.render(e,o,r),r.activeCubeFace=3,t.render(e,a,r),r.activeCubeFace=4,t.render(e,s,r),r.texture.generateMipmaps=h,r.activeCubeFace=5,t.render(e,c,r),t.setRenderTarget(null)},this.clear=function(t,e,r,n){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,r,n);t.setRenderTarget(null)}}function il(){ui.call(this),this.type="AudioListener",this.context=tl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function ol(t){ui.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function al(t){ol.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function sl(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function cl(t,e,r){this.binding=t,this.valueSize=r;var n,i=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(el.prototype,{load:function(t,e,r,n){var i=new Cc(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){tl.getContext().decodeAudioData(t,function(t){e(t)})},r,n)}}),Object.assign(rl.prototype,{update:function(){var t,e,r,n,i,o,a,s,c=new Ne,h=new Ne;return function(l){if(t!==this||e!==l.focus||r!==l.fov||n!==l.aspect*this.aspect||i!==l.near||o!==l.far||a!==l.zoom||s!==this.eyeSep){t=this,e=l.focus,r=l.fov,n=l.aspect*this.aspect,i=l.near,o=l.far,a=l.zoom;var u,p,d=l.projectionMatrix.clone(),f=(s=this.eyeSep/2)*i/e,m=i*Math.tan(Oe.DEG2RAD*r*.5)/a;h.elements[12]=-s,c.elements[12]=s,u=-m*n+f,p=m*n+f,d.elements[0]=2*i/(p-u),d.elements[8]=(p+u)/(p-u),this.cameraL.projectionMatrix.copy(d),u=-m*n-f,p=m*n-f,d.elements[0]=2*i/(p-u),d.elements[8]=(p+u)/(p-u),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(h),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(c)}}()}),nl.prototype=Object.create(ui.prototype),nl.prototype.constructor=nl,il.prototype=Object.assign(Object.create(ui.prototype),{constructor:il,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01)},updateMatrixWorld:function(){var t=new Ue,e=new De,r=new Ue,n=new Ue;return function(i){ui.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,r),n.set(0,0,-1).applyQuaternion(e),o.positionX?(o.positionX.setValueAtTime(t.x,this.context.currentTime),o.positionY.setValueAtTime(t.y,this.context.currentTime),o.positionZ.setValueAtTime(t.z,this.context.currentTime),o.forwardX.setValueAtTime(n.x,this.context.currentTime),o.forwardY.setValueAtTime(n.y,this.context.currentTime),o.forwardZ.setValueAtTime(n.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(t.x,t.y,t.z),o.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z))}}()}),ol.prototype=Object.assign(Object.create(ui.prototype),{constructor:ol,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}),al.prototype=Object.assign(Object.create(ol.prototype),{constructor:al,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new Ue;return function(e){ui.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(sl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),r=0;r<e.length;r++)t+=e[r];return t/e.length}}),Object.assign(cl.prototype,{accumulate:function(t,e){var r=this.buffer,n=this.valueSize,i=t*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)r[i+a]=r[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,r=this.buffer,n=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(r,n,a,1-i,e)}for(var s=e,c=e+e;s!==c;++s)if(r[s]!==r[s+e]){o.setValue(r,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,r=this.valueSize,n=3*r;t.getValue(e,n);for(var i=r,o=n;i!==o;++i)e[i]=e[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,r,n,i){if(n>=.5)for(var o=0;o!==i;++o)t[e+o]=t[r+o]},_slerp:function(t,e,r,n){De.slerpFlat(t,e,t,e,t,r,n)},_lerp:function(t,e,r,n,i){for(var o=1-n,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[r+a]*n}}});var hl,ll,ul="\\[\\]\\.:\\/";function pl(t,e,r){var n=r||dl.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function dl(t,e,r){this.path=e,this.parsedPath=r||dl.parseTrackName(e),this.node=dl.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function fl(){this.uuid=Oe.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,r=arguments.length;e!==r;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function ml(t,e,r){this._mixer=t,this._clip=e,this._localRoot=r||null;for(var n=e.tracks,i=n.length,o=new Array(i),a={endingStart:ge,endingEnd:ge},s=0;s!==i;++s){var c=n[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ue,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function gl(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function vl(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function yl(){Pi.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function xl(t,e,r,n){this.data=t,this.itemSize=e,this.offset=r,this.normalized=!0===n}function bl(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function _l(t,e,r){bl.call(this,t,e),this.meshPerAttribute=r||1}function wl(t,e,r){vi.call(this,t,e),this.meshPerAttribute=r||1}function Ml(t,e,r,n){this.ray=new zi(t,e),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function El(t,e){return t.distance-e.distance}function Tl(t,e,r,n){if(!1!==t.visible&&(t.raycast(e,r),!0===n))for(var i=t.children,o=0,a=i.length;o<a;o++)Tl(i[o],e,r,!0)}function Sl(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Al(t,e,r){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==r?r:0,this}function Rl(t,e,r){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==r?r:0,this}function Ll(t,e){this.min=void 0!==t?t:new Ie(1/0,1/0),this.max=void 0!==e?e:new Ie(-1/0,-1/0)}function Pl(t){ui.call(this),this.material=t,this.render=function(){}}function Cl(t,e,r,n){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==r?r:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new Pi,h=new Ti(2*a*3,3);c.addAttribute("position",h),ka.call(this,c,new Ha({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ol(t,e){ui.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var r=new Pi,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}r.addAttribute("position",new Ti(n,3));var c=new Ha({fog:!1});this.cone=new ka(r,c),this.add(this.cone),this.update()}function Il(t){var e=[];t&&t.isBone&&e.push(t);for(var r=0;r<t.children.length;r++)e.push.apply(e,Il(t.children[r]));return e}function Nl(t){for(var e=Il(t),r=new Pi,n=[],i=[],o=new ni(0,0,1),a=new ni(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}r.addAttribute("position",new Ti(n,3)),r.addAttribute("color",new Ti(i,3));var h=new Ha({vertexColors:x,depthTest:!1,depthWrite:!1,transparent:!0});ka.call(this,r,h),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Dl(t,e,r){this.light=t,this.light.updateMatrixWorld(),this.color=r;var n=new ec(e,4,2),i=new Bi({wireframe:!0,fog:!1});Vi.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Ul(t,e){ui.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var r=new Ha({fog:!1}),n=new Pi;n.addAttribute("position",new vi(new Float32Array(15),3)),this.line=new Va(n,r),this.add(this.line),this.update()}function Bl(t,e,r){ui.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new os(e);n.rotateY(.5*Math.PI),this.material=new Bi({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=x);var i=n.getAttribute("position"),o=new Float32Array(3*i.count);n.addAttribute("color",new vi(o,3)),this.add(new Vi(n,this.material)),this.update()}function Fl(t,e,r,n){t=t||10,e=e||10,r=new ni(void 0!==r?r:4473924),n=new ni(void 0!==n?n:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],c=[],h=0,l=0,u=-a;h<=e;h++,u+=o){s.push(-a,0,u,a,0,u),s.push(u,0,-a,u,0,a);var p=h===i?r:n;p.toArray(c,l),l+=3,p.toArray(c,l),l+=3,p.toArray(c,l),l+=3,p.toArray(c,l),l+=3}var d=new Pi;d.addAttribute("position",new Ti(s,3)),d.addAttribute("color",new Ti(c,3));var f=new Ha({vertexColors:x});ka.call(this,d,f)}function zl(t,e,r,n,i,o){t=t||10,e=e||16,r=r||8,n=n||64,i=new ni(void 0!==i?i:4473924),o=new ni(void 0!==o?o:8947848);var a,s,c,h,l,u,p,d=[],f=[];for(h=0;h<=e;h++)c=h/e*(2*Math.PI),a=Math.sin(c)*t,s=Math.cos(c)*t,d.push(0,0,0),d.push(a,0,s),p=1&h?i:o,f.push(p.r,p.g,p.b),f.push(p.r,p.g,p.b);for(h=0;h<=r;h++)for(p=1&h?i:o,u=t-t/r*h,l=0;l<n;l++)c=l/n*(2*Math.PI),a=Math.sin(c)*u,s=Math.cos(c)*u,d.push(a,0,s),f.push(p.r,p.g,p.b),c=(l+1)/n*(2*Math.PI),a=Math.sin(c)*u,s=Math.cos(c)*u,d.push(a,0,s),f.push(p.r,p.g,p.b);var m=new Pi;m.addAttribute("position",new Ti(d,3)),m.addAttribute("color",new Ti(f,3));var g=new Ha({vertexColors:x});ka.call(this,m,g)}function Gl(t,e,r,n){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==r?r:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new Pi,h=new Ti(2*a*3,3);c.addAttribute("position",h),ka.call(this,c,new Ha({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Hl(t,e,r){ui.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===e&&(e=1);var n=new Pi;n.addAttribute("position",new Ti([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Ha({fog:!1});this.lightPlane=new Va(n,i),this.add(this.lightPlane),(n=new Pi).addAttribute("position",new Ti([0,0,0,0,0,1],3)),this.targetLine=new Va(n,i),this.add(this.targetLine),this.update()}function Vl(t){var e=new Pi,r=new Ha({color:16777215,vertexColors:y}),n=[],i=[],o={},a=new ni(16755200),s=new ni(16711680),c=new ni(43775),h=new ni(16777215),l=new ni(3355443);function u(t,e,r){p(t,r),p(e,r)}function p(t,e){n.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(n.length/3-1)}u("n1","n2",a),u("n2","n4",a),u("n4","n3",a),u("n3","n1",a),u("f1","f2",a),u("f2","f4",a),u("f4","f3",a),u("f3","f1",a),u("n1","f1",a),u("n2","f2",a),u("n3","f3",a),u("n4","f4",a),u("p","n1",s),u("p","n2",s),u("p","n3",s),u("p","n4",s),u("u1","u2",c),u("u2","u3",c),u("u3","u1",c),u("c","t",h),u("p","c",l),u("cn1","cn2",l),u("cn3","cn4",l),u("cf1","cf2",l),u("cf3","cf4",l),e.addAttribute("position",new Ti(n,3)),e.addAttribute("color",new Ti(i,3)),ka.call(this,e,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function kl(t,e){this.object=t,void 0===e&&(e=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new Pi;i.setIndex(new vi(r,1)),i.addAttribute("position",new vi(n,3)),ka.call(this,i,new Ha({color:e})),this.matrixAutoUpdate=!1,this.update()}function jl(t,e){this.type="Box3Helper",this.box=t;var r=void 0!==e?e:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Pi;i.setIndex(new vi(n,1)),i.addAttribute("position",new Ti([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ka.call(this,i,new Ha({color:r})),this.geometry.computeBoundingSphere()}function Wl(t,e,r){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var n=void 0!==r?r:16776960,i=new Pi;i.addAttribute("position",new Ti([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Va.call(this,i,new Ha({color:n}));var o=new Pi;o.addAttribute("position",new Ti([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Vi(o,new Bi({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function Xl(t,e,r,n,i,o){ui.call(this),void 0===n&&(n=16776960),void 0===r&&(r=1),void 0===i&&(i=.2*r),void 0===o&&(o=.2*i),void 0===hl&&((hl=new Pi).addAttribute("position",new Ti([0,0,0,0,1,0],3)),(ll=new uc(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Va(hl,new Ha({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Vi(ll,new Bi({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(r,i,o)}function ql(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],r=new Pi;r.addAttribute("position",new Ti(e,3)),r.addAttribute("color",new Ti([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new Ha({vertexColors:x});ka.call(this,r,n)}function Yl(t,e,r,n,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new fi(t,e,r,i,o,a)}Object.assign(pl.prototype,{getValue:function(t,e){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}),Object.assign(dl,{Composite:pl,create:function(t,e,r){return t&&t.isAnimationObjectGroup?new dl.Composite(t,e,r):new dl(t,e,r)},sanitizeNodeName:function(){var t=new RegExp("["+ul+"]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^"+ul+"]",e="[^"+ul.replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC",t),n=/(WCOD+)?/.source.replace("WCOD",e),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),a=new RegExp("^"+r+n+i+o+"$"),s=["material","materials","bones"];return function(t){var e=a.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==s.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var r=t.skeleton.getBoneByName(e);if(void 0!==r)return r}if(t.children){var n=function(t){for(var r=0;r<t.length;r++){var i=t[r];if(i.name===e||i.uuid===e)return i;var o=n(i.children);if(o)return o}return null},i=n(t.children);if(i)return i}return null}}),Object.assign(dl.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)t[e++]=r[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,r=e.objectName,n=e.propertyName,i=e.propertyIndex;if(t||(t=dl.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[n];if(void 0!==s){var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var h=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}h=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(h=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]}else{var l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(dl.prototype,{_getValue_unbound:dl.prototype.getValue,_setValue_unbound:dl.prototype.setValue}),Object.assign(fl.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,h=0,l=arguments.length;h!==l;++h){var u=arguments[h],p=u.uuid,d=n[p];if(void 0===d){d=e++,n[p]=d,t.push(u);for(var f=0,m=s;f!==m;++f)a[f].push(new dl(u,i[f],o[f]))}else if(d<r){c=t[d];var g=--r,v=t[g];n[v.uuid]=d,t[d]=v,n[p]=g,t[g]=u;for(f=0,m=s;f!==m;++f){var y=a[f],x=y[g],b=y[d];y[d]=x,void 0===b&&(b=new dl(u,i[f],o[f])),y[g]=b}}else t[d]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,h=r[c];if(void 0!==h&&h>=e){var l=e++,u=t[l];r[u.uuid]=h,t[h]=u,r[c]=l,t[l]=s;for(var p=0,d=i;p!==d;++p){var f=n[p],m=f[l],g=f[h];f[h]=m,f[l]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a].uuid,h=n[c];if(void 0!==h)if(delete n[c],h<r){var l=--r,u=t[l],p=t[v=--e];n[u.uuid]=h,t[h]=u,n[p.uuid]=l,t[l]=p,t.pop();for(var d=0,f=o;d!==f;++d){var m=(y=i[d])[l],g=y[v];y[h]=m,y[l]=g,y.pop()}}else{var v;n[(p=t[v=--e]).uuid]=h,t[h]=p,t.pop();for(d=0,f=o;d!==f;++d){var y;(y=i[d])[h]=y[v],y.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){var r=this._bindingsIndicesByPath,n=r[t],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,h=this.nCachedObjects_,l=new Array(c);n=i.length,r[t]=n,o.push(t),a.push(e),i.push(l);for(var u=h,p=s.length;u!==p;++u){var d=s[u];l[u]=new dl(d,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,r=e[t];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=r,o[r]=s,o.pop(),i[r]=i[a],i.pop(),n[r]=n[a],n.pop()}}}),Object.assign(ml.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,r){if(t.fadeOut(e),this.fadeIn(e),r){var n=this._clip.duration,i=t._clip.duration,o=i/n,a=n/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,r){return t.crossFadeFrom(this,e,r)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+r,c[0]=t/a,c[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*r;if(o<0||0===r)return;this._startTime=null,e=r*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,h=this._propertyBindings,l=0,u=c.length;l!==u;++l)c[l].evaluate(a),h[l].accumulate(n,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(t)[0];e*=n,t>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r)e*=r.evaluate(t)[0],t>r.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var r=this._clip.duration,n=this.loop,i=this._loopCount;if(n===le){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=r)e=r;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=n===pe;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=r||e<0){var a=Math.floor(e/r);e-=r*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=e,r-e}return this.time=e,e},_setEndings:function(t,e,r){var n=this._interpolantSettings;r?(n.endingStart=ve,n.endingEnd=ve):(n.endingStart=t?this.zeroSlopeAtStart?ve:ge:ye,n.endingEnd=e?this.zeroSlopeAtEnd?ve:ge:ye)},_scheduleFading:function(t,e,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=r,this}}),gl.prototype=Object.assign(Object.create(t.prototype),{constructor:gl,_bindAction:function(t,e){var r=t._localRoot||this._root,n=t._clip.tracks,i=n.length,o=t._propertyBindings,a=t._interpolants,s=r.uuid,c=this._bindingsByRootAndName,h=c[s];void 0===h&&(h={},c[s]=h);for(var l=0;l!==i;++l){var u=n[l],p=u.name,d=h[p];if(void 0!==d)o[l]=d;else{if(void 0!==(d=o[l])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var f=e&&e._propertyBindings[l].binding.parsedPath;++(d=new cl(dl.create(r,p,f),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(d,s,p),o[l]=d}a[l].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,r){var n=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=n.length,n.push(t),o.actionByRoot[r]=t},_removeInactiveAction:function(t){var e=this._actions,r=e[e.length-1],n=t._cacheIndex;r._cacheIndex=n,e[n]=r,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],h=t._byClipCacheIndex;c._byClipCacheIndex=h,s[h]=c,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,r=t._cacheIndex,n=this._nActiveActions++,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_takeBackAction:function(t){var e=this._actions,r=t._cacheIndex,n=--this._nActiveActions,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_addInactiveBinding:function(t,e,r){var n=this._bindingsByRootAndName,i=n[e],o=this._bindings;void 0===i&&(i={},n[e]=i),i[r]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,r=t.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,a=o[n],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete a[i];t:{for(var h in a)break t;delete o[n]}},_lendBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_takeBackBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,r=t[e];return void 0===r&&((r=new Ch(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=r),r},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,i=e[n];t.__cacheIndex=n,e[n]=t,i.__cacheIndex=r,e[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var r=e||this._root,n=r.uuid,i="string"==typeof t?Uh.findByName(r,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[n];if(void 0!==c)return c;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var h=new ml(this,i,e);return this._bindAction(h,s),this._addInactiveAction(h,o,n),h},existingAction:function(t,e){var r=e||this._root,n=r.uuid,i="string"==typeof t?Uh.findByName(r,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,r=this._nActiveActions,n=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==r;++a){e[a]._update(n,t,i,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,r=t.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var h=c._cacheIndex,l=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=h,e[h]=l,e.pop(),this._removeInactiveBindingsForAction(c)}delete n[r]}},uncacheRoot:function(t){var e=t.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var r=this.existingAction(t,e);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),vl.prototype.clone=function(){return new vl(void 0===this.value.clone?this.value:this.value.clone())},yl.prototype=Object.assign(Object.create(Pi.prototype),{constructor:yl,isInstancedBufferGeometry:!0,copy:function(t){return Pi.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(xl.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(xl.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this}}),Object.defineProperty(bl.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(bl.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.stride:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),_l.prototype=Object.assign(Object.create(bl.prototype),{constructor:_l,isInstancedInterleavedBuffer:!0,copy:function(t){return bl.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),wl.prototype=Object.assign(Object.create(vi.prototype),{constructor:wl,isInstancedBufferAttribute:!0,copy:function(t){return vi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Ml.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,r){var n=r||[];return Tl(t,this,n,e),n.sort(El),n},intersectObjects:function(t,e,r){var n=r||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,o=t.length;i<o;i++)Tl(t[i],this,n,e);return n.sort(El),n}}),Object.assign(Sl.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Al.prototype,{set:function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Oe.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(Rl.prototype,{set:function(t,e,r){return this.radius=t,this.theta=e,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),Object.assign(Ll.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Ie;return function(e,r){var n=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Ie),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Ie),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Ie),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Ie),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Ie;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Pl.prototype=Object.create(ui.prototype),Pl.prototype.constructor=Pl,Pl.prototype.isImmediateRenderObject=!0,Cl.prototype=Object.create(ka.prototype),Cl.prototype.constructor=Cl,Cl.prototype.update=function(){var t=new Ue,e=new Ue,r=new Be;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,c=a.faces,h=0,l=0,u=c.length;l<u;l++)for(var p=c[l],d=0,f=p.vertexNormals.length;d<f;d++){var m=s[p[n[d]]],g=p.vertexNormals[d];t.copy(m).applyMatrix4(i),e.copy(g).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(h,t.x,t.y,t.z),h+=1,o.setXYZ(h,e.x,e.y,e.z),h+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,y=a.attributes.normal;for(h=0,d=0,f=v.count;d<f;d++)t.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(i),e.set(y.getX(d),y.getY(d),y.getZ(d)),e.applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(h,t.x,t.y,t.z),h+=1,o.setXYZ(h,e.x,e.y,e.z),h+=1}o.needsUpdate=!0}}(),Ol.prototype=Object.create(ui.prototype),Ol.prototype.constructor=Ol,Ol.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ol.prototype.update=function(){var t=new Ue,e=new Ue;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Nl.prototype=Object.create(ka.prototype),Nl.prototype.constructor=Nl,Nl.prototype.updateMatrixWorld=function(){var t=new Ue,e=new Ne,r=new Ne;return function(n){var i=this.bones,o=this.geometry,a=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var h=i[s];h.parent&&h.parent.isBone&&(e.multiplyMatrices(r,h.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(c,t.x,t.y,t.z),e.multiplyMatrices(r,h.parent.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(c+1,t.x,t.y,t.z),c+=2)}o.getAttribute("position").needsUpdate=!0,ui.prototype.updateMatrixWorld.call(this,n)}}(),Dl.prototype=Object.create(Vi.prototype),Dl.prototype.constructor=Dl,Dl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Dl.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Ul.prototype=Object.create(ui.prototype),Ul.prototype.constructor=Ul,Ul.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ul.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,r=this.line.geometry.attributes.position,n=r.array;n[0]=t,n[1]=-e,n[2]=0,n[3]=t,n[4]=e,n[5]=0,n[6]=-t,n[7]=e,n[8]=0,n[9]=-t,n[10]=-e,n[11]=0,n[12]=t,n[13]=-e,n[14]=0,r.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Bl.prototype=Object.create(ui.prototype),Bl.prototype.constructor=Bl,Bl.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Bl.prototype.update=function(){var t=new Ue,e=new ni,r=new ni;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");e.copy(this.light.color),r.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?e:r;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Fl.prototype=Object.create(ka.prototype),Fl.prototype.constructor=Fl,zl.prototype=Object.create(ka.prototype),zl.prototype.constructor=zl,Gl.prototype=Object.create(ka.prototype),Gl.prototype.constructor=Gl,Gl.prototype.update=function(){var t=new Ue,e=new Ue,r=new Be;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,c=0,h=0,l=s.length;h<l;h++){var u=s[h],p=u.normal;t.copy(a[u.a]).add(a[u.b]).add(a[u.c]).divideScalar(3).applyMatrix4(n),e.copy(p).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),i.setXYZ(c,t.x,t.y,t.z),c+=1,i.setXYZ(c,e.x,e.y,e.z),c+=1}i.needsUpdate=!0}}(),Hl.prototype=Object.create(ui.prototype),Hl.prototype.constructor=Hl,Hl.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Hl.prototype.update=function(){var t=new Ue,e=new Ue,r=new Ue;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(e,t),this.lightPlane.lookAt(r),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(r),this.targetLine.scale.z=r.length()}}(),Vl.prototype=Object.create(ka.prototype),Vl.prototype.constructor=Vl,Vl.prototype.update=function(){var t,e,r=new Ue,n=new pi;function i(i,o,a,s){r.set(o,a,s).unproject(n);var c=e[i];if(void 0!==c)for(var h=t.getAttribute("position"),l=0,u=c.length;l<u;l++)h.setXYZ(c[l],r.x,r.y,r.z)}return function(){t=this.geometry,e=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),kl.prototype=Object.create(ka.prototype),kl.prototype.constructor=kl,kl.prototype.update=function(){var t=new je;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var r=t.min,n=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),kl.prototype.setFromObject=function(t){return this.object=t,this.update(),this},jl.prototype=Object.create(ka.prototype),jl.prototype.constructor=jl,jl.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),ui.prototype.updateMatrixWorld.call(this,t))},Wl.prototype=Object.create(Va.prototype),Wl.prototype.constructor=Wl,Wl.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?d:p,this.lookAt(this.plane.normal),ui.prototype.updateMatrixWorld.call(this,t)},Xl.prototype=Object.create(ui.prototype),Xl.prototype.constructor=Xl,Xl.prototype.setDirection=function(){var t,e=new Ue;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(r.z,0,-r.x).normalize(),t=Math.acos(r.y),this.quaternion.setFromAxisAngle(e,t))}}(),Xl.prototype.setLength=function(t,e,r){void 0===e&&(e=.2*t),void 0===r&&(r=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix()},Xl.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},ql.prototype=Object.create(ka.prototype),ql.prototype.constructor=ql;var Zl=0,Jl=1;function Ql(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Kl(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function $l(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Xa(t,e)}function tu(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Ua(t)}function eu(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Xa(t,e)}function ru(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Wa(t)}function nu(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Wa(t)}function iu(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Wa(t)}function ou(t,e,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ue(t,e,r)}function au(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new vi(t,e).setDynamic(!0)}function su(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new yi(t,e)}function cu(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new xi(t,e)}function hu(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new bi(t,e)}function lu(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new _i(t,e)}function uu(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new wi(t,e)}function pu(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Mi(t,e)}function du(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ei(t,e)}function fu(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ti(t,e)}function mu(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Si(t,e)}function gu(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Wc.call(this,t),this.type="catmullrom",this.closed=!0}function vu(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Wc.call(this,t),this.type="catmullrom"}function yu(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Wc.call(this,t),this.type="catmullrom"}function xu(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new ql(t)}function bu(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new kl(t,e)}function _u(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ka(new hc(t.geometry),new Ha({color:void 0!==e?e:16777215}))}function wu(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ka(new Qa(t.geometry),new Ha({color:void 0!==e?e:16777215}))}function Mu(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Cc(t)}function Eu(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ic(t)}Bc.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Bc.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(lh.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new gi,r=0,n=t.length;r<n;r++){var i=t[r];e.vertices.push(new Ue(i.x,i.y,i.z||0))}return e}}),Object.assign(uh.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),gu.prototype=Object.create(Wc.prototype),vu.prototype=Object.create(Wc.prototype),yu.prototype=Object.create(Wc.prototype),Object.assign(yu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Fl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Nl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Gh.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Hh.extractUrlBase(t)}}),Object.assign(Ll.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(je.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Gi.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Oe,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Oe.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Oe.ceilPowerOfTwo(t)}}),Object.assign(Be.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ne.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new Ue),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,r,n,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,r,i,o)}}),Xe.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},De.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(zi.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Hi.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Hi,{barycoordFromPoint:function(t,e,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Hi.getBarycoord(t,e,r,n,i)},normal:function(t,e,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Hi.getNormal(t,e,r,n)}}),Object.assign(ph.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ys(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ac(this,t)}}),Object.assign(Ie.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ue.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ge.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(gi.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(ui.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(ui.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ba.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Fa.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Bc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Aa.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(dh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(vi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Pi.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Pi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Zs.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(vl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ui.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ni}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===m}}}),Object.defineProperties(_c.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Fi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Ca.prototype,{animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Ca.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(_a.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(He.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(La.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),ol.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new el).load(t,function(t){e.setBuffer(t)}),this},sl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},nl.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var Tu={merge:function(t,e,r){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,r)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},Su={crossOrigin:void 0,loadTexture:function(t,e,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Uc;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,r,void 0,n);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Dc;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,r,void 0,n);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function Au(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Ru(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}var Lu={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Pu(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}exports.WebGLRenderTargetCube=Ve,exports.WebGLRenderTarget=He,exports.WebGLRenderer=Ca,exports.ShaderLib=oi,exports.UniformsLib=ii,exports.UniformsUtils=ei,exports.ShaderChunk=ti,exports.FogExp2=Oa,exports.Fog=Ia,exports.Scene=Na,exports.Sprite=Ua,exports.LOD=Ba,exports.SkinnedMesh=Ga,exports.Skeleton=Fa,exports.Bone=za,exports.Mesh=Vi,exports.LineSegments=ka,exports.LineLoop=ja,exports.Line=Va,exports.Points=Xa,exports.Group=qa,exports.VideoTexture=Ya,exports.DataTexture=ke,exports.CompressedTexture=Za,exports.CubeTexture=to,exports.CanvasTexture=wa,exports.DepthTexture=Ja,exports.Texture=ze,exports.CompressedTextureLoader=Oc,exports.DataTextureLoader=Ic,exports.CubeTextureLoader=Dc,exports.TextureLoader=Uc,exports.ObjectLoader=kh,exports.MaterialLoader=Bh,exports.BufferGeometryLoader=Fh,exports.DefaultLoadingManager=Lc,exports.LoadingManager=Rc,exports.JSONLoader=Vh,exports.ImageLoader=Nc,exports.ImageBitmapLoader=Yh,exports.FontLoader=$h,exports.FileLoader=Cc,exports.Loader=Gh,exports.LoaderUtils=Hh,exports.Cache=Ac,exports.AudioLoader=el,exports.SpotLightShadow=gh,exports.SpotLight=vh,exports.PointLight=yh,exports.RectAreaLight=wh,exports.HemisphereLight=fh,exports.DirectionalLightShadow=xh,exports.DirectionalLight=bh,exports.AmbientLight=_h,exports.LightShadow=mh,exports.Light=dh,exports.StereoCamera=rl,exports.PerspectiveCamera=Aa,exports.OrthographicCamera=di,exports.CubeCamera=nl,exports.ArrayCamera=Ra,exports.Camera=pi,exports.AudioListener=il,exports.PositionalAudio=al,exports.AudioContext=tl,exports.AudioAnalyser=sl,exports.Audio=ol,exports.VectorKeyframeTrack=Dh,exports.StringKeyframeTrack=Mh,exports.QuaternionKeyframeTrack=Ah,exports.NumberKeyframeTrack=Lh,exports.ColorKeyframeTrack=Rh,exports.BooleanKeyframeTrack=Eh,exports.PropertyMixer=cl,exports.PropertyBinding=dl,exports.KeyframeTrack=Nh,exports.AnimationUtils=Ih,exports.AnimationObjectGroup=fl,exports.AnimationMixer=gl,exports.AnimationClip=Uh,exports.Uniform=vl,exports.InstancedBufferGeometry=yl,exports.BufferGeometry=Pi,exports.Geometry=gi,exports.InterleavedBufferAttribute=xl,exports.InstancedInterleavedBuffer=_l,exports.InterleavedBuffer=bl,exports.InstancedBufferAttribute=wl,exports.Face3=fi,exports.Object3D=ui,exports.Raycaster=Ml,exports.Layers=hi,exports.EventDispatcher=t,exports.Clock=Sl,exports.QuaternionLinearInterpolant=Sh,exports.LinearInterpolant=Ch,exports.DiscreteInterpolant=Oh,exports.CubicInterpolant=Ph,exports.Interpolant=Th,exports.Triangle=Hi,exports.Math=Oe,exports.Spherical=Al,exports.Cylindrical=Rl,exports.Plane=Xe,exports.Frustum=qe,exports.Sphere=We,exports.Ray=zi,exports.Matrix4=Ne,exports.Matrix3=Be,exports.Box3=je,exports.Box2=Ll,exports.Line3=Gi,exports.Euler=ci,exports.Vector4=Ge,exports.Vector3=Ue,exports.Vector2=Ie,exports.Quaternion=De,exports.Color=ni,exports.ImmediateRenderObject=Pl,exports.VertexNormalsHelper=Cl,exports.SpotLightHelper=Ol,exports.SkeletonHelper=Nl,exports.PointLightHelper=Dl,exports.RectAreaLightHelper=Ul,exports.HemisphereLightHelper=Bl,exports.GridHelper=Fl,exports.PolarGridHelper=zl,exports.FaceNormalsHelper=Gl,exports.DirectionalLightHelper=Hl,exports.CameraHelper=Vl,exports.BoxHelper=kl,exports.Box3Helper=jl,exports.PlaneHelper=Wl,exports.ArrowHelper=Xl,exports.AxesHelper=ql,exports.Shape=ph,exports.Path=uh,exports.ShapePath=Zh,exports.Font=Jh,exports.CurvePath=lh,exports.Curve=Bc,exports.ShapeUtils=Ws,exports.WebGLUtils=Sa,exports.WireframeGeometry=Qa,exports.ParametricGeometry=Ka,exports.ParametricBufferGeometry=$a,exports.TetrahedronGeometry=rs,exports.TetrahedronBufferGeometry=ns,exports.OctahedronGeometry=is,exports.OctahedronBufferGeometry=os,exports.IcosahedronGeometry=as,exports.IcosahedronBufferGeometry=ss,exports.DodecahedronGeometry=cs,exports.DodecahedronBufferGeometry=hs,exports.PolyhedronGeometry=ts,exports.PolyhedronBufferGeometry=es,exports.TubeGeometry=ls,exports.TubeBufferGeometry=us,exports.TorusKnotGeometry=ps,exports.TorusKnotBufferGeometry=ds,exports.TorusGeometry=fs,exports.TorusBufferGeometry=ms,exports.TextGeometry=Ks,exports.TextBufferGeometry=$s,exports.SphereGeometry=tc,exports.SphereBufferGeometry=ec,exports.RingGeometry=rc,exports.RingBufferGeometry=nc,exports.PlaneGeometry=Ii,exports.PlaneBufferGeometry=Ni,exports.LatheGeometry=ic,exports.LatheBufferGeometry=oc,exports.ShapeGeometry=ac,exports.ShapeBufferGeometry=sc,exports.ExtrudeGeometry=Ys,exports.ExtrudeBufferGeometry=Zs,exports.EdgesGeometry=hc,exports.ConeGeometry=pc,exports.ConeBufferGeometry=dc,exports.CylinderGeometry=lc,exports.CylinderBufferGeometry=uc,exports.CircleGeometry=fc,exports.CircleBufferGeometry=mc,exports.BoxGeometry=Ci,exports.BoxBufferGeometry=Oi,exports.ShadowMaterial=vc,exports.SpriteMaterial=Da,exports.RawShaderMaterial=yc,exports.ShaderMaterial=Fi,exports.PointsMaterial=Wa,exports.MeshPhysicalMaterial=bc,exports.MeshStandardMaterial=xc,exports.MeshPhongMaterial=_c,exports.MeshToonMaterial=wc,exports.MeshNormalMaterial=Mc,exports.MeshLambertMaterial=Ec,exports.MeshDepthMaterial=xa,exports.MeshDistanceMaterial=ba,exports.MeshBasicMaterial=Bi,exports.LineDashedMaterial=Tc,exports.LineBasicMaterial=Ha,exports.Material=Ui,exports.Float64BufferAttribute=Si,exports.Float32BufferAttribute=Ti,exports.Uint32BufferAttribute=Ei,exports.Int32BufferAttribute=Mi,exports.Uint16BufferAttribute=wi,exports.Int16BufferAttribute=_i,exports.Uint8ClampedBufferAttribute=bi,exports.Uint8BufferAttribute=xi,exports.Int8BufferAttribute=yi,exports.BufferAttribute=vi,exports.ArcCurve=zc,exports.CatmullRomCurve3=Wc,exports.CubicBezierCurve=rh,exports.CubicBezierCurve3=nh,exports.EllipseCurve=Fc,exports.LineCurve=ih,exports.LineCurve3=oh,exports.QuadraticBezierCurve=ah,exports.QuadraticBezierCurve3=sh,exports.SplineCurve=ch,exports.REVISION=e,exports.MOUSE=r,exports.CullFaceNone=n,exports.CullFaceBack=i,exports.CullFaceFront=o,exports.CullFaceFrontBack=a,exports.FrontFaceDirectionCW=s,exports.FrontFaceDirectionCCW=c,exports.BasicShadowMap=h,exports.PCFShadowMap=l,exports.PCFSoftShadowMap=u,exports.FrontSide=p,exports.BackSide=d,exports.DoubleSide=f,exports.FlatShading=m,exports.SmoothShading=g,exports.NoColors=v,exports.FaceColors=y,exports.VertexColors=x,exports.NoBlending=b,exports.NormalBlending=_,exports.AdditiveBlending=w,exports.SubtractiveBlending=M,exports.MultiplyBlending=E,exports.CustomBlending=T,exports.AddEquation=S,exports.SubtractEquation=A,exports.ReverseSubtractEquation=R,exports.MinEquation=L,exports.MaxEquation=P,exports.ZeroFactor=C,exports.OneFactor=O,exports.SrcColorFactor=I,exports.OneMinusSrcColorFactor=N,exports.SrcAlphaFactor=D,exports.OneMinusSrcAlphaFactor=U,exports.DstAlphaFactor=B,exports.OneMinusDstAlphaFactor=F,exports.DstColorFactor=z,exports.OneMinusDstColorFactor=G,exports.SrcAlphaSaturateFactor=H,exports.NeverDepth=V,exports.AlwaysDepth=k,exports.LessDepth=j,exports.LessEqualDepth=W,exports.EqualDepth=X,exports.GreaterEqualDepth=q,exports.GreaterDepth=Y,exports.NotEqualDepth=Z,exports.MultiplyOperation=J,exports.MixOperation=Q,exports.AddOperation=K,exports.NoToneMapping=$,exports.LinearToneMapping=tt,exports.ReinhardToneMapping=et,exports.Uncharted2ToneMapping=rt,exports.CineonToneMapping=nt,exports.UVMapping=it,exports.CubeReflectionMapping=ot,exports.CubeRefractionMapping=at,exports.EquirectangularReflectionMapping=st,exports.EquirectangularRefractionMapping=ct,exports.SphericalReflectionMapping=ht,exports.CubeUVReflectionMapping=lt,exports.CubeUVRefractionMapping=ut,exports.RepeatWrapping=pt,exports.ClampToEdgeWrapping=dt,exports.MirroredRepeatWrapping=ft,exports.NearestFilter=mt,exports.NearestMipMapNearestFilter=gt,exports.NearestMipMapLinearFilter=vt,exports.LinearFilter=yt,exports.LinearMipMapNearestFilter=xt,exports.LinearMipMapLinearFilter=bt,exports.UnsignedByteType=_t,exports.ByteType=wt,exports.ShortType=Mt,exports.UnsignedShortType=Et,exports.IntType=Tt,exports.UnsignedIntType=St,exports.FloatType=At,exports.HalfFloatType=Rt,exports.UnsignedShort4444Type=Lt,exports.UnsignedShort5551Type=Pt,exports.UnsignedShort565Type=Ct,exports.UnsignedInt248Type=Ot,exports.AlphaFormat=It,exports.RGBFormat=Nt,exports.RGBAFormat=Dt,exports.LuminanceFormat=Ut,exports.LuminanceAlphaFormat=Bt,exports.RGBEFormat=Ft,exports.DepthFormat=zt,exports.DepthStencilFormat=Gt,exports.RGB_S3TC_DXT1_Format=Ht,exports.RGBA_S3TC_DXT1_Format=Vt,exports.RGBA_S3TC_DXT3_Format=kt,exports.RGBA_S3TC_DXT5_Format=jt,exports.RGB_PVRTC_4BPPV1_Format=Wt,exports.RGB_PVRTC_2BPPV1_Format=Xt,exports.RGBA_PVRTC_4BPPV1_Format=qt,exports.RGBA_PVRTC_2BPPV1_Format=Yt,exports.RGB_ETC1_Format=Zt,exports.RGBA_ASTC_4x4_Format=Jt,exports.RGBA_ASTC_5x4_Format=Qt,exports.RGBA_ASTC_5x5_Format=Kt,exports.RGBA_ASTC_6x5_Format=$t,exports.RGBA_ASTC_6x6_Format=te,exports.RGBA_ASTC_8x5_Format=ee,exports.RGBA_ASTC_8x6_Format=re,exports.RGBA_ASTC_8x8_Format=ne,exports.RGBA_ASTC_10x5_Format=ie,exports.RGBA_ASTC_10x6_Format=oe,exports.RGBA_ASTC_10x8_Format=ae,exports.RGBA_ASTC_10x10_Format=se,exports.RGBA_ASTC_12x10_Format=ce,exports.RGBA_ASTC_12x12_Format=he,exports.LoopOnce=le,exports.LoopRepeat=ue,exports.LoopPingPong=pe,exports.InterpolateDiscrete=de,exports.InterpolateLinear=fe,exports.InterpolateSmooth=me,exports.ZeroCurvatureEnding=ge,exports.ZeroSlopeEnding=ve,exports.WrapAroundEnding=ye,exports.TrianglesDrawMode=xe,exports.TriangleStripDrawMode=be,exports.TriangleFanDrawMode=_e,exports.LinearEncoding=we,exports.sRGBEncoding=Me,exports.GammaEncoding=Ee,exports.RGBEEncoding=Te,exports.LogLuvEncoding=Se,exports.RGBM7Encoding=Ae,exports.RGBM16Encoding=Re,exports.RGBDEncoding=Le,exports.BasicDepthPacking=Pe,exports.RGBADepthPacking=Ce,exports.CubeGeometry=Ci,exports.Face4=Yl,exports.LineStrip=Zl,exports.LinePieces=Jl,exports.MeshFaceMaterial=Ql,exports.MultiMaterial=Kl,exports.PointCloud=$l,exports.Particle=tu,exports.ParticleSystem=eu,exports.PointCloudMaterial=ru,exports.ParticleBasicMaterial=nu,exports.ParticleSystemMaterial=iu,exports.Vertex=ou,exports.DynamicBufferAttribute=au,exports.Int8Attribute=su,exports.Uint8Attribute=cu,exports.Uint8ClampedAttribute=hu,exports.Int16Attribute=lu,exports.Uint16Attribute=uu,exports.Int32Attribute=pu,exports.Uint32Attribute=du,exports.Float32Attribute=fu,exports.Float64Attribute=mu,exports.ClosedSplineCurve3=gu,exports.SplineCurve3=vu,exports.Spline=yu,exports.AxisHelper=xu,exports.BoundingBoxHelper=bu,exports.EdgesHelper=_u,exports.WireframeHelper=wu,exports.XHRLoader=Mu,exports.BinaryTextureLoader=Eu,exports.GeometryUtils=Tu,exports.ImageUtils=Su,exports.Projector=Au,exports.CanvasRenderer=Ru,exports.SceneUtils=Lu,exports.LensFlare=Pu;
},{}],149:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{dispose(){}}exports.Disposable=e;
},{}],173:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdaptiveLuminosityMaterial=void 0;var r=require("three");const n="uniform sampler2D tPreviousLum;\r\nuniform sampler2D tCurrentLum;\r\nuniform float minLuminance;\r\nuniform float delta;\r\nuniform float tau;\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tfloat previousLum = texture2D(tPreviousLum, vUv, MIP_LEVEL_1X1).r;\r\n\tfloat currentLum = texture2D(tCurrentLum, vUv, MIP_LEVEL_1X1).r;\r\n\r\n\tpreviousLum = max(minLuminance, previousLum);\r\n\tcurrentLum = max(minLuminance, currentLum);\r\n\r\n\t// Adapt the luminance using Pattanaik's technique.\r\n\tfloat adaptedLum = previousLum + (currentLum - previousLum) * (1.0 - exp(-delta * tau));\r\n\r\n\tgl_FragColor.r = adaptedLum;\r\n\r\n}\r\n",e="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends r.ShaderMaterial{constructor(){super({type:"AdaptiveLuminosityMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{tPreviousLum:new r.Uniform(null),tCurrentLum:new r.Uniform(null),minLuminance:new r.Uniform(.01),delta:new r.Uniform(0),tau:new r.Uniform(1)},fragmentShader:n,vertexShader:e,depthWrite:!1,depthTest:!1})}}exports.AdaptiveLuminosityMaterial=t;
},{"three":25}],174:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BokehMaterial=void 0;var r=require("three");const e="uniform sampler2D tDiffuse;\r\nuniform sampler2D tDepth;\r\n\r\nuniform float focus;\r\nuniform float dof;\r\nuniform float aspect;\r\nuniform float aperture;\r\nuniform float maxBlur;\r\n\r\nvarying vec2 vUv;\r\n\r\n#ifndef USE_LOGDEPTHBUF\r\n\r\n\t#include <packing>\r\n\r\n\tuniform float cameraNear;\r\n\tuniform float cameraFar;\r\n\r\n\tfloat readDepth(sampler2D depthSampler, vec2 coord) {\r\n\r\n\t\tfloat fragCoordZ = texture2D(depthSampler, coord).x;\r\n\t\tfloat viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\r\n\r\n\t\treturn viewZToOrthographicDepth(viewZ, cameraNear, cameraFar);\r\n\r\n\t}\r\n\r\n#endif\r\n\r\nvoid main() {\r\n\r\n\tvec2 aspectCorrection = vec2(1.0, aspect);\r\n\r\n\t#ifdef USE_LOGDEPTHBUF\r\n\r\n\t\tfloat depth = texture2D(tDepth, vUv).x;\r\n\r\n\t#else\r\n\r\n\t\tfloat depth = readDepth(tDepth, vUv);\r\n\r\n\t#endif\r\n\r\n\tfloat focusNear = clamp(focus - dof, 0.0, 1.0);\r\n\tfloat focusFar = clamp(focus + dof, 0.0, 1.0);\r\n\r\n\t// Calculate a DoF mask.\r\n\tfloat low = step(depth, focusNear);\r\n\tfloat high = step(focusFar, depth);\r\n\r\n\tfloat factor = (depth - focusNear) * low + (depth - focusFar) * high;\r\n\r\n\tvec2 dofBlur = vec2(clamp(factor * aperture, -maxBlur, maxBlur));\r\n\r\n\tvec2 dofblur9 = dofBlur * 0.9;\r\n\tvec2 dofblur7 = dofBlur * 0.7;\r\n\tvec2 dofblur4 = dofBlur * 0.4;\r\n\r\n\tvec4 color = vec4(0.0);\r\n\r\n\tcolor += texture2D(tDiffuse, vUv);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.0,   0.4 ) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.15,  0.37) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.29,  0.29) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.37,  0.15) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.40,  0.0 ) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.37, -0.15) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.29, -0.29) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.15, -0.37) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.0,  -0.4 ) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.15,  0.37) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.29,  0.29) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.37,  0.15) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.4,   0.0 ) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.37, -0.15) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.29, -0.29) * aspectCorrection) * dofBlur);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.15, -0.37) * aspectCorrection) * dofBlur);\r\n\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.15,  0.37) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.37,  0.15) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.37, -0.15) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.15, -0.37) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.15,  0.37) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.37,  0.15) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.37, -0.15) * aspectCorrection) * dofblur9);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.15, -0.37) * aspectCorrection) * dofblur9);\r\n\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.29,  0.29) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.40,  0.0 ) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.29, -0.29) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.0,  -0.4 ) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.29,  0.29) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.4,   0.0 ) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.29, -0.29) * aspectCorrection) * dofblur7);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.0,   0.4 ) * aspectCorrection) * dofblur7);\r\n\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.29,  0.29) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.4,   0.0 ) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.29, -0.29) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.0,  -0.4 ) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.29,  0.29) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.4,   0.0 ) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2(-0.29, -0.29) * aspectCorrection) * dofblur4);\r\n\tcolor += texture2D(tDiffuse, vUv + (vec2( 0.0,   0.4 ) * aspectCorrection) * dofblur4);\r\n\r\n\tgl_FragColor = color / 41.0;\r\n\r\n}\r\n",t="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class o extends r.ShaderMaterial{constructor(o,c={}){const n=Object.assign({focus:1,dof:.02,aperture:.025,maxBlur:1},c);super({type:"BokehMaterial",uniforms:{cameraNear:new r.Uniform(.1),cameraFar:new r.Uniform(2e3),aspect:new r.Uniform(1),tDiffuse:new r.Uniform(null),tDepth:new r.Uniform(null),focus:new r.Uniform(n.focus),dof:new r.Uniform(n.dof),aperture:new r.Uniform(n.aperture),maxBlur:new r.Uniform(n.maxBlur)},fragmentShader:e,vertexShader:t,depthWrite:!1,depthTest:!1}),this.adoptCameraSettings(o)}adoptCameraSettings(r=null){null!==r&&(this.uniforms.cameraNear.value=r.near,this.uniforms.cameraFar.value=r.far,this.uniforms.aspect.value=r.aspect)}}exports.BokehMaterial=o;
},{"three":25}],175:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorEdgesMaterial=void 0;var t=require("three");const e="uniform sampler2D tDiffuse;\r\n\r\nvarying vec2 vUv;\r\nvarying vec4 vOffset[3];\r\n\r\nvoid main() {\r\n\r\n\tconst vec2 threshold = vec2(EDGE_THRESHOLD);\r\n\r\n\t// Calculate color deltas.\r\n\tvec4 delta;\r\n\tvec3 c = texture2D(tDiffuse, vUv).rgb;\r\n\r\n\tvec3 cLeft = texture2D(tDiffuse, vOffset[0].xy).rgb;\r\n\tvec3 t = abs(c - cLeft);\r\n\tdelta.x = max(max(t.r, t.g), t.b);\r\n\r\n\tvec3 cTop = texture2D(tDiffuse, vOffset[0].zw).rgb;\r\n\tt = abs(c - cTop);\r\n\tdelta.y = max(max(t.r, t.g), t.b);\r\n\r\n\t// We do the usual threshold.\r\n\tvec2 edges = step(threshold, delta.xy);\r\n\r\n\t// Then discard if there is no edge.\r\n\tif(dot(edges, vec2(1.0)) == 0.0) {\r\n\r\n\t\tdiscard;\r\n\r\n\t}\r\n\r\n\t// Calculate right and bottom deltas.\r\n\tvec3 cRight = texture2D(tDiffuse, vOffset[1].xy).rgb;\r\n\tt = abs(c - cRight);\r\n\tdelta.z = max(max(t.r, t.g), t.b);\r\n\r\n\tvec3 cBottom = texture2D(tDiffuse, vOffset[1].zw).rgb;\r\n\tt = abs(c - cBottom);\r\n\tdelta.w = max(max(t.r, t.g), t.b);\r\n\r\n\t// Calculate the maximum delta in the direct neighborhood.\r\n\tfloat maxDelta = max(max(max(delta.x, delta.y), delta.z), delta.w);\r\n\r\n\t// Calculate left-left and top-top deltas.\r\n\tvec3 cLeftLeft = texture2D(tDiffuse, vOffset[2].xy).rgb;\r\n\tt = abs(c - cLeftLeft);\r\n\tdelta.z = max(max(t.r, t.g), t.b);\r\n\r\n\tvec3 cTopTop = texture2D(tDiffuse, vOffset[2].zw).rgb;\r\n\tt = abs(c - cTopTop);\r\n\tdelta.w = max(max(t.r, t.g), t.b);\r\n\r\n\t// Calculate the final maximum delta.\r\n\tmaxDelta = max(max(maxDelta, delta.z), delta.w);\r\n\r\n\t// Local contrast adaptation in action.\r\n\tedges.xy *= step(0.5 * maxDelta, delta.xy);\r\n\r\n\tgl_FragColor = vec4(edges, 0.0, 0.0);\r\n\r\n}\r\n",r="uniform vec2 texelSize;\r\n\r\nvarying vec2 vUv;\r\nvarying vec4 vOffset[3];\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tvOffset[0] = uv.xyxy + texelSize.xyxy * vec4(-1.0, 0.0, 0.0, 1.0); // Changed sign in W component.\r\n\tvOffset[1] = uv.xyxy + texelSize.xyxy * vec4(1.0, 0.0, 0.0, -1.0); // Changed sign in W component.\r\n\tvOffset[2] = uv.xyxy + texelSize.xyxy * vec4(-2.0, 0.0, 0.0, 2.0); // Changed sign in W component.\r\n\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class n extends t.ShaderMaterial{constructor(n=new t.Vector2){super({type:"ColorEdgesMaterial",defines:{EDGE_THRESHOLD:"0.1"},uniforms:{tDiffuse:new t.Uniform(null),texelSize:new t.Uniform(n)},fragmentShader:e,vertexShader:r,depthWrite:!1,depthTest:!1})}setEdgeDetectionThreshold(t){this.defines.EDGE_THRESHOLD=t.toFixed("2"),this.needsUpdate=!0}}exports.ColorEdgesMaterial=n;
},{"three":25}],176:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CombineMaterial=void 0;var e=require("three");const r="uniform sampler2D texture1;\r\nuniform sampler2D texture2;\r\n\r\nuniform float opacity1;\r\nuniform float opacity2;\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel1 = opacity1 * texture2D(texture1, vUv);\r\n\tvec4 texel2 = opacity2 * texture2D(texture2, vUv);\r\n\r\n\t#ifdef SCREEN_MODE\r\n\r\n\t\tvec3 invTexel1 = vec3(1.0) - texel1.rgb;\r\n\t\tvec3 invTexel2 = vec3(1.0) - texel2.rgb;\r\n\r\n\t\tvec4 color = vec4(\r\n\t\t\tvec3(1.0) - invTexel1 * invTexel2,\r\n\t\t\ttexel1.a + texel2.a\r\n\t\t);\r\n\r\n\t#else\r\n\r\n\t\tvec4 color = texel1 + texel2;\r\n\r\n\t#endif\r\n\r\n\tgl_FragColor = color;\r\n\r\n}\r\n",t="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class n extends e.ShaderMaterial{constructor(n=!1){super({type:"CombineMaterial",uniforms:{texture1:new e.Uniform(null),texture2:new e.Uniform(null),opacity1:new e.Uniform(1),opacity2:new e.Uniform(1)},fragmentShader:r,vertexShader:t,depthWrite:!1,depthTest:!1}),this.setScreenModeEnabled(n)}setScreenModeEnabled(e){e?this.defines.SCREEN_MODE="1":delete this.defines.SCREEN_MODE,this.needsUpdate=!0}}exports.CombineMaterial=n;
},{"three":25}],177:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KernelSize=exports.ConvolutionMaterial=void 0;var e=require("three");const r="#include <common>\r\n#include <dithering_pars_fragment>\r\n\r\nuniform sampler2D tDiffuse;\r\n\r\nvarying vec2 vUv0;\r\nvarying vec2 vUv1;\r\nvarying vec2 vUv2;\r\nvarying vec2 vUv3;\r\n\r\nvoid main() {\r\n\r\n\t// Sample top left texel.\r\n\tvec4 sum = texture2D(tDiffuse, vUv0);\r\n\r\n\t// Sample top right texel.\r\n\tsum += texture2D(tDiffuse, vUv1);\r\n\r\n\t// Sample bottom right texel.\r\n\tsum += texture2D(tDiffuse, vUv2);\r\n\r\n\t// Sample bottom left texel.\r\n\tsum += texture2D(tDiffuse, vUv3);\r\n\r\n\t// Compute the average.\r\n\tgl_FragColor = sum * 0.25;\r\n\r\n\t#include <dithering_fragment>\r\n\r\n}\r\n",n="uniform vec2 texelSize;\r\nuniform vec2 halfTexelSize;\r\nuniform float kernel;\r\n\r\nvarying vec2 vUv0;\r\nvarying vec2 vUv1;\r\nvarying vec2 vUv2;\r\nvarying vec2 vUv3;\r\n\r\nvoid main() {\r\n\r\n\tvec2 dUv = (texelSize * vec2(kernel)) + halfTexelSize;\r\n\r\n\tvUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\r\n\tvUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\r\n\tvUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\r\n\tvUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\r\n\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends e.ShaderMaterial{constructor(t=new e.Vector2){super({type:"ConvolutionMaterial",uniforms:{tDiffuse:new e.Uniform(null),texelSize:new e.Uniform(new e.Vector2),halfTexelSize:new e.Uniform(new e.Vector2),kernel:new e.Uniform(0)},fragmentShader:r,vertexShader:n,depthWrite:!1,depthTest:!1}),this.setTexelSize(t.x,t.y),this.kernelSize=i.LARGE}getKernel(){return v[this.kernelSize]}setTexelSize(e,r){this.uniforms.texelSize.value.set(e,r),this.uniforms.halfTexelSize.value.set(e,r).multiplyScalar(.5)}}exports.ConvolutionMaterial=t;const v=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],i=exports.KernelSize={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5};
},{"three":25}],178:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CopyMaterial=void 0;var r=require("three");const e="uniform sampler2D tDiffuse;\r\nuniform float opacity;\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel = texture2D(tDiffuse, vUv);\r\n\tgl_FragColor = opacity * texel;\r\n\r\n}\r\n",t="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class n extends r.ShaderMaterial{constructor(){super({type:"CopyMaterial",uniforms:{tDiffuse:new r.Uniform(null),opacity:new r.Uniform(1)},fragmentShader:e,vertexShader:t,depthWrite:!1,depthTest:!1})}}exports.CopyMaterial=n;
},{"three":25}],179:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DepthComparisonMaterial=void 0;var r=require("three");const e="#include <packing>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nuniform sampler2D tDepth;\r\nuniform float cameraNear;\r\nuniform float cameraFar;\r\n\r\nvarying float vViewZ;\r\nvarying vec4 vProjTexCoord;\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\t// Transform into Cartesian coordinate (not mirrored).\r\n\tvec2 projTexCoord = (vProjTexCoord.xy / vProjTexCoord.w) * 0.5 + 0.5;\r\n\tprojTexCoord = clamp(projTexCoord, 0.002, 0.998);\r\n\r\n\tfloat fragCoordZ = unpackRGBAToDepth(texture2D(tDepth, projTexCoord));\r\n\r\n\t#ifdef PERSPECTIVE_CAMERA\r\n\r\n\t\tfloat viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\r\n\r\n\t#else\r\n\r\n\t\tfloat viewZ = orthographicDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\r\n\r\n\t#endif\r\n\r\n\tfloat depthTest = (-vViewZ > -viewZ) ? 1.0 : 0.0;\r\n\r\n\tgl_FragColor.rgb = vec3(0.0, depthTest, 1.0);\r\n\r\n}\r\n",n="#include <common>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvarying float vViewZ;\r\nvarying vec4 vProjTexCoord;\r\n\r\nvoid main() {\r\n\r\n\t#include <skinbase_vertex>\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <project_vertex>\r\n\r\n\tvViewZ = mvPosition.z;\r\n\tvProjTexCoord = gl_Position;\r\n\r\n\t#include <clipping_planes_vertex>\r\n\r\n}\r\n";class t extends r.ShaderMaterial{constructor(t=null,a){super({type:"DepthComparisonMaterial",uniforms:{tDepth:new r.Uniform(t),cameraNear:new r.Uniform(.1),cameraFar:new r.Uniform(2e3)},fragmentShader:e,vertexShader:n,depthWrite:!1,depthTest:!1,morphTargets:!0,skinning:!0}),this.adoptCameraSettings(a)}adoptCameraSettings(e=null){null!==e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof r.PerspectiveCamera?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA)}}exports.DepthComparisonMaterial=t;
},{"three":25}],180:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DotScreenMaterial=void 0;var e=require("three");const r="uniform sampler2D tDiffuse;\r\n\r\nuniform float angle;\r\nuniform float scale;\r\nuniform float intensity;\r\n\r\nvarying vec2 vUv;\r\nvarying vec2 vUvPattern;\r\n\r\nfloat pattern() {\r\n\r\n\tfloat s = sin(angle);\r\n\tfloat c = cos(angle);\r\n\r\n\tvec2 point = vec2(c * vUvPattern.x - s * vUvPattern.y, s * vUvPattern.x + c * vUvPattern.y) * scale;\r\n\r\n\treturn (sin(point.x) * sin(point.y)) * 4.0;\r\n\r\n}\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel = texture2D(tDiffuse, vUv);\r\n\tvec3 color = texel.rgb;\r\n\r\n\t#ifdef AVERAGE\r\n\r\n\t\tcolor = vec3((color.r + color.g + color.b) / 3.0);\r\n\r\n\t#endif\r\n\r\n\tcolor = vec3(color * 10.0 - 5.0 + pattern());\r\n\tcolor = texel.rgb + (color - texel.rgb) * intensity;\r\n\r\n\tgl_FragColor = vec4(color, texel.a);\r\n\r\n}\r\n",n="uniform vec4 offsetRepeat;\r\n\r\nvarying vec2 vUv;\r\nvarying vec2 vUvPattern;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tvUvPattern = uv * offsetRepeat.zw + offsetRepeat.xy;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends e.ShaderMaterial{constructor(t={}){const o=Object.assign({average:!1,angle:1.57,scale:1,intensity:1},t);super({type:"DotScreenMaterial",uniforms:{tDiffuse:new e.Uniform(null),angle:new e.Uniform(o.angle),scale:new e.Uniform(o.scale),intensity:new e.Uniform(o.intensity),offsetRepeat:new e.Uniform(new e.Vector4(.5,.5,1,1))},fragmentShader:r,vertexShader:n,depthWrite:!1,depthTest:!1}),this.setAverageEnabled(o.average)}setAverageEnabled(e){e?this.defines.AVERAGE="1":delete this.defines.AVERAGE,this.needsUpdate=!0}}exports.DotScreenMaterial=t;
},{"three":25}],181:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FilmMaterial=void 0;var e=require("three");const n="uniform sampler2D tDiffuse;\r\nuniform float time;\r\n\r\nvarying vec2 vUv;\r\n\r\n#ifdef NOISE\r\n\r\n\tuniform float noiseIntensity;\r\n\r\n#endif\r\n\r\n#ifdef SCANLINES\r\n\r\n\tuniform float scanlineIntensity;\r\n\tuniform float scanlineCount;\r\n\r\n#endif\r\n\r\n#ifdef GRID\r\n\r\n\tuniform float gridIntensity;\r\n\tuniform vec2 gridScale;\r\n\tuniform float gridLineWidth;\r\n\r\n#endif\r\n\r\n#ifdef GREYSCALE\r\n\r\n\t#include <common>\r\n\r\n\tuniform float greyscaleIntensity;\r\n\r\n#elif defined(SEPIA)\r\n\r\n\tuniform float sepiaIntensity;\r\n\r\n#endif\r\n\r\n#ifdef VIGNETTE\r\n\r\n\tuniform float vignetteOffset;\r\n\tuniform float vignetteDarkness;\r\n\r\n#endif\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel = texture2D(tDiffuse, vUv);\r\n\tvec3 color = texel.rgb;\r\n\r\n\t#ifdef SCREEN_MODE\r\n\r\n\t\tvec3 invColor;\r\n\r\n\t#endif\r\n\r\n\t#ifdef NOISE\r\n\r\n\t\tfloat x = vUv.x * vUv.y * time * 1000.0;\r\n\t\tx = mod(x, 13.0) * mod(x, 123.0);\r\n\t\tx = mod(x, 0.01);\r\n\r\n\t\tvec3 noise = texel.rgb * clamp(0.1 + x * 100.0, 0.0, 1.0) * noiseIntensity;\r\n\r\n\t\t#ifdef SCREEN_MODE\r\n\r\n\t\t\tinvColor = vec3(1.0) - color;\r\n\t\t\tvec3 invNoise = vec3(1.0) - noise;\r\n\r\n\t\t\tcolor = vec3(1.0) - invColor * invNoise;\r\n\r\n\t\t#else\r\n\r\n\t\t\tcolor += noise;\r\n\r\n\t\t#endif\r\n\r\n\t#endif\r\n\r\n\t#ifdef SCANLINES\r\n\r\n\t\tvec2 sl = vec2(sin(vUv.y * scanlineCount), cos(vUv.y * scanlineCount));\r\n\t\tvec3 scanlines = texel.rgb * vec3(sl.x, sl.y, sl.x) * scanlineIntensity;\r\n\r\n\t\t#ifdef SCREEN_MODE\r\n\r\n\t\t\tinvColor = vec3(1.0) - color;\r\n\t\t\tvec3 invScanlines = vec3(1.0) - scanlines;\r\n\r\n\t\t\tcolor = vec3(1.0) - invColor * invScanlines;\r\n\r\n\t\t#else\r\n\r\n\t\t\tcolor += scanlines;\r\n\r\n\t\t#endif\r\n\r\n\t#endif\r\n\r\n\t#ifdef GRID\r\n\r\n\t\tfloat grid = 0.5 - max(abs(mod(vUv.x * gridScale.x, 1.0) - 0.5), abs(mod(vUv.y * gridScale.y, 1.0) - 0.5));\r\n\t\tcolor *= (1.0 - gridIntensity) + vec3(smoothstep(0.0, gridLineWidth, grid)) * gridIntensity;\r\n\r\n\t#endif\r\n\r\n\t#ifdef GREYSCALE\r\n\r\n\t\tcolor = mix(color, vec3(linearToRelativeLuminance(color)), greyscaleIntensity);\r\n\r\n\t#elif defined(SEPIA)\r\n\r\n\t\tvec3 c = color.rgb;\r\n\r\n\t\tcolor.r = dot(c, vec3(1.0 - 0.607 * sepiaIntensity, 0.769 * sepiaIntensity, 0.189 * sepiaIntensity));\r\n\t\tcolor.g = dot(c, vec3(0.349 * sepiaIntensity, 1.0 - 0.314 * sepiaIntensity, 0.168 * sepiaIntensity));\r\n\t\tcolor.b = dot(c, vec3(0.272 * sepiaIntensity, 0.534 * sepiaIntensity, 1.0 - 0.869 * sepiaIntensity));\r\n\r\n\t#endif\r\n\r\n\t#ifdef VIGNETTE\r\n\r\n\t\tconst vec2 center = vec2(0.5);\r\n\r\n\t\t#ifdef ESKIL\r\n\r\n\t\t\tvec2 uv = (vUv - center) * vec2(vignetteOffset);\r\n\t\t\tcolor = mix(color.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));\r\n\r\n\t\t#else\r\n\r\n\t\t\tfloat dist = distance(vUv, center);\r\n\t\t\tcolor *= smoothstep(0.8, vignetteOffset * 0.799, dist * (vignetteDarkness + vignetteOffset));\r\n\r\n\t\t#endif\t\t\r\n\r\n\t#endif\r\n\r\n\tgl_FragColor = vec4(clamp(color, 0.0, 1.0), texel.a);\r\n\r\n}\r\n",t="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class i extends e.ShaderMaterial{constructor(i={}){const r=Object.assign({screenMode:!0,noise:!0,scanlines:!0,grid:!1,greyscale:!1,sepia:!1,vignette:!1,eskil:!1,noiseIntensity:.5,scanlineIntensity:.05,gridIntensity:1,greyscaleIntensity:1,sepiaIntensity:1,vignetteOffset:1,vignetteDarkness:1},i);super({type:"FilmMaterial",uniforms:{tDiffuse:new e.Uniform(null),time:new e.Uniform(0),noiseIntensity:new e.Uniform(r.noiseIntensity),scanlineIntensity:new e.Uniform(r.scanlineIntensity),gridIntensity:new e.Uniform(r.gridIntensity),scanlineCount:new e.Uniform(0),gridScale:new e.Uniform(new e.Vector2),gridLineWidth:new e.Uniform(0),greyscaleIntensity:new e.Uniform(r.greyscaleIntensity),sepiaIntensity:new e.Uniform(r.sepiaIntensity),vignetteOffset:new e.Uniform(r.vignetteOffset),vignetteDarkness:new e.Uniform(r.vignetteDarkness)},fragmentShader:n,vertexShader:t,depthWrite:!1,depthTest:!1}),this.setScreenModeEnabled(r.screenMode),this.setNoiseEnabled(r.noise),this.setScanlinesEnabled(r.scanlines),this.setGridEnabled(r.grid),this.setGreyscaleEnabled(r.greyscale),this.setSepiaEnabled(r.sepia),this.setVignetteEnabled(r.vignette),this.setEskilEnabled(r.eskil)}setScreenModeEnabled(e){e?this.defines.SCREEN_MODE="1":delete this.defines.SCREEN_MODE,this.needsUpdate=!0}setNoiseEnabled(e){e?this.defines.NOISE="1":delete this.defines.NOISE,this.needsUpdate=!0}setScanlinesEnabled(e){e?this.defines.SCANLINES="1":delete this.defines.SCANLINES,this.needsUpdate=!0}setGridEnabled(e){e?this.defines.GRID="1":delete this.defines.GRID,this.needsUpdate=!0}setGreyscaleEnabled(e){e?this.defines.GREYSCALE="1":delete this.defines.GREYSCALE,this.needsUpdate=!0}setSepiaEnabled(e){e?this.defines.SEPIA="1":delete this.defines.SEPIA,this.needsUpdate=!0}setVignetteEnabled(e){e?this.defines.VIGNETTE="1":delete this.defines.VIGNETTE,this.needsUpdate=!0}setEskilEnabled(e){e?this.defines.ESKIL="1":delete this.defines.ESKIL,this.needsUpdate=!0}}exports.FilmMaterial=i;
},{"three":25}],182:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlitchMaterial=void 0;var r=require("three");const t="uniform sampler2D tDiffuse;\r\nuniform sampler2D tPerturb;\r\n\r\nuniform bool active;\r\n\r\nuniform float amount;\r\nuniform float angle;\r\nuniform float seed;\r\nuniform float seedX;\r\nuniform float seedY;\r\nuniform float distortionX;\r\nuniform float distortionY;\r\nuniform float colS;\r\n\r\nvarying vec2 vUv;\r\n\r\nfloat rand(vec2 tc) {\r\n\r\n\tconst float a = 12.9898;\r\n\tconst float b = 78.233;\r\n\tconst float c = 43758.5453;\r\n\r\n\tfloat dt = dot(tc, vec2(a, b));\r\n\tfloat sn = mod(dt, 3.14);\r\n\r\n\treturn fract(sin(sn) * c);\r\n\r\n}\r\n\r\nvoid main() {\r\n\r\n\tvec2 coord = vUv;\r\n\r\n\tfloat xs, ys;\r\n\tvec4 normal;\r\n\r\n\tvec2 offset;\r\n\tvec4 cr, cga, cb;\r\n\tvec4 snow, color;\r\n\r\n\tfloat sx, sy;\r\n\r\n\tif(active) {\r\n\r\n\t\txs = floor(gl_FragCoord.x / 0.5);\r\n\t\tys = floor(gl_FragCoord.y / 0.5);\r\n\r\n\t\tnormal = texture2D(tPerturb, coord * seed * seed);\r\n\r\n\t\tif(coord.y < distortionX + colS && coord.y > distortionX - colS * seed) {\r\n\r\n\t\t\tsx = clamp(ceil(seedX), 0.0, 1.0);\r\n\t\t\tcoord.y = sx * (1.0 - (coord.y + distortionY)) + (1.0 - sx) * distortionY;\r\n\r\n\t\t}\r\n\r\n\t\tif(coord.x < distortionY + colS && coord.x > distortionY - colS * seed) {\r\n\r\n\t\t\tsy = clamp(ceil(seedY), 0.0, 1.0);\r\n\t\t\tcoord.x = sy * distortionX + (1.0 - sy) * (1.0 - (coord.x + distortionX));\r\n\r\n\t\t}\r\n\r\n\t\tcoord.x += normal.x * seedX * (seed / 5.0);\r\n\t\tcoord.y += normal.y * seedY * (seed / 5.0);\r\n\r\n\t\toffset = amount * vec2(cos(angle), sin(angle));\r\n\r\n\t\tcr = texture2D(tDiffuse, coord + offset);\r\n\t\tcga = texture2D(tDiffuse, coord);\r\n\t\tcb = texture2D(tDiffuse, coord - offset);\r\n\r\n\t\tcolor = vec4(cr.r, cga.g, cb.b, cga.a);\r\n\t\tsnow = 200.0 * amount * vec4(rand(vec2(xs * seed, ys * seed * 50.0)) * 0.2);\r\n\t\tcolor += snow;\r\n\r\n\t} else {\r\n\r\n\t\tcolor = texture2D(tDiffuse, vUv);\r\n\r\n\t}\r\n\r\n\tgl_FragColor = color;\r\n\r\n}\r\n",n="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class o extends r.ShaderMaterial{constructor(){super({type:"GlitchMaterial",uniforms:{tDiffuse:new r.Uniform(null),tPerturb:new r.Uniform(null),active:new r.Uniform(1),amount:new r.Uniform(.8),angle:new r.Uniform(.02),seed:new r.Uniform(.02),seedX:new r.Uniform(.02),seedY:new r.Uniform(.02),distortionX:new r.Uniform(.5),distortionY:new r.Uniform(.6),colS:new r.Uniform(.05)},fragmentShader:t,vertexShader:n,depthWrite:!1,depthTest:!1})}}exports.GlitchMaterial=o;
},{"three":25}],183:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GodRaysMaterial=void 0;var r=require("three");const e="#include <common>\r\n#include <dithering_pars_fragment>\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform vec3 lightPosition;\r\n\r\nuniform float exposure;\r\nuniform float decay;\r\nuniform float density;\r\nuniform float weight;\r\nuniform float clampMax;\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvec2 texCoord = vUv;\r\n\r\n\t// Calculate vector from pixel to light source in screen space.\r\n\tvec2 deltaTexCoord = texCoord - lightPosition.st;\r\n\tdeltaTexCoord *= 1.0 / NUM_SAMPLES_FLOAT * density;\r\n\r\n\t// A decreasing illumination factor.\r\n\tfloat illuminationDecay = 1.0;\r\n\r\n\tvec4 sample;\r\n\tvec4 color = vec4(0.0);\r\n\r\n\t// Estimate the probability of occlusion at each pixel by summing samples along a ray to the light source.\r\n\tfor(int i = 0; i < NUM_SAMPLES_INT; ++i) {\r\n\r\n\t\ttexCoord -= deltaTexCoord;\r\n\t\tsample = texture2D(tDiffuse, texCoord);\r\n\r\n\t\t// Apply sample attenuation scale/decay factors.\r\n\t\tsample *= illuminationDecay * weight;\r\n\r\n\t\tcolor += sample;\r\n\r\n\t\t// Update exponential decay factor.\r\n\t\tilluminationDecay *= decay;\r\n\r\n\t}\r\n\r\n\tgl_FragColor = clamp(color * exposure, 0.0, clampMax);\r\n\r\n\t#include <dithering_fragment>\r\n\r\n}\r\n",n="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends r.ShaderMaterial{constructor(t={}){const o=Object.assign({exposure:.6,density:.93,decay:.96,weight:.4,clampMax:1},t);super({type:"GodRaysMaterial",defines:{NUM_SAMPLES_FLOAT:"60.0",NUM_SAMPLES_INT:"60"},uniforms:{tDiffuse:new r.Uniform(null),lightPosition:new r.Uniform(null),exposure:new r.Uniform(o.exposure),decay:new r.Uniform(o.decay),density:new r.Uniform(o.density),weight:new r.Uniform(o.weight),clampMax:new r.Uniform(o.clampMax)},fragmentShader:e,vertexShader:n,depthWrite:!1,depthTest:!1})}}exports.GodRaysMaterial=t;
},{"three":25}],184:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LuminosityMaterial=void 0;var e=require("three");const n="#include <common>\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform float distinction;\r\nuniform vec2 range;\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel = texture2D(tDiffuse, vUv);\r\n\tfloat l = linearToRelativeLuminance(texel.rgb);\r\n\r\n\t#ifdef RANGE\r\n\r\n\t\tfloat low = step(range.x, l);\r\n\t\tfloat high = step(l, range.y);\r\n\r\n\t\t// Apply the mask.\r\n\t\tl *= low * high;\r\n\r\n\t#endif\r\n\r\n\tl = pow(abs(l), distinction);\r\n\r\n\t#ifdef COLOR\r\n\r\n\t\tgl_FragColor = vec4(texel.rgb * l, texel.a);\r\n\r\n\t#else\r\n\r\n\t\tgl_FragColor = vec4(l, l, l, texel.a);\r\n\r\n\t#endif\r\n\r\n}\r\n",t="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class r extends e.ShaderMaterial{constructor(r=!1,i=null){const l=null!==i;super({type:"LuminosityMaterial",uniforms:{tDiffuse:new e.Uniform(null),distinction:new e.Uniform(1),range:new e.Uniform(l?i:new e.Vector2)},fragmentShader:n,vertexShader:t}),this.setColorOutputEnabled(r),this.setLuminanceRangeEnabled(l)}setColorOutputEnabled(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}setLuminanceRangeEnabled(e){e?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}}exports.LuminosityMaterial=r;
},{"three":25}],185:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutlineBlendMaterial=void 0;var e=require("three");const r="uniform sampler2D tDiffuse;\r\nuniform sampler2D tMask;\r\nuniform sampler2D tEdges;\r\n\r\nuniform vec3 visibleEdgeColor;\r\nuniform vec3 hiddenEdgeColor;\r\nuniform float pulse;\r\nuniform float edgeStrength;\r\n\r\n#ifdef USE_PATTERN\r\n\r\n\tuniform sampler2D tPattern;\r\n\tvarying vec2 vPatternCoord;\r\n\r\n#endif\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvec4 color = texture2D(tDiffuse, vUv);\r\n\tvec2 edge = texture2D(tEdges, vUv).rg;\r\n\tvec2 mask = texture2D(tMask, vUv).rg;\r\n\r\n\t#ifndef X_RAY\r\n\r\n\t\tedge.y = 0.0;\r\n\r\n\t#endif\r\n\r\n\tedge *= (edgeStrength * mask.x * pulse);\r\n\tvec3 outlineColor = edge.x * visibleEdgeColor + edge.y * hiddenEdgeColor;\r\n\r\n\t#ifdef ALPHA_BLENDING\r\n\r\n\t\tcolor.rgb = mix(color.rgb, outlineColor, max(edge.x, edge.y));\r\n\r\n\t#else\r\n\r\n\t\tcolor.rgb += outlineColor;\r\n\r\n\t#endif\r\n\r\n\t#ifdef USE_PATTERN\r\n\r\n\t\tvec3 patternColor = texture2D(tPattern, vPatternCoord).rgb;\r\n\r\n\t\t#ifdef X_RAY\r\n\r\n\t\t\tfloat hiddenFactor = 0.5;\r\n\r\n\t\t#else\r\n\r\n\t\t\tfloat hiddenFactor = 0.0;\r\n\r\n\t\t#endif\r\n\r\n\t\tfloat visibilityFactor = (1.0 - mask.y > 0.0) ? 1.0 : hiddenFactor;\r\n\r\n\t\tcolor.rgb += visibilityFactor * (1.0 - mask.x) * (1.0 - patternColor);\r\n\r\n\t#endif\r\n\r\n\tgl_FragColor = color;\r\n\r\n}\r\n",n="#ifdef USE_PATTERN\r\n\r\n\tuniform float aspect;\r\n\tuniform float patternScale;\r\n\tvarying vec2 vPatternCoord;\r\n\r\n#endif\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\t#ifdef USE_PATTERN\r\n\r\n\t\tvec2 aspectCorrection = vec2(aspect, 1.0);\r\n\t\tvPatternCoord = uv * aspectCorrection * patternScale;\r\n\r\n\t#endif\r\n\r\n\tvUv = uv;\r\n\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends e.ShaderMaterial{constructor(t={}){const i=Object.assign({edgeStrength:1,patternScale:1,visibleEdgeColor:16777215,hiddenEdgeColor:2230538,alphaBlending:!1,xRay:!0},t);super({type:"OutlineBlendMaterial",uniforms:{pulse:new e.Uniform(1),aspect:new e.Uniform(1),tDiffuse:new e.Uniform(null),tMask:new e.Uniform(null),tEdges:new e.Uniform(null),tPattern:new e.Uniform(null),edgeStrength:new e.Uniform(i.edgeStrength),patternScale:new e.Uniform(i.patternScale),visibleEdgeColor:new e.Uniform(new e.Color(i.visibleEdgeColor)),hiddenEdgeColor:new e.Uniform(new e.Color(i.hiddenEdgeColor))},fragmentShader:r,vertexShader:n,depthWrite:!1,depthTest:!1}),this.setAlphaBlendingEnabled(i.alphaBlending),this.setXRayEnabled(i.xRay)}setAlphaBlendingEnabled(e){e?this.defines.ALPHA_BLENDING="1":delete this.defines.ALPHA_BLENDING,this.needsUpdate=!0}setXRayEnabled(e){e?this.defines.X_RAY="1":delete this.defines.X_RAY,this.needsUpdate=!0}setPatternTexture(e=null){null!==e?this.defines.USE_PATTERN="1":delete this.defines.USE_PATTERN,this.uniforms.tPattern.value=e,this.needsUpdate=!0}}exports.OutlineBlendMaterial=t;
},{"three":25}],186:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutlineEdgesMaterial=void 0;var e=require("three");const r="uniform sampler2D tMask;\r\n\r\nvarying vec2 vUv0;\r\nvarying vec2 vUv1;\r\nvarying vec2 vUv2;\r\nvarying vec2 vUv3;\r\n\r\nvoid main() {\r\n\r\n\tvec2 c0 = texture2D(tMask, vUv0).rg;\r\n\tvec2 c1 = texture2D(tMask, vUv1).rg;\r\n\tvec2 c2 = texture2D(tMask, vUv2).rg;\r\n\tvec2 c3 = texture2D(tMask, vUv3).rg;\r\n\r\n\tfloat d0 = (c0.x - c1.x) * 0.5;\r\n\tfloat d1 = (c2.x - c3.x) * 0.5;\r\n\tfloat d = length(vec2(d0, d1));\r\n\r\n\tfloat a0 = min(c0.y, c1.y);\r\n\tfloat a1 = min(c2.y, c3.y);\r\n\tfloat visibilityFactor = min(a0, a1);\r\n\r\n\tgl_FragColor.rg = (1.0 - visibilityFactor > 0.001) ? vec2(d, 0.0) : vec2(0.0, d);\r\n\r\n}\r\n",t="uniform vec2 texelSize;\r\n\r\nvarying vec2 vUv0;\r\nvarying vec2 vUv1;\r\nvarying vec2 vUv2;\r\nvarying vec2 vUv3;\r\n\r\nvoid main() {\r\n\r\n\tvUv0 = vec2(uv.x + texelSize.x, uv.y);\r\n\tvUv1 = vec2(uv.x - texelSize.x, uv.y);\r\n\tvUv2 = vec2(uv.x, uv.y + texelSize.y);\r\n\tvUv3 = vec2(uv.x, uv.y - texelSize.y);\r\n\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class n extends e.ShaderMaterial{constructor(n=new e.Vector2){super({type:"OutlineEdgesMaterial",uniforms:{tMask:new e.Uniform(null),texelSize:new e.Uniform(new e.Vector2)},fragmentShader:r,vertexShader:t,depthWrite:!1,depthTest:!1}),this.setTexelSize(n.x,n.y)}setTexelSize(e,r){this.uniforms.texelSize.value.set(e,r)}}exports.OutlineEdgesMaterial=n;
},{"three":25}],188:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PixelationMaterial=void 0;var r=require("three");const t="uniform sampler2D tDiffuse;\r\nuniform float granularity;\r\nuniform float dx;\r\nuniform float dy;\r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel;\r\n\r\n\tif(granularity > 0.0) {\r\n\r\n\t\tvec2 coord = vec2(\r\n\t\t\tdx * (floor(vUv.x / dx) + 0.5),\r\n\t\t\tdy * (floor(vUv.y / dy) + 0.5)\r\n\t\t);\r\n\r\n\t\ttexel = texture2D(tDiffuse, coord);\r\n\r\n\t} else {\r\n\r\n\t\ttexel = texture2D(tDiffuse, vUv);\r\n\r\n\t}\r\n\r\n\tgl_FragColor = texel;\r\n\r\n}\r\n",n="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class e extends r.ShaderMaterial{constructor(){super({type:"PixelationMaterial",uniforms:{tDiffuse:new r.Uniform(null),granularity:new r.Uniform(1),resolution:new r.Uniform(new r.Vector2(1,1)),dx:new r.Uniform(1),dy:new r.Uniform(1)},fragmentShader:t,vertexShader:n,depthWrite:!1,depthTest:!1})}get granularity(){return this.uniforms.granularity.value}set granularity(r){const t=this.uniforms,n=t.resolution.value;t.granularity.value=r,t.dx.value=r/n.x,t.dy.value=r/n.y}setResolution(r,t){this.uniforms.resolution.value.set(r,t),this.granularity=this.granularity}}exports.PixelationMaterial=e;
},{"three":25}],187:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RealisticBokehMaterial=void 0;var t=require("three");const n="#include <common>\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform sampler2D tDepth;\r\n\r\nuniform vec2 texelSize;\r\nuniform vec2 halfTexelSize;\r\n\r\nuniform float cameraNear;\r\nuniform float cameraFar;\r\n\r\nuniform float focalLength;\r\nuniform float focalStop;\r\n\r\nuniform float maxBlur;\r\nuniform float luminanceThreshold;\r\nuniform float luminanceGain;\r\nuniform float bias;\r\nuniform float fringe;\r\nuniform float ditherStrength;\r\n\r\n#ifdef SHADER_FOCUS\r\n\r\n\tuniform vec2 focusCoords;\r\n\r\n#else\r\n\r\n\tuniform float focalDepth;\r\n\r\n#endif\r\n\r\nvarying vec2 vUv;\r\n\r\n#ifndef USE_LOGDEPTHBUF\r\n\r\n\t#include <packing>\r\n\r\n\tfloat readDepth(sampler2D depthSampler, vec2 coord) {\r\n\r\n\t\tfloat fragCoordZ = texture2D(depthSampler, coord).x;\r\n\t\tfloat viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\r\n\r\n\t\treturn viewZToOrthographicDepth(viewZ, cameraNear, cameraFar);\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#ifdef PENTAGON\r\n\r\n\tfloat penta(vec2 coords) {\r\n\r\n\t\tconst vec4 HS0 = vec4( 1.0,          0.0,         0.0, 1.0);\r\n\t\tconst vec4 HS1 = vec4( 0.309016994,  0.951056516, 0.0, 1.0);\r\n\t\tconst vec4 HS2 = vec4(-0.809016994,  0.587785252, 0.0, 1.0);\r\n\t\tconst vec4 HS3 = vec4(-0.809016994, -0.587785252, 0.0, 1.0);\r\n\t\tconst vec4 HS4 = vec4( 0.309016994, -0.951056516, 0.0, 1.0);\r\n\t\tconst vec4 HS5 = vec4( 0.0,          0.0,         1.0, 1.0);\r\n\r\n\t\tconst vec4 ONE = vec4(1.0);\r\n\r\n\t\tconst float P_FEATHER = 0.4;\r\n\t\tconst float N_FEATHER = -P_FEATHER;\r\n\r\n\t\tfloat inOrOut = -4.0;\r\n\r\n\t\tvec4 P = vec4(coords, vec2(RINGS_FLOAT - 1.3));\r\n\r\n\t\tvec4 dist = vec4(\r\n\t\t\tdot(P, HS0),\r\n\t\t\tdot(P, HS1),\r\n\t\t\tdot(P, HS2),\r\n\t\t\tdot(P, HS3)\r\n\t\t);\r\n\r\n\t\tdist = smoothstep(N_FEATHER, P_FEATHER, dist);\r\n\r\n\t\tinOrOut += dot(dist, ONE);\r\n\r\n\t\tdist.x = dot(P, HS4);\r\n\t\tdist.y = HS5.w - abs(P.z);\r\n\r\n\t\tdist = smoothstep(N_FEATHER, P_FEATHER, dist);\r\n\t\tinOrOut += dist.x;\r\n\r\n\t\treturn clamp(inOrOut, 0.0, 1.0);\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#ifdef SHOW_FOCUS\r\n\r\n\tvec3 debugFocus(vec3 c, float blur, float depth) {\r\n\r\n\t\tfloat edge = 0.002 * depth;\r\n\t\tfloat m = clamp(smoothstep(0.0, edge, blur), 0.0, 1.0);\r\n\t\tfloat e = clamp(smoothstep(1.0 - edge, 1.0, blur), 0.0, 1.0);\r\n\r\n\t\tc = mix(c, vec3(1.0, 0.5, 0.0), (1.0 - m) * 0.6);\r\n\t\tc = mix(c, vec3(0.0, 0.5, 1.0), ((1.0 - e) - (1.0 - m)) * 0.2);\r\n\r\n\t\treturn c;\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#ifdef VIGNETTE\r\n\r\n\tfloat vignette() {\r\n\r\n\t\tconst vec2 CENTER = vec2(0.5);\r\n\r\n\t\tconst float VIGNETTE_OUT = 1.3;\r\n\t\tconst float VIGNETTE_IN = 0.0;\r\n\t\tconst float VIGNETTE_FADE = 22.0; \r\n\r\n\t\tfloat d = distance(vUv, CENTER);\r\n\t\td = smoothstep(VIGNETTE_OUT + (focalStop / VIGNETTE_FADE), VIGNETTE_IN + (focalStop / VIGNETTE_FADE), d);\r\n\r\n\t\treturn clamp(d, 0.0, 1.0);\r\n\r\n\t}\r\n\r\n#endif\r\n\r\nvec2 rand2(vec2 coord) {\r\n\r\n\tvec2 noise;\r\n\r\n\t#ifdef NOISE\r\n\r\n\t\tconst float a = 12.9898;\r\n\t\tconst float b = 78.233;\r\n\t\tconst float c = 43758.5453;\r\n\r\n\t\tnoise.x = clamp(fract(sin(mod(dot(coord, vec2(a, b)), 3.14)) * c), 0.0, 1.0) * 2.0 - 1.0;\r\n\t\tnoise.y = clamp(fract(sin(mod(dot(coord, vec2(a, b) * 2.0), 3.14)) * c), 0.0, 1.0) * 2.0 - 1.0;\r\n\r\n\t#else\r\n\r\n\t\tnoise.x = ((fract(1.0 - coord.s * halfTexelSize.x) * 0.25) + (fract(coord.t * halfTexelSize.y) * 0.75)) * 2.0 - 1.0;\r\n\t\tnoise.y = ((fract(1.0 - coord.s * halfTexelSize.x) * 0.75) + (fract(coord.t * halfTexelSize.y) * 0.25)) * 2.0 - 1.0;\r\n\r\n\t#endif\r\n\r\n\treturn noise;\r\n\r\n}\r\n\r\nvec3 processTexel(vec2 coords, float blur) {\r\n\r\n\tvec3 c;\r\n\tc.r = texture2D(tDiffuse, coords + vec2(0.0, 1.0) * texelSize * fringe * blur).r;\r\n\tc.g = texture2D(tDiffuse, coords + vec2(-0.866, -0.5) * texelSize * fringe * blur).g;\r\n\tc.b = texture2D(tDiffuse, coords + vec2(0.866, -0.5) * texelSize * fringe * blur).b;\r\n\r\n\t// Calculate the luminance of the constructed colour.\r\n\tfloat luminance = linearToRelativeLuminance(c);\r\n\tfloat threshold = max((luminance - luminanceThreshold) * luminanceGain, 0.0);\r\n\r\n\treturn c + mix(vec3(0.0), c, threshold * blur);\r\n\r\n}\r\n\r\nfloat linearize(float depth) {\r\n\r\n\treturn -cameraFar * cameraNear / (depth * (cameraFar - cameraNear) - cameraFar);\r\n\r\n}\r\n\r\nfloat gather(float i, float j, float ringSamples, inout vec3 color, float w, float h, float blur) {\r\n\r\n\tconst float TWO_PI = 6.28318531;\r\n\r\n\tfloat step = TWO_PI / ringSamples;\r\n\tfloat pw = cos(j * step) * i;\r\n\tfloat ph = sin(j * step) * i;\r\n\r\n\t#ifdef PENTAGON\r\n\r\n\t\tfloat p = penta(vec2(pw, ph));\r\n\r\n\t#else\r\n\r\n\t\tfloat p = 1.0;\r\n\r\n\t#endif\r\n\r\n\tcolor += processTexel(vUv + vec2(pw * w, ph * h), blur) * mix(1.0, i / RINGS_FLOAT, bias) * p;\r\n\r\n\treturn mix(1.0, i / RINGS_FLOAT, bias) * p;\r\n\r\n}\r\n\r\nvoid main() {\r\n\r\n\t#ifdef USE_LOGDEPTHBUF\r\n\r\n\t\tfloat depth = linearize(texture2D(tDepth, vUv).x);\r\n\r\n\t#else\r\n\r\n\t\tfloat depth = linearize(readDepth(tDepth, vUv));\r\n\r\n\t#endif\r\n\r\n\t#ifdef SHADER_FOCUS\r\n\r\n\t\t#ifdef USE_LOGDEPTHBUF\r\n\r\n\t\t\tfloat fDepth = linearize(texture2D(tDepth, focusCoords).x);\r\n\r\n\t\t#else\r\n\r\n\t\t\tfloat fDepth = linearize(readDepth(tDepth, focusCoords));\r\n\r\n\t\t#endif\r\n\r\n\t#else\r\n\r\n\t\tfloat fDepth = focalDepth;\r\n\r\n\t#endif\r\n\r\n\t#ifdef MANUAL_DOF\r\n\r\n\t\tconst float nDoFStart = 1.0; \r\n\t\tconst float nDoFDist = 2.0;\r\n\t\tconst float fDoFStart = 1.0;\r\n\t\tconst float fDoFDist = 3.0;\r\n\r\n\t\tfloat focalPlane = depth - fDepth;\r\n\t\tfloat farDoF = (focalPlane - fDoFStart) / fDoFDist;\r\n\t\tfloat nearDoF = (-focalPlane - nDoFStart) / nDoFDist;\r\n\r\n\t\tfloat blur = (focalPlane > 0.0) ? farDoF : nearDoF;\r\n\r\n\t#else\r\n\r\n\t\tconst float CIRCLE_OF_CONFUSION = 0.03; // 35mm film = 0.03mm CoC.\r\n\r\n\t\tfloat focalPlaneMM = fDepth * 1000.0;\r\n\t\tfloat depthMM = depth * 1000.0;\r\n\r\n\t\tfloat focalPlane = (depthMM * focalLength) / (depthMM - focalLength);\r\n\t\tfloat farDoF = (focalPlaneMM * focalLength) / (focalPlaneMM - focalLength);\r\n\t\tfloat nearDoF = (focalPlaneMM - focalLength) / (focalPlaneMM * focalStop * CIRCLE_OF_CONFUSION);\r\n\r\n\t\tfloat blur = abs(focalPlane - farDoF) * nearDoF;\r\n\r\n\t#endif\r\n\r\n\tblur = clamp(blur, 0.0, 1.0);\r\n\r\n\t// Dithering.\r\n\tvec2 noise = rand2(vUv) * ditherStrength * blur;\r\n\r\n\tfloat blurFactorX = texelSize.x * blur * maxBlur + noise.x;\r\n\tfloat blurFactorY = texelSize.y * blur * maxBlur + noise.y;\r\n\r\n\tconst int MAX_RING_SAMPLES = RINGS_INT * SAMPLES_INT;\r\n\r\n\t// Calculation of final color.\r\n\tvec4 color;\r\n\r\n\tif(blur < 0.05) {\r\n\r\n\t\tcolor = texture2D(tDiffuse, vUv);\r\n\r\n\t} else {\r\n\r\n\t\tcolor = texture2D(tDiffuse, vUv);\r\n\r\n\t\tfloat s = 1.0;\r\n\t\tint ringSamples;\r\n\r\n\t\tfor(int i = 1; i <= RINGS_INT; ++i) {\r\n\r\n\t\t\tringSamples = i * SAMPLES_INT;\r\n\r\n\t\t\t// Constant loop.\r\n\t\t\tfor(int j = 0; j < MAX_RING_SAMPLES; ++j) {\r\n\r\n\t\t\t\t// Break earlier.\r\n\t\t\t\tif(j >= ringSamples) { break; }\r\n\r\n\t\t\t\ts += gather(float(i), float(j), float(ringSamples), color.rgb, blurFactorX, blurFactorY, blur);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tcolor.rgb /= s; // Divide by sample count.\r\n\r\n\t}\r\n\r\n\t#ifdef SHOW_FOCUS\r\n\r\n\t\tcolor.rgb = debugFocus(color.rgb, blur, depth);\r\n\r\n\t#endif\r\n\r\n\t#ifdef VIGNETTE\r\n\r\n\t\tcolor.rgb *= vignette();\r\n\r\n\t#endif\r\n\r\n\tgl_FragColor = color;\r\n\r\n}\r\n",r="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class e extends t.ShaderMaterial{constructor(e=null,o={}){const a=Object.assign({texelSize:null,rings:3,samples:2,showFocus:!1,manualDoF:!1,vignette:!1,pentagon:!1,shaderFocus:!0,noise:!0,maxBlur:1,luminanceThreshold:.5,luminanceGain:2,bias:.5,fringe:.7,ditherStrength:1e-4},o);super({type:"RealisticBokehMaterial",defines:{RINGS_INT:a.rings.toFixed(0),RINGS_FLOAT:a.rings.toFixed(1),SAMPLES_INT:a.samples.toFixed(0),SAMPLES_FLOAT:a.samples.toFixed(1)},uniforms:{tDiffuse:new t.Uniform(null),tDepth:new t.Uniform(null),texelSize:new t.Uniform(new t.Vector2),halfTexelSize:new t.Uniform(new t.Vector2),cameraNear:new t.Uniform(.1),cameraFar:new t.Uniform(2e3),focalLength:new t.Uniform(24),focalStop:new t.Uniform(.9),maxBlur:new t.Uniform(a.maxBlur),luminanceThreshold:new t.Uniform(a.luminanceThreshold),luminanceGain:new t.Uniform(a.luminanceGain),bias:new t.Uniform(a.bias),fringe:new t.Uniform(a.fringe),ditherStrength:new t.Uniform(a.ditherStrength),focusCoords:new t.Uniform(new t.Vector2(.5,.5)),focalDepth:new t.Uniform(1)},fragmentShader:n,vertexShader:r,depthWrite:!1,depthTest:!1}),this.setShowFocusEnabled(a.showFocus),this.setManualDepthOfFieldEnabled(a.manualDoF),this.setVignetteEnabled(a.vignette),this.setPentagonEnabled(a.pentagon),this.setShaderFocusEnabled(a.shaderFocus),this.setNoiseEnabled(a.noise),null!==a.texelSize&&this.setTexelSize(a.texelSize.x,a.texelSize.y),this.adoptCameraSettings(e)}setShowFocusEnabled(t){t?this.defines.SHOW_FOCUS="1":delete this.defines.SHOW_FOCUS,this.needsUpdate=!0}setManualDepthOfFieldEnabled(t){t?this.defines.MANUAL_DOF="1":delete this.defines.MANUAL_DOF,this.needsUpdate=!0}setVignetteEnabled(t){t?this.defines.VIGNETTE="1":delete this.defines.VIGNETTE,this.needsUpdate=!0}setPentagonEnabled(t){t?this.defines.PENTAGON="1":delete this.defines.PENTAGON,this.needsUpdate=!0}setShaderFocusEnabled(t){t?this.defines.SHADER_FOCUS="1":delete this.defines.SHADER_FOCUS,this.needsUpdate=!0}setNoiseEnabled(t){t?this.defines.NOISE="1":delete this.defines.NOISE,this.needsUpdate=!0}setTexelSize(t,n){this.uniforms.texelSize.value.set(t,n),this.uniforms.halfTexelSize.value.set(t,n).multiplyScalar(.5)}adoptCameraSettings(t){null!==t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,this.uniforms.focalLength.value=t.getFocalLength())}}exports.RealisticBokehMaterial=e;
},{"three":25}],189:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShockWaveMaterial=void 0;var e=require("three");const n="#include <common>\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform vec2 center;\r\nuniform float aspect;\r\nuniform float waveSize;\r\nuniform float radius;\r\nuniform float maxRadius;\r\nuniform float amplitude;\r\n\r\nvarying vec2 vUv;\r\nvarying float vSize;\r\n\r\nvoid main() {\r\n\r\n\tvec2 aspectCorrection = vec2(aspect, 1.0);\r\n\r\n\tvec2 difference = vUv * aspectCorrection - center * aspectCorrection;\r\n\tfloat distance = sqrt(dot(difference, difference)) * vSize;\r\n\r\n\tvec2 displacement = vec2(0.0);\r\n\r\n\tif(distance > radius) {\r\n\r\n\t\tif(distance < radius + waveSize) {\r\n\r\n\t\t\tfloat angle = (distance - radius) * PI2 / waveSize;\r\n\t\t\tfloat cosSin = (1.0 - cos(angle)) * 0.5;\r\n\r\n\t\t\tfloat extent = maxRadius + waveSize;\r\n\t\t\tfloat decay = max(extent - distance * distance, 0.0) / extent;\r\n\r\n\t\t\tdisplacement = ((cosSin * amplitude * difference) / distance) * decay;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgl_FragColor = texture2D(tDiffuse, vUv - displacement);\r\n\r\n}\r\n",r="uniform float size;\r\nuniform float scale;\r\nuniform float cameraDistance;\r\n\r\nvarying vec2 vUv;\r\nvarying float vSize;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tvSize = (0.1 * cameraDistance) / size;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends e.ShaderMaterial{constructor(t={}){const i=Object.assign({maxRadius:1,waveSize:.2,amplitude:.05},t);super({type:"ShockWaveMaterial",uniforms:{tDiffuse:new e.Uniform(null),center:new e.Uniform(new e.Vector2(.5,.5)),aspect:new e.Uniform(1),cameraDistance:new e.Uniform(1),size:new e.Uniform(1),radius:new e.Uniform(-i.waveSize),maxRadius:new e.Uniform(i.maxRadius),waveSize:new e.Uniform(i.waveSize),amplitude:new e.Uniform(i.amplitude)},fragmentShader:n,vertexShader:r,depthWrite:!1,depthTest:!1})}}exports.ShockWaveMaterial=t;
},{"three":25}],190:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SMAABlendMaterial=void 0;var t=require("three");const e="uniform sampler2D tDiffuse;\r\nuniform sampler2D tWeights;\r\n\r\nuniform vec2 texelSize;\r\n\r\nvarying vec2 vUv;\r\nvarying vec4 vOffset;\r\n\r\nvoid main() {\r\n\r\n\t// Fetch the blending weights for current pixel.\r\n\tvec4 a;\r\n\ta.xz = texture2D(tWeights, vUv).xz;\r\n\ta.y = texture2D(tWeights, vOffset.zw).g;\r\n\ta.w = texture2D(tWeights, vOffset.xy).a;\r\n\r\n\tvec4 color;\r\n\r\n\t// Check if there is any blending weight with a value greater than 0.0.\r\n\tif(dot(a, vec4(1.0)) < 1e-5) {\r\n\r\n\t\tcolor = texture2D(tDiffuse, vUv, 0.0);\r\n\r\n\t} else {\r\n\r\n\t\t/* Up to four lines can be crossing a pixel (one through each edge).\r\n\t\t * The line with the maximum weight for each direction is favoured.\r\n\t\t */\r\n\r\n\t\tvec2 offset;\r\n\t\toffset.x = a.a > a.b ? a.a : -a.b; // Left vs. right.\r\n\t\toffset.y = a.g > a.r ? -a.g : a.r; // Top vs. bottom (changed signs).\r\n\r\n\t\t// Go in the direction with the maximum weight (horizontal vs. vertical).\r\n\t\tif(abs(offset.x) > abs(offset.y)) {\r\n\r\n\t\t\toffset.y = 0.0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\toffset.x = 0.0;\r\n\r\n\t\t}\r\n\r\n\t\t// Fetch the opposite color and lerp by hand.\r\n\t\tcolor = texture2D(tDiffuse, vUv, 0.0);\r\n\t\tvec2 coord = vUv + sign(offset) * texelSize;\r\n\t\tvec4 oppositeColor = texture2D(tDiffuse, coord, 0.0);\r\n\t\tfloat s = abs(offset.x) > abs(offset.y) ? abs(offset.x) : abs(offset.y);\r\n\r\n\t\t// Gamma correction.\r\n\t\tcolor.rgb = pow(abs(color.rgb), vec3(2.2));\r\n\t\toppositeColor.rgb = pow(abs(oppositeColor.rgb), vec3(2.2));\r\n\t\tcolor = mix(color, oppositeColor, s);\r\n\t\tcolor.rgb = pow(abs(color.rgb), vec3(1.0 / 2.2));\r\n\r\n\t}\r\n\r\n\tgl_FragColor = color;\r\n\r\n}\r\n",r="uniform vec2 texelSize;\r\n\r\nvarying vec2 vUv;\r\nvarying vec4 vOffset;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tvOffset = uv.xyxy + texelSize.xyxy * vec4(1.0, 0.0, 0.0, -1.0); // Changed sign in W component.\r\n\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class n extends t.ShaderMaterial{constructor(n=new t.Vector2){super({type:"SMAABlendMaterial",uniforms:{tDiffuse:new t.Uniform(null),tWeights:new t.Uniform(null),texelSize:new t.Uniform(n)},fragmentShader:e,vertexShader:r,depthWrite:!1,depthTest:!1})}}exports.SMAABlendMaterial=n;
},{"three":25}],191:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SMAAWeightsMaterial=void 0;var e=require("three");const t="#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + float(offset) * texelSize, 0.0)\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform sampler2D tArea;\r\nuniform sampler2D tSearch;\r\n\r\nuniform vec2 texelSize;\r\n\r\nvarying vec2 vUv;\r\nvarying vec4 vOffset[3];\r\nvarying vec2 vPixCoord;\r\n\r\nvec2 round(vec2 x) {\r\n\r\n\treturn sign(x) * floor(abs(x) + 0.5);\r\n\r\n}\r\n\r\nfloat searchLength(vec2 e, float bias, float scale) {\r\n\r\n\t// Not required if tSearch accesses are set to point.\r\n\t// const vec2 SEARCH_TEX_PIXEL_SIZE = 1.0 / vec2(66.0, 33.0);\r\n\t// e = vec2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE + e * vec2(scale, 1.0) * vec2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\r\n\r\n\te.r = bias + e.r * scale;\r\n\r\n\treturn 255.0 * texture2D(tSearch, e, 0.0).r;\r\n\r\n}\r\n\r\nfloat searchXLeft(vec2 texCoord, float end) {\r\n\r\n\t/* @PSEUDO_GATHER4\r\n\t * This texCoord has been offset by (-0.25, -0.125) in the vertex shader to\r\n\t * sample between edge, thus fetching four edges in a row.\r\n\t * Sampling with different offsets in each direction allows to disambiguate\r\n\t * which edges are active from the four fetched ones.\r\n\t */\r\n\r\n\tvec2 e = vec2(0.0, 1.0);\r\n\r\n\tfor(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {\r\n\r\n\t\te = texture2D(tDiffuse, texCoord, 0.0).rg;\r\n\t\ttexCoord -= vec2(2.0, 0.0) * texelSize;\r\n\r\n\t\tif(!(texCoord.x > end && e.g > 0.8281 && e.r == 0.0)) { break; }\r\n\r\n\t}\r\n\r\n\t// Correct the previously applied offset (-0.25, -0.125).\r\n\ttexCoord.x += 0.25 * texelSize.x;\r\n\r\n\t// The searches are biased by 1, so adjust the coords accordingly.\r\n\ttexCoord.x += texelSize.x;\r\n\r\n\t// Disambiguate the length added by the last step.\r\n\ttexCoord.x += 2.0 * texelSize.x; // Undo last step.\r\n\ttexCoord.x -= texelSize.x * searchLength(e, 0.0, 0.5);\r\n\r\n\treturn texCoord.x;\r\n\r\n}\r\n\r\nfloat searchXRight(vec2 texCoord, float end) {\r\n\r\n\tvec2 e = vec2(0.0, 1.0);\r\n\r\n\tfor(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {\r\n\r\n\t\te = texture2D(tDiffuse, texCoord, 0.0).rg;\r\n\t\ttexCoord += vec2(2.0, 0.0) * texelSize;\r\n\r\n\t\tif(!(texCoord.x < end && e.g > 0.8281 && e.r == 0.0)) { break; }\r\n\r\n\t}\r\n\r\n\ttexCoord.x -= 0.25 * texelSize.x;\r\n\ttexCoord.x -= texelSize.x;\r\n\ttexCoord.x -= 2.0 * texelSize.x;\r\n\ttexCoord.x += texelSize.x * searchLength(e, 0.5, 0.5);\r\n\r\n\treturn texCoord.x;\r\n\r\n}\r\n\r\nfloat searchYUp(vec2 texCoord, float end) {\r\n\r\n\tvec2 e = vec2(1.0, 0.0);\r\n\r\n\tfor(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {\r\n\r\n\t\te = texture2D(tDiffuse, texCoord, 0.0).rg;\r\n\t\ttexCoord += vec2(0.0, 2.0) * texelSize; // Changed sign.\r\n\r\n\t\tif(!(texCoord.y > end && e.r > 0.8281 && e.g == 0.0)) { break; }\r\n\r\n\t}\r\n\r\n\ttexCoord.y -= 0.25 * texelSize.y; // Changed sign.\r\n\ttexCoord.y -= texelSize.y; // Changed sign.\r\n\ttexCoord.y -= 2.0 * texelSize.y; // Changed sign.\r\n\ttexCoord.y += texelSize.y * searchLength(e.gr, 0.0, 0.5); // Changed sign.\r\n\r\n\treturn texCoord.y;\r\n\r\n}\r\n\r\nfloat searchYDown(vec2 texCoord, float end) {\r\n\r\n\tvec2 e = vec2(1.0, 0.0);\r\n\r\n\tfor(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i ) {\r\n\r\n\t\te = texture2D(tDiffuse, texCoord, 0.0).rg;\r\n\t\ttexCoord -= vec2(0.0, 2.0) * texelSize; // Changed sign.\r\n\r\n\t\tif(!(texCoord.y < end && e.r > 0.8281 && e.g == 0.0)) { break; }\r\n\r\n\t}\r\n\r\n\ttexCoord.y += 0.25 * texelSize.y; // Changed sign.\r\n\ttexCoord.y += texelSize.y; // Changed sign.\r\n\ttexCoord.y += 2.0 * texelSize.y; // Changed sign.\r\n\ttexCoord.y -= texelSize.y * searchLength(e.gr, 0.5, 0.5); // Changed sign.\r\n\r\n\treturn texCoord.y;\r\n\r\n}\r\n\r\nvec2 area(vec2 dist, float e1, float e2, float offset) {\r\n\r\n\t// Rounding prevents precision errors of bilinear filtering.\r\n\tvec2 texCoord = AREATEX_MAX_DISTANCE * round(4.0 * vec2(e1, e2)) + dist;\r\n\r\n\t// Scale and bias for texel space translation.\r\n\ttexCoord = AREATEX_PIXEL_SIZE * texCoord + (0.5 * AREATEX_PIXEL_SIZE);\r\n\r\n\t// Move to proper place, according to the subpixel offset.\r\n\ttexCoord.y += AREATEX_SUBTEX_SIZE * offset;\r\n\r\n\treturn texture2D(tArea, texCoord, 0.0).rg;\r\n\r\n}\r\n\r\nvoid main() {\r\n\r\n\tvec4 weights = vec4(0.0);\r\n\tvec4 subsampleIndices = vec4(0.0);\r\n\tvec2 e = texture2D(tDiffuse, vUv).rg;\r\n\r\n\tif(e.g > 0.0) {\r\n\r\n\t\t// Edge at north.\r\n\t\tvec2 d;\r\n\r\n\t\t// Find the distance to the left.\r\n\t\tvec2 coords;\r\n\t\tcoords.x = searchXLeft(vOffset[0].xy, vOffset[2].x);\r\n\t\tcoords.y = vOffset[1].y; // vOffset[1].y = vUv.y - 0.25 * texelSize.y (@CROSSING_OFFSET)\r\n\t\td.x = coords.x;\r\n\r\n\t\t/* Now fetch the left crossing edges, two at a time using bilinear\r\n\t\tfiltering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to discern what\r\n\t\tvalue each edge has. */\r\n\t\tfloat e1 = texture2D(tDiffuse, coords, 0.0).r;\r\n\r\n\t\t// Find the distance to the right.\r\n\t\tcoords.x = searchXRight(vOffset[0].zw, vOffset[2].y);\r\n\t\td.y = coords.x;\r\n\r\n\t\t/* Translate distances to pixel units for better interleave arithmetic and\r\n\t\tmemory accesses. */\r\n\t\td = d / texelSize.x - vPixCoord.x;\r\n\r\n\t\t// The area texture is compressed quadratically.\r\n\t\tvec2 sqrtD = sqrt(abs(d));\r\n\r\n\t\t// Fetch the right crossing edges.\r\n\t\tcoords.y -= texelSize.y; // WebGL port note: Added.\r\n\t\tfloat e2 = sampleLevelZeroOffset(tDiffuse, coords, ivec2(1, 0)).r;\r\n\r\n\t\t// Pattern recognised, now get the actual area.\r\n\t\tweights.rg = area(sqrtD, e1, e2, subsampleIndices.y);\r\n\r\n\t}\r\n\r\n\tif(e.r > 0.0) {\r\n\r\n\t\t// Edge at west.\r\n\t\tvec2 d;\r\n\r\n\t\t// Find the distance to the top.\r\n\t\tvec2 coords;\r\n\t\tcoords.y = searchYUp(vOffset[1].xy, vOffset[2].z);\r\n\t\tcoords.x = vOffset[0].x; // vOffset[1].x = vUv.x - 0.25 * texelSize.x;\r\n\t\td.x = coords.y;\r\n\r\n\t\t// Fetch the top crossing edges.\r\n\t\tfloat e1 = texture2D(tDiffuse, coords, 0.0).g;\r\n\r\n\t\t// Find the distance to the bottom.\r\n\t\tcoords.y = searchYDown(vOffset[1].zw, vOffset[2].w);\r\n\t\td.y = coords.y;\r\n\r\n\t\t// Distances in pixel units.\r\n\t\td = d / texelSize.y - vPixCoord.y;\r\n\r\n\t\t// The area texture is compressed quadratically.\r\n\t\tvec2 sqrtD = sqrt(abs(d));\r\n\r\n\t\t// Fetch the bottom crossing edges.\r\n\t\tcoords.y -= texelSize.y; // WebGL port note: Added.\r\n\t\tfloat e2 = sampleLevelZeroOffset(tDiffuse, coords, ivec2(0, 1)).g;\r\n\r\n\t\t// Get the area for this direction.\r\n\t\tweights.ba = area(sqrtD, e1, e2, subsampleIndices.x);\r\n\r\n\t}\r\n\r\n\tgl_FragColor = weights;\r\n\r\n}\r\n",r="uniform vec2 texelSize;\r\n\r\nvarying vec2 vUv;\r\nvarying vec4 vOffset[3];\r\nvarying vec2 vPixCoord;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tvPixCoord = uv / texelSize;\r\n\r\n\t// Offsets for the searches (see @PSEUDO_GATHER4).\r\n\tvOffset[0] = uv.xyxy + texelSize.xyxy * vec4(-0.25, 0.125, 1.25, 0.125); // Changed sign in Y and W components.\r\n\tvOffset[1] = uv.xyxy + texelSize.xyxy * vec4(-0.125, 0.25, -0.125, -1.25); //Changed sign in Y and W components.\r\n\r\n\t// This indicates the ends of the loops.\r\n\tvOffset[2] = vec4(vOffset[0].xz, vOffset[1].yw) + vec4(-2.0, 2.0, -2.0, 2.0) * texelSize.xxyy * MAX_SEARCH_STEPS_FLOAT;\r\n\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class n extends e.ShaderMaterial{constructor(n=new e.Vector2){super({type:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"8",MAX_SEARCH_STEPS_FLOAT:"8.0",AREATEX_MAX_DISTANCE:"16.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{tDiffuse:new e.Uniform(null),tArea:new e.Uniform(null),tSearch:new e.Uniform(null),texelSize:new e.Uniform(n)},fragmentShader:t,vertexShader:r,depthWrite:!1,depthTest:!1})}setOrthogonalSearchSteps(e){this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}}exports.SMAAWeightsMaterial=n;
},{"three":25}],192:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ToneMappingMaterial=void 0;var e=require("three");const n="#include <common>\r\n#include <dithering_pars_fragment>\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform float middleGrey;\r\nuniform float maxLuminance;\r\n\r\n#ifdef ADAPTED_LUMINANCE\r\n\r\n\tuniform sampler2D luminanceMap;\r\n\r\n#else\r\n\r\n\tuniform float averageLuminance;\r\n\r\n#endif\r\n\r\nvarying vec2 vUv;\r\n\r\nvec3 toneMap(vec3 c) {\r\n\r\n\t#ifdef ADAPTED_LUMINANCE\r\n\r\n\t\t// Get the calculated average luminance by sampling the center.\r\n\t\tfloat lumAvg = texture2D(luminanceMap, vec2(0.5)).r;\r\n\r\n\t#else\r\n\r\n\t\tfloat lumAvg = averageLuminance;\r\n\r\n\t#endif\r\n\r\n\t// Calculate the luminance of the current pixel.\r\n\tfloat lumPixel = linearToRelativeLuminance(c);\r\n\r\n\t// Apply the modified operator (Reinhard Eq. 4).\r\n\tfloat lumScaled = (lumPixel * middleGrey) / lumAvg;\r\n\r\n\tfloat lumCompressed = (lumScaled * (1.0 + (lumScaled / (maxLuminance * maxLuminance)))) / (1.0 + lumScaled);\r\n\r\n\treturn lumCompressed * c;\r\n\r\n}\r\n\r\nvoid main() {\r\n\r\n\tvec4 texel = texture2D(tDiffuse, vUv);\r\n\tgl_FragColor = vec4(toneMap(texel.rgb), texel.a);\r\n\r\n\t#include <dithering_fragment>\r\n\r\n}\r\n",r="varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\r\n}\r\n";class t extends e.ShaderMaterial{constructor(){super({type:"ToneMappingMaterial",uniforms:{tDiffuse:new e.Uniform(null),luminanceMap:new e.Uniform(null),averageLuminance:new e.Uniform(1),maxLuminance:new e.Uniform(16),middleGrey:new e.Uniform(.6)},fragmentShader:n,vertexShader:r,depthWrite:!1,depthTest:!1})}}exports.ToneMappingMaterial=t;
},{"three":25}],73:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./AdaptiveLuminosityMaterial.js");Object.defineProperty(exports,"AdaptiveLuminosityMaterial",{enumerable:!0,get:function(){return e.AdaptiveLuminosityMaterial}});var r=require("./BokehMaterial.js");Object.defineProperty(exports,"BokehMaterial",{enumerable:!0,get:function(){return r.BokehMaterial}});var t=require("./ColorEdgesMaterial.js");Object.defineProperty(exports,"ColorEdgesMaterial",{enumerable:!0,get:function(){return t.ColorEdgesMaterial}});var a=require("./CombineMaterial.js");Object.defineProperty(exports,"CombineMaterial",{enumerable:!0,get:function(){return a.CombineMaterial}});var i=require("./ConvolutionMaterial.js");Object.defineProperty(exports,"ConvolutionMaterial",{enumerable:!0,get:function(){return i.ConvolutionMaterial}}),Object.defineProperty(exports,"KernelSize",{enumerable:!0,get:function(){return i.KernelSize}});var n=require("./CopyMaterial.js");Object.defineProperty(exports,"CopyMaterial",{enumerable:!0,get:function(){return n.CopyMaterial}});var o=require("./DepthComparisonMaterial.js");Object.defineProperty(exports,"DepthComparisonMaterial",{enumerable:!0,get:function(){return o.DepthComparisonMaterial}});var l=require("./DotScreenMaterial.js");Object.defineProperty(exports,"DotScreenMaterial",{enumerable:!0,get:function(){return l.DotScreenMaterial}});var u=require("./FilmMaterial.js");Object.defineProperty(exports,"FilmMaterial",{enumerable:!0,get:function(){return u.FilmMaterial}});var M=require("./GlitchMaterial.js");Object.defineProperty(exports,"GlitchMaterial",{enumerable:!0,get:function(){return M.GlitchMaterial}});var s=require("./GodRaysMaterial.js");Object.defineProperty(exports,"GodRaysMaterial",{enumerable:!0,get:function(){return s.GodRaysMaterial}});var p=require("./LuminosityMaterial.js");Object.defineProperty(exports,"LuminosityMaterial",{enumerable:!0,get:function(){return p.LuminosityMaterial}});var c=require("./OutlineBlendMaterial.js");Object.defineProperty(exports,"OutlineBlendMaterial",{enumerable:!0,get:function(){return c.OutlineBlendMaterial}});var b=require("./OutlineEdgesMaterial.js");Object.defineProperty(exports,"OutlineEdgesMaterial",{enumerable:!0,get:function(){return b.OutlineEdgesMaterial}});var f=require("./PixelationMaterial.js");Object.defineProperty(exports,"PixelationMaterial",{enumerable:!0,get:function(){return f.PixelationMaterial}});var j=require("./RealisticBokehMaterial.js");Object.defineProperty(exports,"RealisticBokehMaterial",{enumerable:!0,get:function(){return j.RealisticBokehMaterial}});var d=require("./ShockWaveMaterial.js");Object.defineProperty(exports,"ShockWaveMaterial",{enumerable:!0,get:function(){return d.ShockWaveMaterial}});var m=require("./SMAABlendMaterial.js");Object.defineProperty(exports,"SMAABlendMaterial",{enumerable:!0,get:function(){return m.SMAABlendMaterial}});var y=require("./SMAAWeightsMaterial.js");Object.defineProperty(exports,"SMAAWeightsMaterial",{enumerable:!0,get:function(){return y.SMAAWeightsMaterial}});var g=require("./ToneMappingMaterial.js");Object.defineProperty(exports,"ToneMappingMaterial",{enumerable:!0,get:function(){return g.ToneMappingMaterial}});
},{"./AdaptiveLuminosityMaterial.js":173,"./BokehMaterial.js":174,"./ColorEdgesMaterial.js":175,"./CombineMaterial.js":176,"./ConvolutionMaterial.js":177,"./CopyMaterial.js":178,"./DepthComparisonMaterial.js":179,"./DotScreenMaterial.js":180,"./FilmMaterial.js":181,"./GlitchMaterial.js":182,"./GodRaysMaterial.js":183,"./LuminosityMaterial.js":184,"./OutlineBlendMaterial.js":185,"./OutlineEdgesMaterial.js":186,"./PixelationMaterial.js":188,"./RealisticBokehMaterial.js":187,"./ShockWaveMaterial.js":189,"./SMAABlendMaterial.js":190,"./SMAAWeightsMaterial.js":191,"./ToneMappingMaterial.js":192}],163:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pass=void 0;var e=require("three");class s{constructor(s="Pass",t=new e.Scene,i=new e.OrthographicCamera(-1,1,1,-1,0,1),r=new e.Mesh(new e.PlaneBufferGeometry(2,2),null)){this.name=s,this.scene=t,this.camera=i,this.quad=r,null!==this.quad&&(this.quad.frustumCulled=!1,null!==this.scene&&this.scene.add(this.quad)),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0}get material(){return null!==this.quad?this.quad.material:null}set material(e){null!==this.quad&&(this.quad.material=e)}render(e,s,t,i,r){throw new Error("Render method not implemented!")}setSize(e,s){}initialize(e,s){}dispose(){let e;for(e of Object.keys(this))null!==this[e]&&"function"==typeof this[e].dispose&&(this[e].dispose(),this[e]=null);null!==this.material&&this.material.dispose()}}exports.Pass=s;
},{"three":25}],153:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BlurPass=void 0;var e=require("three"),t=require("../materials"),r=require("./Pass.js");class i extends r.Pass{constructor(r={}){super("BlurPass"),this.renderTargetX=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetX.texture.name="Blur.TargetX",this.renderTargetX.texture.generateMipmaps=!1,this.renderTargetY=this.renderTargetX.clone(),this.renderTargetY.texture.name="Blur.TargetY",this.resolutionScale=void 0!==r.resolutionScale?r.resolutionScale:.5,this.convolutionMaterial=new t.ConvolutionMaterial,this.ditheredConvolutionMaterial=new t.ConvolutionMaterial,this.ditheredConvolutionMaterial.dithering=!0,this.dithering=!1,this.kernelSize=r.kernelSize}get width(){return this.renderTargetX.width}get height(){return this.renderTargetX.height}get kernelSize(){return this.convolutionMaterial.kernelSize}set kernelSize(e=t.KernelSize.LARGE){this.convolutionMaterial.kernelSize=e,this.ditheredConvolutionMaterial.kernelSize=e}render(e,t,r,i,n){const a=this.scene,s=this.camera,l=this.renderTargetX,o=this.renderTargetY;let h=this.convolutionMaterial,u=h.uniforms;const d=h.getKernel();let g,c,v,T=t;for(this.material=h,c=0,v=d.length-1;c<v;++c)g=c%2==0?l:o,u.kernel.value=d[c],u.tDiffuse.value=T.texture,e.render(a,s,g),T=g;this.dithering&&(u=(h=this.ditheredConvolutionMaterial).uniforms,this.material=h),u.kernel.value=d[c],u.tDiffuse.value=T.texture,e.render(a,s,this.renderToScreen?null:r)}setSize(e,t){e=Math.max(1,Math.floor(e*this.resolutionScale)),t=Math.max(1,Math.floor(t*this.resolutionScale)),this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t),this.convolutionMaterial.setTexelSize(1/e,1/t),this.ditheredConvolutionMaterial.setTexelSize(1/e,1/t)}initialize(t,r){r||(this.renderTargetX.texture.format=e.RGBFormat,this.renderTargetY.texture.format=e.RGBFormat)}}exports.BlurPass=i;
},{"three":25,"../materials":73,"./Pass.js":163}],152:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BloomPass=void 0;var e=require("three"),t=require("../materials"),i=require("./BlurPass.js"),r=require("./Pass.js");class s extends r.Pass{constructor(r={}){super("BloomPass"),this.renderTarget=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.blurPass=new i.BlurPass(r),this.combineMaterial=new t.CombineMaterial(void 0===r.screenMode||r.screenMode),this.intensity=r.intensity,this.luminosityMaterial=new t.LuminosityMaterial(!0),this.distinction=r.distinction}get resolutionScale(){return this.blurPass.resolutionScale}set resolutionScale(e=.5){this.blurPass.resolutionScale=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e=t.KernelSize.LARGE){this.blurPass.kernelSize=e}get intensity(){return this.combineMaterial.uniforms.opacity2.value}set intensity(e=1){this.combineMaterial.uniforms.opacity2.value=e}get distinction(){return this.luminosityMaterial.uniforms.distinction.value}set distinction(e=1){this.luminosityMaterial.uniforms.distinction.value=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get blend(){return this.needsSwap}set blend(e){this.needsSwap=e}get overlay(){return this.renderTarget.texture}render(e,t,i,r,s){const n=this.scene,a=this.camera,l=this.blurPass,u=this.luminosityMaterial,o=this.combineMaterial,h=this.renderTarget;this.material=u,u.uniforms.tDiffuse.value=t.texture,e.render(n,a,h),l.render(e,h,h),this.blend&&(this.material=o,o.uniforms.texture1.value=t.texture,o.uniforms.texture2.value=h.texture,e.render(n,a,this.renderToScreen?null:i))}setSize(e,t){this.blurPass.setSize(e,t),e=this.blurPass.width,t=this.blurPass.height,this.renderTarget.setSize(e,t)}initialize(t,i){this.blurPass.initialize(t,i),i||(this.renderTarget.texture.format=e.RGBFormat)}}exports.BloomPass=s;
},{"three":25,"../materials":73,"./BlurPass.js":153,"./Pass.js":163}],154:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BokehPass=void 0;var e=require("../materials"),s=require("./Pass.js");class r extends s.Pass{constructor(s,r={}){super("BokehPass"),this.material=new e.BokehMaterial(s,r)}render(e,s,r,t,a){this.material.uniforms.tDiffuse.value=s.texture,this.material.uniforms.tDepth.value=s.depthTexture,e.render(this.scene,this.camera,this.renderToScreen?null:r)}setSize(e,s){this.material.uniforms.aspect.value=e/s}}exports.BokehPass=r;
},{"../materials":73,"./Pass.js":163}],155:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClearMaskPass=void 0;var s=require("./Pass.js");class e extends s.Pass{constructor(){super("ClearMaskPass",null,null,null),this.needsSwap=!1}render(s,e,r,a,t){s.state.buffers.stencil.setTest(!1)}}exports.ClearMaskPass=e;
},{"./Pass.js":163}],156:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClearPass=void 0;var e=require("three"),l=require("./Pass.js");const r=new e.Color;class s extends l.Pass{constructor(e={}){super("ClearPass",null,null,null),this.needsSwap=!1,this.clearColor=void 0!==e.clearColor?e.clearColor:null,this.clearAlpha=void 0!==e.clearAlpha?e.clearAlpha:0}render(e,l,s,a,o){const t=this.clearColor;let c;null!==t&&(r.copy(e.getClearColor()),c=e.getClearAlpha(),e.setClearColor(t,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:l),e.clear(),null!==t&&e.setClearColor(r,c)}}exports.ClearPass=s;
},{"three":25,"./Pass.js":163}],157:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DotScreenPass=void 0;var e=require("../materials"),s=require("./Pass.js");class t extends s.Pass{constructor(s={}){super("DotScreenPass"),this.material=new e.DotScreenMaterial(s)}render(e,s,t,r,a){this.material.uniforms.tDiffuse.value=s.texture,e.render(this.scene,this.camera,this.renderToScreen?null:t)}setSize(e,s){e=Math.max(1,e),s=Math.max(1,s),this.material.uniforms.offsetRepeat.value.z=e,this.material.uniforms.offsetRepeat.value.w=s}}exports.DotScreenPass=t;
},{"../materials":73,"./Pass.js":163}],158:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FilmPass=void 0;var i=require("../materials"),e=require("./Pass.js");class s extends e.Pass{constructor(e={}){super("FilmPass"),this.material=new i.FilmMaterial(e),this.scanlineDensity=void 0===e.scanlineDensity?1.25:e.scanlineDensity,this.gridScale=void 0===e.gridScale?1:Math.max(e.gridScale,1e-6),this.gridLineWidth=void 0===e.gridLineWidth?0:Math.max(e.gridLineWidth,0)}render(i,e,s,t,r){this.material.uniforms.tDiffuse.value=e.texture,this.material.uniforms.time.value+=t,i.render(this.scene,this.camera,this.renderToScreen?null:s)}setSize(i,e){const s=i/e,t=this.gridScale*(.125*e);this.material.uniforms.scanlineCount.value=Math.round(e*this.scanlineDensity),this.material.uniforms.gridScale.value.set(s*t,t),this.material.uniforms.gridLineWidth.value=t/e+this.gridLineWidth}}exports.FilmPass=s;
},{"../materials":73,"./Pass.js":163}],159:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlitchMode=exports.GlitchPass=void 0;var e=require("three"),t=require("../materials"),r=require("./Pass.js");function a(e,t){return e+Math.floor(Math.random()*(t-e+1))}function s(e,t){return e+Math.random()*(t-e)}class i extends r.Pass{constructor(e={}){super("GlitchPass"),this.material=new t.GlitchMaterial,this.texture=null,this.perturbMap=void 0!==e.perturbMap?e.perturbMap:this.generatePerturbMap(e.dtSize),this.perturbMap.name="Glitch.Perturbation",this.perturbMap.generateMipmaps=!1,this.mode=u.SPORADIC,this.counter=0,this.breakPoint=a(120,240)}get perturbMap(){return this.texture}set perturbMap(e){this.texture=e,this.material.uniforms.tPerturb.value=e}generatePerturbMap(t=64){const r=t*t,a=new Float32Array(3*r);let s,i,u=this.perturbMap;for(s=0;s<r;++s)i=Math.random(),a[3*s]=i,a[3*s+1]=i,a[3*s+2]=i;return null!==u&&u.dispose(),(u=new e.DataTexture(a,t,t,e.RGBFormat,e.FloatType)).needsUpdate=!0,this.perturbMap=u,u}render(e,t,r,i,n){const o=this.mode,l=this.counter,h=this.breakPoint,p=this.material.uniforms;p.tDiffuse.value=t.texture,p.seed.value=Math.random(),p.active.value=!0,l%h==0||o===u.CONSTANT_WILD?(p.amount.value=Math.random()/30,p.angle.value=s(-Math.PI,Math.PI),p.seedX.value=s(-1,1),p.seedY.value=s(-1,1),p.distortionX.value=s(0,1),p.distortionY.value=s(0,1),this.breakPoint=a(120,240),this.counter=0):l%h<h/5||o===u.CONSTANT_MILD?(p.amount.value=Math.random()/90,p.angle.value=s(-Math.PI,Math.PI),p.distortionX.value=s(0,1),p.distortionY.value=s(0,1),p.seedX.value=s(-.3,.3),p.seedY.value=s(-.3,.3)):p.active.value=!1,++this.counter,e.render(this.scene,this.camera,this.renderToScreen?null:r)}}exports.GlitchPass=i;const u=exports.GlitchMode={SPORADIC:0,CONSTANT_MILD:1,CONSTANT_WILD:2};
},{"three":25,"../materials":73,"./Pass.js":163}],166:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderPass=void 0;var e=require("./ClearPass.js"),r=require("./Pass.js");class s extends r.Pass{constructor(r,s,a={}){super("RenderPass",r,s,null),this.needsSwap=!1,this.clearPass=new e.ClearPass(a),this.overrideMaterial=void 0!==a.overrideMaterial?a.overrideMaterial:null,this.clearDepth=void 0!==a.clearDepth&&a.clearDepth,this.clear=void 0===a.clear||a.clear}render(e,r,s,a,t){const i=this.scene,l=this.renderToScreen?null:r,d=i.overrideMaterial;this.clear?(this.clearPass.renderToScreen=this.renderToScreen,this.clearPass.render(e,r)):this.clearDepth&&(e.setRenderTarget(l),e.clearDepth()),i.overrideMaterial=this.overrideMaterial,e.render(i,this.camera,l),i.overrideMaterial=d}}exports.RenderPass=s;
},{"./ClearPass.js":156,"./Pass.js":163}],160:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GodRaysPass=void 0;var e=require("three"),t=require("../materials"),r=require("./RenderPass.js"),s=require("./BlurPass.js"),i=require("./Pass.js");function a(e,t,r){return Math.max(t,Math.min(r,e))}class n extends i.Pass{constructor(i,a,n,h={}){super("GodRaysPass"),this.lightScene=new e.Scene,this.mainScene=i,this.mainCamera=a,this.renderTargetX=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetX.texture.name="GodRays.TargetX",this.renderTargetX.texture.generateMipmaps=!1,this.renderTargetY=this.renderTargetX.clone(),this.renderTargetY.texture.name="GodRays.TargetY",this.renderTargetMask=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter}),this.renderTargetMask.texture.name="GodRays.Mask",this.renderTargetMask.texture.generateMipmaps=!1,this.renderPassLight=new r.RenderPass(this.lightScene,this.mainCamera,{clearColor:new e.Color(0)}),this.renderPassMask=new r.RenderPass(this.mainScene,this.mainCamera,{overrideMaterial:new e.MeshBasicMaterial({color:0})}),this.renderPassMask.clear=!1,this.blurPass=new s.BlurPass(h),this.lightSource=n,this.screenPosition=new e.Vector3,this.godRaysMaterial=new t.GodRaysMaterial(h),this.godRaysMaterial.uniforms.lightPosition.value=this.screenPosition,this.samples=h.samples,this.combineMaterial=new t.CombineMaterial(void 0===h.screenMode||h.screenMode),this.intensity=h.intensity}get resolutionScale(){return this.blurPass.resolutionScale}set resolutionScale(e=.5){this.blurPass.resolutionScale=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e=t.KernelSize.LARGE){this.blurPass.kernelSize=e}get intensity(){return this.combineMaterial.uniforms.opacity2.value}set intensity(e=1){this.combineMaterial.uniforms.opacity2.value=e}get samples(){return Number.parseInt(this.godRaysMaterial.defines.NUM_SAMPLES_INT)}set samples(e=60){e=Math.floor(e),this.godRaysMaterial.defines.NUM_SAMPLES_FLOAT=e.toFixed(1),this.godRaysMaterial.defines.NUM_SAMPLES_INT=e.toFixed(0),this.godRaysMaterial.needsUpdate=!0}get dithering(){return this.godRaysMaterial.dithering}set dithering(e){this.dithering!==e&&(this.godRaysMaterial.dithering=e,this.godRaysMaterial.needsUpdate=!0)}get blend(){return this.needsSwap}set blend(e){this.needsSwap=e}get overlay(){return this.renderTargetY.texture}render(e,t,r,s,i){const n=this.scene,h=this.camera,l=this.mainScene,d=this.lightSource,o=this.screenPosition,u=this.godRaysMaterial,g=this.combineMaterial,m=this.renderTargetMask,c=this.renderTargetX,M=this.renderTargetY;let P,S;o.copy(d.position).project(this.mainCamera),o.x=a(.5*(o.x+1),0,1),o.y=a(.5*(o.y+1),0,1),S=d.parent,P=l.background,l.background=null,this.lightScene.add(d),this.renderPassLight.render(e,m),this.renderPassMask.render(e,m),null!==S&&S.add(d),l.background=P,this.blurPass.render(e,this.renderTargetMask,c),this.material=u,u.uniforms.tDiffuse.value=c.texture,e.render(n,h,M),this.blend&&(this.material=g,g.uniforms.texture1.value=t.texture,g.uniforms.texture2.value=M.texture,e.render(n,h,this.renderToScreen?null:r))}setSize(e,t){this.renderPassLight.setSize(e,t),this.renderPassMask.setSize(e,t),this.blurPass.setSize(e,t),e=this.blurPass.width,t=this.blurPass.height,this.renderTargetMask.setSize(e,t),this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t)}initialize(t,r){this.renderPassLight.initialize(t,r),this.renderPassMask.initialize(t,r),this.blurPass.initialize(t,r),r||(this.renderTargetMask.texture.format=e.RGBFormat,this.renderTargetX.texture.format=e.RGBFormat,this.renderTargetY.texture.format=e.RGBFormat)}}exports.GodRaysPass=n;
},{"three":25,"../materials":73,"./RenderPass.js":166,"./BlurPass.js":153,"./Pass.js":163}],161:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MaskPass=void 0;var e=require("./Pass.js");class s extends e.Pass{constructor(e,s){super("MaskPass",e,s,null),this.needsSwap=!1,this.inverse=!1,this.clearStencil=!0}render(e,s,t,r,c){const n=e.context,l=e.state,a=this.scene,i=this.camera,f=this.inverse?0:1,u=1-f;l.buffers.color.setMask(!1),l.buffers.depth.setMask(!1),l.buffers.color.setLocked(!0),l.buffers.depth.setLocked(!0),l.buffers.stencil.setTest(!0),l.buffers.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),l.buffers.stencil.setFunc(n.ALWAYS,f,4294967295),l.buffers.stencil.setClear(u),this.clearStencil&&(this.renderToScreen?(e.setRenderTarget(null),e.clearStencil()):(e.setRenderTarget(s),e.clearStencil(),e.setRenderTarget(t),e.clearStencil())),this.renderToScreen?e.render(a,i,null):(e.render(a,i,s),e.render(a,i,t)),l.buffers.color.setLocked(!1),l.buffers.depth.setLocked(!1),l.buffers.stencil.setFunc(n.EQUAL,1,4294967295),l.buffers.stencil.setOp(n.KEEP,n.KEEP,n.KEEP)}}exports.MaskPass=s;
},{"./Pass.js":163}],168:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShaderPass=void 0;var e=require("./Pass.js");class s extends e.Pass{constructor(e,s="tDiffuse"){super("ShaderPass"),this.material=e,this.textureID=s}render(e,s,r,t,a){void 0!==this.material.uniforms[this.textureID]&&(this.material.uniforms[this.textureID].value=s.texture),e.render(this.scene,this.camera,this.renderToScreen?null:r)}}exports.ShaderPass=s;
},{"./Pass.js":163}],162:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutlinePass=void 0;var e=require("three"),t=require("../materials"),s=require("./BlurPass.js"),r=require("./Pass.js"),i=require("./RenderPass.js"),a=require("./ShaderPass.js");class n extends r.Pass{constructor(r,n,l={}){super("OutlinePass"),this.mainScene=r,this.mainCamera=n,this.renderTargetDepth=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter}),this.renderTargetDepth.texture.name="Outline.Depth",this.renderTargetDepth.texture.generateMipmaps=!1,this.renderTargetMask=this.renderTargetDepth.clone(),this.renderTargetMask.texture.format=e.RGBFormat,this.renderTargetMask.texture.name="Outline.Mask",this.renderTargetEdges=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,stencilBuffer:!1,depthBuffer:!1,format:e.RGBFormat}),this.renderTargetEdges.texture.name="Outline.Edges",this.renderTargetEdges.texture.generateMipmaps=!1,this.renderTargetBlurredEdges=this.renderTargetEdges.clone(),this.renderTargetBlurredEdges.texture.name="Outline.BlurredEdges",this.renderPassDepth=new i.RenderPass(this.mainScene,this.mainCamera,{overrideMaterial:new e.MeshDepthMaterial({depthPacking:e.RGBADepthPacking,morphTargets:!0,skinning:!0}),clearColor:new e.Color(16777215),clearAlpha:1}),this.renderPassMask=new i.RenderPass(this.mainScene,this.mainCamera,{overrideMaterial:new t.DepthComparisonMaterial(this.renderTargetDepth.texture,this.mainCamera),clearColor:new e.Color(16777215),clearAlpha:1}),this.blurPass=new s.BlurPass(l),this.kernelSize=l.kernelSize,this.copyPass=new a.ShaderPass(new t.CopyMaterial),this.copyPass.renderToScreen=!0,this.outlineEdgesMaterial=new t.OutlineEdgesMaterial(l),this.outlineEdgesMaterial.uniforms.tMask.value=this.renderTargetMask.texture,this.outlineBlendMaterial=new t.OutlineBlendMaterial(l),this.outlineBlendMaterial.uniforms.tMask.value=this.renderTargetMask.texture,this.blur=void 0===l.blur||l.blur,this.selection=[],this.time=0,this.pulseSpeed=void 0!==l.pulseSpeed?l.pulseSpeed:0,this.selectionLayer=10}get resolutionScale(){return this.blurPass.resolutionScale}set resolutionScale(e=.5){this.blurPass.resolutionScale=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e=t.KernelSize.VERY_SMALL){this.blurPass.kernelSize=e}get blur(){return this.blurPass.enabled}set blur(e){this.blurPass.enabled=e,this.outlineBlendMaterial.uniforms.tEdges.value=e?this.renderTargetBlurredEdges.texture:this.renderTargetEdges.texture}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get blend(){return this.needsSwap}set blend(e){this.needsSwap=e}get overlay(){return this.outlineBlendMaterial.uniforms.tEdges.value}setPatternTexture(e=null){this.outlineBlendMaterial.setPatternTexture(e)}setSelection(e){const t=e.slice(0),s=this.selectionLayer;let r,i;for(this.clearSelection(),r=0,i=t.length;r<i;++r)t[r].layers.enable(s);return this.selection=t,this}clearSelection(){const e=this.selection,t=this.selectionLayer;let s,r;for(s=0,r=e.length;s<r;++s)e[s].layers.disable(t);return this.selection=[],this.time=0,this}selectObject(e){return e.layers.enable(this.selectionLayer),this.selection.push(e),this}deselectObject(e){const t=this.selection,s=t.indexOf(e);return s>=0&&(t[s].layers.disable(this.selectionLayer),t.splice(s,1),0===t.length&&(this.time=0)),this}setSelectionVisible(e){const t=this.selection;let s,r;for(s=0,r=t.length;s<r;++s)e?t[s].layers.enable(0):t[s].layers.disable(0)}render(e,t,s,r,i){const a=this.mainScene,n=this.mainCamera,l=this.outlineBlendMaterial.uniforms.pulse;let h,d;this.selection.length>0?(h=a.background,d=n.layers.mask,a.background=null,l.value=1,this.pulseSpeed>0&&(l.value=.625+.375*Math.cos(this.time*this.pulseSpeed*10),this.time+=r),this.setSelectionVisible(!1),this.renderPassDepth.render(e,this.renderTargetDepth),this.setSelectionVisible(!0),n.layers.mask=1<<this.selectionLayer,this.renderPassMask.render(e,this.renderTargetMask),n.layers.mask=d,a.background=h,this.material=this.outlineEdgesMaterial,e.render(this.scene,this.camera,this.renderTargetEdges),this.blurPass.enabled&&this.blurPass.render(e,this.renderTargetEdges,this.renderTargetBlurredEdges),this.blend&&(this.material=this.outlineBlendMaterial,this.outlineBlendMaterial.uniforms.tDiffuse.value=t.texture,e.render(this.scene,this.camera,this.renderToScreen?null:this.outputBuffer))):this.renderToScreen&&this.copyPass.render(e,t)}setSize(e,t){this.renderTargetDepth.setSize(e,t),this.renderTargetMask.setSize(e,t),this.renderPassDepth.setSize(e,t),this.renderPassMask.setSize(e,t),this.blurPass.setSize(e,t),e=this.blurPass.width,t=this.blurPass.height,this.renderTargetEdges.setSize(e,t),this.renderTargetBlurredEdges.setSize(e,t),this.outlineBlendMaterial.uniforms.aspect.value=e/t,this.outlineEdgesMaterial.setTexelSize(1/e,1/t)}initialize(e,t){this.renderPassDepth.initialize(e,t),this.renderPassMask.initialize(e,t),this.blurPass.initialize(e,t)}}exports.OutlinePass=n;
},{"three":25,"../materials":73,"./BlurPass.js":153,"./Pass.js":163,"./RenderPass.js":166,"./ShaderPass.js":168}],164:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PixelationPass=void 0;var e=require("../materials"),t=require("./Pass.js");class r extends t.Pass{constructor(t=30){super("PixelationPass"),this.material=new e.PixelationMaterial,this.granularity=t}get granularity(){return this.material.granularity}set granularity(e=30){(e=Math.floor(e))%2>0&&(e+=1),this.material.granularity=e}render(e,t,r,a,s){this.material.uniforms.tDiffuse.value=t.texture,e.render(this.scene,this.camera,this.renderToScreen?null:r)}setSize(e,t){this.material.setResolution(e,t)}}exports.PixelationPass=r;
},{"../materials":73,"./Pass.js":163}],165:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RealisticBokehPass=void 0;var e=require("../materials"),s=require("./Pass.js");class t extends s.Pass{constructor(s,t={}){super("RealisticBokehPass"),this.material=new e.RealisticBokehMaterial(s,t)}render(e,s,t,r,i){this.material.uniforms.tDiffuse.value=s.texture,this.material.uniforms.tDepth.value=s.depthTexture,e.render(this.scene,this.camera,this.renderToScreen?null:t)}setSize(e,s){this.material.setTexelSize(1/e,1/s)}}exports.RealisticBokehPass=t;
},{"../materials":73,"./Pass.js":163}],167:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SavePass=void 0;var e=require("three"),r=require("../materials"),t=require("./Pass.js");class s extends t.Pass{constructor(t,s=!0){super("SavePass"),this.material=new r.CopyMaterial,this.needsSwap=!1,this.renderTarget=void 0!==t?t:new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Save.Target",this.renderTarget.texture.generateMipmaps=!1,this.resize=s}render(e,r,t,s,a){this.material.uniforms.tDiffuse.value=r.texture,e.render(this.scene,this.camera,this.renderTarget)}setSize(e,r){this.resize&&(e=Math.max(1,e),r=Math.max(1,r),this.renderTarget.setSize(e,r))}initialize(r,t){t||(this.renderTarget.texture.format=e.RGBFormat)}}exports.SavePass=s;
},{"three":25,"../materials":73,"./Pass.js":163}],169:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShockWavePass=void 0;var e=require("three"),t=require("../materials"),i=require("./Pass.js");const s=.5*Math.PI,a=new e.Vector3,r=new e.Vector3;class o extends i.Pass{constructor(i,s=new e.Vector3,a={}){super("ShockWavePass"),this.mainCamera=i,this.epicenter=s,this.screenPosition=new e.Vector3,this.speed=void 0!==a.speed?a.speed:2,this.time=0,this.active=!1,this.shockWaveMaterial=new t.ShockWaveMaterial(a),this.shockWaveMaterial.uniforms.center.value=this.screenPosition,this.copyMaterial=new t.CopyMaterial}explode(){this.time=0,this.active=!0}render(e,t,i,o,c){const h=this.epicenter,n=this.mainCamera,l=this.screenPosition,u=this.shockWaveMaterial,v=u.uniforms,p=v.center,m=v.radius,d=v.maxRadius,M=v.waveSize;this.copyMaterial.uniforms.tDiffuse.value=t.texture,this.material=this.copyMaterial,this.active&&(n.getWorldDirection(a),r.copy(n.position).sub(h),a.angleTo(r)>s&&(v.cameraDistance.value=n.position.distanceTo(h),l.copy(h).project(n),p.value.x=.5*(l.x+1),p.value.y=.5*(l.y+1),v.tDiffuse.value=t.texture,this.material=u),this.time+=o*this.speed,m.value=this.time-M.value,m.value>=2*(d.value+M.value)&&(this.active=!1)),e.render(this.scene,this.camera,this.renderToScreen?null:i)}setSize(e,t){this.shockWaveMaterial.uniforms.aspect.value=e/t}}exports.ShockWavePass=o;
},{"three":25,"../materials":73,"./Pass.js":163}],247:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII";
},{}],248:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default="data:image/png;base64,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";
},{}],170:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SMAAPass=void 0;var e=require("three"),r=require("../materials"),t=require("./ClearPass.js"),a=require("./Pass.js"),s=require("../materials/images/smaa/searchImageDataURL.js"),i=n(s),h=require("../materials/images/smaa/areaImageDataURL.js"),l=n(h);function n(e){return e&&e.__esModule?e:{default:e}}class u extends a.Pass{constructor(a,s){super("SMAAPass"),this.clearPass=new t.ClearPass({clearColor:new e.Color(0),clearAlpha:1}),this.renderTargetColorEdges=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearFilter,format:e.RGBFormat,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetColorEdges.texture.name="SMAA.ColorEdges",this.renderTargetColorEdges.texture.generateMipmaps=!1,this.renderTargetWeights=this.renderTargetColorEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.renderTargetWeights.texture.format=e.RGBAFormat,this.colorEdgesMaterial=new r.ColorEdgesMaterial,this.weightsMaterial=new r.SMAAWeightsMaterial,this.weightsMaterial.uniforms.tDiffuse.value=this.renderTargetColorEdges.texture,this.searchTexture=new e.Texture(a),this.searchTexture.name="SMAA.Search",this.searchTexture.magFilter=e.NearestFilter,this.searchTexture.minFilter=e.NearestFilter,this.searchTexture.format=e.RGBAFormat,this.searchTexture.generateMipmaps=!1,this.searchTexture.needsUpdate=!0,this.searchTexture.flipY=!1,this.weightsMaterial.uniforms.tSearch.value=this.searchTexture,this.areaTexture=new e.Texture(s),this.areaTexture.name="SMAA.Area",this.areaTexture.minFilter=e.LinearFilter,this.areaTexture.format=e.RGBAFormat,this.areaTexture.generateMipmaps=!1,this.areaTexture.needsUpdate=!0,this.areaTexture.flipY=!1,this.weightsMaterial.uniforms.tArea.value=this.areaTexture,this.blendMaterial=new r.SMAABlendMaterial,this.blendMaterial.uniforms.tWeights.value=this.renderTargetWeights.texture}render(e,r,t,a,s){this.material=this.colorEdgesMaterial,this.colorEdgesMaterial.uniforms.tDiffuse.value=r.texture,this.clearPass.render(e,this.renderTargetColorEdges),e.render(this.scene,this.camera,this.renderTargetColorEdges),this.material=this.weightsMaterial,e.render(this.scene,this.camera,this.renderTargetWeights),this.material=this.blendMaterial,this.blendMaterial.uniforms.tDiffuse.value=r.texture,e.render(this.scene,this.camera,this.renderToScreen?null:t)}setSize(e,r){this.renderTargetColorEdges.setSize(e,r),this.renderTargetWeights.setSize(e,r),this.colorEdgesMaterial.uniforms.texelSize.value.copy(this.weightsMaterial.uniforms.texelSize.value.copy(this.blendMaterial.uniforms.texelSize.value.set(1/e,1/r)))}static get searchImageDataURL(){return i.default}static get areaImageDataURL(){return l.default}}exports.SMAAPass=u;
},{"three":25,"../materials":73,"./ClearPass.js":156,"./Pass.js":163,"../materials/images/smaa/searchImageDataURL.js":247,"../materials/images/smaa/areaImageDataURL.js":248}],171:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TexturePass=void 0;var e=require("../materials"),t=require("./Pass.js");class r extends t.Pass{constructor(t,r=1,i=!0){super("TexturePass"),this.material=new e.CombineMaterial(i),this.texture=t,this.opacitySource=r}get texture(){return this.material.uniforms.texture2.value}set texture(e){this.material.uniforms.texture2.value=e}get opacityDestination(){return this.material.uniforms.opacity1.value}set opacityDestination(e=1){this.material.uniforms.opacity1.value=e}get opacitySource(){return this.material.uniforms.opacity2.value}set opacitySource(e=1){this.material.uniforms.opacity2.value=e}render(e,t,r,i,s){this.material.uniforms.texture1.value=t.texture,e.render(this.scene,this.camera,this.renderToScreen?null:r)}}exports.TexturePass=r;
},{"../materials":73,"./Pass.js":163}],172:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ToneMappingPass=void 0;var e=require("three"),t=require("../materials"),i=require("./Pass.js");class r extends i.Pass{constructor(i={}){super("ToneMappingPass"),this.renderTargetLuminosity=new e.WebGLRenderTarget(1,1,{minFilter:e.LinearMipMapLinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetLuminosity.texture.name="ToneMapping.Luminosity",this.renderTargetAdapted=this.renderTargetLuminosity.clone(),this.renderTargetAdapted.texture.name="ToneMapping.AdaptedLuminosity",this.renderTargetAdapted.texture.generateMipmaps=!1,this.renderTargetAdapted.texture.minFilter=e.LinearFilter,this.renderTargetPrevious=this.renderTargetAdapted.clone(),this.renderTargetPrevious.texture.name="ToneMapping.PreviousLuminosity",this.copyMaterial=new t.CopyMaterial,this.luminosityMaterial=new t.LuminosityMaterial,this.luminosityMaterial.uniforms.distinction.value=void 0!==i.distinction?i.distinction:1,this.adaptiveLuminosityMaterial=new t.AdaptiveLuminosityMaterial,this.resolution=i.resolution,this.toneMappingMaterial=new t.ToneMappingMaterial,this.adaptive=i.adaptive}get resolution(){return this.renderTargetLuminosity.width}set resolution(e=256){const t=Math.max(0,Math.ceil(Math.log2(e)));e=Math.pow(2,t),this.renderTargetLuminosity.setSize(e,e),this.renderTargetPrevious.setSize(e,e),this.renderTargetAdapted.setSize(e,e),this.adaptiveLuminosityMaterial.defines.MIP_LEVEL_1X1=t.toFixed(1),this.adaptiveLuminosityMaterial.needsUpdate=!0}get adaptive(){return void 0!==this.toneMappingMaterial.defines.ADAPTED_LUMINANCE}set adaptive(e=!0){e?(this.toneMappingMaterial.defines.ADAPTED_LUMINANCE="1",this.toneMappingMaterial.uniforms.luminanceMap.value=this.renderTargetAdapted.texture):(delete this.toneMappingMaterial.defines.ADAPTED_LUMINANCE,this.toneMappingMaterial.uniforms.luminanceMap.value=null),this.toneMappingMaterial.needsUpdate=!0}get dithering(){return this.toneMappingMaterial.dithering}set dithering(e){this.dithering!==e&&(this.toneMappingMaterial.dithering=e,this.toneMappingMaterial.needsUpdate=!0)}render(e,t,i,r,a){const n=this.scene,s=this.camera,o=this.adaptiveLuminosityMaterial,d=this.luminosityMaterial,u=this.toneMappingMaterial,p=this.copyMaterial,l=this.renderTargetPrevious,h=this.renderTargetLuminosity,M=this.renderTargetAdapted;this.adaptive&&(this.material=d,d.uniforms.tDiffuse.value=t.texture,e.render(n,s,h),this.material=o,o.uniforms.delta.value=r,o.uniforms.tPreviousLum.value=l.texture,o.uniforms.tCurrentLum.value=h.texture,e.render(n,s,M),this.material=p,p.uniforms.tDiffuse.value=M.texture,e.render(n,s,l)),this.material=u,u.uniforms.tDiffuse.value=t.texture,e.render(this.scene,this.camera,this.renderToScreen?null:i)}initialize(t,i){this.material=new e.MeshBasicMaterial({color:8388607}),t.render(this.scene,this.camera,this.renderTargetPrevious),this.material.dispose()}}exports.ToneMappingPass=r;
},{"three":25,"../materials":73,"./Pass.js":163}],72:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./BloomPass.js");Object.defineProperty(exports,"BloomPass",{enumerable:!0,get:function(){return e.BloomPass}});var r=require("./BlurPass.js");Object.defineProperty(exports,"BlurPass",{enumerable:!0,get:function(){return r.BlurPass}});var s=require("./BokehPass.js");Object.defineProperty(exports,"BokehPass",{enumerable:!0,get:function(){return s.BokehPass}});var t=require("./ClearMaskPass.js");Object.defineProperty(exports,"ClearMaskPass",{enumerable:!0,get:function(){return t.ClearMaskPass}});var a=require("./ClearPass.js");Object.defineProperty(exports,"ClearPass",{enumerable:!0,get:function(){return a.ClearPass}});var n=require("./DotScreenPass.js");Object.defineProperty(exports,"DotScreenPass",{enumerable:!0,get:function(){return n.DotScreenPass}});var u=require("./FilmPass.js");Object.defineProperty(exports,"FilmPass",{enumerable:!0,get:function(){return u.FilmPass}});var o=require("./GlitchPass.js");Object.defineProperty(exports,"GlitchMode",{enumerable:!0,get:function(){return o.GlitchMode}}),Object.defineProperty(exports,"GlitchPass",{enumerable:!0,get:function(){return o.GlitchPass}});var i=require("./GodRaysPass.js");Object.defineProperty(exports,"GodRaysPass",{enumerable:!0,get:function(){return i.GodRaysPass}});var P=require("./MaskPass.js");Object.defineProperty(exports,"MaskPass",{enumerable:!0,get:function(){return P.MaskPass}});var c=require("./OutlinePass.js");Object.defineProperty(exports,"OutlinePass",{enumerable:!0,get:function(){return c.OutlinePass}});var l=require("./Pass.js");Object.defineProperty(exports,"Pass",{enumerable:!0,get:function(){return l.Pass}});var p=require("./PixelationPass.js");Object.defineProperty(exports,"PixelationPass",{enumerable:!0,get:function(){return p.PixelationPass}});var b=require("./RealisticBokehPass.js");Object.defineProperty(exports,"RealisticBokehPass",{enumerable:!0,get:function(){return b.RealisticBokehPass}});var f=require("./RenderPass.js");Object.defineProperty(exports,"RenderPass",{enumerable:!0,get:function(){return f.RenderPass}});var j=require("./SavePass.js");Object.defineProperty(exports,"SavePass",{enumerable:!0,get:function(){return j.SavePass}});var d=require("./ShaderPass.js");Object.defineProperty(exports,"ShaderPass",{enumerable:!0,get:function(){return d.ShaderPass}});var x=require("./ShockWavePass.js");Object.defineProperty(exports,"ShockWavePass",{enumerable:!0,get:function(){return x.ShockWavePass}});var m=require("./SMAAPass.js");Object.defineProperty(exports,"SMAAPass",{enumerable:!0,get:function(){return m.SMAAPass}});var v=require("./TexturePass.js");Object.defineProperty(exports,"TexturePass",{enumerable:!0,get:function(){return v.TexturePass}});var y=require("./ToneMappingPass.js");Object.defineProperty(exports,"ToneMappingPass",{enumerable:!0,get:function(){return y.ToneMappingPass}});
},{"./BloomPass.js":152,"./BlurPass.js":153,"./BokehPass.js":154,"./ClearMaskPass.js":155,"./ClearPass.js":156,"./DotScreenPass.js":157,"./FilmPass.js":158,"./GlitchPass.js":159,"./GodRaysPass.js":160,"./MaskPass.js":161,"./OutlinePass.js":162,"./Pass.js":163,"./PixelationPass.js":164,"./RealisticBokehPass.js":165,"./RenderPass.js":166,"./SavePass.js":167,"./ShaderPass.js":168,"./ShockWavePass.js":169,"./SMAAPass.js":170,"./TexturePass.js":171,"./ToneMappingPass.js":172}],150:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EffectComposer=void 0;var e=require("three"),t=require("../passes"),s=require("../materials");class r{constructor(e=null,r={}){this.renderer=e,this.inputBuffer=null,this.outputBuffer=null,null!==this.renderer&&(this.renderer.autoClear=!1,this.inputBuffer=this.createBuffer(void 0===r.depthBuffer||r.depthBuffer,void 0!==r.stencilBuffer&&r.stencilBuffer,void 0!==r.depthTexture&&r.depthTexture),this.outputBuffer=this.inputBuffer.clone()),this.copyPass=new t.ShaderPass(new s.CopyMaterial),this.passes=[]}get depthTexture(){return this.inputBuffer.depthTexture}set depthTexture(e){this.inputBuffer.depthTexture=e,this.outputBuffer.depthTexture=e}replaceRenderer(e){const t=this.renderer;let s,r,i;return null!==t&&t!==e&&(this.renderer=e,this.renderer.autoClear=!1,s=t.domElement.parentNode,r=t.getSize(),i=e.getSize(),null!==s&&(s.removeChild(t.domElement),s.appendChild(e.domElement)),r.width===i.width&&r.height===i.height||this.setSize()),t}createBuffer(t,s,r){const i=this.renderer.getDrawingBufferSize(),u=this.renderer.context.getContextAttributes().alpha,n=new e.WebGLRenderTarget(i.width,i.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:u?e.RGBAFormat:e.RGBFormat,depthBuffer:t,stencilBuffer:s,depthTexture:r?new e.DepthTexture:null});return r&&s&&(n.depthTexture.format=e.DepthStencilFormat,n.depthTexture.type=e.UnsignedInt248Type),n.texture.name="EffectComposer.Buffer",n.texture.generateMipmaps=!1,n}addPass(e,t){const s=this.renderer,r=s.getDrawingBufferSize();e.setSize(r.width,r.height),e.initialize(s,s.context.getContextAttributes().alpha),void 0!==t?this.passes.splice(t,0,e):this.passes.push(e)}removePass(e){this.passes.splice(this.passes.indexOf(e),1)}render(e){const s=this.passes,r=this.copyPass,i=this.renderer;let u,n,h,f,p,o,d=this.inputBuffer,a=this.outputBuffer,l=!1;for(p=0,o=s.length;p<o;++p)(u=s[p]).enabled&&(u.render(i,d,a,e,l),u.needsSwap&&(l&&(r.renderToScreen=u.renderToScreen,n=i.context,(h=i.state).buffers.stencil.setFunc(n.NOTEQUAL,1,4294967295),r.render(i,d,a,e,l),h.buffers.stencil.setFunc(n.EQUAL,1,4294967295)),f=d,d=a,a=f),u instanceof t.MaskPass?l=!0:u instanceof t.ClearMaskPass&&(l=!1))}setSize(e,t){const s=this.passes,r=this.renderer;let i,u,n,h;for(void 0!==e&&void 0!==t||(e=(i=r.getSize()).width,t=i.height),r.setSize(e,t),u=r.getDrawingBufferSize(),this.inputBuffer.setSize(u.width,u.height),this.outputBuffer.setSize(u.width,u.height),n=0,h=s.length;n<h;++n)s[n].setSize(u.width,u.height)}reset(){const e=this.createBuffer(this.inputBuffer.depthBuffer,this.inputBuffer.stencilBuffer,null!==this.inputBuffer.depthTexture);this.dispose(),this.inputBuffer=e,this.outputBuffer=e.clone(),this.copyPass=new t.ShaderPass(new s.CopyMaterial)}dispose(){const e=this.passes;let t,s;for(t=0,s=e.length;t<s;++t)e[t].dispose();this.passes=[],null!==this.inputBuffer&&(this.inputBuffer.dispose(),this.inputBuffer=null),null!==this.outputBuffer&&(this.outputBuffer.dispose(),this.outputBuffer=null),this.copyPass.dispose()}}exports.EffectComposer=r;
},{"three":25,"../passes":72,"../materials":73}],151:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{setSize(e,s){}}exports.Resizable=e;
},{}],71:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Disposable.js");Object.defineProperty(exports,"Disposable",{enumerable:!0,get:function(){return e.Disposable}});var r=require("./EffectComposer.js");Object.defineProperty(exports,"EffectComposer",{enumerable:!0,get:function(){return r.EffectComposer}});var t=require("./Resizable.js");Object.defineProperty(exports,"Resizable",{enumerable:!0,get:function(){return t.Resizable}});
},{"./Disposable.js":149,"./EffectComposer.js":150,"./Resizable.js":151}],194:[function(require,module,exports) {
"use strict";function t(t,e,a,h){const n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),s=n.getContext("2d"),i=s.createImageData(t,e),o=i.data;let r,c,d,u;for(c=0;c<e;++c)for(r=0;r<t;++r)u=(c*t+r)*h,o[d=4*(c*t+r)]=h>0?a[u]:0,o[d+1]=h>1?a[u+1]:0,o[d+2]=h>2?a[u+2]:0,o[d+3]=h>3?a[u+3]:255;return n.width=t,n.height=e,s.putImageData(i,0,0),n}Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(t=0,e=0,a=null,h=4){this.width=t,this.height=e,this.data=a,this.channels=h}toCanvas(){return"undefined"==typeof document?null:t(this.width,this.height,this.data,this.channels)}}exports.RawImageData=e;
},{}],195:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SMAAAreaImageData=void 0;var e=require("three"),t=require("../../RawImageData.js");const a=new e.Box2,s=new e.Box2,r=16,n=20,c=30,i=32,d=new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),o=[new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125])],y=[new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4])],w=[new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3])];function A(e,t,a){return e+(t-e)*a}function b(e){return Math.min(Math.max(e,0),1)}function l(e,t){const a=t.min,s=t.max,r=.5*Math.sqrt(2*a.x),n=.5*Math.sqrt(2*a.y),c=.5*Math.sqrt(2*s.x),d=.5*Math.sqrt(2*s.y),o=b(e/i);return a.set(A(r,a.x,o),A(n,a.y,o)),s.set(A(c,s.x,o),A(d,s.y,o)),t}function h(e,t,a,s){const r=t.x-e.x,n=t.y-e.y,c=a,i=a+1,d=e.y+n*(c-e.x)/r,o=e.y+n*(i-e.x)/r;let y,w,A,b;return c>=e.x&&c<t.x||i>e.x&&i<=t.x?Math.sign(d)===Math.sign(o)||Math.abs(d)<1e-4||Math.abs(o)<1e-4?(y=(d+o)/2)<0?s.set(Math.abs(y),0):s.set(0,Math.abs(y)):(w=(b=-e.y*r/n+e.x)>e.x?d*(b-Math.trunc(b))/2:0,A=b<t.x?o*(1-(b-Math.trunc(b)))/2:0,(y=Math.abs(w)>Math.abs(A)?w:-A)<0?s.set(Math.abs(w),Math.abs(A)):s.set(Math.abs(A),Math.abs(w))):s.set(0,0),s}function x(e,t,r,n,c){const i=a.min,d=a.max,o=s.min,y=s.max,w=s,A=.5+n,b=.5+n-1,x=t+r+1;switch(e){case 0:c.set(0,0);break;case 1:t<=r?h(i.set(0,b),d.set(x/2,0),t,c):c.set(0,0);break;case 2:t>=r?h(i.set(x/2,0),d.set(x,b),t,c):c.set(0,0);break;case 3:h(i.set(0,b),d.set(x/2,0),t,o),h(i.set(x/2,0),d.set(x,b),t,y),l(x,w),c.addVectors(o,y);break;case 4:t<=r?h(i.set(0,A),d.set(x/2,0),t,c):c.set(0,0);break;case 5:c.set(0,0);break;case 6:Math.abs(n)>0?(h(i.set(0,A),d.set(x,b),t,o),h(i.set(0,A),d.set(x/2,0),t,y),y.add(h(i.set(x/2,0),d.set(x,b),t,c)),c.addVectors(o,y).divideScalar(2)):h(i.set(0,A),d.set(x,b),t,c);break;case 7:h(i.set(0,A),d.set(x,b),t,c);break;case 8:t>=r?h(i.set(x/2,0),d.set(x,A),t,c):c.set(0,0);break;case 9:Math.abs(n)>0?(h(i.set(0,b),d.set(x,A),t,o),h(i.set(0,b),d.set(x/2,0),t,y),y.add(h(i.set(x/2,0),d.set(x,A),t,c)),c.addVectors(o,y).divideScalar(2)):h(i.set(0,b),d.set(x,A),t,c);break;case 10:c.set(0,0);break;case 11:h(i.set(0,b),d.set(x,A),t,c);break;case 12:h(i.set(0,A),d.set(x/2,0),t,o),h(i.set(x/2,0),d.set(x,A),t,y),l(x,w),c.addVectors(o,y);break;case 13:h(i.set(0,b),d.set(x,A),t,c);break;case 14:h(i.set(0,A),d.set(x,b),t,c);break;case 15:c.set(0,0)}return c}function U(e,t,a,s){let r,n,c,i,d,o=e.equals(t);return o||(r=(e.x+t.x)/2,n=(e.y+t.y)/2,o=(d=(c=t.y-e.y)*(a-r)+(i=e.x-t.x)*(s-n))>0),o}function u(e,t,a,s){let r,n,i,d,o;for(r=0,i=0;i<c;++i)for(n=0;n<c;++n)U(e,t,a+(d=n/(c-1)),s+(o=i/(c-1)))&&++r;return r/(c*c)}function k(e,t,a,s,r,n){const c=w[e],i=c[0],d=c[1];return i>0&&(t.x+=r[0],t.y+=r[1]),d>0&&(a.x+=r[0],a.y+=r[1]),n.set(1-u(t,a,1+s,0+s),u(t,a,1+s,1+s))}function M(e,t,r,n,c){const i=a.min,d=a.max,o=s.min,y=s.max,w=t+r+1;switch(e){case 0:k(e,i.set(1,1),d.set(1+w,1+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 1:k(e,i.set(1,0),d.set(0+w,0+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 2:k(e,i.set(0,0),d.set(1+w,0+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 3:k(e,i.set(1,0),d.set(1+w,0+w),t,n,c);break;case 4:k(e,i.set(1,1),d.set(0+w,0+w),t,n,o),k(e,i.set(1,1),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 5:k(e,i.set(1,1),d.set(0+w,0+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 6:k(e,i.set(1,1),d.set(1+w,0+w),t,n,c);break;case 7:k(e,i.set(1,1),d.set(1+w,0+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 8:k(e,i.set(0,0),d.set(1+w,1+w),t,n,o),k(e,i.set(1,0),d.set(1+w,1+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 9:k(e,i.set(1,0),d.set(1+w,1+w),t,n,c);break;case 10:k(e,i.set(0,0),d.set(1+w,1+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 11:k(e,i.set(1,0),d.set(1+w,1+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 12:k(e,i.set(1,1),d.set(1+w,1+w),t,n,c);break;case 13:k(e,i.set(1,1),d.set(1+w,1+w),t,n,o),k(e,i.set(1,0),d.set(1+w,1+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 14:k(e,i.set(1,1),d.set(1+w,1+w),t,n,o),k(e,i.set(1,1),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2);break;case 15:k(e,i.set(1,1),d.set(1+w,1+w),t,n,o),k(e,i.set(1,0),d.set(1+w,0+w),t,n,y),c.addVectors(o,y).divideScalar(2)}return c}function f(t,a,s){const r=new e.Vector2;let n,c,i,d,o,y,w,A;for(n=0,c=t.length;n<c;++n)for(w=(y=t[n]).data,A=y.width,d=0;d<A;++d)for(i=0;i<A;++i)s?x(n,i,d,a,r):M(n,i,d,a,r),w[o=2*(d*A+i)]=255*r.x,w[o+1]=255*r.y}function m(t,a,s,r,n,c){const i=new e.Vector2,d=c.data,o=c.width;let y,w,A,b,l,h,x,U,u,k;for(y=0,w=a.length;y<w;++y)for(x=s[y],u=(U=a[y]).data,k=U.width,b=0;b<r;++b)for(A=0;A<r;++A)i.fromArray(x).multiplyScalar(r),i.add(t),i.x+=A,i.y+=b,h=n?2*(b*b*k+A*A):2*(b*k+A),d[l=2*(i.y*o+i.x)]=u[h],d[l+1]=u[h+1]}class V{static generate(){const a=10*r,s=5*d.length*r,c=new Uint8ClampedArray(a*s*2),i=new t.RawImageData(a,s,c,2),A=Math.pow(r-1,2)+1,b=n,l=[],h=[],x=new e.Vector2;let U,u;for(U=0;U<16;++U)l.push(new t.RawImageData(A,A,new Uint8ClampedArray(A*A*2),2)),h.push(new t.RawImageData(b,b,new Uint8ClampedArray(b*b*2),2));for(U=0,u=d.length;U<u;++U)f(l,d[U],!0),x.set(0,5*r*U),m(x,l,y,r,!0,i);for(U=0,u=o.length;U<u;++U)f(h,o[U],!1),x.set(5*r,4*n*U),m(x,h,w,n,!1,i);return i}}exports.SMAAAreaImageData=V;
},{"three":25,"../../RawImageData.js":194}],196:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SMAASearchImageData=void 0;var e=require("../../RawImageData.js");const t=new Map([[a([0,0,0,0]),[0,0,0,0]],[a([0,0,0,1]),[0,0,0,1]],[a([0,0,1,0]),[0,0,1,0]],[a([0,0,1,1]),[0,0,1,1]],[a([0,1,0,0]),[0,1,0,0]],[a([0,1,0,1]),[0,1,0,1]],[a([0,1,1,0]),[0,1,1,0]],[a([0,1,1,1]),[0,1,1,1]],[a([1,0,0,0]),[1,0,0,0]],[a([1,0,0,1]),[1,0,0,1]],[a([1,0,1,0]),[1,0,1,0]],[a([1,0,1,1]),[1,0,1,1]],[a([1,1,0,0]),[1,1,0,0]],[a([1,1,0,1]),[1,1,0,1]],[a([1,1,1,0]),[1,1,1,0]],[a([1,1,1,1]),[1,1,1,1]]]);function r(e,t,r){return e+(t-e)*r}function a(e){const t=r(e[0],e[1],.75),a=r(e[2],e[3],.75);return r(t,a,.875)}function n(e,t){let r=0;return 1===t[3]&&(r+=1),1===r&&1===t[2]&&1!==e[1]&&1!==e[3]&&(r+=1),r}function o(e,t){let r=0;return 1===t[3]&&1!==e[1]&&1!==e[3]&&(r+=1),1===r&&1===t[2]&&1!==e[0]&&1!==e[2]&&(r+=1),r}class s{static generate(){const r=new Uint8ClampedArray(2178),a=new Uint8ClampedArray(1024);let s,c,u,i,f,l,g;for(c=0;c<33;++c)for(s=0;s<66;++s)u=.03125*s,i=.03125*c,t.has(u)&&t.has(i)&&(l=t.get(u),g=t.get(i),r[66*c+s]=127*n(l,g),r[66*c+s+33]=127*o(l,g));for(f=0,c=17;c<33;++c)for(s=0;s<64;++s,++f)a[f]=r[66*c+s];return new e.RawImageData(64,16,a,1)}}exports.SMAASearchImageData=s;
},{"../../RawImageData.js":194}],74:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./smaa/utils/SMAAAreaImageData.js");Object.defineProperty(exports,"SMAAAreaImageData",{enumerable:!0,get:function(){return e.SMAAAreaImageData}});var a=require("./smaa/utils/SMAASearchImageData.js");Object.defineProperty(exports,"SMAASearchImageData",{enumerable:!0,get:function(){return a.SMAASearchImageData}});var r=require("./RawImageData.js");Object.defineProperty(exports,"RawImageData",{enumerable:!0,get:function(){return r.RawImageData}});
},{"./smaa/utils/SMAAAreaImageData.js":195,"./smaa/utils/SMAASearchImageData.js":196,"./RawImageData.js":194}],26:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./core");Object.defineProperty(exports,"Disposable",{enumerable:!0,get:function(){return e.Disposable}}),Object.defineProperty(exports,"EffectComposer",{enumerable:!0,get:function(){return e.EffectComposer}}),Object.defineProperty(exports,"Resizable",{enumerable:!0,get:function(){return e.Resizable}});var t=require("./passes");Object.defineProperty(exports,"BloomPass",{enumerable:!0,get:function(){return t.BloomPass}}),Object.defineProperty(exports,"BlurPass",{enumerable:!0,get:function(){return t.BlurPass}}),Object.defineProperty(exports,"BokehPass",{enumerable:!0,get:function(){return t.BokehPass}}),Object.defineProperty(exports,"ClearPass",{enumerable:!0,get:function(){return t.ClearPass}}),Object.defineProperty(exports,"ClearMaskPass",{enumerable:!0,get:function(){return t.ClearMaskPass}}),Object.defineProperty(exports,"DotScreenPass",{enumerable:!0,get:function(){return t.DotScreenPass}}),Object.defineProperty(exports,"FilmPass",{enumerable:!0,get:function(){return t.FilmPass}}),Object.defineProperty(exports,"GlitchMode",{enumerable:!0,get:function(){return t.GlitchMode}}),Object.defineProperty(exports,"GlitchPass",{enumerable:!0,get:function(){return t.GlitchPass}}),Object.defineProperty(exports,"GodRaysPass",{enumerable:!0,get:function(){return t.GodRaysPass}}),Object.defineProperty(exports,"MaskPass",{enumerable:!0,get:function(){return t.MaskPass}}),Object.defineProperty(exports,"OutlinePass",{enumerable:!0,get:function(){return t.OutlinePass}}),Object.defineProperty(exports,"Pass",{enumerable:!0,get:function(){return t.Pass}}),Object.defineProperty(exports,"PixelationPass",{enumerable:!0,get:function(){return t.PixelationPass}}),Object.defineProperty(exports,"RealisticBokehPass",{enumerable:!0,get:function(){return t.RealisticBokehPass}}),Object.defineProperty(exports,"RenderPass",{enumerable:!0,get:function(){return t.RenderPass}}),Object.defineProperty(exports,"SavePass",{enumerable:!0,get:function(){return t.SavePass}}),Object.defineProperty(exports,"ShaderPass",{enumerable:!0,get:function(){return t.ShaderPass}}),Object.defineProperty(exports,"ShockWavePass",{enumerable:!0,get:function(){return t.ShockWavePass}}),Object.defineProperty(exports,"SMAAPass",{enumerable:!0,get:function(){return t.SMAAPass}}),Object.defineProperty(exports,"TexturePass",{enumerable:!0,get:function(){return t.TexturePass}}),Object.defineProperty(exports,"ToneMappingPass",{enumerable:!0,get:function(){return t.ToneMappingPass}});var r=require("./materials");Object.defineProperty(exports,"AdaptiveLuminosityMaterial",{enumerable:!0,get:function(){return r.AdaptiveLuminosityMaterial}}),Object.defineProperty(exports,"BokehMaterial",{enumerable:!0,get:function(){return r.BokehMaterial}}),Object.defineProperty(exports,"ColorEdgesMaterial",{enumerable:!0,get:function(){return r.ColorEdgesMaterial}}),Object.defineProperty(exports,"CombineMaterial",{enumerable:!0,get:function(){return r.CombineMaterial}}),Object.defineProperty(exports,"ConvolutionMaterial",{enumerable:!0,get:function(){return r.ConvolutionMaterial}}),Object.defineProperty(exports,"CopyMaterial",{enumerable:!0,get:function(){return r.CopyMaterial}}),Object.defineProperty(exports,"DepthComparisonMaterial",{enumerable:!0,get:function(){return r.DepthComparisonMaterial}}),Object.defineProperty(exports,"DotScreenMaterial",{enumerable:!0,get:function(){return r.DotScreenMaterial}}),Object.defineProperty(exports,"FilmMaterial",{enumerable:!0,get:function(){return r.FilmMaterial}}),Object.defineProperty(exports,"GlitchMaterial",{enumerable:!0,get:function(){return r.GlitchMaterial}}),Object.defineProperty(exports,"GodRaysMaterial",{enumerable:!0,get:function(){return r.GodRaysMaterial}}),Object.defineProperty(exports,"KernelSize",{enumerable:!0,get:function(){return r.KernelSize}}),Object.defineProperty(exports,"LuminosityMaterial",{enumerable:!0,get:function(){return r.LuminosityMaterial}}),Object.defineProperty(exports,"OutlineBlendMaterial",{enumerable:!0,get:function(){return r.OutlineBlendMaterial}}),Object.defineProperty(exports,"OutlineEdgesMaterial",{enumerable:!0,get:function(){return r.OutlineEdgesMaterial}}),Object.defineProperty(exports,"PixelationMaterial",{enumerable:!0,get:function(){return r.PixelationMaterial}}),Object.defineProperty(exports,"RealisticBokehMaterial",{enumerable:!0,get:function(){return r.RealisticBokehMaterial}}),Object.defineProperty(exports,"ShockWaveMaterial",{enumerable:!0,get:function(){return r.ShockWaveMaterial}}),Object.defineProperty(exports,"SMAABlendMaterial",{enumerable:!0,get:function(){return r.SMAABlendMaterial}}),Object.defineProperty(exports,"SMAAWeightsMaterial",{enumerable:!0,get:function(){return r.SMAAWeightsMaterial}}),Object.defineProperty(exports,"ToneMappingMaterial",{enumerable:!0,get:function(){return r.ToneMappingMaterial}});var n=require("./materials/images");Object.defineProperty(exports,"RawImageData",{enumerable:!0,get:function(){return n.RawImageData}}),Object.defineProperty(exports,"SMAAAreaImageData",{enumerable:!0,get:function(){return n.SMAAAreaImageData}}),Object.defineProperty(exports,"SMAASearchImageData",{enumerable:!0,get:function(){return n.SMAASearchImageData}});
},{"./core":71,"./passes":72,"./materials":73,"./materials/images":74}],8:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.leftWristController=exports.rightWristController=exports.domToWorld=void 0,exports.clothController=X,exports.animateCloth=Q;var t=require("three"),e=n(t),o=require("postprocessing"),i=n(o);function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e.default=t,e}const r=new e.Scene,s=new e.WebGLRenderer({antialias:!0,alpha:!0});s.setClearColor(0,0),s.setSize(window.innerWidth,window.innerHeight);const a=window.innerWidth,l=window.innerHeight,c=new e.PerspectiveCamera(30,window.innerWidth/window.innerHeight,1,1e4);c.position.set(0,0,1500),c.lookAt(0,0,0);const p=new i.EffectComposer(s);p.addPass(new i.RenderPass(r,c));const h=new i.BloomPass,d=new e.Clock;h.renderToScreen=!0,p.addPass(h),document.getElementById("three").appendChild(s.domElement),r.add(new e.AmbientLight(0));let u=new e.DirectionalLight(14674943);u.position.set(100,5,150),r.add(u);const w=new e.Raycaster;let m=new e.Vector2,f=new e.Vector3;const y=exports.domToWorld=function(t,o){let i=new e.Vector3,n=t/a*2-1,r=(o-l)/l*2+1;i.set(n,-r,0),i.unproject(c);let s=i.sub(c.position).normalize(),p=-c.position.z/s.z;return c.position.clone().add(s.multiplyScalar(p))};function g(t){let e=y(t.clientX,t.clientY);f.set(e.x,e.y,0),sphere.position.set(e.x,e.y,0)}window.addEventListener("mousemove",g,!1);let x=new e.Vector3;const v=exports.rightWristController=function(t,e){let o=y(t,e);x.set(o.x,o.y,0)};let V=new e.Vector3;const M=exports.leftWristController=function(t,e){let o=y(t,e);V.set(o.x,o.y,0)};let C,S=.03,b=1-S,P=.05,W=15,D=15,z=15,F=H(W*D,W*z),L=new I(D,z),T=981*1.4,k=new e.Vector3(0,-T,0).multiplyScalar(P),E=.018,R=E*E,_=[0,L.w],j=!0,A=new e.Vector3(0,0,0),B=new e.Vector3(0,-45,0),G=new e.Vector3;function H(t,o){return function(i,n,r){let s=r||new e.Vector3,a=(i-.5)*t,l=(n+.5)*o;return s.set(a,l,0)}}function N(t,o,i,n){this.position=F(t,o),this.previous=F(t,o),this.original=F(t,o),this.a=new e.Vector3(0,0,0),this.mass=n,this.invMass=1/n,this.tmp=new e.Vector3,this.tmp2=new e.Vector3}N.prototype.addForce=function(t){this.a.add(this.tmp2.copy(t).multiplyScalar(this.invMass))},N.prototype.integrate=function(t){let e=this.tmp.subVectors(this.position,this.previous);e.multiplyScalar(b).add(this.position),e.add(this.a.multiplyScalar(t)),this.tmp=this.previous,this.previous=this.position,this.position=e,this.a.set(0,0,0)};let O=new e.Vector3;function q(t,e,o){O.subVectors(e.position,t.position);let i=O.length();if(0===i)return;let n=O.multiplyScalar(1-o/i).multiplyScalar(.5);t.position.add(n),e.position.sub(n)}function I(t,e){t=t||10,e=e||10,this.w=t,this.h=e;let o,i,n=[],r=[];for(i=0;i<=e;i++)for(o=0;o<=t;o++)n.push(new N(o/t,i/e,0,P));for(i=0;i<e;i++)for(o=0;o<t;o++)r.push([n[s(o,i)],n[s(o,i+1)],W]),r.push([n[s(o,i)],n[s(o+1,i)],W]);for(o=t,i=0;i<e;i++)r.push([n[s(o,i)],n[s(o,i+1)],W]);for(i=e,o=0;o<t;o++)r.push([n[s(o,i)],n[s(o+1,i)],W]);function s(e,o){return e+o*(t+1)}this.particles=n,this.constraints=r,this.index=s}function U(t){if(!C)return void(C=t);let e,o,i,n,r,s;if(j){let t,n,r=J.faces;for(i=L.particles,e=0,o=r.length;e<o;e++)n=(t=r[e]).normal,G.copy(n).normalize().multiplyScalar(n.dot(A)),i[t.a].addForce(G),i[t.b].addForce(G),i[t.c].addForce(G)}for(e=0,o=(i=L.particles).length;e<o;e++)(n=i[e]).addForce(k),n.integrate(R);for(o=(r=L.constraints).length,e=0;e<o;e++)q((s=r[e])[0],s[1],s[2]);B.z=90*-Math.sin(Date.now()/600),B.x=70*Math.cos(Date.now()/400),i[_[_.length-1]].position.set(x.x,x.y,0),i[_[0]].position.set(V.x,V.y,0)}function X(t){}let Y=new e.MeshLambertMaterial({side:e.DoubleSide,alphaTest:.5,color:13423325}),J=new e.ParametricGeometry(F,L.w,L.h),K=new e.Mesh(J,Y);function Q(){w.setFromCamera(m,c);let t=Date.now(),e=40*Math.sin(t/1e4);A.set(Math.sin(t/2e3),Math.cos(t/3e3),Math.sin(t/1e3)),A.normalize(),A.multiplyScalar(e),U(t),Z()}function Z(){let t=L.particles;for(let e=0;e<t.length;e++)J.vertices[e].copy(t[e].position);J.verticesNeedUpdate=!0,J.computeFaceNormals(),J.computeVertexNormals(),p.render(d.getDelta())}K.position.set(0,0,0),r.add(K),K.customDepthMaterial=new e.MeshDepthMaterial({depthPacking:e.RGBADepthPacking,alphaTest:.5});
},{"three":25,"postprocessing":26}],17:[function(require,module,exports) {
var define;
var t;!function(e,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof t&&t.amd?t([],s):"object"==typeof exports?exports.Typed=s():e.Typed=s()}(this,function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}return s.m=t,s.c=e,s.p="",s(0)}([function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}();var r=s(1),i=s(3),o=function(){function t(e,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r.initializer.load(this,s,e),this.begin()}return n(t,[{key:"toggle",value:function(){this.pause.status?this.start():this.stop()}},{key:"stop",value:function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))}},{key:"start",value:function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))}},{key:"destroy",value:function(){this.reset(!1),this.options.onDestroy(this)}},{key:"reset",value:function(){var t=arguments.length<=0||void 0===arguments[0]||arguments[0];clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,t&&(this.insertCursor(),this.options.onReset(this),this.begin())}},{key:"begin",value:function(){var t=this;this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout(function(){t.currentElContent&&0!==t.currentElContent.length?t.backspace(t.currentElContent,t.currentElContent.length):t.typewrite(t.strings[t.sequence[t.arrayPos]],t.strPos)},this.startDelay)}},{key:"typewrite",value:function(t,e){var s=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var n=this.humanizer(this.typeSpeed),r=1;!0!==this.pause.status?this.timeout=setTimeout(function(){e=i.htmlParser.typeHtmlChars(t,e,s);var n=0,o=t.substr(e);if("^"===o.charAt(0)&&/^\^\d+/.test(o)){var a=1;a+=(o=/\d+/.exec(o)[0]).length,n=parseInt(o),s.temporaryPause=!0,s.options.onTypingPaused(s.arrayPos,s),t=t.substring(0,e)+t.substring(e+a),s.toggleBlinking(!0)}if("`"===o.charAt(0)){for(;"`"!==t.substr(e+r).charAt(0)&&!(e+ ++r>t.length););var u=t.substring(0,e),l=t.substring(u.length+1,e+r),c=t.substring(e+r+1);t=u+l+c,r--}s.timeout=setTimeout(function(){s.toggleBlinking(!1),e===t.length?s.doneTyping(t,e):s.keepTyping(t,e,r),s.temporaryPause&&(s.temporaryPause=!1,s.options.onTypingResumed(s.arrayPos,s))},n)},n):this.setPauseStatus(t,e,!0)}},{key:"keepTyping",value:function(t,e,s){0===e&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this)),e+=s;var n=t.substr(0,e);this.replaceText(n),this.typewrite(t,e)}},{key:"doneTyping",value:function(t,e){var s=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout(function(){s.backspace(t,e)},this.backDelay))}},{key:"backspace",value:function(t,e){var s=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var n=this.humanizer(this.backSpeed);this.timeout=setTimeout(function(){e=i.htmlParser.backSpaceHtmlChars(t,e,s);var n=t.substr(0,e);if(s.replaceText(n),s.smartBackspace){var r=s.strings[s.arrayPos+1];r&&n===r.substr(0,e)?s.stopNum=e:s.stopNum=0}e>s.stopNum?(e--,s.backspace(t,e)):e<=s.stopNum&&(s.arrayPos++,s.arrayPos===s.strings.length?(s.arrayPos=0,s.options.onLastStringBackspaced(),s.shuffleStringsIfNeeded(),s.begin()):s.typewrite(s.strings[s.sequence[s.arrayPos]],e))},n)}else this.setPauseStatus(t,e,!0)}},{key:"complete",value:function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0}},{key:"setPauseStatus",value:function(t,e,s){this.pause.typewrite=s,this.pause.curString=t,this.pause.curStrPos=e}},{key:"toggleBlinking",value:function(t){this.cursor&&(this.pause.status||this.cursorBlinking!==t&&(this.cursorBlinking=t,t?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))}},{key:"humanizer",value:function(t){return Math.round(Math.random()*t/2)+t}},{key:"shuffleStringsIfNeeded",value:function(){this.shuffle&&(this.sequence=this.sequence.sort(function(){return Math.random()-.5}))}},{key:"initFadeOut",value:function(){var t=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout(function(){t.arrayPos++,t.replaceText(""),t.strings.length>t.arrayPos?t.typewrite(t.strings[t.sequence[t.arrayPos]],0):(t.typewrite(t.strings[0],0),t.arrayPos=0)},this.fadeOutDelay)}},{key:"replaceText",value:function(t){this.attr?this.el.setAttribute(this.attr,t):this.isInput?this.el.value=t:"html"===this.contentType?this.el.innerHTML=t:this.el.textContent=t}},{key:"bindFocusEvents",value:function(){var t=this;this.isInput&&(this.el.addEventListener("focus",function(e){t.stop()}),this.el.addEventListener("blur",function(e){t.el.value&&0!==t.el.value.length||t.start()}))}},{key:"insertCursor",value:function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))}}]),t}();e.default=o,t.exports=e.default},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},r=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}();var i,o=s(2),a=(i=o)&&i.__esModule?i:{default:i},u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"load",value:function(t,e,s){if(t.el="string"==typeof s?document.querySelector(s):s,t.options=n({},a.default,e),t.isInput="input"===t.el.tagName.toLowerCase(),t.attr=t.options.attr,t.bindInputFocusEvents=t.options.bindInputFocusEvents,t.showCursor=!t.isInput&&t.options.showCursor,t.cursorChar=t.options.cursorChar,t.cursorBlinking=!0,t.elContent=t.attr?t.el.getAttribute(t.attr):t.el.textContent,t.contentType=t.options.contentType,t.typeSpeed=t.options.typeSpeed,t.startDelay=t.options.startDelay,t.backSpeed=t.options.backSpeed,t.smartBackspace=t.options.smartBackspace,t.backDelay=t.options.backDelay,t.fadeOut=t.options.fadeOut,t.fadeOutClass=t.options.fadeOutClass,t.fadeOutDelay=t.options.fadeOutDelay,t.isPaused=!1,t.strings=t.options.strings.map(function(t){return t.trim()}),"string"==typeof t.options.stringsElement?t.stringsElement=document.querySelector(t.options.stringsElement):t.stringsElement=t.options.stringsElement,t.stringsElement){t.strings=[],t.stringsElement.style.display="none";var r=Array.prototype.slice.apply(t.stringsElement.children),i=r.length;if(i)for(var o=0;o<i;o+=1){var u=r[o];t.strings.push(u.innerHTML.trim())}}for(var o in t.strPos=0,t.arrayPos=0,t.stopNum=0,t.loop=t.options.loop,t.loopCount=t.options.loopCount,t.curLoop=0,t.shuffle=t.options.shuffle,t.sequence=[],t.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},t.typingComplete=!1,t.strings)t.sequence[o]=o;t.currentElContent=this.getCurrentElContent(t),t.autoInsertCss=t.options.autoInsertCss,this.appendAnimationCss(t)}},{key:"getCurrentElContent",value:function(t){return t.attr?t.el.getAttribute(t.attr):t.isInput?t.el.value:"html"===t.contentType?t.el.innerHTML:t.el.textContent}},{key:"appendAnimationCss",value:function(t){if(t.autoInsertCss&&(t.showCursor||t.fadeOut)&&!document.querySelector("[data-typed-js-css]")){var e=document.createElement("style");e.type="text/css",e.setAttribute("data-typed-js-css",!0);var s="";t.showCursor&&(s+="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      "),t.fadeOut&&(s+="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      "),0!==e.length&&(e.innerHTML=s,document.body.appendChild(e))}}}]),t}();e.default=u;var l=new u;e.initializer=l},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onComplete:function(t){},preStringTyped:function(t,e){},onStringTyped:function(t,e){},onLastStringBackspaced:function(t){},onTypingPaused:function(t,e){},onTypingResumed:function(t,e){},onReset:function(t){},onStop:function(t,e){},onStart:function(t,e){},onDestroy:function(t){}};e.default=s,t.exports=e.default},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}();var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return s(t,[{key:"typeHtmlChars",value:function(t,e,s){if("html"!==s.contentType)return e;var n=t.substr(e).charAt(0);if("<"===n||"&"===n){var r="";for(r="<"===n?">":";";t.substr(e+1).charAt(0)!==r&&!(++e+1>t.length););e++}return e}},{key:"backSpaceHtmlChars",value:function(t,e,s){if("html"!==s.contentType)return e;var n=t.substr(e).charAt(0);if(">"===n||";"===n){var r="";for(r=">"===n?"<":"&";t.substr(e-1).charAt(0)!==r&&!(--e<0););e--}return e}}]),t}();e.default=n;var r=new n;e.htmlParser=r}])});
},{}],6:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("babel-runtime/core-js/promise"),t=l(e);exports.bindPage=V;var n=require("@tensorflow-models/posenet"),o=c(n),i=require("stats.js"),s=l(i),r=require("./demo_util"),a=require("./threeCloth"),d=require("typed.js"),u=l(d);function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function l(e){return e&&e.__esModule?e:{default:e}}const p=600,h=500,g=window.innerWidth,m=window.innerHeight,y=new s.default;function f(){return/Android/i.test(navigator.userAgent)}function w(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function v(){return f()||w()}let P={strings:["welcome","this is an experiment by Kaitlin Schaer","playing with pose and gesture in the browser","turn on your webcam to interact",":)","poseToThree.js"],typeSpeed:40,loop:!1,showCursor:!0,cursorChar:"|",backDelay:1e3},b=new u.default(".typer",P);async function k(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const e=document.getElementById("video");e.width=p,e.height=h;const n=v(),o=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:n?void 0:p,height:n?void 0:h}});return e.srcObject=o,new t.default(t=>{e.onloadedmetadata=(()=>{t(e)})})}async function C(){const e=await k();return e.play(),e}const M={algorithm:"single-pose",input:{mobileNetArchitecture:.75,outputStride:16,imageScaleFactor:.3},singlePoseDetection:{minPoseConfidence:.25,minPartConfidence:.5},multiPoseDetection:{maxPoseDetections:5,minPoseConfidence:.15,minPartConfidence:.1,nmsRadius:30},output:{showVideo:!1,showSkeleton:!0,showPoints:!0},net:null};function x(e,t){M.net=t,e.length>0&&(M.camera=e[0].deviceId)}function D(){y.showPanel(0),document.body.appendChild(y.dom)}let S=0,I=0,j=0,q=0;const E=10,U=(e,t)=>e+t,_=function(e){return e.reduce(U)/e.length};let A,B,O,F,W=[],G=[],K=[],R=[];function T(e,t){const n=document.getElementById("output"),o=n.getContext("2d"),i=!0;n.width=p,n.height=h,async function t(){y.begin();const n=M.input.imageScaleFactor,s=+M.input.outputStride;let d,u,c=[];const l=await M.net.estimateSinglePose(e,n,i,s);c.push(l),d=+M.singlePoseDetection.minPoseConfidence,u=+M.singlePoseDetection.minPartConfidence,o.clearRect(0,0,p,h),M.output.showVideo&&(o.save(),o.scale(-1,1),o.translate(-p,0),o.drawImage(e,0,0,p,h),o.restore()),S&&I||(S=c[0].keypoints[10].position.x-p/2+g/2,I=c[0].keypoints[10].position.y-h/2+m/2),j&&q||(j=c[0].keypoints[9].position.x-p/2+g/2,q=c[0].keypoints[9].position.y-h/2+m/2),S=c[0].keypoints[10].position.x-p/2+g/2,I=c[0].keypoints[10].position.y-h/2+m/2,j=c[0].keypoints[9].position.x-p/2+g/2,q=c[0].keypoints[9].position.y-h/2+m/2,W.length>E&&(W.shift(),G.shift(),K.shift(),R.shift()),W.push(S),G.push(I),K.push(j),R.push(q),W.length?(A=_(W),B=_(G),O=_(K),F=_(R)):(A=S,B=I,O=j,F=q),c.forEach(({score:e,keypoints:t})=>{e>=d&&(M.output.showPoints&&((0,r.drawKeypoints)(t,u,o),(0,a.leftWristController)(A,B),(0,a.rightWristController)(O,F)),M.output.showSkeleton&&(0,r.drawSkeleton)(t,u,o))}),y.end(),(0,a.animateCloth)(),requestAnimationFrame(t)}()}async function V(){const e=await o.load(.75);let t;document.getElementById("loading").style.display="none",document.getElementById("main").style.display="block";try{t=await C()}catch(e){let t=document.getElementById("info");throw t.textContent="this browser does not support video capture,or this device does not have a camera",t.style.display="block",e}x([],e),D(),T(t,e)}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,V();
},{"babel-runtime/core-js/promise":16,"@tensorflow-models/posenet":15,"stats.js":14,"./demo_util":10,"./threeCloth":8,"typed.js":17}]},{},[6], null)
//# sourceMappingURL=/camera.60d8a276.map